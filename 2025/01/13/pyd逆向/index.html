<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;zh-CN&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Npc"><meta name="copyright" content="Npc"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>pydé€†å‘ | Npc | Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.css"><script src="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.js"></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"npc0vo.github.io","root":"/","title":"Npcå°ç«™","version":"1.10.11","mode":"light","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://waline-onelastchicks-projects.vercel.app/","comment":false,"el":"#waline","lang":["en","zh-CN","default"]},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="https:&#x2F;&#x2F;tenthousandmeters.com&#x2F;blog&#x2F;python-behind-the-scenes-8-how-python-integers-work&#x2F; https:&#x2F;&#x2F;www.cnblogs.com&#x2F;lordtianqiyi&#x2F;p&#x2F;18614184 https:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;16155?time__1311&#x3D;GuD%3D7Iqmxfhx%2FD0lD2">
<meta property="og:type" content="article">
<meta property="og:title" content="pydé€†å‘">
<meta property="og:url" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/index.html">
<meta property="og:site_name" content="Npc | Blog">
<meta property="og:description" content="https:&#x2F;&#x2F;tenthousandmeters.com&#x2F;blog&#x2F;python-behind-the-scenes-8-how-python-integers-work&#x2F; https:&#x2F;&#x2F;www.cnblogs.com&#x2F;lordtianqiyi&#x2F;p&#x2F;18614184 https:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;16155?time__1311&#x3D;GuD%3D7Iqmxfhx%2FD0lD2">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734420585968-3909b9a2-ef0e-4948-8134-ea08ae1bf219.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734420599875-3236ccdf-0ac1-4293-9ea7-4c22ce12e355.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734421313126-48de522e-d915-4ef9-8ef9-b8624b3316cb.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734421377754-5a2acd1c-de74-408a-a292-e31c7f86fb83.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734438391825-fad73a81-6cf2-4ce7-b49c-b9a45e09a600.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734438229203-72af4db1-08e0-4ebf-9d88-7074922c2a98.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734438456803-17510bbd-eee7-46af-a6ad-8a9d003b2248.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734440524313-31b102fe-4196-4718-b942-0afb3842cf14.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734440512426-80086783-e086-426a-81ee-d88e8873fc4d.png">
<meta property="og:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734440678680-b030ccc2-13e0-4831-9d3c-89c61276993f.png">
<meta property="article:published_time" content="2025-01-13T09:03:21.000Z">
<meta property="article:modified_time" content="2025-01-13T09:05:54.144Z">
<meta property="article:author" content="Npc">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/1734420585968-3909b9a2-ef0e-4948-8134-ea08ae1bf219.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Npc"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Npc"><span class="site-author-status">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">Npc</a></div><span class="site-name">Npc | Blog</span><sub class="site-subtitle">åˆæ´»äº†ä¸€å¤©</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">75</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">11</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">14</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/npc0vo" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@1930278836@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/npc0vo" title="Yuque" target="_blank" style="color:#a0c69d"><span class="icon iconify" data-icon="ri:yuque-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#basic"><span class="toc-number">1.</span> <span class="toc-text"> Basic</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#py_long%E7%9A%84%E8%A7%A3%E6%9E%90"><span class="toc-number">1.1.</span> <span class="toc-text"> PY_LONGçš„è§£æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cython%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80"><span class="toc-number">1.2.</span> <span class="toc-text"> cythoné€†å‘åŸºç¡€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E9%A2%98%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text"> å¸¸è§çš„é¢˜å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-number">2.</span> <span class="toc-text"> æ–¹æ³•æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E7%B1%BB"><span class="toc-number">2.1.</span> <span class="toc-text"> æ³¨å…¥ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%86%99%E4%B8%80%E4%B8%AApyd%E6%81%A2%E5%A4%8D%E7%AC%A6%E5%8F%B7"><span class="toc-number">2.2.</span> <span class="toc-text"> æ‰‹å†™ä¸€ä¸ªpyd(æ¢å¤ç¬¦å·)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81trace"><span class="toc-number">2.3.</span> <span class="toc-text"> åŠ¨æ€trace</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2025ciscn-rand0m"><span class="toc-number">2.3.1.</span> <span class="toc-text"> 2025ciscn-rand0m</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#idapro%E7%9A%84trace"><span class="toc-number">2.3.1.1.</span> <span class="toc-text"> idaproçš„trace</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#xdbg"><span class="toc-number">2.3.1.2.</span> <span class="toc-text"> xdbg</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2025ciscn-cython"><span class="toc-number">2.3.2.</span> <span class="toc-text"> 2025ciscn-cython</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://npc0vo.github.io/2025/01/13/pyd%E9%80%86%E5%90%91/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Npc"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Npc | Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">pydé€†å‘</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2025-01-13 17:03:21" itemprop="dateCreated datePublished" datetime="2025-01-13T17:03:21+08:00">2025-01-13</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">5.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">30m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Reverse/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Reverse</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/Reverse/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">Reverse</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><blockquote>
<p><a target="_blank" rel="noopener" href="https://tenthousandmeters.com/blog/python-behind-the-scenes-8-how-python-integers-work/">https://tenthousandmeters.com/blog/python-behind-the-scenes-8-how-python-integers-work/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lordtianqiyi/p/18614184">https://www.cnblogs.com/lordtianqiyi/p/18614184</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/16155?time__1311=GuD%3D7Iqmxfhx%2FD0lD2DUgDj2RjGCK%2Bj3WfeD">https://xz.aliyun.com/t/16155?time__1311=GuD%3D7Iqmxfhx%2FD0lD2DUgDj2RjGCK%2Bj3WfeD</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.hxzzz.asia/">https://blog.hxzzz.asia/</a></p>
</blockquote>
<p>è¿™æ¬¡å›½èµ›å‡ºäº†2ä¸ªcythonï¼Œå‘ç°æˆ‘éƒ½ä¸ä¼šï¼Œå¤ªèœäº†</p>
<p>èµ›å®Œå­¦ä¹ ä¸€æ³¢</p>
<h2 id="basic"><a class="markdownIt-Anchor" href="#basic"></a> Basic</h2>
<p>Cython = ä¸€ä¸ªå¯ä»¥å°† Python è½¬åŒ–ä¸º C çš„ç¼–è¯‘å™¨ï¼Œä¹Ÿæ˜¯ä¸€ç§è¯­è¨€ï¼ˆPython çš„è¶…é›†ï¼‰</p>
<p>Python = ä¸€ç§ä¼—æ‰€å‘¨çŸ¥çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¯ä»¥è®©ä½ å¿«é€Ÿå·¥ä½œå¹¶æ›´æœ‰æ•ˆåœ°é›†æˆç³»ç»Ÿã€‚<br />
CPython = Python è§£é‡Šå™¨çš„æºç ï¼Œå¹¶ç»™ç”¨æˆ·æä¾› Python-C API æ”¯æŒä»¥ç¼–å†™ C æ‰©å±•</p>
<p>python æºæ–‡ä»¶(.py)  ç»è¿‡è§£é‡Šå™¨ å¾—åˆ°(.pyc)å­—èŠ‚ç æ–‡ä»¶ï¼Œè€Œå­—èŠ‚ç  ç»è¿‡ pythonçš„vmè¿è¡Œ å¾—åˆ°çš„pydæ–‡ä»¶æ˜¯è¿è¡Œåœ¨æœºå™¨çš„æœºå™¨ç æ–‡ä»¶</p>
<h3 id="py_longçš„è§£æ"><a class="markdownIt-Anchor" href="#py_longçš„è§£æ"></a> PY_LONGçš„è§£æ</h3>
<p>åœ¨é€†å‘pydçš„æ—¶å€™ï¼Œç”±äºpythonè‡ªè¡Œå®ç°äº†ä¸€å¥—å¤§æ•°è¿ç®—ç³»ç»Ÿï¼Œæ‰€ä»¥åœ¨Numberçš„è§£æä¸­ï¼Œåªçœ‹å†…å­˜å¾ˆéš¾æ‰¾åˆ°å¯¹åº”å…·ä½“æ•°å€¼(å½“æ—¶å¡äº†ä¸€å¤©â€¦ï¼‰</p>
<p>è¿™é‡Œç›´æ¥å»çœ‹cythonæºç </p>
<pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">/*  =========> python12  PyLongObject structure &lt;========
#define _PyLong_NON_SIZE_BITS 3 
The number of digits (ndigits) is stored in the high bits of
   the lv_tag field (lvtag >> _PyLong_NON_SIZE_BITS). 


The sign of the value is stored in the lower 2 bits of lv_tag.
- 0: Positive
- 1: Zero
- 2: Negative
The third lowest bit of lv_tag is reserved for an immortality flag, but is
not currently used.



struct _object &#123;
    Py_ssize_t ob_refcnt;
    PyTypeObject *ob_type;
&#125;;

typedef struct _PyLongValue &#123;
    uintptr_t lv_tag;  //Number of digits, sign and flags //  
    digit ob_digit[1];
&#125; _PyLongValue;
typedef struct _object PyObject;
#define PyObject_HEAD                   PyObject ob_base;
struct _longobject &#123;
    PyObject_HEAD
    _PyLongValue long_value;
&#125;;

typedef struct _longobject PyLongObject;
*/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a target="_blank" rel="noopener" href="https://tenthousandmeters.com/blog/python-behind-the-scenes-8-how-python-integers-work/">Python behind the scenes #8: how Python integers work</a></p>
<p>è¿™é‡Œçš„æ¯ä¸ªpython_numberéƒ½æ˜¯30bitsçš„</p>
<p>(val&amp;0xffffffff) |(val&gt;&gt;32)&lt;&lt;30  æ‰èƒ½æ­£ç¡®è§£æå‡ºæ•°å€¼</p>
<h3 id="cythoné€†å‘åŸºç¡€"><a class="markdownIt-Anchor" href="#cythoné€†å‘åŸºç¡€"></a> cythoné€†å‘åŸºç¡€</h3>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36791177/article/details/144567790">ç³»ç»Ÿè®²è§£pydé€†å‘/Cythoné€†å‘_pydçš„é€†å‘-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/16155?time__1311=GuD%3D7Iqmxfhx%2FD0lD2DUgDj2RKGCWAA7RfeD">å¯¹äºcythonçš„åŸºç¡€é€†å‘åˆ†æï¼ˆ1ï¼‰ - å…ˆçŸ¥ç¤¾åŒº</a></p>
<p>è¯»æ˜ç™½äº†é™æ€åˆ†æåº”è¯¥æ²¡å•¥é—®é¢˜äº†</p>
<h3 id="å¸¸è§çš„é¢˜å‹"><a class="markdownIt-Anchor" href="#å¸¸è§çš„é¢˜å‹"></a> å¸¸è§çš„é¢˜å‹</h3>
<ul>
<li>æºä»£ç ç»è¿‡æ··æ·†å¾—åˆ°çš„pyé€†å‘,oråªæä¾›å­—èŠ‚ç çš„æ–‡æœ¬</li>
<li>.pycå­—èŠ‚ç é€†å‘  #pycåç¼–è¯‘ (ä»¥åŠå¸¸è§çš„èŠ±æŒ‡ä»¤å’Œé­”æ”¹)</li>
<li>pyinstalleræ‰“åŒ…   #è§£åŒ… pycåç¼–è¯‘</li>
<li>cythonç¼–è¯‘çš„æ‹“å±•(.pyc/so) 	# éš¾åº¦æœ€å¤§  æ‰‹æ’•+åŠ¨æ€</li>
</ul>
<h2 id="æ–¹æ³•æ€»ç»“"><a class="markdownIt-Anchor" href="#æ–¹æ³•æ€»ç»“"></a> æ–¹æ³•æ€»ç»“</h2>
<h3 id="æ³¨å…¥ç±»"><a class="markdownIt-Anchor" href="#æ³¨å…¥ç±»"></a> æ³¨å…¥ç±»</h3>
<p>å¯ä»¥åˆ—å‡ºæ‰€æœ‰çš„å¯¼å…¥åº“</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pefile

<span class="token keyword">def</span> <span class="token function">import_check</span><span class="token punctuation">(</span>pyd_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pe <span class="token operator">=</span> pefile<span class="token punctuation">.</span>PE<span class="token punctuation">(</span>pyd_file<span class="token punctuation">)</span>
    <span class="token keyword">for</span> entry <span class="token keyword">in</span> pe<span class="token punctuation">.</span>DIRECTORY_ENTRY_IMPORT<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Module: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>entry<span class="token punctuation">.</span>dll<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> imp <span class="token keyword">in</span> entry<span class="token punctuation">.</span>imports<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  Function: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>imp<span class="token punctuation">.</span>name<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> imp<span class="token punctuation">.</span>name <span class="token keyword">else</span> <span class="token boolean">None</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

import_check<span class="token punctuation">(</span><span class="token string">'cy.cp38-win_amd64.pyd'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ ¹æ®æ¶‰åŠçš„è¿ç®—å¯ä»¥å¤§æ¦‚çŒœæµ‹ä¸€ä¸‹åŠ å¯†ç±»å‹</p>
<p>æ¯”å¦‚åªæœ‰xorï¼Œshiftï¼Œå¯ä»¥å¤§è‡´çŒœæµ‹æ˜¯ä¸€ä¸ªteaå®¶æ—</p>
<p>å¦‚æœæœ‰ç±»çš„è¯æˆ‘ä»¬å¯ä»¥æ³¨å…¥ç±»</p>
<p>ä¾‹å¦‚2024SCTFçš„ ez_cython</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> cy

<span class="token keyword">class</span> <span class="token class-name">Symbol</span><span class="token punctuation">:</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>name <span class="token operator">=</span> name

  <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>name

  <span class="token keyword">def</span> <span class="token function">__rshift__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Symbol<span class="token punctuation">)</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> >> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> >> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> expression

  <span class="token keyword">def</span> <span class="token function">__lshift__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Symbol<span class="token punctuation">)</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> &lt;&lt; </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> &lt;&lt; </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> expression

  <span class="token keyword">def</span> <span class="token function">__rxor__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Symbol<span class="token punctuation">)</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> ^ </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> ^ </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> expression

  <span class="token keyword">def</span> <span class="token function">__xor__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Symbol<span class="token punctuation">)</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> ^ </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> ^ </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> expression

  <span class="token keyword">def</span> <span class="token function">__add__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Symbol<span class="token punctuation">)</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> expression

  <span class="token keyword">def</span> <span class="token function">__and__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Symbol<span class="token punctuation">)</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> &amp; </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
      expression <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string"> &amp; </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> expression

<span class="token keyword">class</span> <span class="token class-name">AList</span><span class="token punctuation">:</span>
  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> nums<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>nums <span class="token operator">=</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> num <span class="token keyword">in</span> nums<span class="token punctuation">]</span>

  <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>nums<span class="token punctuation">[</span>key<span class="token punctuation">]</span>

  <span class="token keyword">def</span> <span class="token function">copy</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> AList<span class="token punctuation">(</span>self<span class="token punctuation">.</span>nums<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>nums<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">__setitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"new_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>nums<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>value<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>nums<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"new_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>nums<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>nums<span class="token punctuation">&#125;</span></span><span class="token string"> == </span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>nums <span class="token operator">==</span> other

inp <span class="token operator">=</span> AList<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"a[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">]"</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
res <span class="token operator">=</span> cy<span class="token punctuation">.</span>sub14514<span class="token punctuation">(</span>inp<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æœ‰ä¸€ç‚¹å±€é™æ€§ï¼Œå°±æ˜¯åœ¨è¿ç®—è¿‡ç¨‹ä¸­ä¸ä¼šå‡ºç°ä¸€äº›ç±»å‹è½¬æ¢ä¹‹ç±»çš„ï¼Œå¦åˆ™è¿˜æ˜¯æ— æ³•hook</p>
<h3 id="æ‰‹å†™ä¸€ä¸ªpydæ¢å¤ç¬¦å·"><a class="markdownIt-Anchor" href="#æ‰‹å†™ä¸€ä¸ªpydæ¢å¤ç¬¦å·"></a> æ‰‹å†™ä¸€ä¸ªpyd(æ¢å¤ç¬¦å·)</h3>
<p>linuxç¼–è¯‘ä¸€ä»½ç›¸åŒpythonç‰ˆæœ¬çš„soæ–‡ä»¶ï¼Œidaè½½å…¥ï¼ŒFile-&gt;Produce File-&gt;Create C Header Fileå¯¼å‡ºç»“æ„ä½“</p>
<p>åŠ è½½éœ€è¦é€†å‘çš„pydï¼ŒFile-&gt;Load File-&gt;Parse C Header Fileï¼Œå¯¼å…¥soæ–‡ä»¶å¯¼å‡ºxxx.h(æœ‰é”™è¯¯å°±ä¿®å¤)ï¼Œå¯¼å…¥soæ–‡ä»¶å¯¼å‡ºçš„xxx.hæ˜¯å› ä¸ºé”™è¯¯æ¯”è¾ƒå°‘ï¼Œwindowså¸¦è°ƒè¯•ç¬¦å·å¯¼å‡ºçš„headeré”™è¯¯è¾ƒå¤šæ¯”è¾ƒéš¾ä¿®å¤</p>
<p>æ‰‹åŠ¨ç¼–è¯‘ä¸€ä¸ªç›¸åŒç‰ˆæœ¬çš„pydæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨bindiffæ¢å¤ä¸€ä¸‹ç¬¦å·ï¼Œé™æ€åˆ†ææ›´å®¹æ˜“ä¸€ç‚¹</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">:</span>
  a <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">1</span>
  b <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">2</span>
  c <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">^</span> <span class="token number">3</span>
  a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">6</span>
  b <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">while</span> b<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"11"</span><span class="token punctuation">)</span>
    b <span class="token operator">-=</span> <span class="token number">1</span>
  rand0m<span class="token punctuation">(</span>flag<span class="token punctuation">)</span> 
  <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c <span class="token operator">+</span> flag

<span class="token keyword">def</span> <span class="token function">myxor</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> a <span class="token operator">^</span> b
<span class="token keyword">def</span> <span class="token function">rand0m</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> x <span class="token operator">^</span> <span class="token number">123</span>

__test__ <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> setuptools <span class="token keyword">import</span> setup<span class="token punctuation">,</span> Extension
<span class="token keyword">from</span> Cython<span class="token punctuation">.</span>Build <span class="token keyword">import</span> cythonize

ext_module <span class="token operator">=</span> <span class="token punctuation">[</span>
  Extension<span class="token punctuation">(</span>
    name <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">,</span>
    sources<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"test.py"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    extra_compile_args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"/Zi"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    extra_link_args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"/DEBUG"</span><span class="token punctuation">]</span>
   <span class="token punctuation">)</span>
<span class="token punctuation">]</span>
 
setup<span class="token punctuation">(</span>
  name<span class="token operator">=</span><span class="token string">"test"</span><span class="token punctuation">,</span>
  ext_modules<span class="token operator">=</span>cythonize<span class="token punctuation">(</span>ext_module<span class="token punctuation">,</span> annotate<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">python build<span class="token punctuation">.</span>py build_ext <span class="token operator">-</span><span class="token operator">-</span>inplace<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ç§æ–¹æ³•ç”Ÿæˆçš„pydæ–‡ä»¶åœ¨windowsä¸‹é»˜è®¤æ˜¯æ— ç¬¦å·çš„ï¼Œåœ¨linuxä¸‹é»˜è®¤æ˜¯æœ‰ç¬¦å·çš„</p>
<p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥æŒ‡å®šç”Ÿæˆæœ‰ç¬¦å·çš„ pydæ–‡ä»¶:</p>
<pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">python setup.py build_ext --inplace --debug<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><font style="background-color:#FBDE28;">è¿™é‡Œéœ€è¦åœ¨å®‰è£…python3.12ç‰ˆæœ¬æ—¶å‹¾é€‰download debug binaries</font></p>
<p>bindiffåæ‰¾åˆ°<strong>initstring</strong>å‡½æ•°</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">typedef struct <span class="token punctuation">&#123;</span>
    __int64 <span class="token operator">*</span>__pyx_0<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_1<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_2<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_3<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_4<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_5<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_6<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_7<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_8<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_9<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_10<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_11<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_12<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_13<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_14<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_15<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_16<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_17<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_18<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_19<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_20<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_21<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_22<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_23<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_24<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_25<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_26<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_27<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_28<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_29<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_30<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_31<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_32<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_33<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_34<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_35<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_36<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_37<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_38<span class="token punctuation">;</span>
    __int64 <span class="token operator">*</span>__pyx_39<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> __pyx_mstate_me<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶åæ‰¾åˆ°initstringå‡½æ•°å¯¹åº”çš„åç§°å¡«å……æŒ‡é’ˆåç§°</p>
<p>ç„¶åé™æ€åˆ†æå¯ä»¥å¤§å¤§æé«˜æ•ˆç‡</p>
<h3 id="åŠ¨æ€trace"><a class="markdownIt-Anchor" href="#åŠ¨æ€trace"></a> åŠ¨æ€trace</h3>
<p>å¯ä»¥åˆ©ç”¨æ¡ä»¶æ–­ç‚¹å¯¹pydçš„è¿ç®—è¿›è¡Œæ’æ¡©ï¼Œç„¶ååˆ†æåŠ å¯†è¿‡ç¨‹</p>
<p>è¿™é‡Œ<font style="color:rgb(34, 34, 34);">å¯¹äºLshiftã€Rshiftã€Andç­‰é€»è¾‘æ“ä½œæ¥è¯´ï¼Œæ˜¯hookä¸åˆ°çš„ï¼Œç”±äºä¼˜åŒ–çš„ç¼˜æ•…ä¸èµ° Pyæä¾›çš„åº“å‡½æ•°ï¼Œç›´æ¥åœ¨pydä¸­è‡ªå·±å®ç°äº†</font></p>
<p><font style="color:rgb(34, 34, 34);">å½“ç„¶ä¹Ÿå¯ä»¥ä¸€æ¡ä¸€æ¡çš„ä¸‹æ–­ç‚¹æ‰“logï¼Œå»traceï¼Œä½“åŠ›æ´»</font></p>
<p><font style="color:rgb(34, 34, 34);">è¿™é‡Œæˆ‘å°±ç›´æ¥åŠ¨è°ƒç›´æ¥çœ‹äº†</font></p>
<h4 id="2025ciscn-rand0m"><a class="markdownIt-Anchor" href="#2025ciscn-rand0m"></a> 2025ciscn-rand0m</h4>
<h5 id="idaproçš„trace"><a class="markdownIt-Anchor" href="#idaproçš„trace"></a> idaproçš„trace</h5>
<p>ä¸‹æ¡ä»¶æ–­ç‚¹trace åŸºæœ¬è¿ç®—</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token operator">|</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">|</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token operator">&amp;</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">&amp;</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token operator">%</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">%</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">?=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token operator">^</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">^</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val<span class="token operator">>></span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">>></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val<span class="token operator">&lt;&lt;</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">&lt;&lt;</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token operator">-</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token operator">+</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">+</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token operator">*</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">*</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">**</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"div=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">%</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span>val
    <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">16</span><span class="token punctuation">:</span>
        val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
        result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg2_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>arg1_size<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">?=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">rand0m<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token string">'11223344aabbccddeeffeeffaaccddee'</span><span class="token punctuation">)</span>
<span class="token number">0x283af96e130</span>?<span class="token operator">=</span><span class="token number">0x283af96e130</span>
<span class="token number">0x8f154afd</span><span class="token operator">=</span><span class="token number">0x11223344</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0x12223440</span><span class="token operator">=</span><span class="token number">0x112233440</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0x12223441</span><span class="token operator">=</span><span class="token number">0x12223440</span><span class="token operator">+</span><span class="token number">0x1</span>
<span class="token number">0x11e2a9</span><span class="token operator">**</span><span class="token number">0x10001</span>
<span class="token number">0x13c501cc</span><span class="token operator">=</span><span class="token number">0xef90a60e6d9e2a9</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>  <span class="token operator">//</span> è¿™é‡Œæ˜¯ä¸å‡†ç¡®çš„ï¼Œå› ä¸ºæ•°å­—å¤ªå¤§äº†ï¼Œæœ‰<span class="token number">0xd0b7</span>ä½ï¼Œæ‰€ä»¥åªå†™äº†éƒ¨åˆ†æ•°å­—ï¼ŒçŒœæµ‹æ˜¯<span class="token builtin">pow</span>ä¹‹åçš„ç»“æœ ç„¶åmod <span class="token number">0xfffffffd</span>
<span class="token number">0x12223441</span>?<span class="token operator">=</span><span class="token number">0x12287f38</span>
<span class="token number">0x348cb564</span><span class="token operator">=</span><span class="token number">0xaabbccdd</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0xaa38cdd0</span><span class="token operator">=</span><span class="token number">0xaabbccdd0</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0xaa38cdda</span><span class="token operator">=</span><span class="token number">0xaa38cdd0</span><span class="token operator">+</span><span class="token number">0xa</span>
<span class="token number">0x69196</span><span class="token operator">**</span><span class="token number">0x10001</span>
<span class="token number">0x0</span><span class="token operator">=</span><span class="token number">0x0</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0xaa38cdda</span>?<span class="token operator">=</span><span class="token number">0x4a30f74d</span>
<span class="token number">0x43fbc213</span><span class="token operator">=</span><span class="token number">0xddccbbaa</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0xd80abaa0</span><span class="token operator">=</span><span class="token number">0xddccbbaa0</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0xd80abaad</span><span class="token operator">=</span><span class="token number">0xd80abaa0</span><span class="token operator">+</span><span class="token number">0xd</span>
<span class="token number">0x87f78</span><span class="token operator">**</span><span class="token number">0x10001</span>
<span class="token number">0x0</span><span class="token operator">=</span><span class="token number">0x0</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0xd80abaad</span>?<span class="token operator">=</span><span class="token number">0x23a1268</span>
<span class="token number">0xda045ba8</span><span class="token operator">=</span><span class="token number">0x44332211</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0x42322110</span><span class="token operator">=</span><span class="token number">0x443322110</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0x42322114</span><span class="token operator">=</span><span class="token number">0x42322110</span><span class="token operator">+</span><span class="token number">0x4</span>
<span class="token number">0x1b408b</span><span class="token operator">**</span><span class="token number">0x10001</span>
<span class="token number">0xc5e0a74e</span><span class="token operator">=</span><span class="token number">0xccb22419f7f408b</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0x42322114</span>?<span class="token operator">=</span><span class="token number">0x88108807</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç»“åˆé™æ€åˆ†æï¼Œæ¯ä¸€è½®æœ‰ä¸¤æ¬¡cmpï¼Œå¦‚ä½•ç¬¬ä¸€æ¬¡cmpå¤±è´¥ï¼Œç¬¬äºŒæ¬¡å°±ä¸æ¯”è¾ƒäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éƒ½ä¸‹æ–­ç‚¹åˆ°richcmpareï¼Œå°†æ¯æ¬¡è¿”å›ç»“æœæ”¹ä¸ºtrueobjectï¼Œç„¶åè·å¾—æ–°çš„tracelog</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">0x252bbc2e130</span>?<span class="token operator">=</span><span class="token number">0x252bbc2e130</span>
<span class="token number">0x8f154afd</span><span class="token operator">=</span><span class="token number">0x11223344</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0x12223440</span><span class="token operator">=</span><span class="token number">0x112233440</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0x12223441</span><span class="token operator">=</span><span class="token number">0x12223440</span><span class="token operator">+</span><span class="token number">0x1</span>
<span class="token number">0x11e2a9</span><span class="token operator">**</span><span class="token number">0x10001</span>
div<span class="token operator">=</span><span class="token number">0xa019a7204a7965087e77970426e62484218bd070e82b679cdc532edc68dfb2ace88e676cef90a60e6d9e2a9</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0x12223441</span>?<span class="token operator">=</span><span class="token number">0x12287f38</span>
<span class="token number">0x27fe60b7</span>?<span class="token operator">=</span><span class="token number">0x98d24b3a</span>
<span class="token number">0x348cb564</span><span class="token operator">=</span><span class="token number">0xaabbccdd</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0xaa38cdd0</span><span class="token operator">=</span><span class="token number">0xaabbccdd0</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0xaa38cdda</span><span class="token operator">=</span><span class="token number">0xaa38cdd0</span><span class="token operator">+</span><span class="token number">0xa</span>
<span class="token number">0x69196</span><span class="token operator">**</span><span class="token number">0x10001</span>
div<span class="token operator">=</span><span class="token number">0x0</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0xaa38cdda</span>?<span class="token operator">=</span><span class="token number">0x4a30f74d</span>
<span class="token number">0x2b356987</span>?<span class="token operator">=</span><span class="token number">0xe0f1db77</span>
<span class="token number">0x70c89746</span><span class="token operator">=</span><span class="token number">0xeeffeeff</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0xea3aeff0</span><span class="token operator">=</span><span class="token number">0xeeffeeff0</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0xeeffeeffe</span><span class="token operator">=</span><span class="token number">0xeeffeeff0</span><span class="token operator">+</span><span class="token number">0xe</span>
<span class="token number">0xe1912</span><span class="token operator">**</span><span class="token number">0x10001</span>
div<span class="token operator">=</span><span class="token number">0x0</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0xea3aeffe</span>?<span class="token operator">=</span><span class="token number">0x23a1268</span> 
<span class="token number">0x81ac0cf0</span>?<span class="token operator">=</span><span class="token number">0xadf38403</span>
<span class="token number">0x34fba457</span><span class="token operator">=</span><span class="token number">0xaaccddee</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0xa808dee0</span><span class="token operator">=</span><span class="token number">0xaaccddee0</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0xaaccddeea</span><span class="token operator">=</span><span class="token number">0xaaccddee0</span><span class="token operator">+</span><span class="token number">0xa</span>
<span class="token number">0x69f74</span><span class="token operator">**</span><span class="token number">0x10001</span>
div<span class="token operator">=</span><span class="token number">0x0</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0xa808deea</span>?<span class="token operator">=</span><span class="token number">0x88108807</span>
<span class="token number">0x61ff12d1</span>?<span class="token operator">=</span><span class="token number">0xd8499bb6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æœ‰pow 0x10001  ä»¥åŠ mod 0xfffffffd  æˆ‘ä»¬å¯ä»¥çŒœæµ‹æ˜¯ä¸€ä¸ªrsaåŠ å¯†</p>
<p>ç”±äºpowçš„è¿ç®—çš„ç¬¬ä¸€ä¸ªå‚æ•° ä½æ•°å¤ªå¤§äº†ï¼Œå‹¾çš„å€¼å¹¶ä¸æ˜¯çœŸå®çš„valueï¼Œæœ‰0xd087ä½ï¼Œè¿™é‡Œæˆ‘ä»¬çŒœä¸€ä¸‹å°±çŸ¥é“æ˜¯ä»€ä¹ˆ</p>
<p>æˆ‘ä»¬ç›²çŒœç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯0x11e2a9**0x10001çš„ç»“æœ</p>
<p>è¿™é‡Œhex</p>
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734420585968-3909b9a2-ef0e-4948-8134-ea08ae1bf219.png" class="" loading="lazy">
<p>æ°å¥½å°±æ˜¯<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734420599875-3236ccdf-0ac1-4293-9ea7-4c22ce12e355.png" class="" loading="lazy">ç¬¬äºŒä¸ªcmpæ¯”è¾ƒçš„ç»“æœ</p>
<p>å¯ä»¥éªŒè¯æˆ‘ä»¬çš„çŒœæƒ³æ­£ç¡®</p>
<p>ç°åœ¨æˆ‘ä»¬ä¸æ˜ç™½0x11e2a9 åˆ°åº•æ˜¯ä¸æ˜¯ä¸æˆ‘ä»¬çš„è¾“å…¥æœ‰å…³ï¼Œå¯ä»¥å¤šè¾“å…¥å‡ è½®æµ‹è¯•ä¸€ä¸‹</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">0x252bbc2e130</span>?<span class="token operator">=</span><span class="token number">0x252bbc2e130</span>
<span class="token number">0x8f2668a8</span><span class="token operator">=</span><span class="token number">0x11111111</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0x10101110</span><span class="token operator">=</span><span class="token number">0x111111110</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0x11e4cd</span><span class="token operator">**</span><span class="token number">0x10001</span>
div<span class="token operator">=</span><span class="token number">0x6a21c24449c1db9452f195dcc87cf7a4c6173dfc07e6982cc02d8080186cd284c5ba2c3caf39ee88b7ad161d6c5e4cd</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0x10101111</span>?<span class="token operator">=</span><span class="token number">0x12287f38</span>
<span class="token number">0x8f2668a8</span><span class="token operator">=</span><span class="token number">0x11111111</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0x10101110</span><span class="token operator">=</span><span class="token number">0x111111110</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0x11e4cd</span><span class="token operator">**</span><span class="token number">0x10001</span>
div<span class="token operator">=</span><span class="token number">0x6a21c24449c1db9452f195dcc87cf7a4c6173dfc07e6982cc02d8080186cd284c5ba2c3caf39ee88b7ad161d6c5e4cd</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0x10101111</span>?<span class="token operator">=</span><span class="token number">0x4a30f74d</span>
<span class="token number">0x8f2668a8</span><span class="token operator">=</span><span class="token number">0x11111111</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0x10101110</span><span class="token operator">=</span><span class="token number">0x111111110</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0x11e4cd</span><span class="token operator">**</span><span class="token number">0x10001</span>
div<span class="token operator">=</span><span class="token number">0x6a21c24449c1db9452f195dcc87cf7a4c6173dfc07e6982cc02d8080186cd284c5ba2c3caf39ee88b7ad161d6c5e4cd</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0x10101111</span>?<span class="token operator">=</span><span class="token number">0x23a1268</span>
<span class="token number">0x8f2668a8</span><span class="token operator">=</span><span class="token number">0x11111111</span><span class="token operator">^</span><span class="token number">0x9e3779b9</span>
<span class="token number">0x10101110</span><span class="token operator">=</span><span class="token number">0x111111110</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span>
<span class="token number">0x11e4cd</span><span class="token operator">**</span><span class="token number">0x10001</span>
div<span class="token operator">=</span><span class="token number">0x6a21c24449c1db9452f195dcc87cf7a4c6173dfc07e6982cc02d8080186cd284c5ba2c3caf39ee88b7ad161d6c5e4cd</span><span class="token operator">%</span><span class="token number">0xfffffffd</span>
<span class="token number">0x10101111</span>?<span class="token operator">=</span><span class="token number">0x88108807</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œæˆ‘çœ‹ä¸å‡ºæ¥åˆ°åº•æ˜¯æ€ä¹ˆä¸inputå¯¹åº”çš„,åªèƒ½å»é™æ€åˆ†æä¸€ä¸‹</p>
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734421313126-48de522e-d915-4ef9-8ef9-b8624b3316cb.png" class="" loading="lazy">
<p>å‚æ•°a3ä¸º11</p>
<p>å®šä½åˆ°è¿™é‡Œï¼Œå‘ç°å³ç§»äº†11ä½</p>
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734421377754-5a2acd1c-de74-408a-a292-e31c7f86fb83.png" class="" loading="lazy">éªŒè¯çŒœæƒ³æ˜¯æ­£ç¡®çš„
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°å®é™…ä¸Šä¸€ç»„å¯†æ–‡è¿›è¡Œäº†2ç»„å¤„ç†</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token operator">^</span><span class="token number">0x9e3779b9</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x10001</span><span class="token punctuation">,</span><span class="token number">0xfffffffd</span><span class="token punctuation">)</span>   <span class="token operator">-</span><span class="token operator">></span>å³å°†ä¸€ç»„å¯†æ–‡è¿›è¡ŒrsaåŠ å¯†
<span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xfa3affff</span><span class="token punctuation">)</span><span class="token operator">|</span>k<span class="token operator">>></span><span class="token number">28</span>   <span class="token number">0x7ff0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>è¿™é‡Œçš„ä¸¤ç»„åŠ å¯†æ˜¯ä¼šæœ‰ä¿¡æ¯ç¼ºå¤±çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸¤ç»„åŠ å¯†å®Œæ•´æ¢å¤å‡ºæ˜æ–‡</p>
<p>ç¬¬ä¸€ç»„ï¼Œæˆ‘ä»¬å¯ä»¥æ¢å¤å‡ºé«˜22ä½ï¼Œç¬¬äºŒç»„æ¢å¤å‡ºä½12ä½å³å¯</p>
<p>traceå·²ç»dumpå‡ºäº†æ¯ç»„å¯†æ–‡</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
cipher<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">0x98d24b3a</span><span class="token punctuation">,</span><span class="token number">0x12287f38</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0xe0f1db77</span><span class="token punctuation">,</span><span class="token number">0x4a30f74d</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0xadf38403</span><span class="token punctuation">,</span><span class="token number">0x23a1268</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0xd8499bb6</span><span class="token punctuation">,</span><span class="token number">0x88108807</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">dersa</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p<span class="token operator">=</span><span class="token number">9241</span>
    q<span class="token operator">=</span><span class="token number">464773</span>
    e<span class="token operator">=</span><span class="token number">0x10001</span>
    phi<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    d<span class="token operator">=</span>inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span>d<span class="token punctuation">,</span>p<span class="token operator">*</span>q<span class="token punctuation">)</span> 

<span class="token keyword">for</span> a<span class="token punctuation">,</span>b <span class="token keyword">in</span> cipher<span class="token punctuation">:</span>
    k1<span class="token operator">=</span>dersa<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    k1<span class="token operator">=</span>k1<span class="token operator">&lt;&lt;</span><span class="token number">11</span>
    k1<span class="token operator">^</span><span class="token operator">=</span><span class="token number">0x9e3779b9</span>
    k2<span class="token operator">=</span>b
    k2<span class="token operator">&amp;</span><span class="token operator">=</span><span class="token number">0x7ff0</span>
    k2<span class="token operator">>></span><span class="token number">4</span>
    k<span class="token operator">=</span>k1<span class="token operator">|</span>k2
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#0x813affb9</span>
<span class="token comment">#0xd4b37ff9</span>
<span class="token comment">#0x802bb3f9</span>
<span class="token comment">#0x789509b9</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="xdbg"><a class="markdownIt-Anchor" href="#xdbg"></a> xdbg</h5>
<p>xdbgæ¡ä»¶æ–­ç‚¹</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">PyNumber_And
0x<span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">=</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
PyNumber_Add
0x<span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">=</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">+</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
PyNumber_Xor
0x<span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">=</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">^</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
PyNumber_LShift
0x<span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">=</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">&lt;&lt;</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
PyNumber_RShift
0x<span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">=</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">>></span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
PyNumber_Reminder
0x<span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">=</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">%</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
PyNumber_Power
0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token operator">**</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
PyObject_RichCompare
0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rcx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> ?<span class="token operator">=</span> 0x<span class="token punctuation">&#123;</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>rdx<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0x1e</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>command:run</p>
<h4 id="2025ciscn-cython"><a class="markdownIt-Anchor" href="#2025ciscn-cython"></a> 2025ciscn-cython</h4>
<p>pyins è§£åŒ…</p>
<p>pycdcæ— æ³•åç¼–è¯‘ï¼Œç”¨pycdas</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>Disassembly<span class="token punctuation">]</span>
       <span class="token number">0</span>       RESUME                          <span class="token number">0</span>
       <span class="token number">2</span>       LOAD_CONST                      <span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">0</span>
       <span class="token number">4</span>       LOAD_CONST                      <span class="token number">1</span><span class="token punctuation">:</span> <span class="token boolean">None</span>
       <span class="token number">6</span>       IMPORT_NAME                     <span class="token number">0</span><span class="token punctuation">:</span> ez
       <span class="token number">8</span>       STORE_NAME                      <span class="token number">0</span><span class="token punctuation">:</span> ez
       <span class="token number">10</span>      PUSH_NULL
       <span class="token number">12</span>      LOAD_NAME                       <span class="token number">1</span><span class="token punctuation">:</span> <span class="token builtin">input</span>
       <span class="token number">14</span>      LOAD_CONST                      <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'ç’‡ç–¯ç·­éî™¬lag:'</span>
       <span class="token number">16</span>      PRECALL                         <span class="token number">1</span>
       <span class="token number">20</span>      CALL                            <span class="token number">1</span>
       <span class="token number">30</span>      STORE_NAME                      <span class="token number">2</span><span class="token punctuation">:</span> flag
       <span class="token number">32</span>      PUSH_NULL
       <span class="token number">34</span>      LOAD_NAME                       <span class="token number">3</span><span class="token punctuation">:</span> <span class="token builtin">list</span>
       <span class="token number">36</span>      LOAD_NAME                       <span class="token number">2</span><span class="token punctuation">:</span> flag
       <span class="token number">38</span>      PRECALL                         <span class="token number">1</span>
       <span class="token number">42</span>      CALL                            <span class="token number">1</span>
       <span class="token number">52</span>      STORE_NAME                      <span class="token number">4</span><span class="token punctuation">:</span> flag1
       <span class="token number">54</span>      BUILD_LIST                      <span class="token number">0</span>
       <span class="token number">56</span>      STORE_NAME                      <span class="token number">5</span><span class="token punctuation">:</span> value
       <span class="token number">58</span>      LOAD_CONST                      <span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">0</span>
       <span class="token number">60</span>      STORE_NAME                      <span class="token number">6</span><span class="token punctuation">:</span> b
       <span class="token number">62</span>      LOAD_CONST                      <span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">0</span>
       <span class="token number">64</span>      STORE_NAME                      <span class="token number">7</span><span class="token punctuation">:</span> ck
       <span class="token number">66</span>      PUSH_NULL
       <span class="token number">68</span>      LOAD_NAME                       <span class="token number">8</span><span class="token punctuation">:</span> <span class="token builtin">len</span>
       <span class="token number">70</span>      LOAD_NAME                       <span class="token number">4</span><span class="token punctuation">:</span> flag1
       <span class="token number">72</span>      PRECALL                         <span class="token number">1</span>
       <span class="token number">76</span>      CALL                            <span class="token number">1</span>
       <span class="token number">86</span>      LOAD_CONST                      <span class="token number">3</span><span class="token punctuation">:</span> <span class="token number">24</span>
       <span class="token number">88</span>      COMPARE_OP                      <span class="token number">2</span> <span class="token punctuation">(</span><span class="token operator">==</span><span class="token punctuation">)</span>
       <span class="token number">94</span>      POP_JUMP_FORWARD_IF_FALSE       <span class="token number">259</span> <span class="token punctuation">(</span>to <span class="token number">616</span><span class="token punctuation">)</span>
       <span class="token number">98</span>      PUSH_NULL
       <span class="token number">100</span>     LOAD_NAME                       <span class="token number">9</span><span class="token punctuation">:</span> <span class="token builtin">range</span>
       <span class="token number">102</span>     LOAD_CONST                      <span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">0</span>
       <span class="token number">104</span>     PUSH_NULL
       <span class="token number">106</span>     LOAD_NAME                       <span class="token number">8</span><span class="token punctuation">:</span> <span class="token builtin">len</span>
       <span class="token number">108</span>     LOAD_NAME                       <span class="token number">4</span><span class="token punctuation">:</span> flag1
       <span class="token number">110</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">114</span>     CALL                            <span class="token number">1</span>
       <span class="token number">124</span>     LOAD_CONST                      <span class="token number">4</span><span class="token punctuation">:</span> <span class="token number">4</span>
       <span class="token number">126</span>     PRECALL                         <span class="token number">3</span>
       <span class="token number">130</span>     CALL                            <span class="token number">3</span>
       <span class="token number">140</span>     GET_ITER
       <span class="token number">142</span>     FOR_ITER                        <span class="token number">112</span> <span class="token punctuation">(</span>to <span class="token number">368</span><span class="token punctuation">)</span>
       <span class="token number">144</span>     STORE_NAME                      <span class="token number">10</span><span class="token punctuation">:</span> i
       <span class="token number">146</span>     PUSH_NULL
       <span class="token number">148</span>     LOAD_NAME                       <span class="token number">11</span><span class="token punctuation">:</span> <span class="token builtin">ord</span>
       <span class="token number">150</span>     LOAD_NAME                       <span class="token number">4</span><span class="token punctuation">:</span> flag1
       <span class="token number">152</span>     LOAD_NAME                       <span class="token number">10</span><span class="token punctuation">:</span> i
       <span class="token number">154</span>     BINARY_SUBSCR
       <span class="token number">164</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">168</span>     CALL                            <span class="token number">1</span>
       <span class="token number">178</span>     LOAD_CONST                      <span class="token number">3</span><span class="token punctuation">:</span> <span class="token number">24</span>
       <span class="token number">180</span>     BINARY_OP                       <span class="token number">3</span> <span class="token punctuation">(</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">)</span>
       <span class="token number">184</span>     PUSH_NULL
       <span class="token number">186</span>     LOAD_NAME                       <span class="token number">11</span><span class="token punctuation">:</span> <span class="token builtin">ord</span>
       <span class="token number">188</span>     LOAD_NAME                       <span class="token number">4</span><span class="token punctuation">:</span> flag1
       <span class="token number">190</span>     LOAD_NAME                       <span class="token number">10</span><span class="token punctuation">:</span> i
       <span class="token number">192</span>     LOAD_CONST                      <span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">1</span>
       <span class="token number">194</span>     BINARY_OP                       <span class="token number">0</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
       <span class="token number">198</span>     BINARY_SUBSCR
       <span class="token number">208</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">212</span>     CALL                            <span class="token number">1</span>
       <span class="token number">222</span>     LOAD_CONST                      <span class="token number">6</span><span class="token punctuation">:</span> <span class="token number">16</span>
       <span class="token number">224</span>     BINARY_OP                       <span class="token number">3</span> <span class="token punctuation">(</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">)</span>
       <span class="token number">228</span>     BINARY_OP                       <span class="token number">7</span> <span class="token punctuation">(</span><span class="token operator">|</span><span class="token punctuation">)</span>
       <span class="token number">232</span>     PUSH_NULL
       <span class="token number">234</span>     LOAD_NAME                       <span class="token number">11</span><span class="token punctuation">:</span> <span class="token builtin">ord</span>
       <span class="token number">236</span>     LOAD_NAME                       <span class="token number">4</span><span class="token punctuation">:</span> flag1
       <span class="token number">238</span>     LOAD_NAME                       <span class="token number">10</span><span class="token punctuation">:</span> i
       <span class="token number">240</span>     LOAD_CONST                      <span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">2</span>
       <span class="token number">242</span>     BINARY_OP                       <span class="token number">0</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
       <span class="token number">246</span>     BINARY_SUBSCR
       <span class="token number">256</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">260</span>     CALL                            <span class="token number">1</span>
       <span class="token number">270</span>     LOAD_CONST                      <span class="token number">8</span><span class="token punctuation">:</span> <span class="token number">8</span>
       <span class="token number">272</span>     BINARY_OP                       <span class="token number">3</span> <span class="token punctuation">(</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">)</span>
       <span class="token number">276</span>     BINARY_OP                       <span class="token number">7</span> <span class="token punctuation">(</span><span class="token operator">|</span><span class="token punctuation">)</span>
       <span class="token number">280</span>     PUSH_NULL
       <span class="token number">282</span>     LOAD_NAME                       <span class="token number">11</span><span class="token punctuation">:</span> <span class="token builtin">ord</span>
       <span class="token number">284</span>     LOAD_NAME                       <span class="token number">4</span><span class="token punctuation">:</span> flag1
       <span class="token number">286</span>     LOAD_NAME                       <span class="token number">10</span><span class="token punctuation">:</span> i
       <span class="token number">288</span>     LOAD_CONST                      <span class="token number">9</span><span class="token punctuation">:</span> <span class="token number">3</span>
       <span class="token number">290</span>     BINARY_OP                       <span class="token number">0</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
       <span class="token number">294</span>     BINARY_SUBSCR
       <span class="token number">304</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">308</span>     CALL                            <span class="token number">1</span>
       <span class="token number">318</span>     BINARY_OP                       <span class="token number">7</span> <span class="token punctuation">(</span><span class="token operator">|</span><span class="token punctuation">)</span>
       <span class="token number">322</span>     STORE_NAME                      <span class="token number">6</span><span class="token punctuation">:</span> b
       <span class="token number">324</span>     LOAD_NAME                       <span class="token number">5</span><span class="token punctuation">:</span> value
       <span class="token number">326</span>     LOAD_METHOD                     <span class="token number">12</span><span class="token punctuation">:</span> append
       <span class="token number">348</span>     LOAD_NAME                       <span class="token number">6</span><span class="token punctuation">:</span> b
       <span class="token number">350</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">354</span>     CALL                            <span class="token number">1</span>
       <span class="token number">364</span>     POP_TOP
       <span class="token number">366</span>     JUMP_BACKWARD                   <span class="token number">113</span> <span class="token punctuation">(</span>to <span class="token number">142</span><span class="token punctuation">)</span>
       <span class="token number">368</span>     BUILD_LIST                      <span class="token number">0</span>
       <span class="token number">370</span>     LOAD_CONST                      <span class="token number">10</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span>
       <span class="token number">372</span>     LIST_EXTEND                     <span class="token number">1</span>
       <span class="token number">374</span>     STORE_NAME                      <span class="token number">13</span><span class="token punctuation">:</span> key
       <span class="token number">376</span>     BUILD_LIST                      <span class="token number">0</span>
       <span class="token number">378</span>     STORE_NAME                      <span class="token number">14</span><span class="token punctuation">:</span> flag_encrypt
       <span class="token number">380</span>     PUSH_NULL
       <span class="token number">382</span>     LOAD_NAME                       <span class="token number">9</span><span class="token punctuation">:</span> <span class="token builtin">range</span>
       <span class="token number">384</span>     LOAD_CONST                      <span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">0</span>
       <span class="token number">386</span>     LOAD_CONST                      <span class="token number">11</span><span class="token punctuation">:</span> <span class="token number">6</span>
       <span class="token number">388</span>     LOAD_CONST                      <span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">2</span>
       <span class="token number">390</span>     PRECALL                         <span class="token number">3</span>
       <span class="token number">394</span>     CALL                            <span class="token number">3</span>
       <span class="token number">404</span>     GET_ITER
       <span class="token number">406</span>     FOR_ITER                        <span class="token number">56</span> <span class="token punctuation">(</span>to <span class="token number">520</span><span class="token punctuation">)</span>
       <span class="token number">408</span>     STORE_NAME                      <span class="token number">10</span><span class="token punctuation">:</span> i
       <span class="token number">410</span>     PUSH_NULL
       <span class="token number">412</span>     LOAD_NAME                       <span class="token number">0</span><span class="token punctuation">:</span> ez
       <span class="token number">414</span>     LOAD_ATTR                       <span class="token number">15</span><span class="token punctuation">:</span> encrypt
       <span class="token number">424</span>     LOAD_NAME                       <span class="token number">5</span><span class="token punctuation">:</span> value
       <span class="token number">426</span>     LOAD_NAME                       <span class="token number">10</span><span class="token punctuation">:</span> i
       <span class="token number">428</span>     BINARY_SUBSCR
       <span class="token number">438</span>     LOAD_NAME                       <span class="token number">5</span><span class="token punctuation">:</span> value
       <span class="token number">440</span>     LOAD_NAME                       <span class="token number">10</span><span class="token punctuation">:</span> i
       <span class="token number">442</span>     LOAD_CONST                      <span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">1</span>
       <span class="token number">444</span>     BINARY_OP                       <span class="token number">0</span> <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
       <span class="token number">448</span>     BINARY_SUBSCR
       <span class="token number">458</span>     LOAD_NAME                       <span class="token number">13</span><span class="token punctuation">:</span> key
       <span class="token number">460</span>     PRECALL                         <span class="token number">3</span>
       <span class="token number">464</span>     CALL                            <span class="token number">3</span>
       <span class="token number">474</span>     STORE_NAME                      <span class="token number">16</span><span class="token punctuation">:</span> res
       <span class="token number">476</span>     LOAD_NAME                       <span class="token number">14</span><span class="token punctuation">:</span> flag_encrypt
       <span class="token number">478</span>     LOAD_METHOD                     <span class="token number">12</span><span class="token punctuation">:</span> append
       <span class="token number">500</span>     LOAD_NAME                       <span class="token number">16</span><span class="token punctuation">:</span> res
       <span class="token number">502</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">506</span>     CALL                            <span class="token number">1</span>
       <span class="token number">516</span>     POP_TOP
       <span class="token number">518</span>     JUMP_BACKWARD                   <span class="token number">57</span> <span class="token punctuation">(</span>to <span class="token number">406</span><span class="token punctuation">)</span>
       <span class="token number">520</span>     PUSH_NULL
       <span class="token number">522</span>     LOAD_NAME                       <span class="token number">0</span><span class="token punctuation">:</span> ez
       <span class="token number">524</span>     LOAD_ATTR                       <span class="token number">17</span><span class="token punctuation">:</span> check
       <span class="token number">534</span>     LOAD_NAME                       <span class="token number">14</span><span class="token punctuation">:</span> flag_encrypt
       <span class="token number">536</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">540</span>     CALL                            <span class="token number">1</span>
       <span class="token number">550</span>     STORE_NAME                      <span class="token number">7</span><span class="token punctuation">:</span> ck
       <span class="token number">552</span>     LOAD_NAME                       <span class="token number">7</span><span class="token punctuation">:</span> ck
       <span class="token number">554</span>     LOAD_CONST                      <span class="token number">9</span><span class="token punctuation">:</span> <span class="token number">3</span>
       <span class="token number">556</span>     COMPARE_OP                      <span class="token number">2</span> <span class="token punctuation">(</span><span class="token operator">==</span><span class="token punctuation">)</span>
       <span class="token number">562</span>     POP_JUMP_FORWARD_IF_FALSE       <span class="token number">13</span> <span class="token punctuation">(</span>to <span class="token number">590</span><span class="token punctuation">)</span>
       <span class="token number">564</span>     PUSH_NULL
       <span class="token number">566</span>     LOAD_NAME                       <span class="token number">18</span><span class="token punctuation">:</span> <span class="token keyword">print</span>
       <span class="token number">568</span>     LOAD_CONST                      <span class="token number">12</span><span class="token punctuation">:</span> <span class="token string">'yes!!!,you get right flag'</span>
       <span class="token number">570</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">574</span>     CALL                            <span class="token number">1</span>
       <span class="token number">584</span>     POP_TOP
       <span class="token number">586</span>     LOAD_CONST                      <span class="token number">1</span><span class="token punctuation">:</span> <span class="token boolean">None</span>
       <span class="token number">588</span>     RETURN_VALUE
       <span class="token number">590</span>     PUSH_NULL
       <span class="token number">592</span>     LOAD_NAME                       <span class="token number">18</span><span class="token punctuation">:</span> <span class="token keyword">print</span>
       <span class="token number">594</span>     LOAD_CONST                      <span class="token number">13</span><span class="token punctuation">:</span> <span class="token string">'wrong!!!'</span>
       <span class="token number">596</span>     PRECALL                         <span class="token number">1</span>
       <span class="token number">600</span>     CALL                            <span class="token number">1</span>
       <span class="token number">610</span>     POP_TOP
       <span class="token number">612</span>     LOAD_CONST                      <span class="token number">1</span><span class="token punctuation">:</span> <span class="token boolean">None</span>
       <span class="token number">614</span>     RETURN_VALUE
       <span class="token number">616</span>     LOAD_CONST                      <span class="token number">1</span><span class="token punctuation">:</span> <span class="token boolean">None</span>
       <span class="token number">618</span>     RETURN_VALUE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç”¨chatgptç¿»è¯‘ä¸€ä¸‹</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> ez

flag <span class="token operator">=</span> <span class="token string">"aaaabbbbccccddddeeeeffff"</span>  <span class="token comment"># Input message (possibly in a different encoding)</span>
flag1 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>  <span class="token comment"># Convert flag to a list of characters</span>
value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> <span class="token number">0</span>
ck <span class="token operator">=</span> <span class="token number">0</span>

<span class="token comment"># Check if length of input flag is 24</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">24</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        b <span class="token operator">=</span> <span class="token punctuation">(</span>
            <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>flag1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>flag1<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>flag1<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span>
            <span class="token builtin">ord</span><span class="token punctuation">(</span>flag1<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        value<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b<span class="token punctuation">)</span>

    key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">]</span>  <span class="token comment"># ASCII values of 'f', 'l', 'a', 'g'</span>
    flag_encrypt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        res <span class="token operator">=</span> ez<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>value<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> value<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>
        flag_encrypt<span class="token punctuation">.</span>append<span class="token punctuation">(</span>res<span class="token punctuation">)</span>

    ck <span class="token operator">=</span> ez<span class="token punctuation">.</span>check<span class="token punctuation">(</span>flag_encrypt<span class="token punctuation">)</span>

    <span class="token keyword">if</span> ck <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'yes!!!,you get right flag'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong!!!'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong!!!'</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ezçš„help</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Help on module ez<span class="token punctuation">:</span>

NAME
    ez

FUNCTIONS
    FormatError<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
        FormatError<span class="token punctuation">(</span><span class="token punctuation">[</span>integer<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> string

        Convert a win32 error code into a string<span class="token punctuation">.</span> If the error code <span class="token keyword">is</span> <span class="token keyword">not</span>
        given<span class="token punctuation">,</span> the <span class="token keyword">return</span> value of a call to GetLastError<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span> used<span class="token punctuation">.</span>

    POINTER<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

    addressof<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
        addressof<span class="token punctuation">(</span>C instance<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> integer
        Return the address of the C instance internal <span class="token builtin">buffer</span>

    alignment<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
        alignment<span class="token punctuation">(</span>C <span class="token builtin">type</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> integer
        alignment<span class="token punctuation">(</span>C instance<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> integer
        Return the alignment requirements of a C instance

    byref<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
        byref<span class="token punctuation">(</span>C instance<span class="token punctuation">[</span><span class="token punctuation">,</span> offset<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> byref<span class="token operator">-</span><span class="token builtin">object</span>
        Return a pointer lookalike to a C instance<span class="token punctuation">,</span> only usable
        <span class="token keyword">as</span> function argument

    check<span class="token punctuation">(</span>flag_encrypt<span class="token punctuation">)</span>

    encrypt<span class="token punctuation">(</span>V0<span class="token punctuation">,</span> V1<span class="token punctuation">,</span> key<span class="token punctuation">)</span>

    get_errno<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

    get_last_error<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

    pointer<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

    resize<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
        Resize the memory <span class="token builtin">buffer</span> of a ctypes instance

    set_errno<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

    set_last_error<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

    sizeof<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
        sizeof<span class="token punctuation">(</span>C <span class="token builtin">type</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> integer
        sizeof<span class="token punctuation">(</span>C instance<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> integer
        Return the size <span class="token keyword">in</span> <span class="token builtin">bytes</span> of a C instance

DATA
    DEFAULT_MODE <span class="token operator">=</span> <span class="token number">0</span>
    GetLastError <span class="token operator">=</span> <span class="token operator">&lt;</span>_FuncPtr <span class="token builtin">object</span><span class="token operator">></span>
    RTLD_GLOBAL <span class="token operator">=</span> <span class="token number">0</span>
    RTLD_LOCAL <span class="token operator">=</span> <span class="token number">0</span>
    __test__ <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    cdll <span class="token operator">=</span> <span class="token operator">&lt;</span>ctypes<span class="token punctuation">.</span>LibraryLoader <span class="token builtin">object</span><span class="token operator">></span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">3572312064</span><span class="token punctuation">,</span> <span class="token number">2468433000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3725770449</span><span class="token punctuation">,</span> <span class="token number">3734689877</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">338735471.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    memmove <span class="token operator">=</span> <span class="token operator">&lt;</span>CFunctionType <span class="token builtin">object</span><span class="token operator">></span>
    memset <span class="token operator">=</span> <span class="token operator">&lt;</span>CFunctionType <span class="token builtin">object</span><span class="token operator">></span>
    oledll <span class="token operator">=</span> <span class="token operator">&lt;</span>ctypes<span class="token punctuation">.</span>LibraryLoader <span class="token builtin">object</span><span class="token operator">></span>
    pydll <span class="token operator">=</span> <span class="token operator">&lt;</span>ctypes<span class="token punctuation">.</span>LibraryLoader <span class="token builtin">object</span><span class="token operator">></span>
    pythonapi <span class="token operator">=</span> <span class="token operator">&lt;</span>PyDLL <span class="token string">'python dll'</span><span class="token punctuation">,</span> handle 7ffa16710000<span class="token operator">></span>
    windll <span class="token operator">=</span> <span class="token operator">&lt;</span>ctypes<span class="token punctuation">.</span>LibraryLoader <span class="token builtin">object</span><span class="token operator">></span>

FILE
    c<span class="token punctuation">:</span>\users\npc\desktop\ctf\events\2025ciscn\cython\cython<span class="token punctuation">.</span>exe_extracted\ez<span class="token punctuation">.</span>pyd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°dataï¼Œåº”è¯¥å°±æ˜¯å¯†æ–‡äº†,ç»“åˆæºç ä¸‰ç»„ä¸€ä¸€å¯¹åº”</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">3572312064</span><span class="token punctuation">,</span> <span class="token number">2468433000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3725770449</span><span class="token punctuation">,</span> <span class="token number">3734689877</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3387354714</span><span class="token punctuation">,</span> <span class="token number">1042217819</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>éƒ¨åˆ†tracelog</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token number">0x4fc00605f3</span><span class="token operator">=</span><span class="token number">0x400606f0</span><span class="token operator">^</span><span class="token number">0x4f80000303</span>
<span class="token number">0x204dc006c6d1</span><span class="token operator">=</span><span class="token number">0x1ffe400605f3</span><span class="token operator">+</span><span class="token number">0x4f8000c0de</span>
<span class="token number">0x80001122</span><span class="token operator">=</span><span class="token number">0x0</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x4fc006d7f3</span><span class="token operator">=</span><span class="token number">0x4006c6d1</span><span class="token operator">^</span><span class="token number">0x4f80001122</span>
<span class="token number">0x13ec03dabda</span><span class="token operator">=</span><span class="token number">0x13e803db500</span><span class="token operator">^</span><span class="token number">0x40001eda</span>
<span class="token number">0x1ffe8045627a</span><span class="token operator">=</span><span class="token number">0x1ffe403dabda</span><span class="token operator">+</span><span class="token number">0x4007b6a0</span>
<span class="token number">0xd4647576</span><span class="token operator">=</span><span class="token number">0x54646454</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x13ed421170c</span><span class="token operator">=</span><span class="token number">0x13e8045627a</span><span class="token operator">^</span><span class="token number">0x54647576</span>
<span class="token number">0x13c205e380f</span><span class="token operator">=</span><span class="token number">0x2a10ebf50</span><span class="token operator">^</span><span class="token number">0x13e8150875f</span>
<span class="token number">0x2f4800ff9</span><span class="token operator">=</span><span class="token number">0x2a05e380f</span><span class="token operator">+</span><span class="token number">0x5421d7ea</span>
<span class="token number">0xd4647576</span><span class="token operator">=</span><span class="token number">0x54646454</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x2a0e47a8f</span><span class="token operator">=</span><span class="token number">0x2f4800ff9</span><span class="token operator">^</span><span class="token number">0x54647576</span>
<span class="token number">0x785e239bc</span><span class="token operator">=</span><span class="token number">0x507618978</span><span class="token operator">^</span><span class="token number">0x28283b0c4</span>
<span class="token number">0x5a6ce6aeb</span><span class="token operator">=</span><span class="token number">0x505e239bc</span><span class="token operator">+</span><span class="token number">0xa0ec312f</span>
<span class="token number">0xa8c8fbec</span><span class="token operator">=</span><span class="token number">0xa8c8c8a8</span><span class="token operator">+</span><span class="token number">0x3344</span>
<span class="token number">0x50e069107</span><span class="token operator">=</span><span class="token number">0x5a6ce6aeb</span><span class="token operator">^</span><span class="token number">0xa8c8fbec</span>
<span class="token number">0x390cbe62b</span><span class="token operator">=</span><span class="token number">0x311434788</span><span class="token operator">^</span><span class="token number">0x8188a1a3</span>
<span class="token number">0x372f44f1c</span><span class="token operator">=</span><span class="token number">0x310cbe62b</span><span class="token operator">+</span><span class="token number">0x622868f1</span>
<span class="token number">0x128c8d9ca</span><span class="token operator">=</span><span class="token number">0xa8c8c8a8</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x3da3c96d6</span><span class="token operator">=</span><span class="token number">0x372f44f1c</span><span class="token operator">^</span><span class="token number">0xa8c8d9ca</span>
<span class="token number">0xd8aae308</span><span class="token operator">=</span><span class="token number">0x3d9464028</span><span class="token operator">^</span><span class="token number">0x301eca320</span>
<span class="token number">0x453d3ab0d</span><span class="token operator">=</span><span class="token number">0x3d8aae308</span><span class="token operator">+</span><span class="token number">0x7b28c805</span>
<span class="token number">0xfd2d6040</span><span class="token operator">=</span><span class="token number">0xfd2d2cfc</span><span class="token operator">+</span><span class="token number">0x3344</span>
<span class="token number">0x4aefecb4d</span><span class="token operator">=</span><span class="token number">0x453d3ab0d</span><span class="token operator">^</span><span class="token number">0xfd2d6040</span>
<span class="token number">0x497d3d20</span><span class="token operator">=</span><span class="token number">0x8939a1f0</span><span class="token operator">^</span><span class="token number">0xc0449cd0</span>
<span class="token number">0x15aa4715e</span><span class="token operator">=</span><span class="token number">0x897d3d20</span><span class="token operator">+</span><span class="token number">0xd127343e</span>
<span class="token number">0x17d2d3e1e</span><span class="token operator">=</span><span class="token number">0xfd2d2cfc</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x67894f40</span><span class="token operator">=</span><span class="token number">0x9aa4715e</span><span class="token operator">^</span><span class="token number">0xfd2d3e1e</span>
<span class="token number">0x7961a7275</span><span class="token operator">=</span><span class="token number">0x71590ba28</span><span class="token operator">^</span><span class="token number">0x838ac85d</span>
<span class="token number">0x7f8cc89ba</span><span class="token operator">=</span><span class="token number">0x7161a7275</span><span class="token operator">+</span><span class="token number">0xe2b21745</span>
<span class="token number">0x5191e6b6</span><span class="token operator">=</span><span class="token number">0x51919150</span><span class="token operator">+</span><span class="token number">0x5566</span>
<span class="token number">0x7a95d6f0c</span><span class="token operator">=</span><span class="token number">0x7f8cc89ba</span><span class="token operator">^</span><span class="token number">0x5191e6b6</span>
<span class="token number">0x596cf08dd</span><span class="token operator">=</span><span class="token number">0x5d4251a50</span><span class="token operator">^</span><span class="token number">0x42ea128d</span>
<span class="token number">0x69153ac27</span><span class="token operator">=</span><span class="token number">0x5d6cf08dd</span><span class="token operator">+</span><span class="token number">0xba84a34a</span>
<span class="token number">0xd191a272</span><span class="token operator">=</span><span class="token number">0x51919150</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x6c0c20e55</span><span class="token operator">=</span><span class="token number">0x69153ac27</span><span class="token operator">^</span><span class="token number">0x5191a272</span>
<span class="token number">0xd92cfc46</span><span class="token operator">=</span><span class="token number">0x51ba12cd0</span><span class="token operator">^</span><span class="token number">0x5c28dd096</span>
<span class="token number">0x5bca121e0</span><span class="token operator">=</span><span class="token number">0x5192cfc46</span><span class="token operator">+</span><span class="token number">0xa374259a</span>
<span class="token number">0xa5f64b0a</span><span class="token operator">=</span><span class="token number">0xa5f5f5a4</span><span class="token operator">+</span><span class="token number">0x5566</span>
<span class="token number">0x519576aea</span><span class="token operator">=</span><span class="token number">0x5bca121e0</span><span class="token operator">^</span><span class="token number">0xa5f64b0a</span>
<span class="token number">0x61daf0198</span><span class="token operator">=</span><span class="token number">0x69ee071a0</span><span class="token operator">^</span><span class="token number">0x834f7038</span>
<span class="token number">0x7718b0fcc</span><span class="token operator">=</span><span class="token number">0x69daf0198</span><span class="token operator">+</span><span class="token number">0xd3dc0e34</span>
<span class="token number">0x125f606c6</span><span class="token operator">=</span><span class="token number">0xa5f5f5a4</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x7d47d090a</span><span class="token operator">=</span><span class="token number">0x7718b0fcc</span><span class="token operator">^</span><span class="token number">0xa5f606c6</span>
<span class="token number">0x53e56b19a</span><span class="token operator">=</span><span class="token number">0x3bf897520</span><span class="token operator">^</span><span class="token number">0x681dfc4ba</span>
<span class="token number">0x43647e03e</span><span class="token operator">=</span><span class="token number">0x3be56b19a</span><span class="token operator">+</span><span class="token number">0x77f12ea4</span>
<span class="token number">0xfa5ad180</span><span class="token operator">=</span><span class="token number">0xfa5a59f8</span><span class="token operator">+</span><span class="token number">0x7788</span>
<span class="token number">0x4cc1d31be</span><span class="token operator">=</span><span class="token number">0x43647e03e</span><span class="token operator">^</span><span class="token number">0xfa5ad180</span>
<span class="token number">0x43db61b6f</span><span class="token operator">=</span><span class="token number">0x4ffc9ff90</span><span class="token operator">^</span><span class="token number">0xc27fe4ff</span>
<span class="token number">0x59daf5b61</span><span class="token operator">=</span><span class="token number">0x4fdb61b6f</span><span class="token operator">+</span><span class="token number">0x9ff93ff2</span>
<span class="token number">0x17a5a6b1a</span><span class="token operator">=</span><span class="token number">0xfa5a59f8</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x567f5307b</span><span class="token operator">=</span><span class="token number">0x59daf5b61</span><span class="token operator">^</span><span class="token number">0xfa5a6b1a</span>
<span class="token number">0x23c4d6184</span><span class="token operator">=</span><span class="token number">0x6ff32f8f8</span><span class="token operator">^</span><span class="token number">0x4c37f997c</span>
<span class="token number">0x7dc33c0a3</span><span class="token operator">=</span><span class="token number">0x6fc4d6184</span><span class="token operator">+</span><span class="token number">0xdfe65f1f</span>
<span class="token number">0x4ebf35d4</span><span class="token operator">=</span><span class="token number">0x4ebebe4c</span><span class="token operator">+</span><span class="token number">0x7788</span>
<span class="token number">0x7928cf577</span><span class="token operator">=</span><span class="token number">0x7dc33c0a3</span><span class="token operator">^</span><span class="token number">0x4ebf35d4</span>
<span class="token number">0x1d4fbb39d</span><span class="token operator">=</span><span class="token number">0x19431ab48</span><span class="token operator">^</span><span class="token number">0x40ca18d5</span>
<span class="token number">0x20781e906</span><span class="token operator">=</span><span class="token number">0x194fbb39d</span><span class="token operator">+</span><span class="token number">0x72863569</span>
<span class="token number">0xcebecf6e</span><span class="token operator">=</span><span class="token number">0x4ebebe4c</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x1893f2668</span><span class="token operator">=</span><span class="token number">0x1c781e906</span><span class="token operator">^</span><span class="token number">0x4ebecf6e</span>
<span class="token number">0x2c888ba2e</span><span class="token operator">=</span><span class="token number">0x3492c2c38</span><span class="token operator">^</span><span class="token number">0x181a49616</span>
<span class="token number">0x3b1ae3fb5</span><span class="token operator">=</span><span class="token number">0x34888ba2e</span><span class="token operator">+</span><span class="token number">0x69258587</span>
<span class="token number">0x1232333c2</span><span class="token operator">=</span><span class="token number">0xa32322a0</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x3128d0c77</span><span class="token operator">=</span><span class="token number">0x3b1ae3fb5</span><span class="token operator">^</span><span class="token number">0xa32333c2</span>
<span class="token number">0x2a98e4207</span><span class="token operator">=</span><span class="token number">0x2289a0f00</span><span class="token operator">^</span><span class="token number">0x81144d07</span>
<span class="token number">0x26ea183e7</span><span class="token operator">=</span><span class="token number">0x2298e4207</span><span class="token operator">+</span><span class="token number">0x451341e0</span>
<span class="token number">0x1232333c2</span><span class="token operator">=</span><span class="token number">0xa32322a0</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x2cd82b025</span><span class="token operator">=</span><span class="token number">0x26ea183e7</span><span class="token operator">^</span><span class="token number">0xa32333c2</span>
<span class="token number">0x3b59b0db6</span><span class="token operator">=</span><span class="token number">0x1b541ad60</span><span class="token operator">^</span><span class="token number">0x200daa0d6</span>
<span class="token number">0x3ec434362</span><span class="token operator">=</span><span class="token number">0x1b59b0db6</span><span class="token operator">+</span><span class="token number">0x236a835ac</span>
<span class="token number">0x177879816</span><span class="token operator">=</span><span class="token number">0xf78786f4</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x11bc4db74</span><span class="token operator">=</span><span class="token number">0x1ec434362</span><span class="token operator">^</span><span class="token number">0xf7879816</span>
<span class="token number">0x3c7438ad5</span><span class="token operator">=</span><span class="token number">0x306c0eaa0</span><span class="token operator">^</span><span class="token number">0xc1836075</span>
<span class="token number">0x3681ba829</span><span class="token operator">=</span><span class="token number">0x307438ad5</span><span class="token operator">+</span><span class="token number">0x60d81d54</span>
<span class="token number">0x177879816</span><span class="token operator">=</span><span class="token number">0xf78786f4</span><span class="token operator">+</span><span class="token number">0x80001122</span>
<span class="token number">0x39f9c303f</span><span class="token operator">=</span><span class="token number">0x3681ba829</span><span class="token operator">^</span><span class="token number">0xf7879816</span>
<span class="token number">0x5b17a3ecf</span><span class="token operator">=</span><span class="token number">0x6b2232f58</span><span class="token operator">^</span><span class="token number">0x303591197</span>
<span class="token number">0x787bea4ba</span><span class="token operator">=</span><span class="token number">0x6b17a3ecf</span><span class="token operator">+</span><span class="token number">0xd64465eb</span>
<span class="token number">0x4bec1e8c</span><span class="token operator">=</span><span class="token number">0x4bebeb48</span><span class="token operator">+</span><span class="token number">0x3344</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œçš„shiftæ²¡æœ‰ç”¨åˆ°pynumber_shiftï¼Œè€Œæ˜¯ç»è¿‡äº†åº•å±‚ä¼˜åŒ–ç¼–ç¨‹çš„Cè¯­è¨€çš„è¿ç®—ç¬¦ï¼Œæ‰€ä»¥traceä¸å‡ºæ¥ï¼Œæˆ‘ä»¬åªèƒ½é™æ€åˆ†æ</p>
<p>è¿™é‡Œçš„æ•°å­—ä½æ•°ç¡®å®šä¸äº†,å†™hookè„šæœ¬å¾ˆéš¾å—</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> idc
<span class="token keyword">def</span> <span class="token function">calVal</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    val<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>val<span class="token punctuation">,</span>byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
    result<span class="token operator">=</span><span class="token punctuation">(</span>val<span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span><span class="token punctuation">(</span>val<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">30</span>
    <span class="token keyword">return</span> result

arg2_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span>
arg1_addr<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_reg_value<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span>
arg2_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg1_size<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
arg2_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg2_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
arg1_val<span class="token operator">=</span>idc<span class="token punctuation">.</span>get_bytes<span class="token punctuation">(</span>arg1_addr<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
val2<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg2_val<span class="token punctuation">,</span>arg2_size<span class="token punctuation">)</span>
val1<span class="token operator">=</span>calVal<span class="token punctuation">(</span>arg1_val<span class="token punctuation">,</span>arg1_size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token operator">&lt;&lt;</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">&lt;&lt;</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç›´æ¥é™æ€çœ‹ä¹Ÿä¸æ˜¯ä¸å¯ä»¥</p>
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734438391825-fad73a81-6cf2-4ce7-b49c-b9a45e09a600.png" class="" loading="lazy">
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734438229203-72af4db1-08e0-4ebf-9d88-7074922c2a98.png" class="" loading="lazy">
<p>é¦–å…ˆæ‰¾åˆ°åŠ å¯†å‡½æ•°,ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¾“å…¥çš„ç¬¬äºŒä¸ªæ•°æ®ï¼Œç¬¬ä¸‰ä¸ªåº”è¯¥æ˜¯åˆ—è¡¨çš„åœ°å€</p>
<p>è¿›å»åï¼Œä¸­é—´æœ‰ä¸€ä¸ªå¤§å¾ªç¯</p>
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734438456803-17510bbd-eee7-46af-a6ad-8a9d003b2248.png" class="" loading="lazy">
<p>å¾ªç¯å‰é¢çš„ä¸€å †éƒ½æ˜¯åˆå§‹åŒ–ä»£ç ï¼Œå¯ä»¥ä¸çœ‹</p>
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734440524313-31b102fe-4196-4718-b942-0afb3842cf14.png" class="" loading="lazy">
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734440512426-80086783-e086-426a-81ee-d88e8873fc4d.png" class="" loading="lazy">
<img src="/2025/01/13/pyd%E9%80%86%E5%90%91/1734440678680-b030ccc2-13e0-4831-9d3c-89c61276993f.png" class="" loading="lazy">
<p>è·Ÿè¸ªæ•°æ®æµ ç»“åˆtracelogæœ€åå°±èƒ½å¾—åˆ°æœ€åçš„ç­‰å¼</p>
<p>æœ€åçš„exp</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"stdio.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"stdint.h"</span></span>
<span class="token keyword">typedef</span> <span class="token class-name">uint32_t</span> uint32<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token class-name">uint8_t</span> uint8<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">decipher</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> num_rounds<span class="token punctuation">,</span> <span class="token class-name">uint32_t</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">uint32_t</span> <span class="token keyword">const</span> key<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> v0 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v1 <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> delta <span class="token operator">=</span> <span class="token number">0x54646454</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> delta <span class="token operator">*</span> num_rounds<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num_rounds<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        v1 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v0 <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> v0<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token punctuation">(</span>sum <span class="token operator">>></span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sum <span class="token operator">-=</span> delta<span class="token punctuation">;</span>
        v0 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v1 <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> v1<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sum <span class="token operator">+</span> key<span class="token punctuation">[</span>sum <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v0<span class="token punctuation">;</span>
    v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    uint32 v<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token number">3572312064</span><span class="token punctuation">,</span> <span class="token number">2468433000</span><span class="token punctuation">,</span> <span class="token number">3725770449</span><span class="token punctuation">,</span> <span class="token number">3734689877</span><span class="token punctuation">,</span> <span class="token number">3387354714</span><span class="token punctuation">,</span>  <span class="token number">1042217819</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    uint32 key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">103</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">decipher</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> v <span class="token operator">+</span> i<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    uint8 <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token punctuation">(</span>uint8 <span class="token operator">*</span><span class="token punctuation">)</span> v<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c%c%c%c"</span><span class="token punctuation">,</span> ptr<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ptr<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ptr<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ptr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">flag</span><span class="token expression"><span class="token punctuation">&#123;</span>pFmuS0qUf8ic2rYrXO<span class="token punctuation">&#125;</span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</div></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/11/04/2024%E5%BC%BA%E7%BD%91%E6%9D%AFRe%E6%96%B9%E5%90%91%E5%A4%8D%E7%8E%B0/" rel="next" title="2024å¼ºç½‘æ¯éƒ¨åˆ†Reå¤ç°"><span class="post-nav-text">2024å¼ºç½‘æ¯éƒ¨åˆ†Reå¤ç°</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>æ‚¨éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼Œæ‰å¯ä½¿ç”¨è¯„è®ºåŒºåŠŸèƒ½ã€‚</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2025/01/13/pyd%E9%80%86%E5%90%91/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank"></a></div><div class="copyright"><span>&copy; 2023 â€“ 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Npc</span></div><div class="footer-custom-text">=w=</div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>