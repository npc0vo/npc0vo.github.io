<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;zh-CN&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Npc"><meta name="copyright" content="Npc"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>pwnCollege2-ProgramInteraction | Npc | Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.css"><script src="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.js"></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"npc0vo.github.io","root":"/","title":"Npcå°ç«™","version":"1.10.11","mode":"light","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://waline-onelastchicks-projects.vercel.app/","comment":false,"el":"#waline","lang":["en","zh-CN","default"]},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="LectureNote  Linux Command Line: Linuxå‘½ä»¤è¡Œ:  File System: æ–‡ä»¶ç³»ç»Ÿ:   Absolute Paths: start with &#x2F;ç»å¯¹è·¯å¾„ï¼šä»¥ &quot;Â &#x2F;&quot; å¼€å¤´ã€‚ Relative Paths: do NOT start with &#x2F;, relative to the current working directoryç›¸å¯¹">
<meta property="og:type" content="article">
<meta property="og:title" content="pwnCollege2-ProgramInteraction">
<meta property="og:url" content="http://npc0vo.github.io/2024/05/09/PwnCollege2-ProgramInteraction/index.html">
<meta property="og:site_name" content="Npc | Blog">
<meta property="og:description" content="LectureNote  Linux Command Line: Linuxå‘½ä»¤è¡Œ:  File System: æ–‡ä»¶ç³»ç»Ÿ:   Absolute Paths: start with &#x2F;ç»å¯¹è·¯å¾„ï¼šä»¥ &quot;Â &#x2F;&quot; å¼€å¤´ã€‚ Relative Paths: do NOT start with &#x2F;, relative to the current working directoryç›¸å¯¹">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s0merset7.github.io/post/2021/sept/program_interaction/fileSystemStructure.png">
<meta property="article:published_time" content="2024-05-09T11:36:57.000Z">
<meta property="article:modified_time" content="2024-06-08T12:43:28.305Z">
<meta property="article:author" content="Npc">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s0merset7.github.io/post/2021/sept/program_interaction/fileSystemStructure.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Npc"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Npc"><span class="site-author-status">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">Npc</a></div><span class="site-name">Npc | Blog</span><sub class="site-subtitle">æƒ³s</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">68</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">14</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/npc0vo" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@1930278836@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/npc0vo" title="Yuque" target="_blank" style="color:var(--hty-text-color)"><span class="icon iconify" data-icon="ri:yuque"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#lecturenote"><span class="toc-number">1.</span> <span class="toc-text"> LectureNote</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#linux-command-line-linux%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-number">1.1.</span> <span class="toc-text"> Linux Command Line: Linuxå‘½ä»¤è¡Œ:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#file-system-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text"> File System: æ–‡ä»¶ç³»ç»Ÿ:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#environment-variables"><span class="toc-number">1.1.2.</span> <span class="toc-text"> Environment Variables:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#files"><span class="toc-number">1.1.3.</span> <span class="toc-text"> Files:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pipes"><span class="toc-number">1.1.4.</span> <span class="toc-text"> Pipes:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useful-commands-cli"><span class="toc-number">1.1.5.</span> <span class="toc-text"> Useful Commands (CLI):</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#binary-files"><span class="toc-number">1.2.</span> <span class="toc-text"> Binary Files</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#elf-files"><span class="toc-number">1.2.1.</span> <span class="toc-text"> ELF Files:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#symbols"><span class="toc-number">1.2.2.</span> <span class="toc-text"> Symbols:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resources-to-interact-with-elf"><span class="toc-number">1.2.3.</span> <span class="toc-text"> Resources to Interact with ELF:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useful-commands-binary"><span class="toc-number">1.2.4.</span> <span class="toc-text"> Useful Commands (Binary):</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lifecycle-of-a-linux-process"><span class="toc-number">1.3.</span> <span class="toc-text"> Lifecycle of a Linux Process</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#what-is-a-process"><span class="toc-number">1.3.1.</span> <span class="toc-text"> What is a Process:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#process-timeline-%E8%BF%87%E7%A8%8B%E6%97%B6%E9%97%B4%E8%BD%B4"><span class="toc-number">1.3.2.</span> <span class="toc-text"> Process Timeline: è¿‡ç¨‹æ—¶é—´è½´:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useful-commands-viewing-processes"><span class="toc-number">1.3.3.</span> <span class="toc-text"> Useful Commands (Viewing Processes):</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sources"><span class="toc-number">1.4.</span> <span class="toc-text"> Sources:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#challenges"><span class="toc-number">2.</span> <span class="toc-text"> Challenges</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#program-interaction"><span class="toc-number">2.1.</span> <span class="toc-text"> Program Interaction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#level1"><span class="toc-number">2.1.1.</span> <span class="toc-text"> level1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level2"><span class="toc-number">2.1.2.</span> <span class="toc-text"> level2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level3"><span class="toc-number">2.1.3.</span> <span class="toc-text"> level3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level4"><span class="toc-number">2.1.4.</span> <span class="toc-text"> level4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level7"><span class="toc-number">2.1.5.</span> <span class="toc-text"> level7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level5"><span class="toc-number">2.1.6.</span> <span class="toc-text"> level5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level6"><span class="toc-number">2.1.7.</span> <span class="toc-text"> level6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level8"><span class="toc-number">2.1.8.</span> <span class="toc-text"> level8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level9"><span class="toc-number">2.1.9.</span> <span class="toc-text"> level9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level10"><span class="toc-number">2.1.10.</span> <span class="toc-text"> level10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level11"><span class="toc-number">2.1.11.</span> <span class="toc-text"> level11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level12"><span class="toc-number">2.1.12.</span> <span class="toc-text"> level12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level13"><span class="toc-number">2.1.13.</span> <span class="toc-text"> level13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level14"><span class="toc-number">2.1.14.</span> <span class="toc-text"> level14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level15"><span class="toc-number">2.1.15.</span> <span class="toc-text"> level15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level16"><span class="toc-number">2.1.16.</span> <span class="toc-text"> level16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level17"><span class="toc-number">2.1.17.</span> <span class="toc-text"> level17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level18"><span class="toc-number">2.1.18.</span> <span class="toc-text"> level18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level19"><span class="toc-number">2.1.19.</span> <span class="toc-text"> level19</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level20"><span class="toc-number">2.1.20.</span> <span class="toc-text"> level20</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level21"><span class="toc-number">2.1.21.</span> <span class="toc-text"> level21</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level22"><span class="toc-number">2.1.22.</span> <span class="toc-text"> level22</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level23"><span class="toc-number">2.1.23.</span> <span class="toc-text"> level23</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level24"><span class="toc-number">2.1.24.</span> <span class="toc-text"> level24</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level25"><span class="toc-number">2.1.25.</span> <span class="toc-text"> level25</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level26"><span class="toc-number">2.1.26.</span> <span class="toc-text"> level26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level27"><span class="toc-number">2.1.27.</span> <span class="toc-text"> level27</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level28"><span class="toc-number">2.1.28.</span> <span class="toc-text"> level28</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level29"><span class="toc-number">2.1.29.</span> <span class="toc-text"> level29</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level30"><span class="toc-number">2.1.30.</span> <span class="toc-text"> level30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level31"><span class="toc-number">2.1.31.</span> <span class="toc-text"> level31</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level32"><span class="toc-number">2.1.32.</span> <span class="toc-text"> level32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level33"><span class="toc-number">2.1.33.</span> <span class="toc-text"> level33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level34"><span class="toc-number">2.1.34.</span> <span class="toc-text"> level34</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level35"><span class="toc-number">2.1.35.</span> <span class="toc-text"> level35</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level36"><span class="toc-number">2.1.36.</span> <span class="toc-text"> level36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level37"><span class="toc-number">2.1.37.</span> <span class="toc-text"> level37</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level38"><span class="toc-number">2.1.38.</span> <span class="toc-text"> level38</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level39"><span class="toc-number">2.1.39.</span> <span class="toc-text"> level39</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level40"><span class="toc-number">2.1.40.</span> <span class="toc-text"> level40</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level41"><span class="toc-number">2.1.41.</span> <span class="toc-text"> level41</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level42"><span class="toc-number">2.1.42.</span> <span class="toc-text"> level42</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level43"><span class="toc-number">2.1.43.</span> <span class="toc-text"> level43</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level44"><span class="toc-number">2.1.44.</span> <span class="toc-text"> level44</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level45"><span class="toc-number">2.1.45.</span> <span class="toc-text"> level45</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level46"><span class="toc-number">2.1.46.</span> <span class="toc-text"> level46</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level47"><span class="toc-number">2.1.47.</span> <span class="toc-text"> level47</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level48"><span class="toc-number">2.1.48.</span> <span class="toc-text"> level48</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level49"><span class="toc-number">2.1.49.</span> <span class="toc-text"> level49</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level50"><span class="toc-number">2.1.50.</span> <span class="toc-text"> level50</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level51"><span class="toc-number">2.1.51.</span> <span class="toc-text"> level51</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level52"><span class="toc-number">2.1.52.</span> <span class="toc-text"> level52</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level53"><span class="toc-number">2.1.53.</span> <span class="toc-text"> level53</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level54"><span class="toc-number">2.1.54.</span> <span class="toc-text"> level54</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level55"><span class="toc-number">2.1.55.</span> <span class="toc-text"> level55</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level56"><span class="toc-number">2.1.56.</span> <span class="toc-text"> level56</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level57"><span class="toc-number">2.1.57.</span> <span class="toc-text"> level57</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level58"><span class="toc-number">2.1.58.</span> <span class="toc-text"> level58</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level59"><span class="toc-number">2.1.59.</span> <span class="toc-text"> level59</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level60"><span class="toc-number">2.1.60.</span> <span class="toc-text"> level60</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://npc0vo.github.io/2024/05/09/PwnCollege2-ProgramInteraction/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Npc"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Npc | Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">pwnCollege2-ProgramInteraction</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-05-09 19:36:57" itemprop="dateCreated datePublished" datetime="2024-05-09T19:36:57+08:00">2024-05-09</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2024-06-08 20:43:28" itemprop="dateModified" datetime="2024-06-08T20:43:28+08:00">2024-06-08</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">8.5k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">39m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/PwnCollege/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">PwnCollege</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/CTF/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">CTF</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="lecturenote"><a class="markdownIt-Anchor" href="#lecturenote"></a> LectureNote</h1>
<h2 id="linux-command-line-linuxå‘½ä»¤è¡Œ"><a class="markdownIt-Anchor" href="#linux-command-line-linuxå‘½ä»¤è¡Œ"></a> Linux Command Line: Linuxå‘½ä»¤è¡Œ:</h2>
<h3 id="file-system-æ–‡ä»¶ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#file-system-æ–‡ä»¶ç³»ç»Ÿ"></a> <strong>File System: æ–‡ä»¶ç³»ç»Ÿ:</strong></h3>
<img src="https://s0merset7.github.io/post/2021/sept/program_interaction/fileSystemStructure.png" alt="File System Structure" / loading="lazy">
<ul>
<li>Absolute Paths: start with <code>/</code>ç»å¯¹è·¯å¾„ï¼šä»¥ &quot;Â <code>/</code>&quot; å¼€å¤´ã€‚</li>
<li>Relative Paths: do NOT start with <code>/</code>, relative to the current working directoryç›¸å¯¹è·¯å¾„ï¼šä¸è¦ä»¥â€œÂ <code>/</code>Â â€å¼€å¤´ï¼Œç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•</li>
</ul>
<h3 id="environment-variables"><a class="markdownIt-Anchor" href="#environment-variables"></a> <strong>Environment Variables:</strong></h3>
<p>Environment Variables: a set of Key/Value pairs passed into every process when launched. Critical variables include:ç¯å¢ƒå˜é‡ï¼šåœ¨å¯åŠ¨è¿›ç¨‹æ—¶ä¼ é€’ç»™æ¯ä¸ªè¿›ç¨‹çš„ä¸€ç»„é”®/å€¼å¯¹ã€‚å…³é”®å˜é‡åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>PATH</code>: list of directories to search for programs in[b0]ï¼šè¦æœç´¢ç¨‹åºçš„ç›®å½•åˆ—è¡¨</li>
<li><code>PWD</code>: current working directoryï¼šå½“å‰å·¥ä½œç›®å½•</li>
<li><code>HOME</code>: path to home directoryå®¶ç›®å½•è·¯å¾„</li>
<li><code>HOSTNAME</code>: name of the systemç³»ç»Ÿçš„åç§°</li>
</ul>
<h3 id="files"><a class="markdownIt-Anchor" href="#files"></a> <strong>Files:</strong></h3>
<ul>
<li>Symbolic Links (Soft Links): special type of file that references another file ç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼‰ï¼šä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ç±»å‹ï¼Œå®ƒæŒ‡å‘å¦ä¸€ä¸ªæ–‡ä»¶ã€‚
<ul>
<li>symbolic links to relative paths are relative to the directory containing the linkæŒ‡å‘ç›¸å¯¹è·¯å¾„çš„ç¬¦å·é“¾æ¥ç›¸å¯¹äºåŒ…å«é“¾æ¥çš„ç›®å½•æ˜¯ç›¸å¯¹çš„ã€‚</li>
</ul>
</li>
<li>Hard Links: a perfect reference to the data/content inside the linked file. They link only to the data of the linked file, not its original pathç¡¬é“¾æ¥ï¼šæ˜¯å¯¹é“¾æ¥æ–‡ä»¶å†…éƒ¨æ•°æ®/å†…å®¹çš„å®Œç¾å¼•ç”¨ã€‚å®ƒä»¬ä»…é“¾æ¥åˆ°è¢«é“¾æ¥æ–‡ä»¶çš„æ•°æ®ï¼Œè€Œä¸é“¾æ¥åˆ°å…¶åŸå§‹è·¯å¾„ã€‚</li>
</ul>
<p><strong>Different Types of Files:ä¸åŒç±»å‹çš„æ–‡ä»¶ï¼š</strong></p>
<ul>
<li><code>-</code>: regular file <code>-</code>Â :æ™®é€šæ–‡ä»¶</li>
<li><code>d</code>: a directory (yes, directories are actually just special files!)<code>d</code>Â ï¼š ä¸€ä¸ªç›®å½•ï¼ˆæ˜¯çš„ï¼Œç›®å½•å®é™…ä¸Šåªæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼ï¼‰</li>
<li><code>l</code>: a symbolic link (a file that transparently points to another file or directory)`<code>l</code>Â `ï¼š ç¬¦å·é“¾æ¥ï¼ˆä¸€ç§é€æ˜åœ°æŒ‡å‘å…¶ä»–æ–‡ä»¶æˆ–ç›®å½•çš„æ–‡ä»¶ï¼‰</li>
<li><code>p</code>: is a named pipe (also known as a FIFO)&quot;<code>p</code>Â &quot; æ˜¯ä¸€ä¸ªå‘½åç®¡é“ï¼ˆä¹Ÿç§°ä¸º FIFOï¼‰ã€‚</li>
<li><code>c</code>: is a character device file (i.e., backed by a hardware device that produces or receives data streams, such as a microphone)`/dev/b0` æ˜¯ä¸€ä¸ªå­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼ˆå³ç”±ç¡¬ä»¶è®¾å¤‡æ”¯æŒï¼Œè¯¥ç¡¬ä»¶è®¾å¤‡å¯ä»¥ç”Ÿæˆæˆ–æ¥æ”¶æ•°æ®æµï¼Œä¾‹å¦‚éº¦å…‹é£ï¼‰ã€‚</li>
<li><code>b</code>: a block device file (i.e., backed by a hardware device that stores and loads blocks of data, such as a hard drive)`<code>b</code>Â `ï¼š å—è®¾å¤‡æ–‡ä»¶ï¼ˆå³ç”±ç¡¬ä»¶è®¾å¤‡æ”¯æŒçš„æ–‡ä»¶ï¼Œè¯¥ç¡¬ä»¶è®¾å¤‡ç”¨äºå­˜å‚¨å’ŒåŠ è½½æ•°æ®å—ï¼Œä¾‹å¦‚ç¡¬ç›˜ï¼‰</li>
<li><code>s</code>: a unix socket (essentially a local network connection encapsulated in a file)<code>s</code>Â ï¼š ä¸€ä¸ª Unix å¥—æ¥å­—ï¼ˆæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå°è£…åœ¨æ–‡ä»¶ä¸­çš„æœ¬åœ°ç½‘ç»œè¿æ¥ï¼‰</li>
</ul>
<h3 id="pipes"><a class="markdownIt-Anchor" href="#pipes"></a> <strong>Pipes:</strong></h3>
<ul>
<li>Unnamed Pipes (<code>|</code>): ethereal channels of communication, often used to direct data from one command to anotheråŒ¿åç®¡é“ï¼ˆÂ <code>|</code>Â ï¼‰ï¼šä¸€ç§ç”¨äºé€šä¿¡çš„æ— å½¢é€šé“ï¼Œé€šå¸¸ç”¨äºå°†æ•°æ®ä»ä¸€ä¸ªå‘½ä»¤ä¼ è¾“åˆ°å¦ä¸€ä¸ªå‘½ä»¤ã€‚</li>
<li>Named Pipes (FIFOs): used to help facilitate data flow in certain situations. The flow of data is First In First Out (FIFO)å‘½åç®¡é“ï¼ˆå…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼‰ï¼šç”¨äºåœ¨æŸäº›æƒ…å†µä¸‹å¸®åŠ©æ•°æ®æµçš„ä¼ è¾“ã€‚æ•°æ®çš„ä¼ è¾“éµå¾ªå…ˆè¿›å…ˆå‡ºçš„åŸåˆ™ï¼ˆFIFOï¼‰ã€‚</li>
</ul>
<h3 id="useful-commands-cli"><a class="markdownIt-Anchor" href="#useful-commands-cli"></a> <strong>Useful Commands (CLI):</strong></h3>
<ul>
<li><code>witch programName</code>: will return the absolute path of the program given found by the <code>PATH</code> variableå®ƒå°†è¿”å›ç”± Â <code>PATH</code>Â  å˜é‡æ‰¾åˆ°çš„ç¨‹åºçš„ç»å¯¹è·¯å¾„ã€‚</li>
<li><code>env</code>: prints all the environment variables to the screen`<code>env</code>Â ` ä¼šå°†æ‰€æœ‰ç¯å¢ƒå˜é‡æ‰“å°åˆ°å±å¹•ä¸Šã€‚</li>
<li><code>export variable=value</code>: can set new/existing variables to a new value[b0] å¯ä»¥ä¸ºç°æœ‰æˆ–æ–°åˆ›å»ºçš„å˜é‡è®¾ç½®æ–°çš„å€¼ã€‚</li>
<li><code>ln -s fileToBeLinked symbolicLinkName</code>: creates a symbolic linkåˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚</li>
<li><code>ln fileToBeLinked hardLinkName</code>: creates a hard linkåˆ›å»ºç¡¬é“¾æ¥</li>
<li><code>ls -ld</code>: Lists all files in current directory along with the filesâ€™ absolute path<code>ls -ld</code>Â ï¼š åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠå…¶ç»å¯¹è·¯å¾„</li>
<li><code>mkfifo fifoName</code>: makes a new FIFOåˆ›å»ºä¸€ä¸ªæ–°çš„FIFOï¼ˆå…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼‰ã€‚</li>
<li><code>command &lt; in_file</code>: redirect in_file into commandâ€™s inputå°† `in_file` é‡å®šå‘åˆ°å‘½ä»¤çš„è¾“å…¥ä¸­ã€‚</li>
<li><code>command &gt; out_file</code>: redirect commandâ€™s output into out_file, overwriting itå°†å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ° out_file æ–‡ä»¶ä¸­ï¼Œå¹¶è¦†ç›–è¯¥æ–‡ä»¶ã€‚</li>
<li><code>command &gt;&gt;out_file</code>: redirect the commandâ€™s output into out_file, appending to itå°†å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ° out_file æ–‡ä»¶ä¸­ï¼Œå¹¶è¿½åŠ åˆ°è¯¥æ–‡ä»¶ä¸­ã€‚</li>
<li><code>command 2&gt;error_file</code>: redirect the commandâ€™s errors into error_file, overwriting itå°†å‘½ä»¤çš„é”™è¯¯é‡å®šå‘åˆ° error_file ä¸­ï¼Œå¹¶è¦†ç›–è¯¥æ–‡ä»¶ã€‚</li>
<li><code>command 2&gt;&gt;error_file</code>: redirect the commandâ€™s errors into error_file, appending to itå°†å‘½ä»¤çš„é”™è¯¯é‡å®šå‘åˆ° error_file ä¸­ï¼Œå¹¶è¿½åŠ åˆ°å…¶ä¸­ã€‚</li>
</ul>
<h2 id="binary-files"><a class="markdownIt-Anchor" href="#binary-files"></a> Binary Files</h2>
<h3 id="elf-files"><a class="markdownIt-Anchor" href="#elf-files"></a> <strong>ELF Files:</strong></h3>
<p>Executable and Linkable Format (ELF): defines a program as it will be loaded and executed in memory for Linux/BSD systems. Allows for a compiler to create and define a programå¯æ‰§è¡Œå’Œå¯é“¾æ¥æ ¼å¼ï¼ˆELFï¼‰ï¼šå®šä¹‰äº†Linux/BSDç³»ç»Ÿä¸ŠåŠ è½½å¹¶æ‰§è¡Œçš„ç¨‹åºåœ¨å†…å­˜ä¸­çš„æ ¼å¼ã€‚å…è®¸ç¼–è¯‘å™¨åˆ›å»ºå¹¶å®šä¹‰ç¨‹åºã€‚</p>
<ul>
<li>is a binary file format containing the program, its data, how the program should be loaded (program/segment headers), and the metadata describing program components (section headers)è¿™æ˜¯ä¸€ç§äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼ï¼Œå…¶ä¸­åŒ…å«ç¨‹åºæœ¬èº«ã€æ•°æ®ä»¥åŠç¨‹åºçš„åŠ è½½æ–¹å¼ï¼ˆç¨‹åº/æ®µå¤´ï¼‰ï¼Œä»¥åŠæè¿°ç¨‹åºç»„ä»¶çš„å…ƒæ•°æ®ï¼ˆèŠ‚å¤´ï¼‰ã€‚</li>
<li>For Windows the equivalent are Portable Executables (PE)å¯¹äºWindowsç³»ç»Ÿæ¥è¯´ï¼Œå¯¹åº”çš„æ–‡ä»¶æ ¼å¼æ˜¯Portable Executablesï¼ˆPEï¼‰ã€‚</li>
<li>For MacOS the equivalent are Mach-Oå¯¹äºMacOSï¼Œå…¶å¯¹åº”çš„æ ¼å¼æ˜¯Mach-Oã€‚</li>
</ul>
<p>Dynamically Linked ELF: The ELF file relies on libraries that also need to be loadedåŠ¨æ€é“¾æ¥çš„ELFæ–‡ä»¶ï¼šè¯¥ELFæ–‡ä»¶ä¾èµ–äºéœ€è¦åŠ è½½çš„åº“æ–‡ä»¶ã€‚</p>
<p>Program Headers: specify information and define segments needed to prepare the program for execution. The source of information used when loading a fileç¨‹åºå¤´ï¼šæŒ‡å®šéœ€è¦çš„ä¿¡æ¯å¹¶å®šä¹‰ä¸ºä½¿ç¨‹åºèƒ½å¤Ÿæ‰§è¡Œæ‰€éœ€çš„æ®µã€‚åŠ è½½æ–‡ä»¶æ—¶ä½¿ç”¨çš„ä¿¡æ¯æ¥æº</p>
<ul>
<li>Segments: parts of an ELF file that are loaded into the memory of a computer when that file is executedæ®µï¼šå½“ELFæ–‡ä»¶è¢«æ‰§è¡Œæ—¶ï¼ŒåŠ è½½åˆ°è®¡ç®—æœºå†…å­˜ä¸­çš„æ–‡ä»¶éƒ¨åˆ†</li>
</ul>
<p><strong>Important Entry Types: é‡è¦çš„å…¥å£ç±»å‹ï¼š</strong></p>
<ul>
<li><code>INTERP</code>: entry type defining the library that should be used to load this ELF into memory[b0] å…¥å£ç±»å‹å®šä¹‰äº†åº”è¯¥ä½¿ç”¨å“ªä¸ªåº“æ¥å°†æ­¤ELFåŠ è½½åˆ°å†…å­˜ä¸­ã€‚</li>
<li><code>LOAD</code>: entry type defining a part of the file that should be loaded into memory<code>LOAD</code>Â ï¼š å®šä¹‰æ–‡ä»¶ä¸­åº”åŠ è½½åˆ°å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†çš„å…¥å£ç±»å‹</li>
</ul>
<p>Section Headers: represent a different view inside an ELF file with a lot more semantic information that is less important for the actual loading processèŠ‚å¤´ï¼šä»£è¡¨ELFæ–‡ä»¶ä¸­ä¸€ç§ä¸åŒçš„å†…éƒ¨è§†å›¾ï¼ŒåŒ…å«æ›´å¤šä¸å®é™…åŠ è½½è¿‡ç¨‹å…³ç³»ä¸å¤§çš„è¯­ä¹‰ä¿¡æ¯ã€‚</p>
<ul>
<li>They are not required in an ELF file, they are stored as metadataå®ƒä»¬åœ¨ELFæ–‡ä»¶ä¸­ä¸æ˜¯å¿…éœ€çš„ï¼Œè€Œæ˜¯ä½œä¸ºå…ƒæ•°æ®å­˜å‚¨çš„ã€‚</li>
</ul>
<p><strong>Important Sections: é‡è¦çš„éƒ¨åˆ†:</strong></p>
<ul>
<li><code>.text</code>: the executable code of your program.[b0]ï¼šæ‚¨ç¨‹åºçš„å¯æ‰§è¡Œä»£ç ã€‚</li>
<li><code>.plt</code> and <code>.got</code>: used to resolve and dispatch library calls.å’Œï¼šç”¨äºè§£å†³å’Œåˆ†å‘åº“çš„è°ƒç”¨ã€‚</li>
<li><code>.data</code>: used for pre-initialized global writable data (such as global arrays with initial values)<code>.data</code>Â ï¼š ç”¨äºé¢„å…ˆåˆå§‹åŒ–çš„å…¨å±€å¯å†™æ•°æ®ï¼ˆä¾‹å¦‚å…·æœ‰åˆå§‹å€¼çš„å…¨å±€æ•°ç»„ï¼‰</li>
<li><code>.rodata</code>: used for global read-only data (such as string constants)<code>.rodata</code>Â ï¼šç”¨äºå…¨å±€åªè¯»æ•°æ®ï¼ˆå¦‚å­—ç¬¦ä¸²å¸¸é‡ï¼‰</li>
<li><code>.bss</code>: used for uninitialized global writable data (such as global arrays without initial values)<code>.bss</code>Â ï¼š ç”¨äºæœªåˆå§‹åŒ–çš„å…¨å±€å¯å†™æ•°æ®ï¼ˆä¾‹å¦‚æ²¡æœ‰åˆå§‹å€¼çš„å…¨å±€æ•°ç»„ï¼‰</li>
</ul>
<h3 id="symbols"><a class="markdownIt-Anchor" href="#symbols"></a> <strong>Symbols:</strong></h3>
<p>Symbols: binaries and libraries that use dynamically loaded libraries to find libraries, resolve function calls into those libraries, etc 6081</p>
<h3 id="resources-to-interact-with-elf"><a class="markdownIt-Anchor" href="#resources-to-interact-with-elf"></a> <strong>Resources to Interact with ELF:</strong></h3>
<ul>
<li><code>gcc</code>: to make your ELF.åˆ¶ä½œä½ çš„ELFæ–‡ä»¶ã€‚</li>
<li><code>readelf</code>: to parse the ELF header.è§£æELFå¤´æ–‡ä»¶ã€‚</li>
<li><code>objdump</code>: to parse the ELF header and disassemble the source code.è§£æELFå¤´æ–‡ä»¶å¹¶åæ±‡ç¼–æºä»£ç ã€‚</li>
<li><code>nm</code>: to view your ELFâ€™s symbols.[b0]ï¼šæŸ¥çœ‹æ‚¨çš„ELFæ–‡ä»¶çš„ç¬¦å·ã€‚</li>
<li><code>patchelf</code>: to change some ELF properties.[b0]ï¼šç”¨æ¥æ›´æ”¹ä¸€äº›ELFæ–‡ä»¶çš„å±æ€§ã€‚</li>
<li><code>objcopy</code>: to swap out ELF sections.æ›¿æ¢ELFæ®µã€‚</li>
<li><code>strip</code>: to remove otherwise-helpful information (such as symbols).åˆ é™¤åŸæœ¬æœ‰ç”¨çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ç¬¦å·ï¼‰ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://ide.kaitai.io/"><strong>kaitai struct</strong></a>: to look through your ELF interactively.å‡¯æ³°ç»“æ„ï¼šç”¨äºäº¤äº’å¼æŸ¥çœ‹ELFæ–‡ä»¶ã€‚</li>
</ul>
<h3 id="useful-commands-binary"><a class="markdownIt-Anchor" href="#useful-commands-binary"></a> <strong>Useful Commands (Binary):</strong></h3>
<ul>
<li><code>readelf -a programName</code>: will parse out the ELF file, providing information such as headerså®ƒä¼šè§£æELFæ–‡ä»¶ï¼Œæä¾›è¯¸å¦‚å¤´æ–‡ä»¶ä¹‹ç±»çš„ä¿¡æ¯ã€‚</li>
<li><code>nm -a programName</code>: will list out all of the symbols associated with a program[b0] å°†ä¼šåˆ—å‡ºä¸ç¨‹åºç›¸å…³çš„æ‰€æœ‰ç¬¦å·ã€‚</li>
<li><code>nm -D programName</code>: will list out all of the dynamic imports used at runtimeå°†ä¼šåˆ—å‡ºåœ¨è¿è¡Œæ—¶ä½¿ç”¨çš„æ‰€æœ‰åŠ¨æ€å¯¼å…¥ã€‚</li>
</ul>
<h2 id="lifecycle-of-a-linux-process"><a class="markdownIt-Anchor" href="#lifecycle-of-a-linux-process"></a> Lifecycle of a Linux Process</h2>
<h3 id="what-is-a-process"><a class="markdownIt-Anchor" href="#what-is-a-process"></a> <strong>What is a Process:</strong></h3>
<p><strong>Every Linux process has: æ¯ä¸ªLinuxè¿›ç¨‹éƒ½æœ‰ï¼š</strong></p>
<ul>
<li>State çŠ¶æ€
<ul>
<li>running, waiting, stopped, zombieè·‘æ­¥ã€ç­‰å¾…ã€åœæ­¢ã€åƒµå°¸</li>
</ul>
</li>
<li>Priority (and other scheduling information)ä¼˜å…ˆçº§ï¼ˆä»¥åŠå…¶ä»–è°ƒåº¦ä¿¡æ¯ï¼‰</li>
<li>Parent, Siblings, Childrençˆ¶æ¯ã€å…„å¼Ÿå§å¦¹ã€å­å¥³</li>
<li>Shared Resources å…±äº«èµ„æº
<ul>
<li>files, pipes, sockets æ–‡ä»¶ã€ç®¡é“ã€å¥—æ¥å­—</li>
</ul>
</li>
<li>Virtual Memory Space è™šæ‹Ÿå†…å­˜ç©ºé—´</li>
<li>Security Context å®‰å…¨ä¸Šä¸‹æ–‡
<ul>
<li>effective uid and gid æœ‰æ•ˆçš„UIDï¼ˆç”¨æˆ·IDï¼‰å’ŒGIDï¼ˆç»„IDï¼‰</li>
<li>saved uid and gid å·²ä¿å­˜çš„uidå’Œgid</li>
<li>capabilities åŠŸèƒ½</li>
</ul>
</li>
</ul>
<p>Virtual Memory: memory dedicated to a specific processè™šæ‹Ÿå†…å­˜ï¼šä¸“é—¨åˆ†é…ç»™æŸä¸ªè¿›ç¨‹çš„å†…å­˜</p>
<p>Physical Memory: memory shared among the whole systemç‰©ç†å†…å­˜ï¼šç³»ç»Ÿä¸­æ‰€æœ‰ç»„ä»¶å…±äº«çš„å†…å­˜</p>
<p>libc: a library full of helper functions that is used by almost every program (including common C functions)libc æ˜¯ä¸€ä¸ªåŒ…å«å¤§é‡è¾…åŠ©å‡½æ•°çš„åº“ï¼Œå‡ ä¹æ‰€æœ‰çš„ç¨‹åºï¼ˆåŒ…æ‹¬å¸¸è§çš„ C å‡½æ•°ï¼‰éƒ½ä¼šä½¿ç”¨å®ƒã€‚</p>
<h3 id="process-timeline-è¿‡ç¨‹æ—¶é—´è½´"><a class="markdownIt-Anchor" href="#process-timeline-è¿‡ç¨‹æ—¶é—´è½´"></a> <strong>Process Timeline: è¿‡ç¨‹æ—¶é—´è½´:</strong></h3>
<ol>
<li><strong>Process is created åˆ›å»ºæµç¨‹</strong>
<ul>
<li>Kernel will check for executable permissions</li>
<li>Calls <code>execve()</code> to begin loading</li>
</ul>
</li>
<li><strong>Process is loaded è¿›ç¨‹å·²åŠ è½½</strong></li>
</ol>
<ul>
<li>Figures out what steps need to be taken to load the file
<ul>
<li>Starts from the beginning of the file, looks for <code>#!</code> (sh-bang) to extract the rest of the line (the interpreter)
<ul>
<li>Will see if the interpreter matches one in the system, and will instead run your file as an argument to the interpreter from <code>#!</code></li>
</ul>
</li>
<li>If there is no <code>#!</code> (not a script) then it will check if the file matches a format in <code>/proc/sys/binfmt_misc</code>
<ul>
<li>If a match is found, then it will execute the interpreter for that format with your file as an argument</li>
</ul>
</li>
<li>If it is a dynamically-linked ELF file, the kernel will read the interpreter/loader (collectively loader) defined in the ELF file
<ul>
<li>The interpreter will be loaded and will be given control</li>
<li>The interpreter then locates the libraries
<ul>
<li><code>LD_PRELOAD</code>: environment variable, and anything in /etc/ld.so.preload</li>
<li><code>LD_LIBRARY_PATH</code>: environment variable (can be set in the shell)</li>
<li><code>DT_RUNPATH</code> or <code>DT_RPATH</code>: specified in the binary file (both can be modified with patchelf)</li>
<li>/etc/ld.so.conf: system-wide configuration</li>
<li>/lib and /usr/lib /libå’Œ/usr/lib</li>
</ul>
</li>
<li>The interpreter then runs the libraries
<ul>
<li>May cause more libraries to load if libraries depend on other libraries</li>
<li>Will also update relocations during this process</li>
</ul>
</li>
</ul>
</li>
<li>If it is a static ELF file, the kernel will just load the file</li>
</ul>
</li>
<li>All of this information will be loaded to its own virtual memory space containing (located in /proc/self/maps):
<ul>
<li>the binary äºŒè¿›åˆ¶</li>
<li>the libraries åº“</li>
<li>the â€œheapâ€ â€œå †â€
<ul>
<li>for dynamically allocated memory</li>
</ul>
</li>
<li>the â€œstackâ€ â€œæ ˆâ€
<ul>
<li>for function local variables</li>
</ul>
</li>
<li>any memory specifically mapped by the program</li>
<li>some helper regions ä¸€äº›è¾…åŠ©åŒºåŸŸ</li>
<li>kernel code in the â€œupper halfâ€ of memory is inaccessible to the process
<ul>
<li>above 0x8000000000000000 on 64-bit architectures</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>Process is initialized è¿›ç¨‹å·²åˆå§‹åŒ–ã€‚</strong>
<ul>
<li>Will run any constructors specified in the ELF fileå°†ä¼šè¿è¡ŒELFæ–‡ä»¶ä¸­æŒ‡å®šçš„æ‰€æœ‰æ„é€ å‡½æ•°ã€‚</li>
</ul>
</li>
<li><strong>Process is launched è¿›ç¨‹å¯åŠ¨</strong>
<ul>
<li>The ELF file automatically calls <code>_libc_start_main()</code> from the libc library, which then calls the programâ€™s <code>main()</code> functionELFæ–‡ä»¶ä¼šè‡ªåŠ¨ä»libcåº“ä¸­è°ƒç”¨Â <code>_libc_start_main()</code>Â ï¼Œç„¶ålibcåº“ä¼šè°ƒç”¨ç¨‹åºä¸­çš„Â <code>main()</code>Â å‡½æ•°ã€‚</li>
<li>Now the code is runningç°åœ¨ä»£ç æ­£åœ¨è¿è¡Œã€‚</li>
</ul>
</li>
<li><strong>Process reads its arguments and environmentç¨‹åºä¼šè¯»å–å…¶å‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚</strong></li>
</ol>
<ul>
<li>
<p>The <code>int main(int argc, void **argv, void **envp);</code> function will take in three arguments:</p>
<ul>
<li><code>argc</code>: the loaded objects (binaries and libraries)åŠ è½½çš„å¯¹è±¡ï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶å’Œåº“æ–‡ä»¶ï¼‰</li>
<li><code>argv</code>: command-line arguments in argvargv ä¸­çš„å‘½ä»¤è¡Œå‚æ•°</li>
<li><code>envp</code>: environment variables<code>envp</code>Â ï¼š ç¯å¢ƒå˜é‡</li>
</ul>
<p>è¿™ä¸ª `b0` å‡½æ•°å°†æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š</p>
</li>
</ul>
<ol start="6">
<li><strong>Process executes æµç¨‹æ‰§è¡Œ</strong></li>
</ol>
<ul>
<li>To interact with the operating system(OS), the process will use system callsä¸ºäº†ä¸æ“ä½œç³»ç»Ÿï¼ˆOSï¼‰è¿›è¡Œäº¤äº’ï¼Œè¿›ç¨‹å°†ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚</li>
<li>For the OS to communicate with the process, signals are used æ“ä½œç³»ç»Ÿé€šè¿‡ä¿¡å·ä¸è¿›ç¨‹è¿›è¡Œé€šä¿¡ã€‚
<ul>
<li>Signals will pause process execution and invoke the handler (functions that take in the signal number) ä¿¡å·ä¼šæš‚åœè¿›ç¨‹çš„æ‰§è¡Œï¼Œå¹¶è°ƒç”¨å¤„ç†ç¨‹åºï¼ˆå³æ¥æ”¶ä¿¡å·å·ç çš„å‡½æ•°ï¼‰ã€‚
<ul>
<li>If the signal has no handler, the default action is to kill the process</li>
</ul>
</li>
</ul>
</li>
<li>Another method of outside interaction is by sharing memory with other processes
<ul>
<li>This requires an initial system call, but then is self sustaining</li>
<li>One way is to use a shared memory-mapped file in /dev/shm</li>
</ul>
</li>
</ul>
<ol start="7">
<li><strong>Process terminates è¿›ç¨‹ç»ˆæ­¢</strong></li>
</ol>
<ul>
<li>Only two ways a process can terminate:
<ul>
<li>Receive an unhandled signal</li>
<li>Calling the <code>exit()</code> system call</li>
</ul>
</li>
<li>After termination, processes must be â€œreapedâ€
<ul>
<li>A process will remain in a zombie state and take up memory until the <code>wait()</code> function is called by their parent</li>
<li>This will return the processâ€™s exit code to the parent and then the process will be freed
<ul>
<li>If this does not happen, the process is re-parented to PID 1 and will remain there until cleaned up</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="useful-commands-viewing-processes"><a class="markdownIt-Anchor" href="#useful-commands-viewing-processes"></a> Useful Commands (Viewing Processes):</h3>
<ul>
<li><code>readelf -a fileName | grep interpret</code>: will return the specific loader being used to load the fileå°†ä¼šè¿”å›ç”¨äºåŠ è½½è¯¥æ–‡ä»¶çš„ç‰¹å®šåŠ è½½å™¨ã€‚</li>
<li><code>patchelf --set-interpreter /some/interpreter ./fileName</code>: will forcibly set the interpreter for a provided file[b0] ä¼šå¼ºåˆ¶ä¸ºæŒ‡å®šæ–‡ä»¶è®¾ç½®è§£é‡Šå™¨ã€‚</li>
<li><code>ldd ./fileName</code>: will list the libraries necessary for the file to run, including the interpreterå®ƒä¼šåˆ—å‡ºè¯¥æ–‡ä»¶è¿è¡Œæ‰€éœ€çš„åº“ï¼ŒåŒ…æ‹¬è§£é‡Šå™¨ã€‚</li>
<li><code>strace ./executable uncompiledFile</code>: will â€œtraceâ€ out all of the system calls from when the process is first created to when its terminatedå®ƒä¼šè¿½è¸ªè¯¥è¿›ç¨‹ä»åˆ›å»ºåˆ°ç»ˆæ­¢æœŸé—´çš„æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨ã€‚</li>
<li><code>./executable /proc/self/maps</code>: will show the virtual memory storage layout for the executableå®ƒå°†å±•ç¤ºå¯æ‰§è¡Œæ–‡ä»¶çš„è™šæ‹Ÿå†…å­˜å­˜å‚¨å¸ƒå±€ã€‚</li>
<li><code>man 2 open</code>: documentation for all the different system callsæ‰€æœ‰ç³»ç»Ÿè°ƒç”¨çš„æ–‡æ¡£</li>
<li><code>du -sb programFile</code>: will output how many bytes a file is`<code>du -sb programFile</code>Â ` ä¼šè¾“å‡ºæ–‡ä»¶çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</li>
</ul>
<h2 id="sources"><a class="markdownIt-Anchor" href="#sources"></a> Sources:</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://pwn.college/modules/interaction">pwn.college Module 1 Lecturespwn.college ç¬¬ä¸€æ¨¡å—è¯¾ç¨‹</a></li>
<li><a target="_blank" rel="noopener" href="https://dojo.pwn.college/challenges/interaction">pwn.college Module 1 Challengespwn.college ç¬¬ä¸€æ¨¡å—æŒ‘æˆ˜</a></li>
<li><a target="_blank" rel="noopener" href="https://www.twitch.tv/pwncollege">pwn.college Class Twitch Streamsé«˜æ ¡é»‘å®¢å­¦é™¢ Twitch ç›´æ’­è¯¾ç¨‹</a></li>
</ul>
<h1 id="challenges"><a class="markdownIt-Anchor" href="#challenges"></a> Challenges</h1>
<h2 id="program-interaction"><a class="markdownIt-Anchor" href="#program-interaction"></a> Program Interaction</h2>
<p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ¶‰åŠåˆ°åŸºæœ¬çš„ç¨‹åºäº¤äº’æ–¹æ³•ï¼ŒåŒ…æ‹¬linuxç¯å¢ƒä¸‹è¿è¡Œç¨‹åºä¸€äº›åŸºæœ¬æ–¹æ³•å’ŒçŸ¥è¯†ï¼Œé™¤æ­¤ä»¥å¤–ä¹Ÿæ•™äº†ä¸€äº›åŸºæœ¬çš„shellè„šæœ¬ã€pythonè„šæœ¬ã€cè¯­è¨€ç­‰çŸ¥è¯†</p>
<p>embryoio  èƒšèƒéš¾åº¦  <s>çœŸçš„æ˜¯è¿™æ ·å—</s></p>
<h3 id="level1"><a class="markdownIt-Anchor" href="#level1"></a> level1</h3>
<p>æ— å¯†ç ç›´æ¥è¿è¡Œ</p>
<h3 id="level2"><a class="markdownIt-Anchor" href="#level2"></a> level2</h3>
<p>æœ‰å¯†ç ï¼Œæç¤ºä¸Šå†™äº†</p>
<h3 id="level3"><a class="markdownIt-Anchor" href="#level3"></a> level3</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./embryoio_level3 suvobmbtle<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>env</code> å‘½ä»¤ä¸»è¦ç”¨äºæ˜¾ç¤ºæˆ–è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå…¶å¸¸è§çš„æŒ‡ä»¤åŒ…æ‹¬ï¼š</p>
<ol>
<li>
<p><strong>æ˜¾ç¤ºå½“å‰ç¯å¢ƒå˜é‡</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">env<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>è®¾ç½®ç¯å¢ƒå˜é‡å¹¶è¿è¡Œå‘½ä»¤</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">env VARIABLE_NAME&#x3D;value your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ¸…é™¤æ‰€æœ‰ç¯å¢ƒå˜é‡å¹¶è¿è¡Œå‘½ä»¤</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">env -i your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>æ˜¾ç¤ºç‰¹å®šç¯å¢ƒå˜é‡çš„å€¼</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">env VARIABLE_NAME<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä»¥é€—å·åˆ†éš”æ˜¾ç¤ºå¤šä¸ªç¯å¢ƒå˜é‡çš„å€¼</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">env VARIABLE1,VARIABLE2 your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>é€šè¿‡<code>-u</code>é€‰é¡¹åˆ é™¤ç‰¹å®šçš„ç¯å¢ƒå˜é‡</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">env -u VARIABLE_NAME your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨<code>-i</code>é€‰é¡¹å¯åŠ¨ä¸€ä¸ªä¸åŒ…å«ä»»ä½•ç¯å¢ƒå˜é‡çš„ç¯å¢ƒ</strong>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">env -i your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h3 id="level4"><a class="markdownIt-Anchor" href="#level4"></a> level4</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">env</span> <span class="token parameter variable">-i</span> <span class="token assign-left variable">gizpoq</span><span class="token operator">=</span>tkikjioeyj ./embryoio_level4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level7"><a class="markdownIt-Anchor" href="#level7"></a> level7</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">env</span> <span class="token parameter variable">-i</span> ./embryoio_level7<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level5"><a class="markdownIt-Anchor" href="#level5"></a> level5</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-interaction~level5:/challenge$ <span class="token builtin class-name">echo</span> <span class="token string">"hxhxyvux"</span> <span class="token operator">></span> /tmp/cwxhwa
hacker@program-interaction~level5:/challenge$ ./embryoio_level5 <span class="token operator">&lt;</span> /tmp/cwxhwa
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level6"><a class="markdownIt-Anchor" href="#level6"></a> level6</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-interaction~level6:/challenge$ ./embryoio_level6 <span class="token operator">></span> /tmp/tzdetd
hacker@program-interaction~level6:/challenge$ <span class="token function">cat</span> /tmp/tzdetd <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level8"><a class="markdownIt-Anchor" href="#level8"></a> level8</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"/challenge/embryoio_level8"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level9"><a class="markdownIt-Anchor" href="#level9"></a> level9</h3>
<p>åŒä¸Šï¼ŒåŠ ä¸ªå¯†ç ä¼ å‚</p>
<h3 id="level10"><a class="markdownIt-Anchor" href="#level10"></a> level10</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"./embryoio_level10 xolzrhbfsw"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> my_script.sh
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level11"><a class="markdownIt-Anchor" href="#level11"></a> level11</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"env -i huawoi=hzrutrkycu ./embryoio_level11"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level12"><a class="markdownIt-Anchor" href="#level12"></a> level12</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-interaction~level12:/challenge$ <span class="token builtin class-name">echo</span> <span class="token string">"bczijbap"</span> <span class="token operator">></span> /tmp/kzgaox
hacker@program-interaction~level12:/challenge$ <span class="token builtin class-name">echo</span> <span class="token string">"./embryoio_level12 &lt; /tmp/kzgaox"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level13"><a class="markdownIt-Anchor" href="#level13"></a> level13</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"./embryoio_level13 > /tmp/xtnsry"</span> <span class="token operator">></span>/tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span><span class="token function">cat</span> /tmp/xtnsry
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level14"><a class="markdownIt-Anchor" href="#level14"></a> level14</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"env -i  ./embryoio_level14"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level15"><a class="markdownIt-Anchor" href="#level15"></a> level15</h3>
<p>Pythonä¸­è¿è¡Œç¨‹åºæ—¶ï¼Œæœ‰å‡ ç§å¸¸è§çš„æ–¹æ³•</p>
<ol>
<li>
<p><strong>ä½¿ç”¨subprocessæ¨¡å—</strong>ï¼šé€šè¿‡subprocessæ¨¡å—å¯ä»¥åœ¨Pythonä¸­æ‰§è¡Œå¤–éƒ¨å‘½ä»¤å’Œç¨‹åºã€‚å¯ä»¥ä½¿ç”¨<code>subprocess.run()</code>å‡½æ•°æ¥æ‰§è¡Œç¨‹åºï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>subprocess.Popen()</code>æ¥è·å¾—æ›´å¤šæ§åˆ¶å’Œçµæ´»æ€§ã€‚</p>
<p>è¦åœ¨Pythonä¸­æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>subprocess</code>æ¨¡å—ä¸­çš„<code>run</code>å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å…è®¸ä½ è¿è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¹¶ç­‰å¾…å®ƒå®Œæˆã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨Pythonæ¥æ‰§è¡Œä¸€ä¸ªåä¸º<code>script.py</code>çš„Pythonè„šæœ¬æ–‡ä»¶ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># æŒ‡å®šè¦æ‰§è¡Œçš„æ–‡ä»¶å</span>
filename <span class="token operator">=</span> <span class="token string">"script.py"</span>

<span class="token comment"># æ‰§è¡Œæ–‡ä»¶</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"python"</span><span class="token punctuation">,</span> filename<span class="token punctuation">]</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> subprocess<span class="token punctuation">.</span>CalledProcessError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œæ–‡ä»¶æ—¶å‡ºé”™:"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™å°†è¿è¡Œåä¸º<code>script.py</code>çš„Pythonè„šæœ¬ã€‚å¦‚æœå¸Œæœ›ä¼ é€’å‚æ•°ç»™è„šæœ¬ï¼Œå¯ä»¥åœ¨<code>subprocess.run</code>ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­æ·»åŠ é¢å¤–çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦ä¼ é€’ä¸€ä¸ªåä¸º<code>arg1</code>çš„å‚æ•°ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"python"</span><span class="token punctuation">,</span> filename<span class="token punctuation">,</span> <span class="token string">"arg1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿™ä¼šå°†<code>arg1</code>ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>script.py</code>è„šæœ¬ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨execè¯­å¥</strong>ï¼šä½¿ç”¨<code>exec</code>è¯­å¥å¯ä»¥åœ¨å½“å‰Pythonè¿›ç¨‹ä¸­æ‰§è¡Œå¦ä¸€ä¸ªPythonæ–‡ä»¶ã€‚ä½†æ˜¯è¦æ³¨æ„ï¼Œå®ƒä¼šæ”¹å˜å½“å‰è¿›ç¨‹çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬å˜é‡ã€å‡½æ•°ç­‰ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨importè¯­å¥</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨<code>import</code>è¯­å¥æ¥å¯¼å…¥ä¸€ä¸ªPythonæ–‡ä»¶ä½œä¸ºæ¨¡å—ï¼Œç„¶åè°ƒç”¨å®ƒçš„å‡½æ•°æˆ–è€…æ‰§è¡Œå…¶ä¸­çš„ä»£ç ã€‚è¿™ç§æ–¹æ³•æ›´å®‰å…¨ï¼Œå› ä¸ºå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‘½åç©ºé—´ï¼Œä¸ä¼šç›´æ¥ä¿®æ”¹å½“å‰è¿›ç¨‹çš„çŠ¶æ€ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨os.system()å‡½æ•°</strong>ï¼šosæ¨¡å—æä¾›äº†ä¸€ä¸ª<code>system()</code>å‡½æ•°ï¼Œå®ƒå¯ä»¥åœ¨æ“ä½œç³»ç»Ÿçº§åˆ«æ‰§è¡Œå‘½ä»¤ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¸å¤Ÿçµæ´»ï¼Œå¹¶ä¸”å®¹æ˜“å—åˆ°æ“ä½œç³»ç»Ÿé™åˆ¶ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨eval()å‡½æ•°</strong>ï¼šè™½ç„¶ä¸æ¨èï¼Œä½†ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>eval()</code>å‡½æ•°æ¥æ‰§è¡ŒPythonä»£ç å­—ç¬¦ä¸²ã€‚è¿™ç§æ–¹æ³•æ½œåœ¨çš„å®‰å…¨é£é™©å¾ˆé«˜ï¼Œåº”è¯¥å°½é‡é¿å…ä½¿ç”¨ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨execfile()å‡½æ•°</strong>ï¼šåœ¨Python 2ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>execfile()</code>å‡½æ•°æ‰§è¡Œä¸€ä¸ªPythonæ–‡ä»¶ã€‚ä½†æ˜¯åœ¨Python 3ä¸­å·²ç»ç§»é™¤äº†è¿™ä¸ªå‡½æ•°ã€‚</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token function">import</span> os

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: os.system<span class="token punctuation">(</span><span class="token string">"./embryoio_level15"</span><span class="token punctuation">)</span>
WELCOME<span class="token operator">!</span> This challenge makes the following asks of you:
- the challenge checks <span class="token keyword">for</span> a specific parent process <span class="token builtin class-name">:</span> ipython

ONWARDS TO GREATNESS<span class="token operator">!</span>

<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> This challenge will now perform a bunch of checks.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> If you pass these checks, you will receive the flag.
<span class="token punctuation">[</span>TEST<span class="token punctuation">]</span> Performing checks on the parent process of this process.
<span class="token punctuation">[</span>TEST<span class="token punctuation">]</span> We will now check that that the process is an interactive ipython instance.

<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> Since ipython runs as a script inside python, this will check a few things:
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> <span class="token number">1</span>. That the process itself is python.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> <span class="token number">2</span>. That the module being run <span class="token keyword">in</span> python is ipython.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> If the process being checked is just a normal <span class="token string">'ipython'</span>, you<span class="token string">'ll be okay!

[INFO] The process'</span> executable is /usr/bin/dash.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> This might be different than expected because of symbolic links <span class="token punctuation">(</span>for example, from /usr/bin/python to /usr/bin/python3 to /usr/bin/python3.8<span class="token punctuation">)</span>.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> To pass the checks, the executable must be python3.8.
<span class="token punctuation">[</span>FAIL<span class="token punctuation">]</span> You did not satisfy all the execution requirements.
<span class="token punctuation">[</span>FAIL<span class="token punctuation">]</span> Specifically, you must fix the following issue:
<span class="token punctuation">[</span>FAIL<span class="token punctuation">]</span>    Executable must be <span class="token string">'python'</span><span class="token builtin class-name">.</span> Yours is: dash
Out<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: <span class="token number">512</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å°è¯•<code>os</code>ä¸è¡Œï¼Œå› ä¸º<code>os</code>æ¨¡å—è¿˜æ˜¯è°ƒç”¨çš„<code>dash</code>æ¥æ‰§è¡Œçš„</p>
<p>å‘ç°ç”¨<code>subprocess</code>å¯ä»¥</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./embryoio_level15"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level16"><a class="markdownIt-Anchor" href="#level16"></a> level16</h3>
<p>åŒä¸Šï¼Œè¿è¡Œåå†è¾“å…¥å¯†ç å³å¯</p>
<h3 id="level17"><a class="markdownIt-Anchor" href="#level17"></a> level17</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./embryoio_level17"</span><span class="token punctuation">,</span><span class="token string">"jduimogzro"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level18"><a class="markdownIt-Anchor" href="#level18"></a> level18</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> subprocess

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"env"</span><span class="token punctuation">,</span><span class="token string">"-i"</span><span class="token punctuation">,</span><span class="token string">"uaznno=hqbclqnobf"</span><span class="token punctuation">,</span><span class="token string">"./embryoio_level18"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="level19"><a class="markdownIt-Anchor" href="#level19"></a> level19</h3>
<p>è¿™é‡Œéœ€è¦è¯¦ç»†äº†è§£ä¸€ä¸‹ï¼Œå¦‚ä½•ç”¨<code>subprocess.run</code>è¿›è¡Œé‡å®šå‘</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/python3-subprocess.html">Python3 subprocess | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> cwd<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> env<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> universal_newlines<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>argsï¼šè¡¨ç¤ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¿…é¡»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å‚æ•°åˆ—è¡¨ã€‚</li>
<li>stdinã€stdout å’Œ stderrï¼šå­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯ã€‚å…¶å€¼å¯ä»¥æ˜¯ subprocess.PIPEã€subprocess.DEVNULLã€ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶æè¿°ç¬¦ã€å·²ç»æ‰“å¼€çš„æ–‡ä»¶å¯¹è±¡æˆ–è€… Noneã€‚subprocess.PIPE è¡¨ç¤ºä¸ºå­è¿›ç¨‹åˆ›å»ºæ–°çš„ç®¡é“ã€‚subprocess.DEVNULL è¡¨ç¤ºä½¿ç”¨ os.devnullã€‚é»˜è®¤ä½¿ç”¨çš„æ˜¯ Noneï¼Œè¡¨ç¤ºä»€ä¹ˆéƒ½ä¸åšã€‚å¦å¤–ï¼Œstderr å¯ä»¥åˆå¹¶åˆ° stdout é‡Œä¸€èµ·è¾“å‡ºã€‚</li>
<li>timeoutï¼šè®¾ç½®å‘½ä»¤è¶…æ—¶æ—¶é—´ã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œæ—¶é—´è¶…æ—¶ï¼Œå­è¿›ç¨‹å°†è¢«æ€æ­»ï¼Œå¹¶å¼¹å‡º TimeoutExpired å¼‚å¸¸ã€‚</li>
<li>checkï¼šå¦‚æœè¯¥å‚æ•°è®¾ç½®ä¸º Trueï¼Œå¹¶ä¸”è¿›ç¨‹é€€å‡ºçŠ¶æ€ç ä¸æ˜¯ 0ï¼Œåˆ™å¼¹ å‡º CalledProcessError å¼‚å¸¸ã€‚</li>
<li>encoding: å¦‚æœæŒ‡å®šäº†è¯¥å‚æ•°ï¼Œåˆ™ stdinã€stdout å’Œ stderr å¯ä»¥æ¥æ”¶å­—ç¬¦ä¸²æ•°æ®ï¼Œå¹¶ä»¥è¯¥ç¼–ç æ–¹å¼ç¼–ç ã€‚å¦åˆ™åªæ¥æ”¶ bytes ç±»å‹çš„æ•°æ®ã€‚</li>
<li>shellï¼šå¦‚æœè¯¥å‚æ•°ä¸º Trueï¼Œå°†é€šè¿‡æ“ä½œç³»ç»Ÿçš„ shell æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ã€‚</li>
<li>input:ç¨‹åºè¿è¡Œåçš„äº¤äº’è¾“å…¥  æ³¨æ„ä¸stdinåŒºåˆ†</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># å®šä¹‰å‘½ä»¤åŠå…¶å‚æ•°</span>
command <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level19"</span><span class="token punctuation">]</span>

<span class="token comment"># æ‰“å¼€è¾“å…¥æ–‡ä»¶å¹¶è¯»å–æ•°æ®</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/tmp/xhekoe"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    input_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># ä½¿ç”¨subprocess.run()æ‰§è¡Œå‘½ä»¤å¹¶é‡å®šå‘è¾“å…¥</span>
result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token operator">=</span>input_data<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>

<span class="token comment"># æ‰“å°è¾“å‡ºç»“æœ</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"stdout:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"stderr:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>stderr<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶è€Œæç¤º</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>ADVICE<span class="token punctuation">]</span> File descriptors are inherited from the parent, unless the FD_CLOEXEC is <span class="token builtin class-name">set</span> by the parent on the <span class="token function">file</span> descriptor.
<span class="token punctuation">[</span>ADVICE<span class="token punctuation">]</span> For security reasons, some programs, such as python, <span class="token keyword">do</span> this by default <span class="token keyword">in</span> certain cases. Be careful <span class="token keyword">if</span> you are
<span class="token punctuation">[</span>ADVICE<span class="token punctuation">]</span> creating and trying to pass <span class="token keyword">in</span> FDs <span class="token keyword">in</span> python.
<span class="token punctuation">[</span>FAIL<span class="token punctuation">]</span> You did not satisfy all the execution requirements.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># å®šä¹‰å‘½ä»¤åŠå…¶å‚æ•°</span>
command <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level19"</span><span class="token punctuation">]</span>

<span class="token comment"># æ‰“å¼€è¾“å…¥æ–‡ä»¶å¹¶è¯»å–æ•°æ®</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/tmp/xhekoe"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>

<span class="token comment"># ä½¿ç”¨subprocess.run()æ‰§è¡Œå‘½ä»¤å¹¶é‡å®šå‘è¾“å…¥</span>
    result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>command<span class="token punctuation">,</span> stdin<span class="token operator">=</span>f<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>

<span class="token comment"># æ‰“å°è¾“å‡ºç»“æœ</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"stdout:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"stderr:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>äº‹å®ä¸Šå¿…é¡»è¦ç”¨<code>stdin</code>ä¼ å…¥,ä¸¤è€…æ˜¯æœ‰åŒºåˆ«çš„:</p>
<p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œæ ‡å‡†è¾“å…¥æµï¼ˆstdinï¼‰æ˜¯æŒ‡å‘ç»ˆç«¯ï¼ˆé€šå¸¸æ˜¯é”®ç›˜ï¼‰çš„æ–‡ä»¶æè¿°ç¬¦ã€‚å½“ä½ åœ¨ç»ˆç«¯ä¸Šé”®å…¥æ•°æ®æ—¶ï¼Œè¿™äº›æ•°æ®è¢«å‘é€åˆ°æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„æ ‡å‡†è¾“å…¥æµä¸­ã€‚</p>
<p><code>FD_CLOEXEC</code> æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œé€šå¸¸åœ¨æ“ä½œç³»ç»Ÿä¸­ç”¨äºæ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰ã€‚å®ƒæ˜¯æ–‡ä»¶æè¿°ç¬¦æ ‡å¿—ä¹‹ä¸€ï¼Œç”¨äºæŒ‡ç¤ºå½“æ‰§è¡Œ <code>exec</code> ç³»åˆ—å‡½æ•°æ—¶ï¼Œæ–‡ä»¶æè¿°ç¬¦æ˜¯å¦åº”è¯¥å…³é—­ã€‚</p>
<ol>
<li><strong>input å‚æ•°</strong>ï¼š
<ul>
<li><code>input</code> å‚æ•°æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸²ï¼ˆbytesï¼‰æˆ–è€… Noneã€‚</li>
<li>å¦‚æœæŒ‡å®šäº† <code>input</code> å‚æ•°ä¸”ä¸ä¸º Noneï¼Œé‚£ä¹ˆå®ƒä¼šä½œä¸ºå­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ã€‚</li>
<li>å¦‚æœ <code>input</code> å‚æ•°ä¸º Noneï¼ˆé»˜è®¤æƒ…å†µï¼‰ï¼Œåˆ™å­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ä¸ºç©ºã€‚</li>
<li>å½“ä½ æœ‰ä¸€ä¸ªå­—èŠ‚ä¸²æ•°æ®éœ€è¦ä¼ é€’ç»™å­è¿›ç¨‹ä½œä¸ºæ ‡å‡†è¾“å…¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>input</code> å‚æ•°ã€‚</li>
</ul>
</li>
<li><strong>stdin å‚æ•°</strong>ï¼š
<ul>
<li><code>stdin</code> å‚æ•°æ˜¯ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡æˆ–è€…ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚</li>
<li>å¦‚æœæŒ‡å®šäº† <code>stdin</code> å‚æ•°ï¼Œé‚£ä¹ˆå®ƒä¼šä½œä¸ºå­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ã€‚</li>
<li>å¦‚æœ <code>stdin</code> å‚æ•°ä¸º Noneï¼ˆé»˜è®¤æƒ…å†µï¼‰ï¼Œåˆ™å­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥å°†ä¼šä» <code>/dev/null</code> ä¸­è¯»å–ç©ºæ•°æ®ã€‚</li>
<li>å½“ä½ å·²ç»æœ‰ä¸€ä¸ªå·²ç»æ‰“å¼€çš„æ–‡ä»¶å¯¹è±¡æˆ–è€…æ–‡ä»¶æè¿°ç¬¦ï¼Œæƒ³è¦å°†å…¶ä¼ é€’ç»™å­è¿›ç¨‹ä½œä¸ºæ ‡å‡†è¾“å…¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>stdin</code> å‚æ•°</li>
</ul>
</li>
</ol>
<p>æ ¹æ®æç¤ºï¼Œ<code>input</code>ä¸ä¼šä¼ é€’<code>FD_CLOEXEC</code>è€Œ<code>stdin</code>åˆ™ä¼šä¼ é€’<code>FD_CLOEXEC</code></p>
<p>å½“ç„¶æˆ‘ä»¬è¿™é¢˜åŒ…å«åº“æ–‡ä»¶å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œäº‹å®ä¸Šé¢˜ç›®å¯èƒ½æ˜¯è¦è¦æ±‚æˆ‘ä»¬æ‰‹æ“,<s>æˆ‘ä»¬ç”¨è½®å­ç»•è¿‡äº†è¿™ä¸€ä¸ªè¿‡ç¨‹</s></p>
<p>æ‰‹æ“ä¸€ä¸ªè¯•è¯•</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">run_program_with_input</span><span class="token punctuation">(</span>program_path<span class="token punctuation">,</span> input_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># æ‰“å¼€è¾“å…¥æ–‡ä»¶</span>
    input_fd <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> os<span class="token punctuation">.</span>O_RDONLY<span class="token punctuation">)</span>
    
    <span class="token comment"># åˆ›å»ºå­è¿›ç¨‹</span>
    pid <span class="token operator">=</span> os<span class="token punctuation">.</span>fork<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> pid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># å­è¿›ç¨‹</span>
        <span class="token comment"># é‡å®šå‘å­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥åˆ°è¾“å…¥æ–‡ä»¶</span>
        os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>input_fd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ‰§è¡Œå¤–éƒ¨ç¨‹åº</span>
        os<span class="token punctuation">.</span>execl<span class="token punctuation">(</span>program_path<span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>program_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># çˆ¶è¿›ç¨‹</span>
        <span class="token comment"># ç­‰å¾…å­è¿›ç¨‹ç»“æŸ</span>
        os<span class="token punctuation">.</span>waitpid<span class="token punctuation">(</span>pid<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        
        <span class="token comment"># å…³é—­æ–‡ä»¶æè¿°ç¬¦</span>
        os<span class="token punctuation">.</span>close<span class="token punctuation">(</span>input_fd<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    program_path <span class="token operator">=</span> <span class="token string">"./your_program"</span>
    input_file <span class="token operator">=</span> <span class="token string">"./input.txt"</span>
    run_program_with_input<span class="token punctuation">(</span>program_path<span class="token punctuation">,</span> input_file<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level20"><a class="markdownIt-Anchor" href="#level20"></a> level20</h3>
<p>æœ‰äº†ä¸Šé¢˜çš„ç»éªŒ</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># æ‰“å¼€å¹¶è¯»å–æ–‡ä»¶å†…å®¹</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/tmp/rfqbmu'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
<span class="token comment"># å°†æ–‡ä»¶å†…å®¹ä½œä¸ºè¾“å…¥ä¼ é€’ç»™å­è¿›ç¨‹</span>
    result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level20'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>f<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶åç›´æ¥catå°±å¯ä»¥äº†</p>
<h3 id="level21"><a class="markdownIt-Anchor" href="#level21"></a> level21</h3>
<p><code>subprocess.run(['env','-i','/challenge/embryoio_level21'])</code></p>
<h3 id="level22"><a class="markdownIt-Anchor" href="#level22"></a> level22</h3>
<p>mdï¼Œåˆæ¥ä¸€è½®ï¼ŒæŠŠä¸Šé¢çš„è„šæœ¬<code>ipython</code>è¿è¡Œæ”¹ä¸º<code>python</code>è¿è¡Œï¼ŒçœŸæ˜¯æœäº†</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">subprocess.run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'env'</span>,<span class="token string">'-i'</span>,<span class="token string">'/challenge/embryoio_level22'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level23"><a class="markdownIt-Anchor" href="#level23"></a> level23</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">subprocess.run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./embryoio_level23'</span><span class="token punctuation">]</span>,input<span class="token operator">=</span>b<span class="token string">"eyejkdde"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level24"><a class="markdownIt-Anchor" href="#level24"></a> level24</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">subprocess.run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level24'</span>,<span class="token string">"yogjcbumez"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level25"><a class="markdownIt-Anchor" href="#level25"></a> level25</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level25'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>env<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"qpvtwc"</span><span class="token punctuation">:</span><span class="token string">"eghdabuygy"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level26"><a class="markdownIt-Anchor" href="#level26"></a> level26</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/tmp/sjfilu"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>f<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level27"><a class="markdownIt-Anchor" href="#level27"></a> level27</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/tmp/zjvuap"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level27'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>f<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level28"><a class="markdownIt-Anchor" href="#level28"></a> level28</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level28'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>env<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level29"><a class="markdownIt-Anchor" href="#level29"></a> level29</h3>
<p>ç°åœ¨åˆ°Cè¯­è¨€ç¼–ç¨‹çš„ç¯‡ç« äº†</p>
<p>è¿™éƒ¨åˆ†å¯¹linuxç³»ç»Ÿè¿›ç¨‹çš„åˆ›å»ºè°ƒç”¨éœ€è¦ç†è§£æ¸…é™¤</p>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/difference-fork-exec/#">Difference between fork() and exec() - GeeksforGeeks</a></p>
<p>å¬ä¸€éè¯¾æ„Ÿè§‰è¿˜æ˜¯æ”¶è·å¾ˆå¤§</p>
<p>é¢˜ç›®è¦æ±‚<code>fork</code>å¼€å­è¿›ç¨‹ç„¶åè°ƒç”¨æ–‡ä»¶</p>
<ul>
<li>åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œ<code>pid</code> çš„å€¼æ˜¯æ–°åˆ›å»ºçš„å­è¿›ç¨‹çš„è¿›ç¨‹ IDã€‚è¿™ä¸ªå€¼ä¼šå¤§äº 0ã€‚</li>
<li>åœ¨å­è¿›ç¨‹ä¸­ï¼Œ<code>pid</code> çš„å€¼æ˜¯ 0ï¼Œç”¨æ¥è¡¨ç¤ºå½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç æ˜¯å­è¿›ç¨‹éƒ¨åˆ†ã€‚</li>
<li>å¯¹çˆ¶è¿›ç¨‹çš„æ£€æµ‹éœ€è¦ä½¿ç”¨exec()ç³»åˆ—çš„å‡½æ•°ï¼Œå› ä¸ºsystem()æˆ–popen()å‡½æ•°éƒ½ä¼šæ‰§è¡Œä¸€ä¸ªshellï¼Œç„¶åç”¨shellæ¥æ‰§è¡Œï¼Œæ‰€ä»¥æ­¤æ—¶çˆ¶è¿›ç¨‹ä¸ºshellï¼ˆæµ‹è¯•åæ˜¯dashï¼‰ï¼Œè€Œä¸æ˜¯ä½ çš„ç¨‹åºã€‚</li>
<li>è€Œexec()åªæ˜¯æ›¿æ¢æ‰æ­£åœ¨exec()çš„è¿›ç¨‹ï¼Œå½“ç”¨fork()å‡½æ•°æ—¶å­è¿›ç¨‹è°ƒç”¨exec()ç³»åˆ—å‡½æ•°æ€æ­»è‡ªå·±çš„å­è¿›ç¨‹å‰¯æœ¬çš„æ—¶å€™å°±ä¼šå»ºç«‹ä¸å½“å‰ä¸»è¿›ç¨‹çš„çˆ¶å­å…³ç³»ã€‚</li>
<li>å½“ä¸€ä¸ªçˆ¶äº²åˆ›å»ºäº†ä¸€ä¸ªå­©å­ä½†æ²¡æœ‰ç­‰å®ƒç»“æŸå°±è‡ªå·±ç»“æŸçš„è¯å°±å¯èƒ½é€ æˆç³»ç»Ÿå¼‚å¸¸ï¼ŒæŸ¥è¯¢waitpid()çš„ä½¿ç”¨æ¥ç­‰å¾…å­©å­è¿›ç¨‹ã€‚</li>
</ul>
<p>å¦å¤–æŸ¥è¯¢äº†ä¸€ä¸‹ï¼Œè¯´æ˜¯execç³»ç»Ÿè°ƒç”¨ï¼Œå®é™…ä¸Šåœ¨Linuxä¸­ï¼Œå¹¶ä¸å­˜åœ¨ä¸€ä¸ªexec()çš„å‡½æ•°å½¢å¼ï¼ŒexecæŒ‡çš„æ˜¯ä¸€ç»„å‡½æ•°ï¼Œä¸€å…±æœ‰6ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">#include &lt;unistd.h&gt;
int execl(const char *path, const char *arg, ...);
int execlp(const char *file, const char *arg, ...);
int execle(const char *path, const char *arg, ..., char *const envp[]);
int execv(const char *path, char *const argv[]);
int execvp(const char *file, char *const argv[]);
int execve(const char *path, char *const argv[], char *const envp[]);
const char *filenameï¼šè¡¨ç¤ºè¦æ‰§è¡Œçš„ç¨‹åºçš„æ–‡ä»¶è·¯å¾„ã€‚è¿™ä¸ªå‚æ•°æŒ‡å®šäº†è¦æ‰§è¡Œçš„ç¨‹åºçš„è·¯å¾„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œåº”è¯¥æä¾›ç¨‹åºçš„ç»å¯¹è·¯å¾„ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿå¯ä»¥æ‰¾åˆ°å¹¶æ­£ç¡®æ‰§è¡Œç¨‹åºã€‚å¦‚æœç¨‹åºåœ¨ PATH ç¯å¢ƒå˜é‡ä¸­ï¼Œåˆ™å¯ä»¥ç›´æ¥æä¾›ç¨‹åºçš„åç§°ã€‚

char *const argv[]ï¼šè¡¨ç¤ºç¨‹åºçš„å‘½ä»¤è¡Œå‚æ•°åˆ—è¡¨ã€‚è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ã€‚æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ é€šå¸¸æ˜¯ç¨‹åºçš„åç§°ï¼Œåç»­å…ƒç´ æ˜¯ä¼ é€’ç»™ç¨‹åºçš„å‘½ä»¤è¡Œå‚æ•°ã€‚æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯ NULLï¼Œä»¥è¡¨ç¤ºå‚æ•°åˆ—è¡¨çš„ç»“æŸã€‚

char *const envp[]ï¼šè¡¨ç¤ºç¨‹åºçš„ç¯å¢ƒå˜é‡åˆ—è¡¨ã€‚è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡è®¾ç½®ï¼Œæ ¼å¼ä¸º &quot;name&#x3D;value&quot;ã€‚æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹Ÿå¿…é¡»æ˜¯ NULLï¼Œä»¥è¡¨ç¤ºç¯å¢ƒå˜é‡åˆ—è¡¨çš„ç»“æŸã€‚

ä¸‹é¢æ˜¯è¿™äº›å‚æ•°çš„è¯¦ç»†è¯´æ˜ï¼š

filenameï¼šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šäº†è¦æ‰§è¡Œçš„ç¨‹åºçš„è·¯å¾„ã€‚å¦‚æœè·¯å¾„æŒ‡å‘ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåˆ™ execve() å°†åŠ è½½å¹¶æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚æ³¨æ„ï¼Œexecve() ä¸ä¼šæŸ¥æ‰¾ PATH ç¯å¢ƒå˜é‡ä¸­æŒ‡å®šçš„è·¯å¾„ï¼Œå› æ­¤å¿…é¡»æä¾›ç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„ã€‚

argv[]ï¼šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œç”¨äºä¼ é€’å‘½ä»¤è¡Œå‚æ•°ç»™æ–°ç¨‹åºã€‚æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ é€šå¸¸æ˜¯ç¨‹åºçš„åç§°ï¼Œåç»­å…ƒç´ æ˜¯ç¨‹åºçš„å‘½ä»¤è¡Œå‚æ•°ã€‚æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯ NULLï¼Œä»¥è¡¨ç¤ºå‚æ•°åˆ—è¡¨çš„ç»“æŸã€‚

envp[]ï¼šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œç”¨äºä¼ é€’ç¯å¢ƒå˜é‡ç»™æ–°ç¨‹åºã€‚æ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡è®¾ç½®ï¼Œæ ¼å¼ä¸º &quot;name&#x3D;value&quot;ã€‚æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯ NULLï¼Œä»¥è¡¨ç¤ºç¯å¢ƒå˜é‡åˆ—è¡¨çš„ç»“æŸã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
â€‹
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level29"</span><span class="token punctuation">,</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä½¿ç”¨execç³»åˆ—å‡½æ•°æ‰§è¡Œæ—¶ä¸ä¼šæ”¹å˜æ–°è¿›ç¨‹çš„çˆ¶äº²ï¼Œç›¸å½“äºåªæ˜¯å°†å½“å‰è¿›>ç¨‹æ›¿æ¢æ‰äº†</span>
    <span class="token keyword">return</span> <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
â€‹
    <span class="token comment">//char *argv[]æ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼ŒæŒ‡å‘ä¼ å…¥çš„å‚æ•°ï¼Œæ¯ä¸ªæŒ‡é’ˆéƒ½æŒ‡å‘ä¸€ä¸ªå­—ç¬¦ä¸²</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
â€‹
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//fork()æ‰§è¡Œä¹‹åï¼Œä¼šå¤åˆ¶ä¸€ä¸ªåŸºæœ¬ä¸€æ ·çš„è¿›ç¨‹ä½œä¸ºå­è¿›ç¨‹ï¼Œç„¶åä¸¤ä¸ªè¿›ç¨‹ä¼šåˆ†åˆ«æ‰§è¡Œåé¢çš„ä»£ç </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//å¦‚æœfpidä¸º-1ï¼Œè¯´æ˜forkå¤±è´¥</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error in fork!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//æˆåŠŸåˆ™ä¼šå‡ºç°ä¸¤ä¸ªè¿›ç¨‹ï¼Œfpid==0çš„æ˜¯å­è¿›ç¨‹</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æˆ‘æ˜¯å­è¿›ç¨‹\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//fpid==1çš„æ˜¯çˆ¶è¿›ç¨‹</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"æˆ‘æ˜¯çˆ¶è¿›ç¨‹\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç­‰å¾…å­è¿›ç¨‹ç»“æŸ</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¼„æ‡‚äº†åŸºæœ¬åŸç†å</p>
<p>å†™å‡ºä¸€ä¸ªç®€å•çš„è¿è¡Œç¨‹åº</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level29"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level29"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level30"><a class="markdownIt-Anchor" href="#level30"></a> level30</h3>
<p>åŒä¸Šå¤šä¸ªå¯†ç ä¼ å‚</p>
<h3 id="level31"><a class="markdownIt-Anchor" href="#level31"></a> level31</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level31"</span><span class="token punctuation">,</span><span class="token string">"aomapmyibu"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level31"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level32"><a class="markdownIt-Anchor" href="#level32"></a> level32</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level32"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newenv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"rnzara=mtqxpnweqm"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level32"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>newenv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level33"><a class="markdownIt-Anchor" href="#level33"></a> level33</h3>
<p>è¾“å…¥æµé‡å®šå‘</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level33"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newenv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level33"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>newenv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        FILE <span class="token operator">*</span>fp<span class="token operator">=</span><span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"/tmp/aoztam"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level34"><a class="markdownIt-Anchor" href="#level34"></a> level34</h3>
<p>è¾“å‡ºæµé‡å®šå‘</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level34"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newenv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level34"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>newenv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        FILE <span class="token operator">*</span>fp<span class="token operator">=</span><span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"/tmp/ivyyzs"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">,</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level35"><a class="markdownIt-Anchor" href="#level35"></a> level35</h3>
<p>è®¾ç½®ç©ºç¯å¢ƒå˜é‡ï¼Œä¸é‡å¤è´´äº†</p>
<h3 id="level36"><a class="markdownIt-Anchor" href="#level36"></a> level36</h3>
<pre class="line-numbers language-none"><code class="language-none">- the challenge checks for a specific parent process : bash
- the challenge checks for a specific process at the other end of stdout : cat
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>é‚£ä¹ˆæˆ‘ä»¬ä¹‹é—´bashæ‰§è¡Œï¼Œ å°†stdout è¾“é€åˆ° catå³å¯</p>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level36 | cat<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level37"><a class="markdownIt-Anchor" href="#level37"></a> level37</h3>
<p>è¿™é‡Œæœ‰ä¸ªå‘ï¼Œå› ä¸ºæˆ‘ç”¨çš„vscode ï¼Œé»˜è®¤æ˜¯<code>dash</code></p>
<p>éœ€è¦æ‰‹åŠ¨è¾“å…¥<code>bash</code>åˆ‡æ¢åˆ°<code>bash</code>ç„¶åæ‰èƒ½é€šè¿‡æ£€æŸ¥</p>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level37 | grep &quot;pwn&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level38"><a class="markdownIt-Anchor" href="#level38"></a> level38</h3>
<p>å¤ä¹ ä¸€ä¸‹<code>sed</code></p>
<ol>
<li><strong>æ›¿æ¢æ–‡æœ¬</strong>ï¼š
<ul>
<li><code>s/old/new/</code>ï¼šå°†è¡Œä¸­çš„ç¬¬ä¸€ä¸ªåŒ¹é…çš„ <code>old</code> æ›¿æ¢ä¸º <code>new</code>ã€‚</li>
<li><code>s/old/new/g</code>ï¼šå°†è¡Œä¸­æ‰€æœ‰åŒ¹é…çš„ <code>old</code> æ›¿æ¢ä¸º <code>new</code>ã€‚</li>
<li><code>s/old/new/2</code>ï¼šå°†è¡Œä¸­ç¬¬äºŒä¸ªåŒ¹é…çš„ <code>old</code> æ›¿æ¢ä¸º <code>new</code>ã€‚</li>
</ul>
</li>
<li><strong>åˆ é™¤è¡Œ</strong>ï¼š
<ul>
<li><code>d</code>ï¼šåˆ é™¤åŒ¹é…çš„è¡Œã€‚</li>
<li><code>1d</code>ï¼šåˆ é™¤ç¬¬ä¸€è¡Œã€‚</li>
<li><code>2,5d</code>ï¼šåˆ é™¤ç¬¬äºŒåˆ°ç¬¬äº”è¡Œã€‚</li>
</ul>
</li>
<li><strong>æ’å…¥å’Œè¿½åŠ æ–‡æœ¬</strong>ï¼š
<ul>
<li><code>i\text</code>ï¼šåœ¨åŒ¹é…è¡Œå‰æ’å…¥æ–‡æœ¬ã€‚</li>
<li><code>a\text</code>ï¼šåœ¨åŒ¹é…è¡Œåè¿½åŠ æ–‡æœ¬ã€‚</li>
</ul>
</li>
<li><strong>æ‰“å°æ–‡æœ¬</strong>ï¼š
<ul>
<li><code>p</code>ï¼šæ‰“å°åŒ¹é…çš„è¡Œã€‚</li>
</ul>
</li>
<li><strong>è¡Œçš„é€‰æ‹©</strong>ï¼š
<ul>
<li><code>5p</code>ï¼šæ‰“å°ç¬¬äº”è¡Œã€‚</li>
<li><code>1,5p</code>ï¼šæ‰“å°ç¬¬ä¸€åˆ°ç¬¬äº”è¡Œã€‚</li>
</ul>
</li>
<li><strong>æ‰§è¡Œæ–‡ä»¶ä¸­çš„å‘½ä»¤</strong>ï¼š
<ul>
<li><code>-f scriptfile</code>ï¼šä»æŒ‡å®šæ–‡ä»¶ä¸­è¯»å– <code>sed</code> å‘½ä»¤å¹¶æ‰§è¡Œã€‚</li>
</ul>
</li>
<li><strong>ç¼–è¾‘æ ‡è®°</strong>ï¼š
<ul>
<li><code>b label</code>ï¼šè·³è½¬åˆ°æ ‡è®° <code>label</code>ã€‚</li>
<li><code>t label</code>ï¼šå¦‚æœæœ‰æ›¿æ¢ï¼Œåˆ™è·³è½¬åˆ°æ ‡è®° <code>label</code>ã€‚</li>
</ul>
</li>
<li><strong>è¡Œå·</strong>ï¼š
<ul>
<li><code>=</code>ï¼šæ‰“å°è¡Œå·ã€‚</li>
<li><code>N</code>ï¼šå°†ä¸‹ä¸€è¡Œæ·»åŠ åˆ°æ¨¡å¼ç©ºé—´ã€‚</li>
</ul>
</li>
<li><strong>æ¨¡å¼åŒ¹é…</strong>ï¼š
<ul>
<li><code>^</code>ï¼šåŒ¹é…è¡Œçš„å¼€å¤´ã€‚</li>
<li><code>$</code>ï¼šåŒ¹é…è¡Œçš„ç»“å°¾ã€‚</li>
<li><code>.</code>ï¼šåŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ã€‚</li>
<li><code>*</code>ï¼šåŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå‰é¢çš„å…ƒç´ ã€‚</li>
</ul>
</li>
<li><strong>å…¶ä»–å‘½ä»¤</strong>ï¼š
<ul>
<li><code>q</code>ï¼šé€€å‡º <code>sed</code>ã€‚</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level38 | sed &quot;p&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level39"><a class="markdownIt-Anchor" href="#level39"></a> level39</h3>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level39 | rev |rev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level40"><a class="markdownIt-Anchor" href="#level40"></a> level40</h3>
<pre class="line-numbers language-none"><code class="language-none">cat | .&#x2F;embryoio_level40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level41"><a class="markdownIt-Anchor" href="#level41"></a> level41</h3>
<p>æœ‰ç‚¹sb?</p>
<p>æ²¡æ‡‚ä»€ä¹ˆåŸç†</p>
<p>å¼€å§‹ä½¿ç”¨<code>rev | ./embryoio_level41</code>è¾“å…¥åæ²¡ååº”</p>
<p><a target="_blank" rel="noopener" href="https://discord.com/channels/750635557666816031/1193136623169310731/threads/1214880613790777365">â€¢ Discord | #program-interaction | pwn.college</a></p>
<p>å‘ç°å¾ˆå¤šäººå’Œæˆ‘ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨vscodeé‡Œé¢çš„ç»ˆç«¯æå°±ä¸å¤ªè¡Œ</p>
<p>è¿™é‡Œæœ‰è¯¦ç»†çš„è®¨è®º</p>
<p>åŸå› å¤§æ¦‚æ˜¯å› ä¸º<code>rev</code>ä¸ä¼šå¤„ç†<code>\n</code>,éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è¾“å…¥<code>ctrl+D</code>å‘ç”Ÿ<code>EOF</code>ä¿¡å·</p>
<p>è¿™æ ·å°±è§£å†³äº†</p>
<h3 id="level42"><a class="markdownIt-Anchor" href="#level42"></a> level42</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./embryoio_level42 <span class="token operator">|</span> <span class="token function">cat</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ç„¶å<code>bash 1.sh</code>æ‰§è¡Œè¿™ä¸ªè„šæœ¬,åˆæ˜¯ä¸€éè½®å›</p>
<h3 id="level43"><a class="markdownIt-Anchor" href="#level43"></a> level43</h3>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level43 | grep &quot;pwn&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level44"><a class="markdownIt-Anchor" href="#level44"></a> level44</h3>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level44 | sed &quot;p&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level45"><a class="markdownIt-Anchor" href="#level45"></a> level45</h3>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level45 | rev | rev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level46"><a class="markdownIt-Anchor" href="#level46"></a> level46</h3>
<pre class="line-numbers language-none"><code class="language-none">cat | .&#x2F;embryoio_level46<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level47"><a class="markdownIt-Anchor" href="#level47"></a> level47</h3>
<pre class="line-numbers language-none"><code class="language-none">rev|rev | .&#x2F;embryoio_level47<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è®°å¾—è¾“å…¥<code>ctrl + D</code></p>
<h3 id="level48"><a class="markdownIt-Anchor" href="#level48"></a> level48</h3>
<p>æ ¹æ®æç¤ºï¼Œå¯ä»¥ä½¿ç”¨<code>subprocess</code>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>pwntools</code></p>
<p><code>subprocess</code>åªèƒ½ä½¿ç”¨<code>popen</code>å› ä¸º<code>run</code>çš„åŒºåˆ«åœ¨äº</p>
<p><code>subprocess.Popen</code> å’Œ <code>subprocess.run</code> éƒ½æ˜¯ Python ä¸­ç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤çš„æ¨¡å—ã€‚å®ƒä»¬ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š</p>
<ol>
<li><strong>è¿”å›å€¼</strong>ï¼š
<ul>
<li><code>subprocess.Popen</code> è¿”å›ä¸€ä¸ª Popen å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¡¨ç¤ºæ­£åœ¨è¿è¡Œçš„å­è¿›ç¨‹ã€‚ä½ å¯ä»¥ä½¿ç”¨è¯¥å¯¹è±¡çš„æ–¹æ³•æ¥ä¸å­è¿›ç¨‹è¿›è¡Œäº¤äº’ï¼Œä¾‹å¦‚ç­‰å¾…å…¶å®Œæˆæˆ–å‘é€è¾“å…¥ã€‚</li>
<li><code>subprocess.run</code> è¿”å›ä¸€ä¸ª CompletedProcess å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«æœ‰å…³è¿è¡Œå‘½ä»¤çš„ä¿¡æ¯ï¼Œå¦‚è¿”å›ç ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level48"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¼‚æˆ–??</p>
<p>æˆ‘é˜…è¯»äº†<code>pwntools</code>çš„æ–‡æ¡£ï¼Œæˆ‘è®¤ä¸º</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶å°†è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªç®¡é“</span>
p1 <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level48"</span><span class="token punctuation">)</span>

<span class="token comment"># ä½¿ç”¨catå‘½ä»¤è¯»å–å­è¿›ç¨‹çš„è¾“å‡º</span>
p2 <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>

<span class="token comment"># è¯»å–catå‘½ä»¤çš„è¾“å‡º</span>
output <span class="token operator">=</span> p2<span class="token punctuation">.</span>recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># æ‰“å°è¾“å‡º</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸ºä»€ä¹ˆä¸è¡Œå‘¢</p>
<p><s>å¿ƒæ€çˆ†ç‚¸äº†</s></p>
<p>ç ”ç©¶ä¸€æ³¢<code>pwntools</code></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kelxLZ/article/details/123152529">Pwntools 2022ç®€æ˜æ‰‹å†Œ_pwntoolsæ‰‹å†Œ-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://gist.github.com/anvbis/64907e4f90974c4bdd930baeb705dedf">pwntools-cheatsheet.md (github.com)</a></p>
<h3 id="level49"><a class="markdownIt-Anchor" href="#level49"></a> level49</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level49"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"grep"</span><span class="token punctuation">,</span><span class="token string">"pwn"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level50"><a class="markdownIt-Anchor" href="#level50"></a> level50</h3>
<p>åœ¨Ipythonä¸­è¿è¡Œ</p>
<h3 id="level51"><a class="markdownIt-Anchor" href="#level51"></a> level51</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level51"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p2<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level52"><a class="markdownIt-Anchor" href="#level52"></a> level52</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level52"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level53"><a class="markdownIt-Anchor" href="#level53"></a> level53</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level53"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¾“å…¥å¯†ç åè®°å¾—<code>ctrl+D</code>å‘ç”Ÿ<code>fd</code>æ ‡è¯†</p>
<h3 id="level54"><a class="markdownIt-Anchor" href="#level54"></a> level54</h3>
<p>ç”¨pythonæ‰§è¡Œåˆšæ‰çš„è„šæœ¬åˆæ˜¯ä¸€éè½®å› æˆ‘è§‰å¾—å¯ä»¥ç²¾ç®€ä¸€ä¸‹</p>
 <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level54"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level55"><a class="markdownIt-Anchor" href="#level55"></a> level55</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level55"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"grep"</span><span class="token punctuation">,</span><span class="token string">"pwn"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level56"><a class="markdownIt-Anchor" href="#level56"></a> level56</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level56"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"sed"</span><span class="token punctuation">,</span><span class="token string">"p"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level57"><a class="markdownIt-Anchor" href="#level57"></a> level57</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level57"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p2<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level58"><a class="markdownIt-Anchor" href="#level58"></a> level58</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>close_fds<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level58"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level59"><a class="markdownIt-Anchor" href="#level59"></a> level59</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p2<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level59"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p2<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level60"><a class="markdownIt-Anchor" href="#level60"></a> level60</h3>
<p>ç”¨Cè¯­è¨€ç¼–ç¨‹å®ç°ä»¥ä¸Šè¿‡ç¨‹ï¼Œåˆæ˜¯ä¸€éè½®å›<s>å…³äºæˆ‘9æ¬¡è½®å›è¿™ä»¶äº‹</s></p>
<p>è¿™é‡Œéœ€è¦æ·±å…¥äº†è§£<code>Linux</code>çš„<code>pipe</code>æœºåˆ¶ï¼Œä¸èƒ½è€å½“<code>è°ƒåŒ…ä¾ </code></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/58489873">Linux çš„è¿›ç¨‹é—´é€šä¿¡ï¼šç®¡é“ - çŸ¥ä¹ (zhihu.com)</a></p>
<p><code>ç®¡é“çš„è®¾è®¡ä¹Ÿæ˜¯éµå¾ªUNIXçš„â€œä¸€åˆ‡çš†æ–‡ä»¶â€è®¾è®¡åŸåˆ™çš„</code></p>
<p><code>å®ç°å½¢æ€ä¸Šæ˜¯æ–‡ä»¶ï¼Œä½†æ˜¯ç®¡é“æœ¬èº«å¹¶ä¸å ç”¨ç£ç›˜æˆ–è€…å…¶ä»–å¤–éƒ¨å­˜å‚¨çš„ç©ºé—´</code></p>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/05/09/PwnCollege1-ProgramMiuse/" rel="prev" title="pwnCollege1-ProgramMiuse"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">pwnCollege1-ProgramMiuse</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/05/04/web-practices/" rel="next" title="web-practices"><span class="post-nav-text">web-practices</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>æ‚¨éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼Œæ‰å¯ä½¿ç”¨è¯„è®ºåŒºåŠŸèƒ½ã€‚</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/05/09/PwnCollege2-ProgramInteraction/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank"></a></div><div class="copyright"><span>&copy; 2023 â€“ 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Npc</span></div><div class="footer-custom-text">=w=</div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>