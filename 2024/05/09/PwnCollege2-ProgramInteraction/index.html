<!DOCTYPE html><html lang="[&quot;en&quot;,&quot;zh-CN&quot;,&quot;default&quot;]"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Npc"><meta name="copyright" content="Npc"><meta name="generator" content="Hexo 7.1.1"><meta name="theme" content="hexo-theme-yun"><title>pwnCollege2-ProgramInteraction | Npc | Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.css"><script src="https://cdn.jsdelivr.net/npm/my_blog_prism@1.0.5/prism.js"></script><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"npc0vo.github.io","root":"/","title":"NpcÂ∞èÁ´ô","version":"1.10.11","mode":"light","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://waline-onelastchicks-projects.vercel.app/","comment":false,"el":"#waline","lang":["en","zh-CN","default"]},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="LectureNote  Linux Command Line: LinuxÂëΩ‰ª§Ë°å:  File System: Êñá‰ª∂Á≥ªÁªü:   Absolute Paths: start with &#x2F;ÁªùÂØπË∑ØÂæÑÔºö‰ª• &quot;¬†&#x2F;&quot; ÂºÄÂ§¥„ÄÇ Relative Paths: do NOT start with &#x2F;, relative to the current working directoryÁõ∏ÂØπ">
<meta property="og:type" content="article">
<meta property="og:title" content="pwnCollege2-ProgramInteraction">
<meta property="og:url" content="http://npc0vo.github.io/2024/05/09/PwnCollege2-ProgramInteraction/index.html">
<meta property="og:site_name" content="Npc | Blog">
<meta property="og:description" content="LectureNote  Linux Command Line: LinuxÂëΩ‰ª§Ë°å:  File System: Êñá‰ª∂Á≥ªÁªü:   Absolute Paths: start with &#x2F;ÁªùÂØπË∑ØÂæÑÔºö‰ª• &quot;¬†&#x2F;&quot; ÂºÄÂ§¥„ÄÇ Relative Paths: do NOT start with &#x2F;, relative to the current working directoryÁõ∏ÂØπ">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s0merset7.github.io/post/2021/sept/program_interaction/fileSystemStructure.png">
<meta property="article:published_time" content="2024-05-09T11:36:57.000Z">
<meta property="article:modified_time" content="2024-06-08T12:43:28.305Z">
<meta property="article:author" content="Npc">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s0merset7.github.io/post/2021/sept/program_interaction/fileSystemStructure.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Npc"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Npc"><span class="site-author-status">üò≠</span></a><div class="site-author-name"><a href="/about/">Npc</a></div><span class="site-name">Npc | Blog</span><sub class="site-subtitle">ÊÉ≥s</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">68</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">14</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ÁïôË®ÄÊùø"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/npc0vo" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@1930278836@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.yuque.com/npc0vo" title="Yuque" target="_blank" style="color:var(--hty-text-color)"><span class="icon iconify" data-icon="ri:yuque"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="ÊàëÁöÑÂ∞è‰ºô‰º¥‰ª¨" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#lecturenote"><span class="toc-number">1.</span> <span class="toc-text"> LectureNote</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#linux-command-line-linux%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-number">1.1.</span> <span class="toc-text"> Linux Command Line: LinuxÂëΩ‰ª§Ë°å:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#file-system-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text"> File System: Êñá‰ª∂Á≥ªÁªü:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#environment-variables"><span class="toc-number">1.1.2.</span> <span class="toc-text"> Environment Variables:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#files"><span class="toc-number">1.1.3.</span> <span class="toc-text"> Files:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pipes"><span class="toc-number">1.1.4.</span> <span class="toc-text"> Pipes:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useful-commands-cli"><span class="toc-number">1.1.5.</span> <span class="toc-text"> Useful Commands (CLI):</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#binary-files"><span class="toc-number">1.2.</span> <span class="toc-text"> Binary Files</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#elf-files"><span class="toc-number">1.2.1.</span> <span class="toc-text"> ELF Files:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#symbols"><span class="toc-number">1.2.2.</span> <span class="toc-text"> Symbols:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resources-to-interact-with-elf"><span class="toc-number">1.2.3.</span> <span class="toc-text"> Resources to Interact with ELF:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useful-commands-binary"><span class="toc-number">1.2.4.</span> <span class="toc-text"> Useful Commands (Binary):</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lifecycle-of-a-linux-process"><span class="toc-number">1.3.</span> <span class="toc-text"> Lifecycle of a Linux Process</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#what-is-a-process"><span class="toc-number">1.3.1.</span> <span class="toc-text"> What is a Process:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#process-timeline-%E8%BF%87%E7%A8%8B%E6%97%B6%E9%97%B4%E8%BD%B4"><span class="toc-number">1.3.2.</span> <span class="toc-text"> Process Timeline: ËøáÁ®ãÊó∂Èó¥ËΩ¥:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useful-commands-viewing-processes"><span class="toc-number">1.3.3.</span> <span class="toc-text"> Useful Commands (Viewing Processes):</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sources"><span class="toc-number">1.4.</span> <span class="toc-text"> Sources:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#challenges"><span class="toc-number">2.</span> <span class="toc-text"> Challenges</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#program-interaction"><span class="toc-number">2.1.</span> <span class="toc-text"> Program Interaction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#level1"><span class="toc-number">2.1.1.</span> <span class="toc-text"> level1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level2"><span class="toc-number">2.1.2.</span> <span class="toc-text"> level2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level3"><span class="toc-number">2.1.3.</span> <span class="toc-text"> level3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level4"><span class="toc-number">2.1.4.</span> <span class="toc-text"> level4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level7"><span class="toc-number">2.1.5.</span> <span class="toc-text"> level7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level5"><span class="toc-number">2.1.6.</span> <span class="toc-text"> level5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level6"><span class="toc-number">2.1.7.</span> <span class="toc-text"> level6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level8"><span class="toc-number">2.1.8.</span> <span class="toc-text"> level8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level9"><span class="toc-number">2.1.9.</span> <span class="toc-text"> level9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level10"><span class="toc-number">2.1.10.</span> <span class="toc-text"> level10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level11"><span class="toc-number">2.1.11.</span> <span class="toc-text"> level11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level12"><span class="toc-number">2.1.12.</span> <span class="toc-text"> level12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level13"><span class="toc-number">2.1.13.</span> <span class="toc-text"> level13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level14"><span class="toc-number">2.1.14.</span> <span class="toc-text"> level14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level15"><span class="toc-number">2.1.15.</span> <span class="toc-text"> level15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level16"><span class="toc-number">2.1.16.</span> <span class="toc-text"> level16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level17"><span class="toc-number">2.1.17.</span> <span class="toc-text"> level17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level18"><span class="toc-number">2.1.18.</span> <span class="toc-text"> level18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level19"><span class="toc-number">2.1.19.</span> <span class="toc-text"> level19</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level20"><span class="toc-number">2.1.20.</span> <span class="toc-text"> level20</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level21"><span class="toc-number">2.1.21.</span> <span class="toc-text"> level21</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level22"><span class="toc-number">2.1.22.</span> <span class="toc-text"> level22</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level23"><span class="toc-number">2.1.23.</span> <span class="toc-text"> level23</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level24"><span class="toc-number">2.1.24.</span> <span class="toc-text"> level24</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level25"><span class="toc-number">2.1.25.</span> <span class="toc-text"> level25</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level26"><span class="toc-number">2.1.26.</span> <span class="toc-text"> level26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level27"><span class="toc-number">2.1.27.</span> <span class="toc-text"> level27</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level28"><span class="toc-number">2.1.28.</span> <span class="toc-text"> level28</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level29"><span class="toc-number">2.1.29.</span> <span class="toc-text"> level29</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level30"><span class="toc-number">2.1.30.</span> <span class="toc-text"> level30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level31"><span class="toc-number">2.1.31.</span> <span class="toc-text"> level31</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level32"><span class="toc-number">2.1.32.</span> <span class="toc-text"> level32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level33"><span class="toc-number">2.1.33.</span> <span class="toc-text"> level33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level34"><span class="toc-number">2.1.34.</span> <span class="toc-text"> level34</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level35"><span class="toc-number">2.1.35.</span> <span class="toc-text"> level35</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level36"><span class="toc-number">2.1.36.</span> <span class="toc-text"> level36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level37"><span class="toc-number">2.1.37.</span> <span class="toc-text"> level37</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level38"><span class="toc-number">2.1.38.</span> <span class="toc-text"> level38</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level39"><span class="toc-number">2.1.39.</span> <span class="toc-text"> level39</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level40"><span class="toc-number">2.1.40.</span> <span class="toc-text"> level40</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level41"><span class="toc-number">2.1.41.</span> <span class="toc-text"> level41</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level42"><span class="toc-number">2.1.42.</span> <span class="toc-text"> level42</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level43"><span class="toc-number">2.1.43.</span> <span class="toc-text"> level43</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level44"><span class="toc-number">2.1.44.</span> <span class="toc-text"> level44</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level45"><span class="toc-number">2.1.45.</span> <span class="toc-text"> level45</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level46"><span class="toc-number">2.1.46.</span> <span class="toc-text"> level46</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level47"><span class="toc-number">2.1.47.</span> <span class="toc-text"> level47</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level48"><span class="toc-number">2.1.48.</span> <span class="toc-text"> level48</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level49"><span class="toc-number">2.1.49.</span> <span class="toc-text"> level49</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level50"><span class="toc-number">2.1.50.</span> <span class="toc-text"> level50</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level51"><span class="toc-number">2.1.51.</span> <span class="toc-text"> level51</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level52"><span class="toc-number">2.1.52.</span> <span class="toc-text"> level52</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level53"><span class="toc-number">2.1.53.</span> <span class="toc-text"> level53</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level54"><span class="toc-number">2.1.54.</span> <span class="toc-text"> level54</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level55"><span class="toc-number">2.1.55.</span> <span class="toc-text"> level55</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level56"><span class="toc-number">2.1.56.</span> <span class="toc-text"> level56</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level57"><span class="toc-number">2.1.57.</span> <span class="toc-text"> level57</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level58"><span class="toc-number">2.1.58.</span> <span class="toc-text"> level58</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level59"><span class="toc-number">2.1.59.</span> <span class="toc-text"> level59</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level60"><span class="toc-number">2.1.60.</span> <span class="toc-text"> level60</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://npc0vo.github.io/2024/05/09/PwnCollege2-ProgramInteraction/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Npc"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Npc | Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">pwnCollege2-ProgramInteraction</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-05-09 19:36:57" itemprop="dateCreated datePublished" datetime="2024-05-09T19:36:57+08:00">2024-05-09</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2024-06-08 20:43:28" itemprop="dateModified" datetime="2024-06-08T20:43:28+08:00">2024-06-08</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">8.5k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">39m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/PwnCollege/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">PwnCollege</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/CTF/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">CTF</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="lecturenote"><a class="markdownIt-Anchor" href="#lecturenote"></a> LectureNote</h1>
<h2 id="linux-command-line-linuxÂëΩ‰ª§Ë°å"><a class="markdownIt-Anchor" href="#linux-command-line-linuxÂëΩ‰ª§Ë°å"></a> Linux Command Line: LinuxÂëΩ‰ª§Ë°å:</h2>
<h3 id="file-system-Êñá‰ª∂Á≥ªÁªü"><a class="markdownIt-Anchor" href="#file-system-Êñá‰ª∂Á≥ªÁªü"></a> <strong>File System: Êñá‰ª∂Á≥ªÁªü:</strong></h3>
<img src="https://s0merset7.github.io/post/2021/sept/program_interaction/fileSystemStructure.png" alt="File System Structure" / loading="lazy">
<ul>
<li>Absolute Paths: start with <code>/</code>ÁªùÂØπË∑ØÂæÑÔºö‰ª• &quot;¬†<code>/</code>&quot; ÂºÄÂ§¥„ÄÇ</li>
<li>Relative Paths: do NOT start with <code>/</code>, relative to the current working directoryÁõ∏ÂØπË∑ØÂæÑÔºö‰∏çË¶Å‰ª•‚Äú¬†<code>/</code>¬†‚ÄùÂºÄÂ§¥ÔºåÁõ∏ÂØπ‰∫éÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï</li>
</ul>
<h3 id="environment-variables"><a class="markdownIt-Anchor" href="#environment-variables"></a> <strong>Environment Variables:</strong></h3>
<p>Environment Variables: a set of Key/Value pairs passed into every process when launched. Critical variables include:ÁéØÂ¢ÉÂèòÈáèÔºöÂú®ÂêØÂä®ËøõÁ®ãÊó∂‰º†ÈÄíÁªôÊØè‰∏™ËøõÁ®ãÁöÑ‰∏ÄÁªÑÈîÆ/ÂÄºÂØπ„ÄÇÂÖ≥ÈîÆÂèòÈáèÂåÖÊã¨Ôºö</p>
<ul>
<li><code>PATH</code>: list of directories to search for programs in[b0]ÔºöË¶ÅÊêúÁ¥¢Á®ãÂ∫èÁöÑÁõÆÂΩïÂàóË°®</li>
<li><code>PWD</code>: current working directoryÔºöÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï</li>
<li><code>HOME</code>: path to home directoryÂÆ∂ÁõÆÂΩïË∑ØÂæÑ</li>
<li><code>HOSTNAME</code>: name of the systemÁ≥ªÁªüÁöÑÂêçÁß∞</li>
</ul>
<h3 id="files"><a class="markdownIt-Anchor" href="#files"></a> <strong>Files:</strong></h3>
<ul>
<li>Symbolic Links (Soft Links): special type of file that references another file Á¨¶Âè∑ÈìæÊé•ÔºàËΩØÈìæÊé•ÔºâÔºö‰∏ÄÁßçÁâπÊÆäÁöÑÊñá‰ª∂Á±ªÂûãÔºåÂÆÉÊåáÂêëÂè¶‰∏Ä‰∏™Êñá‰ª∂„ÄÇ
<ul>
<li>symbolic links to relative paths are relative to the directory containing the linkÊåáÂêëÁõ∏ÂØπË∑ØÂæÑÁöÑÁ¨¶Âè∑ÈìæÊé•Áõ∏ÂØπ‰∫éÂåÖÂê´ÈìæÊé•ÁöÑÁõÆÂΩïÊòØÁõ∏ÂØπÁöÑ„ÄÇ</li>
</ul>
</li>
<li>Hard Links: a perfect reference to the data/content inside the linked file. They link only to the data of the linked file, not its original pathÁ°¨ÈìæÊé•ÔºöÊòØÂØπÈìæÊé•Êñá‰ª∂ÂÜÖÈÉ®Êï∞ÊçÆ/ÂÜÖÂÆπÁöÑÂÆåÁæéÂºïÁî®„ÄÇÂÆÉ‰ª¨‰ªÖÈìæÊé•Âà∞Ë¢´ÈìæÊé•Êñá‰ª∂ÁöÑÊï∞ÊçÆÔºåËÄå‰∏çÈìæÊé•Âà∞ÂÖ∂ÂéüÂßãË∑ØÂæÑ„ÄÇ</li>
</ul>
<p><strong>Different Types of Files:‰∏çÂêåÁ±ªÂûãÁöÑÊñá‰ª∂Ôºö</strong></p>
<ul>
<li><code>-</code>: regular file <code>-</code>¬†:ÊôÆÈÄöÊñá‰ª∂</li>
<li><code>d</code>: a directory (yes, directories are actually just special files!)<code>d</code>¬†Ôºö ‰∏Ä‰∏™ÁõÆÂΩïÔºàÊòØÁöÑÔºåÁõÆÂΩïÂÆûÈôÖ‰∏äÂè™ÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÊñá‰ª∂ÔºÅÔºâ</li>
<li><code>l</code>: a symbolic link (a file that transparently points to another file or directory)`<code>l</code>¬†`Ôºö Á¨¶Âè∑ÈìæÊé•Ôºà‰∏ÄÁßçÈÄèÊòéÂú∞ÊåáÂêëÂÖ∂‰ªñÊñá‰ª∂ÊàñÁõÆÂΩïÁöÑÊñá‰ª∂Ôºâ</li>
<li><code>p</code>: is a named pipe (also known as a FIFO)&quot;<code>p</code>¬†&quot; ÊòØ‰∏Ä‰∏™ÂëΩÂêçÁÆ°ÈÅìÔºà‰πüÁß∞‰∏∫ FIFOÔºâ„ÄÇ</li>
<li><code>c</code>: is a character device file (i.e., backed by a hardware device that produces or receives data streams, such as a microphone)`/dev/b0` ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶ËÆæÂ§áÊñá‰ª∂ÔºàÂç≥Áî±Á°¨‰ª∂ËÆæÂ§áÊîØÊåÅÔºåËØ•Á°¨‰ª∂ËÆæÂ§áÂèØ‰ª•ÁîüÊàêÊàñÊé•Êî∂Êï∞ÊçÆÊµÅÔºå‰æãÂ¶ÇÈ∫¶ÂÖãÈ£éÔºâ„ÄÇ</li>
<li><code>b</code>: a block device file (i.e., backed by a hardware device that stores and loads blocks of data, such as a hard drive)`<code>b</code>¬†`Ôºö ÂùóËÆæÂ§áÊñá‰ª∂ÔºàÂç≥Áî±Á°¨‰ª∂ËÆæÂ§áÊîØÊåÅÁöÑÊñá‰ª∂ÔºåËØ•Á°¨‰ª∂ËÆæÂ§áÁî®‰∫éÂ≠òÂÇ®ÂíåÂä†ËΩΩÊï∞ÊçÆÂùóÔºå‰æãÂ¶ÇÁ°¨ÁõòÔºâ</li>
<li><code>s</code>: a unix socket (essentially a local network connection encapsulated in a file)<code>s</code>¬†Ôºö ‰∏Ä‰∏™ Unix Â•óÊé•Â≠óÔºàÊú¨Ë¥®‰∏äÊòØ‰∏Ä‰∏™Â∞ÅË£ÖÂú®Êñá‰ª∂‰∏≠ÁöÑÊú¨Âú∞ÁΩëÁªúËøûÊé•Ôºâ</li>
</ul>
<h3 id="pipes"><a class="markdownIt-Anchor" href="#pipes"></a> <strong>Pipes:</strong></h3>
<ul>
<li>Unnamed Pipes (<code>|</code>): ethereal channels of communication, often used to direct data from one command to anotherÂåøÂêçÁÆ°ÈÅìÔºà¬†<code>|</code>¬†ÔºâÔºö‰∏ÄÁßçÁî®‰∫éÈÄö‰ø°ÁöÑÊó†ÂΩ¢ÈÄöÈÅìÔºåÈÄöÂ∏∏Áî®‰∫éÂ∞ÜÊï∞ÊçÆ‰ªé‰∏Ä‰∏™ÂëΩ‰ª§‰º†ËæìÂà∞Âè¶‰∏Ä‰∏™ÂëΩ‰ª§„ÄÇ</li>
<li>Named Pipes (FIFOs): used to help facilitate data flow in certain situations. The flow of data is First In First Out (FIFO)ÂëΩÂêçÁÆ°ÈÅìÔºàÂÖàËøõÂÖàÂá∫ÈòüÂàóÔºâÔºöÁî®‰∫éÂú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÂ∏ÆÂä©Êï∞ÊçÆÊµÅÁöÑ‰º†Ëæì„ÄÇÊï∞ÊçÆÁöÑ‰º†ËæìÈÅµÂæ™ÂÖàËøõÂÖàÂá∫ÁöÑÂéüÂàôÔºàFIFOÔºâ„ÄÇ</li>
</ul>
<h3 id="useful-commands-cli"><a class="markdownIt-Anchor" href="#useful-commands-cli"></a> <strong>Useful Commands (CLI):</strong></h3>
<ul>
<li><code>witch programName</code>: will return the absolute path of the program given found by the <code>PATH</code> variableÂÆÉÂ∞ÜËøîÂõûÁî± ¬†<code>PATH</code>¬† ÂèòÈáèÊâæÂà∞ÁöÑÁ®ãÂ∫èÁöÑÁªùÂØπË∑ØÂæÑ„ÄÇ</li>
<li><code>env</code>: prints all the environment variables to the screen`<code>env</code>¬†` ‰ºöÂ∞ÜÊâÄÊúâÁéØÂ¢ÉÂèòÈáèÊâìÂç∞Âà∞Â±èÂπï‰∏ä„ÄÇ</li>
<li><code>export variable=value</code>: can set new/existing variables to a new value[b0] ÂèØ‰ª•‰∏∫Áé∞ÊúâÊàñÊñ∞ÂàõÂª∫ÁöÑÂèòÈáèËÆæÁΩÆÊñ∞ÁöÑÂÄº„ÄÇ</li>
<li><code>ln -s fileToBeLinked symbolicLinkName</code>: creates a symbolic linkÂàõÂª∫‰∏Ä‰∏™Á¨¶Âè∑ÈìæÊé•„ÄÇ</li>
<li><code>ln fileToBeLinked hardLinkName</code>: creates a hard linkÂàõÂª∫Á°¨ÈìæÊé•</li>
<li><code>ls -ld</code>: Lists all files in current directory along with the files‚Äô absolute path<code>ls -ld</code>¬†Ôºö ÂàóÂá∫ÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÂèäÂÖ∂ÁªùÂØπË∑ØÂæÑ</li>
<li><code>mkfifo fifoName</code>: makes a new FIFOÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑFIFOÔºàÂÖàËøõÂÖàÂá∫ÈòüÂàóÔºâ„ÄÇ</li>
<li><code>command &lt; in_file</code>: redirect in_file into command‚Äôs inputÂ∞Ü `in_file` ÈáçÂÆöÂêëÂà∞ÂëΩ‰ª§ÁöÑËæìÂÖ•‰∏≠„ÄÇ</li>
<li><code>command &gt; out_file</code>: redirect command‚Äôs output into out_file, overwriting itÂ∞ÜÂëΩ‰ª§ÁöÑËæìÂá∫ÈáçÂÆöÂêëÂà∞ out_file Êñá‰ª∂‰∏≠ÔºåÂπ∂Ë¶ÜÁõñËØ•Êñá‰ª∂„ÄÇ</li>
<li><code>command &gt;&gt;out_file</code>: redirect the command‚Äôs output into out_file, appending to itÂ∞ÜÂëΩ‰ª§ÁöÑËæìÂá∫ÈáçÂÆöÂêëÂà∞ out_file Êñá‰ª∂‰∏≠ÔºåÂπ∂ËøΩÂä†Âà∞ËØ•Êñá‰ª∂‰∏≠„ÄÇ</li>
<li><code>command 2&gt;error_file</code>: redirect the command‚Äôs errors into error_file, overwriting itÂ∞ÜÂëΩ‰ª§ÁöÑÈîôËØØÈáçÂÆöÂêëÂà∞ error_file ‰∏≠ÔºåÂπ∂Ë¶ÜÁõñËØ•Êñá‰ª∂„ÄÇ</li>
<li><code>command 2&gt;&gt;error_file</code>: redirect the command‚Äôs errors into error_file, appending to itÂ∞ÜÂëΩ‰ª§ÁöÑÈîôËØØÈáçÂÆöÂêëÂà∞ error_file ‰∏≠ÔºåÂπ∂ËøΩÂä†Âà∞ÂÖ∂‰∏≠„ÄÇ</li>
</ul>
<h2 id="binary-files"><a class="markdownIt-Anchor" href="#binary-files"></a> Binary Files</h2>
<h3 id="elf-files"><a class="markdownIt-Anchor" href="#elf-files"></a> <strong>ELF Files:</strong></h3>
<p>Executable and Linkable Format (ELF): defines a program as it will be loaded and executed in memory for Linux/BSD systems. Allows for a compiler to create and define a programÂèØÊâßË°åÂíåÂèØÈìæÊé•Ê†ºÂºèÔºàELFÔºâÔºöÂÆö‰πâ‰∫ÜLinux/BSDÁ≥ªÁªü‰∏äÂä†ËΩΩÂπ∂ÊâßË°åÁöÑÁ®ãÂ∫èÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÊ†ºÂºè„ÄÇÂÖÅËÆ∏ÁºñËØëÂô®ÂàõÂª∫Âπ∂ÂÆö‰πâÁ®ãÂ∫è„ÄÇ</p>
<ul>
<li>is a binary file format containing the program, its data, how the program should be loaded (program/segment headers), and the metadata describing program components (section headers)ËøôÊòØ‰∏ÄÁßç‰∫åËøõÂà∂Êñá‰ª∂Ê†ºÂºèÔºåÂÖ∂‰∏≠ÂåÖÂê´Á®ãÂ∫èÊú¨Ë∫´„ÄÅÊï∞ÊçÆ‰ª•ÂèäÁ®ãÂ∫èÁöÑÂä†ËΩΩÊñπÂºèÔºàÁ®ãÂ∫è/ÊÆµÂ§¥ÔºâÔºå‰ª•ÂèäÊèèËø∞Á®ãÂ∫èÁªÑ‰ª∂ÁöÑÂÖÉÊï∞ÊçÆÔºàËäÇÂ§¥Ôºâ„ÄÇ</li>
<li>For Windows the equivalent are Portable Executables (PE)ÂØπ‰∫éWindowsÁ≥ªÁªüÊù•ËØ¥ÔºåÂØπÂ∫îÁöÑÊñá‰ª∂Ê†ºÂºèÊòØPortable ExecutablesÔºàPEÔºâ„ÄÇ</li>
<li>For MacOS the equivalent are Mach-OÂØπ‰∫éMacOSÔºåÂÖ∂ÂØπÂ∫îÁöÑÊ†ºÂºèÊòØMach-O„ÄÇ</li>
</ul>
<p>Dynamically Linked ELF: The ELF file relies on libraries that also need to be loadedÂä®ÊÄÅÈìæÊé•ÁöÑELFÊñá‰ª∂ÔºöËØ•ELFÊñá‰ª∂‰æùËµñ‰∫éÈúÄË¶ÅÂä†ËΩΩÁöÑÂ∫ìÊñá‰ª∂„ÄÇ</p>
<p>Program Headers: specify information and define segments needed to prepare the program for execution. The source of information used when loading a fileÁ®ãÂ∫èÂ§¥ÔºöÊåáÂÆöÈúÄË¶ÅÁöÑ‰ø°ÊÅØÂπ∂ÂÆö‰πâ‰∏∫‰ΩøÁ®ãÂ∫èËÉΩÂ§üÊâßË°åÊâÄÈúÄÁöÑÊÆµ„ÄÇÂä†ËΩΩÊñá‰ª∂Êó∂‰ΩøÁî®ÁöÑ‰ø°ÊÅØÊù•Ê∫ê</p>
<ul>
<li>Segments: parts of an ELF file that are loaded into the memory of a computer when that file is executedÊÆµÔºöÂΩìELFÊñá‰ª∂Ë¢´ÊâßË°åÊó∂ÔºåÂä†ËΩΩÂà∞ËÆ°ÁÆóÊú∫ÂÜÖÂ≠ò‰∏≠ÁöÑÊñá‰ª∂ÈÉ®ÂàÜ</li>
</ul>
<p><strong>Important Entry Types: ÈáçË¶ÅÁöÑÂÖ•Âè£Á±ªÂûãÔºö</strong></p>
<ul>
<li><code>INTERP</code>: entry type defining the library that should be used to load this ELF into memory[b0] ÂÖ•Âè£Á±ªÂûãÂÆö‰πâ‰∫ÜÂ∫îËØ•‰ΩøÁî®Âì™‰∏™Â∫ìÊù•Â∞ÜÊ≠§ELFÂä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠„ÄÇ</li>
<li><code>LOAD</code>: entry type defining a part of the file that should be loaded into memory<code>LOAD</code>¬†Ôºö ÂÆö‰πâÊñá‰ª∂‰∏≠Â∫îÂä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠ÁöÑ‰∏ÄÈÉ®ÂàÜÁöÑÂÖ•Âè£Á±ªÂûã</li>
</ul>
<p>Section Headers: represent a different view inside an ELF file with a lot more semantic information that is less important for the actual loading processËäÇÂ§¥Ôºö‰ª£Ë°®ELFÊñá‰ª∂‰∏≠‰∏ÄÁßç‰∏çÂêåÁöÑÂÜÖÈÉ®ËßÜÂõæÔºåÂåÖÂê´Êõ¥Â§ö‰∏éÂÆûÈôÖÂä†ËΩΩËøáÁ®ãÂÖ≥Á≥ª‰∏çÂ§ßÁöÑËØ≠‰πâ‰ø°ÊÅØ„ÄÇ</p>
<ul>
<li>They are not required in an ELF file, they are stored as metadataÂÆÉ‰ª¨Âú®ELFÊñá‰ª∂‰∏≠‰∏çÊòØÂøÖÈúÄÁöÑÔºåËÄåÊòØ‰Ωú‰∏∫ÂÖÉÊï∞ÊçÆÂ≠òÂÇ®ÁöÑ„ÄÇ</li>
</ul>
<p><strong>Important Sections: ÈáçË¶ÅÁöÑÈÉ®ÂàÜ:</strong></p>
<ul>
<li><code>.text</code>: the executable code of your program.[b0]ÔºöÊÇ®Á®ãÂ∫èÁöÑÂèØÊâßË°å‰ª£Á†Å„ÄÇ</li>
<li><code>.plt</code> and <code>.got</code>: used to resolve and dispatch library calls.ÂíåÔºöÁî®‰∫éËß£ÂÜ≥ÂíåÂàÜÂèëÂ∫ìÁöÑË∞ÉÁî®„ÄÇ</li>
<li><code>.data</code>: used for pre-initialized global writable data (such as global arrays with initial values)<code>.data</code>¬†Ôºö Áî®‰∫éÈ¢ÑÂÖàÂàùÂßãÂåñÁöÑÂÖ®Â±ÄÂèØÂÜôÊï∞ÊçÆÔºà‰æãÂ¶ÇÂÖ∑ÊúâÂàùÂßãÂÄºÁöÑÂÖ®Â±ÄÊï∞ÁªÑÔºâ</li>
<li><code>.rodata</code>: used for global read-only data (such as string constants)<code>.rodata</code>¬†ÔºöÁî®‰∫éÂÖ®Â±ÄÂè™ËØªÊï∞ÊçÆÔºàÂ¶ÇÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèÔºâ</li>
<li><code>.bss</code>: used for uninitialized global writable data (such as global arrays without initial values)<code>.bss</code>¬†Ôºö Áî®‰∫éÊú™ÂàùÂßãÂåñÁöÑÂÖ®Â±ÄÂèØÂÜôÊï∞ÊçÆÔºà‰æãÂ¶ÇÊ≤°ÊúâÂàùÂßãÂÄºÁöÑÂÖ®Â±ÄÊï∞ÁªÑÔºâ</li>
</ul>
<h3 id="symbols"><a class="markdownIt-Anchor" href="#symbols"></a> <strong>Symbols:</strong></h3>
<p>Symbols: binaries and libraries that use dynamically loaded libraries to find libraries, resolve function calls into those libraries, etc 6081</p>
<h3 id="resources-to-interact-with-elf"><a class="markdownIt-Anchor" href="#resources-to-interact-with-elf"></a> <strong>Resources to Interact with ELF:</strong></h3>
<ul>
<li><code>gcc</code>: to make your ELF.Âà∂‰Ωú‰Ω†ÁöÑELFÊñá‰ª∂„ÄÇ</li>
<li><code>readelf</code>: to parse the ELF header.Ëß£ÊûêELFÂ§¥Êñá‰ª∂„ÄÇ</li>
<li><code>objdump</code>: to parse the ELF header and disassemble the source code.Ëß£ÊûêELFÂ§¥Êñá‰ª∂Âπ∂ÂèçÊ±áÁºñÊ∫ê‰ª£Á†Å„ÄÇ</li>
<li><code>nm</code>: to view your ELF‚Äôs symbols.[b0]ÔºöÊü•ÁúãÊÇ®ÁöÑELFÊñá‰ª∂ÁöÑÁ¨¶Âè∑„ÄÇ</li>
<li><code>patchelf</code>: to change some ELF properties.[b0]ÔºöÁî®Êù•Êõ¥Êîπ‰∏Ä‰∫õELFÊñá‰ª∂ÁöÑÂ±ûÊÄß„ÄÇ</li>
<li><code>objcopy</code>: to swap out ELF sections.ÊõøÊç¢ELFÊÆµ„ÄÇ</li>
<li><code>strip</code>: to remove otherwise-helpful information (such as symbols).Âà†Èô§ÂéüÊú¨ÊúâÁî®ÁöÑ‰ø°ÊÅØÔºà‰æãÂ¶ÇÁ¨¶Âè∑Ôºâ„ÄÇ</li>
<li><a target="_blank" rel="noopener" href="https://ide.kaitai.io/"><strong>kaitai struct</strong></a>: to look through your ELF interactively.ÂáØÊ≥∞ÁªìÊûÑÔºöÁî®‰∫é‰∫§‰∫íÂºèÊü•ÁúãELFÊñá‰ª∂„ÄÇ</li>
</ul>
<h3 id="useful-commands-binary"><a class="markdownIt-Anchor" href="#useful-commands-binary"></a> <strong>Useful Commands (Binary):</strong></h3>
<ul>
<li><code>readelf -a programName</code>: will parse out the ELF file, providing information such as headersÂÆÉ‰ºöËß£ÊûêELFÊñá‰ª∂ÔºåÊèê‰æõËØ∏Â¶ÇÂ§¥Êñá‰ª∂‰πãÁ±ªÁöÑ‰ø°ÊÅØ„ÄÇ</li>
<li><code>nm -a programName</code>: will list out all of the symbols associated with a program[b0] Â∞Ü‰ºöÂàóÂá∫‰∏éÁ®ãÂ∫èÁõ∏ÂÖ≥ÁöÑÊâÄÊúâÁ¨¶Âè∑„ÄÇ</li>
<li><code>nm -D programName</code>: will list out all of the dynamic imports used at runtimeÂ∞Ü‰ºöÂàóÂá∫Âú®ËøêË°åÊó∂‰ΩøÁî®ÁöÑÊâÄÊúâÂä®ÊÄÅÂØºÂÖ•„ÄÇ</li>
</ul>
<h2 id="lifecycle-of-a-linux-process"><a class="markdownIt-Anchor" href="#lifecycle-of-a-linux-process"></a> Lifecycle of a Linux Process</h2>
<h3 id="what-is-a-process"><a class="markdownIt-Anchor" href="#what-is-a-process"></a> <strong>What is a Process:</strong></h3>
<p><strong>Every Linux process has: ÊØè‰∏™LinuxËøõÁ®ãÈÉΩÊúâÔºö</strong></p>
<ul>
<li>State Áä∂ÊÄÅ
<ul>
<li>running, waiting, stopped, zombieË∑ëÊ≠•„ÄÅÁ≠âÂæÖ„ÄÅÂÅúÊ≠¢„ÄÅÂÉµÂ∞∏</li>
</ul>
</li>
<li>Priority (and other scheduling information)‰ºòÂÖàÁ∫ßÔºà‰ª•ÂèäÂÖ∂‰ªñË∞ÉÂ∫¶‰ø°ÊÅØÔºâ</li>
<li>Parent, Siblings, ChildrenÁà∂ÊØç„ÄÅÂÖÑÂºüÂßêÂ¶π„ÄÅÂ≠êÂ•≥</li>
<li>Shared Resources ÂÖ±‰∫´ËµÑÊ∫ê
<ul>
<li>files, pipes, sockets Êñá‰ª∂„ÄÅÁÆ°ÈÅì„ÄÅÂ•óÊé•Â≠ó</li>
</ul>
</li>
<li>Virtual Memory Space ËôöÊãüÂÜÖÂ≠òÁ©∫Èó¥</li>
<li>Security Context ÂÆâÂÖ®‰∏ä‰∏ãÊñá
<ul>
<li>effective uid and gid ÊúâÊïàÁöÑUIDÔºàÁî®Êà∑IDÔºâÂíåGIDÔºàÁªÑIDÔºâ</li>
<li>saved uid and gid Â∑≤‰øùÂ≠òÁöÑuidÂíågid</li>
<li>capabilities ÂäüËÉΩ</li>
</ul>
</li>
</ul>
<p>Virtual Memory: memory dedicated to a specific processËôöÊãüÂÜÖÂ≠òÔºö‰∏ìÈó®ÂàÜÈÖçÁªôÊüê‰∏™ËøõÁ®ãÁöÑÂÜÖÂ≠ò</p>
<p>Physical Memory: memory shared among the whole systemÁâ©ÁêÜÂÜÖÂ≠òÔºöÁ≥ªÁªü‰∏≠ÊâÄÊúâÁªÑ‰ª∂ÂÖ±‰∫´ÁöÑÂÜÖÂ≠ò</p>
<p>libc: a library full of helper functions that is used by almost every program (including common C functions)libc ÊòØ‰∏Ä‰∏™ÂåÖÂê´Â§ßÈáèËæÖÂä©ÂáΩÊï∞ÁöÑÂ∫ìÔºåÂá†‰πéÊâÄÊúâÁöÑÁ®ãÂ∫èÔºàÂåÖÊã¨Â∏∏ËßÅÁöÑ C ÂáΩÊï∞ÔºâÈÉΩ‰ºö‰ΩøÁî®ÂÆÉ„ÄÇ</p>
<h3 id="process-timeline-ËøáÁ®ãÊó∂Èó¥ËΩ¥"><a class="markdownIt-Anchor" href="#process-timeline-ËøáÁ®ãÊó∂Èó¥ËΩ¥"></a> <strong>Process Timeline: ËøáÁ®ãÊó∂Èó¥ËΩ¥:</strong></h3>
<ol>
<li><strong>Process is created ÂàõÂª∫ÊµÅÁ®ã</strong>
<ul>
<li>Kernel will check for executable permissions</li>
<li>Calls <code>execve()</code> to begin loading</li>
</ul>
</li>
<li><strong>Process is loaded ËøõÁ®ãÂ∑≤Âä†ËΩΩ</strong></li>
</ol>
<ul>
<li>Figures out what steps need to be taken to load the file
<ul>
<li>Starts from the beginning of the file, looks for <code>#!</code> (sh-bang) to extract the rest of the line (the interpreter)
<ul>
<li>Will see if the interpreter matches one in the system, and will instead run your file as an argument to the interpreter from <code>#!</code></li>
</ul>
</li>
<li>If there is no <code>#!</code> (not a script) then it will check if the file matches a format in <code>/proc/sys/binfmt_misc</code>
<ul>
<li>If a match is found, then it will execute the interpreter for that format with your file as an argument</li>
</ul>
</li>
<li>If it is a dynamically-linked ELF file, the kernel will read the interpreter/loader (collectively loader) defined in the ELF file
<ul>
<li>The interpreter will be loaded and will be given control</li>
<li>The interpreter then locates the libraries
<ul>
<li><code>LD_PRELOAD</code>: environment variable, and anything in /etc/ld.so.preload</li>
<li><code>LD_LIBRARY_PATH</code>: environment variable (can be set in the shell)</li>
<li><code>DT_RUNPATH</code> or <code>DT_RPATH</code>: specified in the binary file (both can be modified with patchelf)</li>
<li>/etc/ld.so.conf: system-wide configuration</li>
<li>/lib and /usr/lib /libÂíå/usr/lib</li>
</ul>
</li>
<li>The interpreter then runs the libraries
<ul>
<li>May cause more libraries to load if libraries depend on other libraries</li>
<li>Will also update relocations during this process</li>
</ul>
</li>
</ul>
</li>
<li>If it is a static ELF file, the kernel will just load the file</li>
</ul>
</li>
<li>All of this information will be loaded to its own virtual memory space containing (located in /proc/self/maps):
<ul>
<li>the binary ‰∫åËøõÂà∂</li>
<li>the libraries Â∫ì</li>
<li>the ‚Äúheap‚Äù ‚ÄúÂ†Ü‚Äù
<ul>
<li>for dynamically allocated memory</li>
</ul>
</li>
<li>the ‚Äústack‚Äù ‚ÄúÊ†à‚Äù
<ul>
<li>for function local variables</li>
</ul>
</li>
<li>any memory specifically mapped by the program</li>
<li>some helper regions ‰∏Ä‰∫õËæÖÂä©Âå∫Âüü</li>
<li>kernel code in the ‚Äúupper half‚Äù of memory is inaccessible to the process
<ul>
<li>above 0x8000000000000000 on 64-bit architectures</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>Process is initialized ËøõÁ®ãÂ∑≤ÂàùÂßãÂåñ„ÄÇ</strong>
<ul>
<li>Will run any constructors specified in the ELF fileÂ∞Ü‰ºöËøêË°åELFÊñá‰ª∂‰∏≠ÊåáÂÆöÁöÑÊâÄÊúâÊûÑÈÄ†ÂáΩÊï∞„ÄÇ</li>
</ul>
</li>
<li><strong>Process is launched ËøõÁ®ãÂêØÂä®</strong>
<ul>
<li>The ELF file automatically calls <code>_libc_start_main()</code> from the libc library, which then calls the program‚Äôs <code>main()</code> functionELFÊñá‰ª∂‰ºöËá™Âä®‰ªélibcÂ∫ì‰∏≠Ë∞ÉÁî®¬†<code>_libc_start_main()</code>¬†ÔºåÁÑ∂ÂêélibcÂ∫ì‰ºöË∞ÉÁî®Á®ãÂ∫è‰∏≠ÁöÑ¬†<code>main()</code>¬†ÂáΩÊï∞„ÄÇ</li>
<li>Now the code is runningÁé∞Âú®‰ª£Á†ÅÊ≠£Âú®ËøêË°å„ÄÇ</li>
</ul>
</li>
<li><strong>Process reads its arguments and environmentÁ®ãÂ∫è‰ºöËØªÂèñÂÖ∂ÂèÇÊï∞ÂíåÁéØÂ¢ÉÂèòÈáè„ÄÇ</strong></li>
</ol>
<ul>
<li>
<p>The <code>int main(int argc, void **argv, void **envp);</code> function will take in three arguments:</p>
<ul>
<li><code>argc</code>: the loaded objects (binaries and libraries)Âä†ËΩΩÁöÑÂØπË±°Ôºà‰∫åËøõÂà∂Êñá‰ª∂ÂíåÂ∫ìÊñá‰ª∂Ôºâ</li>
<li><code>argv</code>: command-line arguments in argvargv ‰∏≠ÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞</li>
<li><code>envp</code>: environment variables<code>envp</code>¬†Ôºö ÁéØÂ¢ÉÂèòÈáè</li>
</ul>
<p>Ëøô‰∏™ `b0` ÂáΩÊï∞Â∞ÜÊé•Âèó‰∏â‰∏™ÂèÇÊï∞Ôºö</p>
</li>
</ul>
<ol start="6">
<li><strong>Process executes ÊµÅÁ®ãÊâßË°å</strong></li>
</ol>
<ul>
<li>To interact with the operating system(OS), the process will use system calls‰∏∫‰∫Ü‰∏éÊìç‰ΩúÁ≥ªÁªüÔºàOSÔºâËøõË°å‰∫§‰∫íÔºåËøõÁ®ãÂ∞Ü‰ΩøÁî®Á≥ªÁªüË∞ÉÁî®„ÄÇ</li>
<li>For the OS to communicate with the process, signals are used Êìç‰ΩúÁ≥ªÁªüÈÄöËøá‰ø°Âè∑‰∏éËøõÁ®ãËøõË°åÈÄö‰ø°„ÄÇ
<ul>
<li>Signals will pause process execution and invoke the handler (functions that take in the signal number) ‰ø°Âè∑‰ºöÊöÇÂÅúËøõÁ®ãÁöÑÊâßË°åÔºåÂπ∂Ë∞ÉÁî®Â§ÑÁêÜÁ®ãÂ∫èÔºàÂç≥Êé•Êî∂‰ø°Âè∑Âè∑Á†ÅÁöÑÂáΩÊï∞Ôºâ„ÄÇ
<ul>
<li>If the signal has no handler, the default action is to kill the process</li>
</ul>
</li>
</ul>
</li>
<li>Another method of outside interaction is by sharing memory with other processes
<ul>
<li>This requires an initial system call, but then is self sustaining</li>
<li>One way is to use a shared memory-mapped file in /dev/shm</li>
</ul>
</li>
</ul>
<ol start="7">
<li><strong>Process terminates ËøõÁ®ãÁªàÊ≠¢</strong></li>
</ol>
<ul>
<li>Only two ways a process can terminate:
<ul>
<li>Receive an unhandled signal</li>
<li>Calling the <code>exit()</code> system call</li>
</ul>
</li>
<li>After termination, processes must be ‚Äúreaped‚Äù
<ul>
<li>A process will remain in a zombie state and take up memory until the <code>wait()</code> function is called by their parent</li>
<li>This will return the process‚Äôs exit code to the parent and then the process will be freed
<ul>
<li>If this does not happen, the process is re-parented to PID 1 and will remain there until cleaned up</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="useful-commands-viewing-processes"><a class="markdownIt-Anchor" href="#useful-commands-viewing-processes"></a> Useful Commands (Viewing Processes):</h3>
<ul>
<li><code>readelf -a fileName | grep interpret</code>: will return the specific loader being used to load the fileÂ∞Ü‰ºöËøîÂõûÁî®‰∫éÂä†ËΩΩËØ•Êñá‰ª∂ÁöÑÁâπÂÆöÂä†ËΩΩÂô®„ÄÇ</li>
<li><code>patchelf --set-interpreter /some/interpreter ./fileName</code>: will forcibly set the interpreter for a provided file[b0] ‰ºöÂº∫Âà∂‰∏∫ÊåáÂÆöÊñá‰ª∂ËÆæÁΩÆËß£ÈáäÂô®„ÄÇ</li>
<li><code>ldd ./fileName</code>: will list the libraries necessary for the file to run, including the interpreterÂÆÉ‰ºöÂàóÂá∫ËØ•Êñá‰ª∂ËøêË°åÊâÄÈúÄÁöÑÂ∫ìÔºåÂåÖÊã¨Ëß£ÈáäÂô®„ÄÇ</li>
<li><code>strace ./executable uncompiledFile</code>: will ‚Äútrace‚Äù out all of the system calls from when the process is first created to when its terminatedÂÆÉ‰ºöËøΩË∏™ËØ•ËøõÁ®ã‰ªéÂàõÂª∫Âà∞ÁªàÊ≠¢ÊúüÈó¥ÁöÑÊâÄÊúâÁ≥ªÁªüË∞ÉÁî®„ÄÇ</li>
<li><code>./executable /proc/self/maps</code>: will show the virtual memory storage layout for the executableÂÆÉÂ∞ÜÂ±ïÁ§∫ÂèØÊâßË°åÊñá‰ª∂ÁöÑËôöÊãüÂÜÖÂ≠òÂ≠òÂÇ®Â∏ÉÂ±Ä„ÄÇ</li>
<li><code>man 2 open</code>: documentation for all the different system callsÊâÄÊúâÁ≥ªÁªüË∞ÉÁî®ÁöÑÊñáÊ°£</li>
<li><code>du -sb programFile</code>: will output how many bytes a file is`<code>du -sb programFile</code>¬†` ‰ºöËæìÂá∫Êñá‰ª∂ÁöÑÂ§ßÂ∞èÔºà‰ª•Â≠óËäÇ‰∏∫Âçï‰ΩçÔºâ„ÄÇ</li>
</ul>
<h2 id="sources"><a class="markdownIt-Anchor" href="#sources"></a> Sources:</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://pwn.college/modules/interaction">pwn.college Module 1 Lecturespwn.college Á¨¨‰∏ÄÊ®°ÂùóËØæÁ®ã</a></li>
<li><a target="_blank" rel="noopener" href="https://dojo.pwn.college/challenges/interaction">pwn.college Module 1 Challengespwn.college Á¨¨‰∏ÄÊ®°ÂùóÊåëÊàò</a></li>
<li><a target="_blank" rel="noopener" href="https://www.twitch.tv/pwncollege">pwn.college Class Twitch StreamsÈ´òÊ†°ÈªëÂÆ¢Â≠¶Èô¢ Twitch Áõ¥Êí≠ËØæÁ®ã</a></li>
</ul>
<h1 id="challenges"><a class="markdownIt-Anchor" href="#challenges"></a> Challenges</h1>
<h2 id="program-interaction"><a class="markdownIt-Anchor" href="#program-interaction"></a> Program Interaction</h2>
<p>Ëøô‰∏ÄÈÉ®ÂàÜ‰∏ªË¶ÅÊ∂âÂèäÂà∞Âü∫Êú¨ÁöÑÁ®ãÂ∫è‰∫§‰∫íÊñπÊ≥ïÔºåÂåÖÊã¨linuxÁéØÂ¢É‰∏ãËøêË°åÁ®ãÂ∫è‰∏Ä‰∫õÂü∫Êú¨ÊñπÊ≥ïÂíåÁü•ËØÜÔºåÈô§Ê≠§‰ª•Â§ñ‰πüÊïô‰∫Ü‰∏Ä‰∫õÂü∫Êú¨ÁöÑshellËÑöÊú¨„ÄÅpythonËÑöÊú¨„ÄÅcËØ≠Ë®ÄÁ≠âÁü•ËØÜ</p>
<p>embryoio  ËÉöËÉéÈöæÂ∫¶  <s>ÁúüÁöÑÊòØËøôÊ†∑Âêó</s></p>
<h3 id="level1"><a class="markdownIt-Anchor" href="#level1"></a> level1</h3>
<p>Êó†ÂØÜÁ†ÅÁõ¥Êé•ËøêË°å</p>
<h3 id="level2"><a class="markdownIt-Anchor" href="#level2"></a> level2</h3>
<p>ÊúâÂØÜÁ†ÅÔºåÊèêÁ§∫‰∏äÂÜô‰∫Ü</p>
<h3 id="level3"><a class="markdownIt-Anchor" href="#level3"></a> level3</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./embryoio_level3 suvobmbtle<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>env</code> ÂëΩ‰ª§‰∏ªË¶ÅÁî®‰∫éÊòæÁ§∫ÊàñËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÔºåÂÖ∂Â∏∏ËßÅÁöÑÊåá‰ª§ÂåÖÊã¨Ôºö</p>
<ol>
<li>
<p><strong>ÊòæÁ§∫ÂΩìÂâçÁéØÂ¢ÉÂèòÈáè</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">env<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÂπ∂ËøêË°åÂëΩ‰ª§</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">env VARIABLE_NAME&#x3D;value your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>Ê∏ÖÈô§ÊâÄÊúâÁéØÂ¢ÉÂèòÈáèÂπ∂ËøêË°åÂëΩ‰ª§</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">env -i your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÊòæÁ§∫ÁâπÂÆöÁéØÂ¢ÉÂèòÈáèÁöÑÂÄº</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">env VARIABLE_NAME<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ª•ÈÄóÂè∑ÂàÜÈöîÊòæÁ§∫Â§ö‰∏™ÁéØÂ¢ÉÂèòÈáèÁöÑÂÄº</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">env VARIABLE1,VARIABLE2 your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>ÈÄöËøá<code>-u</code>ÈÄâÈ°πÂà†Èô§ÁâπÂÆöÁöÑÁéØÂ¢ÉÂèòÈáè</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">env -u VARIABLE_NAME your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p><strong>‰ΩøÁî®<code>-i</code>ÈÄâÈ°πÂêØÂä®‰∏Ä‰∏™‰∏çÂåÖÂê´‰ªª‰ΩïÁéØÂ¢ÉÂèòÈáèÁöÑÁéØÂ¢É</strong>Ôºö</p>
<pre class="line-numbers language-none"><code class="language-none">env -i your_command_here<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ol>
<h3 id="level4"><a class="markdownIt-Anchor" href="#level4"></a> level4</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">env</span> <span class="token parameter variable">-i</span> <span class="token assign-left variable">gizpoq</span><span class="token operator">=</span>tkikjioeyj ./embryoio_level4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level7"><a class="markdownIt-Anchor" href="#level7"></a> level7</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">env</span> <span class="token parameter variable">-i</span> ./embryoio_level7<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level5"><a class="markdownIt-Anchor" href="#level5"></a> level5</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-interaction~level5:/challenge$ <span class="token builtin class-name">echo</span> <span class="token string">"hxhxyvux"</span> <span class="token operator">></span> /tmp/cwxhwa
hacker@program-interaction~level5:/challenge$ ./embryoio_level5 <span class="token operator">&lt;</span> /tmp/cwxhwa
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level6"><a class="markdownIt-Anchor" href="#level6"></a> level6</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-interaction~level6:/challenge$ ./embryoio_level6 <span class="token operator">></span> /tmp/tzdetd
hacker@program-interaction~level6:/challenge$ <span class="token function">cat</span> /tmp/tzdetd <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level8"><a class="markdownIt-Anchor" href="#level8"></a> level8</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"/challenge/embryoio_level8"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level9"><a class="markdownIt-Anchor" href="#level9"></a> level9</h3>
<p>Âêå‰∏äÔºåÂä†‰∏™ÂØÜÁ†Å‰º†ÂèÇ</p>
<h3 id="level10"><a class="markdownIt-Anchor" href="#level10"></a> level10</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"./embryoio_level10 xolzrhbfsw"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> my_script.sh
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level11"><a class="markdownIt-Anchor" href="#level11"></a> level11</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"env -i huawoi=hzrutrkycu ./embryoio_level11"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level12"><a class="markdownIt-Anchor" href="#level12"></a> level12</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker@program-interaction~level12:/challenge$ <span class="token builtin class-name">echo</span> <span class="token string">"bczijbap"</span> <span class="token operator">></span> /tmp/kzgaox
hacker@program-interaction~level12:/challenge$ <span class="token builtin class-name">echo</span> <span class="token string">"./embryoio_level12 &lt; /tmp/kzgaox"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level13"><a class="markdownIt-Anchor" href="#level13"></a> level13</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"./embryoio_level13 > /tmp/xtnsry"</span> <span class="token operator">></span>/tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span><span class="token function">cat</span> /tmp/xtnsry
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level14"><a class="markdownIt-Anchor" href="#level14"></a> level14</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"env -i  ./embryoio_level14"</span> <span class="token operator">></span> /tmp/my_script.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> /tmp/my_script.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level15"><a class="markdownIt-Anchor" href="#level15"></a> level15</h3>
<p>Python‰∏≠ËøêË°åÁ®ãÂ∫èÊó∂ÔºåÊúâÂá†ÁßçÂ∏∏ËßÅÁöÑÊñπÊ≥ï</p>
<ol>
<li>
<p><strong>‰ΩøÁî®subprocessÊ®°Âùó</strong>ÔºöÈÄöËøásubprocessÊ®°ÂùóÂèØ‰ª•Âú®Python‰∏≠ÊâßË°åÂ§ñÈÉ®ÂëΩ‰ª§ÂíåÁ®ãÂ∫è„ÄÇÂèØ‰ª•‰ΩøÁî®<code>subprocess.run()</code>ÂáΩÊï∞Êù•ÊâßË°åÁ®ãÂ∫èÔºåËøòÂèØ‰ª•‰ΩøÁî®<code>subprocess.Popen()</code>Êù•Ëé∑ÂæóÊõ¥Â§öÊéßÂà∂ÂíåÁÅµÊ¥ªÊÄß„ÄÇ</p>
<p>Ë¶ÅÂú®Python‰∏≠ÊâßË°å‰∏Ä‰∏™Êñá‰ª∂Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁî®<code>subprocess</code>Ê®°Âùó‰∏≠ÁöÑ<code>run</code>ÂáΩÊï∞„ÄÇËøô‰∏™ÂáΩÊï∞ÂÖÅËÆ∏‰Ω†ËøêË°åÂ§ñÈÉ®ÂëΩ‰ª§ÔºåÂπ∂Á≠âÂæÖÂÆÉÂÆåÊàê„ÄÇ‰ª•‰∏ãÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÁ§∫‰æãÔºåÊºîÁ§∫Â¶Ç‰Ωï‰ΩøÁî®PythonÊù•ÊâßË°å‰∏Ä‰∏™Âêç‰∏∫<code>script.py</code>ÁöÑPythonËÑöÊú¨Êñá‰ª∂Ôºö</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># ÊåáÂÆöË¶ÅÊâßË°åÁöÑÊñá‰ª∂Âêç</span>
filename <span class="token operator">=</span> <span class="token string">"script.py"</span>

<span class="token comment"># ÊâßË°åÊñá‰ª∂</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"python"</span><span class="token punctuation">,</span> filename<span class="token punctuation">]</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> subprocess<span class="token punctuation">.</span>CalledProcessError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ÊâßË°åÊñá‰ª∂Êó∂Âá∫Èîô:"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ËøôÂ∞ÜËøêË°åÂêç‰∏∫<code>script.py</code>ÁöÑPythonËÑöÊú¨„ÄÇÂ¶ÇÊûúÂ∏åÊúõ‰º†ÈÄíÂèÇÊï∞ÁªôËÑöÊú¨ÔºåÂèØ‰ª•Âú®<code>subprocess.run</code>‰∏≠ÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞‰∏≠Ê∑ªÂä†È¢ùÂ§ñÁöÑÂèÇÊï∞„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûúË¶Å‰º†ÈÄí‰∏Ä‰∏™Âêç‰∏∫<code>arg1</code>ÁöÑÂèÇÊï∞ÔºåÂèØ‰ª•ËøôÊ†∑ÂÅöÔºö</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"python"</span><span class="token punctuation">,</span> filename<span class="token punctuation">,</span> <span class="token string">"arg1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ëøô‰ºöÂ∞Ü<code>arg1</code>‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíÁªô<code>script.py</code>ËÑöÊú¨„ÄÇ</p>
</li>
<li>
<p><strong>‰ΩøÁî®execËØ≠Âè•</strong>Ôºö‰ΩøÁî®<code>exec</code>ËØ≠Âè•ÂèØ‰ª•Âú®ÂΩìÂâçPythonËøõÁ®ã‰∏≠ÊâßË°åÂè¶‰∏Ä‰∏™PythonÊñá‰ª∂„ÄÇ‰ΩÜÊòØË¶ÅÊ≥®ÊÑèÔºåÂÆÉ‰ºöÊîπÂèòÂΩìÂâçËøõÁ®ãÁöÑÁä∂ÊÄÅÔºåÂåÖÊã¨ÂèòÈáè„ÄÅÂáΩÊï∞Á≠â„ÄÇ</p>
</li>
<li>
<p><strong>‰ΩøÁî®importËØ≠Âè•</strong>Ôºö‰Ω†ÂèØ‰ª•‰ΩøÁî®<code>import</code>ËØ≠Âè•Êù•ÂØºÂÖ•‰∏Ä‰∏™PythonÊñá‰ª∂‰Ωú‰∏∫Ê®°ÂùóÔºåÁÑ∂ÂêéË∞ÉÁî®ÂÆÉÁöÑÂáΩÊï∞ÊàñËÄÖÊâßË°åÂÖ∂‰∏≠ÁöÑ‰ª£Á†Å„ÄÇËøôÁßçÊñπÊ≥ïÊõ¥ÂÆâÂÖ®ÔºåÂõ†‰∏∫ÂÆÉ‰ºöÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂëΩÂêçÁ©∫Èó¥Ôºå‰∏ç‰ºöÁõ¥Êé•‰øÆÊîπÂΩìÂâçËøõÁ®ãÁöÑÁä∂ÊÄÅ„ÄÇ</p>
</li>
<li>
<p><strong>‰ΩøÁî®os.system()ÂáΩÊï∞</strong>ÔºöosÊ®°ÂùóÊèê‰æõ‰∫Ü‰∏Ä‰∏™<code>system()</code>ÂáΩÊï∞ÔºåÂÆÉÂèØ‰ª•Âú®Êìç‰ΩúÁ≥ªÁªüÁ∫ßÂà´ÊâßË°åÂëΩ‰ª§„ÄÇ‰ΩÜÊòØËøô‰∏™ÊñπÊ≥ï‰∏çÂ§üÁÅµÊ¥ªÔºåÂπ∂‰∏îÂÆπÊòìÂèóÂà∞Êìç‰ΩúÁ≥ªÁªüÈôêÂà∂„ÄÇ</p>
</li>
<li>
<p><strong>‰ΩøÁî®eval()ÂáΩÊï∞</strong>ÔºöËôΩÁÑ∂‰∏çÊé®ËçêÔºå‰ΩÜ‰Ω†‰πüÂèØ‰ª•‰ΩøÁî®<code>eval()</code>ÂáΩÊï∞Êù•ÊâßË°åPython‰ª£Á†ÅÂ≠óÁ¨¶‰∏≤„ÄÇËøôÁßçÊñπÊ≥ïÊΩúÂú®ÁöÑÂÆâÂÖ®È£éÈô©ÂæàÈ´òÔºåÂ∫îËØ•Â∞ΩÈáèÈÅøÂÖç‰ΩøÁî®„ÄÇ</p>
</li>
<li>
<p><strong>‰ΩøÁî®execfile()ÂáΩÊï∞</strong>ÔºöÂú®Python 2‰∏≠Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁî®<code>execfile()</code>ÂáΩÊï∞ÊâßË°å‰∏Ä‰∏™PythonÊñá‰ª∂„ÄÇ‰ΩÜÊòØÂú®Python 3‰∏≠Â∑≤ÁªèÁßªÈô§‰∫ÜËøô‰∏™ÂáΩÊï∞„ÄÇ</p>
</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token function">import</span> os

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: os.system<span class="token punctuation">(</span><span class="token string">"./embryoio_level15"</span><span class="token punctuation">)</span>
WELCOME<span class="token operator">!</span> This challenge makes the following asks of you:
- the challenge checks <span class="token keyword">for</span> a specific parent process <span class="token builtin class-name">:</span> ipython

ONWARDS TO GREATNESS<span class="token operator">!</span>

<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> This challenge will now perform a bunch of checks.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> If you pass these checks, you will receive the flag.
<span class="token punctuation">[</span>TEST<span class="token punctuation">]</span> Performing checks on the parent process of this process.
<span class="token punctuation">[</span>TEST<span class="token punctuation">]</span> We will now check that that the process is an interactive ipython instance.

<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> Since ipython runs as a script inside python, this will check a few things:
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> <span class="token number">1</span>. That the process itself is python.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> <span class="token number">2</span>. That the module being run <span class="token keyword">in</span> python is ipython.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> If the process being checked is just a normal <span class="token string">'ipython'</span>, you<span class="token string">'ll be okay!

[INFO] The process'</span> executable is /usr/bin/dash.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> This might be different than expected because of symbolic links <span class="token punctuation">(</span>for example, from /usr/bin/python to /usr/bin/python3 to /usr/bin/python3.8<span class="token punctuation">)</span>.
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> To pass the checks, the executable must be python3.8.
<span class="token punctuation">[</span>FAIL<span class="token punctuation">]</span> You did not satisfy all the execution requirements.
<span class="token punctuation">[</span>FAIL<span class="token punctuation">]</span> Specifically, you must fix the following issue:
<span class="token punctuation">[</span>FAIL<span class="token punctuation">]</span>    Executable must be <span class="token string">'python'</span><span class="token builtin class-name">.</span> Yours is: dash
Out<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: <span class="token number">512</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Â∞ùËØï<code>os</code>‰∏çË°åÔºåÂõ†‰∏∫<code>os</code>Ê®°ÂùóËøòÊòØË∞ÉÁî®ÁöÑ<code>dash</code>Êù•ÊâßË°åÁöÑ</p>
<p>ÂèëÁé∞Áî®<code>subprocess</code>ÂèØ‰ª•</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./embryoio_level15"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level16"><a class="markdownIt-Anchor" href="#level16"></a> level16</h3>
<p>Âêå‰∏äÔºåËøêË°åÂêéÂÜçËæìÂÖ•ÂØÜÁ†ÅÂç≥ÂèØ</p>
<h3 id="level17"><a class="markdownIt-Anchor" href="#level17"></a> level17</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./embryoio_level17"</span><span class="token punctuation">,</span><span class="token string">"jduimogzro"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level18"><a class="markdownIt-Anchor" href="#level18"></a> level18</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> subprocess

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"env"</span><span class="token punctuation">,</span><span class="token string">"-i"</span><span class="token punctuation">,</span><span class="token string">"uaznno=hqbclqnobf"</span><span class="token punctuation">,</span><span class="token string">"./embryoio_level18"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="level19"><a class="markdownIt-Anchor" href="#level19"></a> level19</h3>
<p>ËøôÈáåÈúÄË¶ÅËØ¶ÁªÜ‰∫ÜËß£‰∏Ä‰∏ãÔºåÂ¶Ç‰ΩïÁî®<code>subprocess.run</code>ËøõË°åÈáçÂÆöÂêë</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/python3-subprocess.html">Python3 subprocess | ËèúÈ∏üÊïôÁ®ã (runoob.com)</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> cwd<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> env<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> universal_newlines<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>argsÔºöË°®Á§∫Ë¶ÅÊâßË°åÁöÑÂëΩ‰ª§„ÄÇÂøÖÈ°ªÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂ≠óÁ¨¶‰∏≤ÂèÇÊï∞ÂàóË°®„ÄÇ</li>
<li>stdin„ÄÅstdout Âíå stderrÔºöÂ≠êËøõÁ®ãÁöÑÊ†áÂáÜËæìÂÖ•„ÄÅËæìÂá∫ÂíåÈîôËØØ„ÄÇÂÖ∂ÂÄºÂèØ‰ª•ÊòØ subprocess.PIPE„ÄÅsubprocess.DEVNULL„ÄÅ‰∏Ä‰∏™Â∑≤ÁªèÂ≠òÂú®ÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶„ÄÅÂ∑≤ÁªèÊâìÂºÄÁöÑÊñá‰ª∂ÂØπË±°ÊàñËÄÖ None„ÄÇsubprocess.PIPE Ë°®Á§∫‰∏∫Â≠êËøõÁ®ãÂàõÂª∫Êñ∞ÁöÑÁÆ°ÈÅì„ÄÇsubprocess.DEVNULL Ë°®Á§∫‰ΩøÁî® os.devnull„ÄÇÈªòËÆ§‰ΩøÁî®ÁöÑÊòØ NoneÔºåË°®Á§∫‰ªÄ‰πàÈÉΩ‰∏çÂÅö„ÄÇÂè¶Â§ñÔºåstderr ÂèØ‰ª•ÂêàÂπ∂Âà∞ stdout Èáå‰∏ÄËµ∑ËæìÂá∫„ÄÇ</li>
<li>timeoutÔºöËÆæÁΩÆÂëΩ‰ª§Ë∂ÖÊó∂Êó∂Èó¥„ÄÇÂ¶ÇÊûúÂëΩ‰ª§ÊâßË°åÊó∂Èó¥Ë∂ÖÊó∂ÔºåÂ≠êËøõÁ®ãÂ∞ÜË¢´ÊùÄÊ≠ªÔºåÂπ∂ÂºπÂá∫ TimeoutExpired ÂºÇÂ∏∏„ÄÇ</li>
<li>checkÔºöÂ¶ÇÊûúËØ•ÂèÇÊï∞ËÆæÁΩÆ‰∏∫ TrueÔºåÂπ∂‰∏îËøõÁ®ãÈÄÄÂá∫Áä∂ÊÄÅÁ†Å‰∏çÊòØ 0ÔºåÂàôÂºπ Âá∫ CalledProcessError ÂºÇÂ∏∏„ÄÇ</li>
<li>encoding: Â¶ÇÊûúÊåáÂÆö‰∫ÜËØ•ÂèÇÊï∞ÔºåÂàô stdin„ÄÅstdout Âíå stderr ÂèØ‰ª•Êé•Êî∂Â≠óÁ¨¶‰∏≤Êï∞ÊçÆÔºåÂπ∂‰ª•ËØ•ÁºñÁ†ÅÊñπÂºèÁºñÁ†Å„ÄÇÂê¶ÂàôÂè™Êé•Êî∂ bytes Á±ªÂûãÁöÑÊï∞ÊçÆ„ÄÇ</li>
<li>shellÔºöÂ¶ÇÊûúËØ•ÂèÇÊï∞‰∏∫ TrueÔºåÂ∞ÜÈÄöËøáÊìç‰ΩúÁ≥ªÁªüÁöÑ shell ÊâßË°åÊåáÂÆöÁöÑÂëΩ‰ª§„ÄÇ</li>
<li>input:Á®ãÂ∫èËøêË°åÂêéÁöÑ‰∫§‰∫íËæìÂÖ•  Ê≥®ÊÑè‰∏éstdinÂå∫ÂàÜ</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># ÂÆö‰πâÂëΩ‰ª§ÂèäÂÖ∂ÂèÇÊï∞</span>
command <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level19"</span><span class="token punctuation">]</span>

<span class="token comment"># ÊâìÂºÄËæìÂÖ•Êñá‰ª∂Âπ∂ËØªÂèñÊï∞ÊçÆ</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/tmp/xhekoe"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    input_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># ‰ΩøÁî®subprocess.run()ÊâßË°åÂëΩ‰ª§Âπ∂ÈáçÂÆöÂêëËæìÂÖ•</span>
result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token operator">=</span>input_data<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>

<span class="token comment"># ÊâìÂç∞ËæìÂá∫ÁªìÊûú</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"stdout:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"stderr:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>stderr<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÁÑ∂ËÄåÊèêÁ§∫</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>ADVICE<span class="token punctuation">]</span> File descriptors are inherited from the parent, unless the FD_CLOEXEC is <span class="token builtin class-name">set</span> by the parent on the <span class="token function">file</span> descriptor.
<span class="token punctuation">[</span>ADVICE<span class="token punctuation">]</span> For security reasons, some programs, such as python, <span class="token keyword">do</span> this by default <span class="token keyword">in</span> certain cases. Be careful <span class="token keyword">if</span> you are
<span class="token punctuation">[</span>ADVICE<span class="token punctuation">]</span> creating and trying to pass <span class="token keyword">in</span> FDs <span class="token keyword">in</span> python.
<span class="token punctuation">[</span>FAIL<span class="token punctuation">]</span> You did not satisfy all the execution requirements.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># ÂÆö‰πâÂëΩ‰ª§ÂèäÂÖ∂ÂèÇÊï∞</span>
command <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level19"</span><span class="token punctuation">]</span>

<span class="token comment"># ÊâìÂºÄËæìÂÖ•Êñá‰ª∂Âπ∂ËØªÂèñÊï∞ÊçÆ</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/tmp/xhekoe"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>

<span class="token comment"># ‰ΩøÁî®subprocess.run()ÊâßË°åÂëΩ‰ª§Âπ∂ÈáçÂÆöÂêëËæìÂÖ•</span>
    result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>command<span class="token punctuation">,</span> stdin<span class="token operator">=</span>f<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>

<span class="token comment"># ÊâìÂç∞ËæìÂá∫ÁªìÊûú</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"stdout:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"stderr:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰∫ãÂÆû‰∏äÂøÖÈ°ªË¶ÅÁî®<code>stdin</code>‰º†ÂÖ•,‰∏§ËÄÖÊòØÊúâÂå∫Âà´ÁöÑ:</p>
<p>Âú®LinuxÁ≥ªÁªü‰∏≠ÔºåÊ†áÂáÜËæìÂÖ•ÊµÅÔºàstdinÔºâÊòØÊåáÂêëÁªàÁ´ØÔºàÈÄöÂ∏∏ÊòØÈîÆÁõòÔºâÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶„ÄÇÂΩì‰Ω†Âú®ÁªàÁ´Ø‰∏äÈîÆÂÖ•Êï∞ÊçÆÊó∂ÔºåËøô‰∫õÊï∞ÊçÆË¢´ÂèëÈÄÅÂà∞Ê≠£Âú®ËøêË°åÁöÑÁ®ãÂ∫èÁöÑÊ†áÂáÜËæìÂÖ•ÊµÅ‰∏≠„ÄÇ</p>
<p><code>FD_CLOEXEC</code> ÊòØ‰∏Ä‰∏™Â∏∏ÈáèÔºåÈÄöÂ∏∏Âú®Êìç‰ΩúÁ≥ªÁªü‰∏≠Áî®‰∫éÊñá‰ª∂ÊèèËø∞Á¨¶Ôºàfile descriptorÔºâ„ÄÇÂÆÉÊòØÊñá‰ª∂ÊèèËø∞Á¨¶Ê†áÂøó‰πã‰∏ÄÔºåÁî®‰∫éÊåáÁ§∫ÂΩìÊâßË°å <code>exec</code> Á≥ªÂàóÂáΩÊï∞Êó∂ÔºåÊñá‰ª∂ÊèèËø∞Á¨¶ÊòØÂê¶Â∫îËØ•ÂÖ≥Èó≠„ÄÇ</p>
<ol>
<li><strong>input ÂèÇÊï∞</strong>Ôºö
<ul>
<li><code>input</code> ÂèÇÊï∞ÊòØ‰∏Ä‰∏™Â≠óËäÇ‰∏≤ÔºàbytesÔºâÊàñËÄÖ None„ÄÇ</li>
<li>Â¶ÇÊûúÊåáÂÆö‰∫Ü <code>input</code> ÂèÇÊï∞‰∏î‰∏ç‰∏∫ NoneÔºåÈÇ£‰πàÂÆÉ‰ºö‰Ωú‰∏∫Â≠êËøõÁ®ãÁöÑÊ†áÂáÜËæìÂÖ•„ÄÇ</li>
<li>Â¶ÇÊûú <code>input</code> ÂèÇÊï∞‰∏∫ NoneÔºàÈªòËÆ§ÊÉÖÂÜµÔºâÔºåÂàôÂ≠êËøõÁ®ãÁöÑÊ†áÂáÜËæìÂÖ•‰∏∫Á©∫„ÄÇ</li>
<li>ÂΩì‰Ω†Êúâ‰∏Ä‰∏™Â≠óËäÇ‰∏≤Êï∞ÊçÆÈúÄË¶Å‰º†ÈÄíÁªôÂ≠êËøõÁ®ã‰Ωú‰∏∫Ê†áÂáÜËæìÂÖ•Êó∂ÔºåÂèØ‰ª•‰ΩøÁî® <code>input</code> ÂèÇÊï∞„ÄÇ</li>
</ul>
</li>
<li><strong>stdin ÂèÇÊï∞</strong>Ôºö
<ul>
<li><code>stdin</code> ÂèÇÊï∞ÊòØ‰∏Ä‰∏™Êñá‰ª∂ÂØπË±°ÊàñËÄÖ‰∏Ä‰∏™Êñá‰ª∂ÊèèËø∞Á¨¶„ÄÇ</li>
<li>Â¶ÇÊûúÊåáÂÆö‰∫Ü <code>stdin</code> ÂèÇÊï∞ÔºåÈÇ£‰πàÂÆÉ‰ºö‰Ωú‰∏∫Â≠êËøõÁ®ãÁöÑÊ†áÂáÜËæìÂÖ•„ÄÇ</li>
<li>Â¶ÇÊûú <code>stdin</code> ÂèÇÊï∞‰∏∫ NoneÔºàÈªòËÆ§ÊÉÖÂÜµÔºâÔºåÂàôÂ≠êËøõÁ®ãÁöÑÊ†áÂáÜËæìÂÖ•Â∞Ü‰ºö‰ªé <code>/dev/null</code> ‰∏≠ËØªÂèñÁ©∫Êï∞ÊçÆ„ÄÇ</li>
<li>ÂΩì‰Ω†Â∑≤ÁªèÊúâ‰∏Ä‰∏™Â∑≤ÁªèÊâìÂºÄÁöÑÊñá‰ª∂ÂØπË±°ÊàñËÄÖÊñá‰ª∂ÊèèËø∞Á¨¶ÔºåÊÉ≥Ë¶ÅÂ∞ÜÂÖ∂‰º†ÈÄíÁªôÂ≠êËøõÁ®ã‰Ωú‰∏∫Ê†áÂáÜËæìÂÖ•Êó∂ÔºåÂèØ‰ª•‰ΩøÁî® <code>stdin</code> ÂèÇÊï∞</li>
</ul>
</li>
</ol>
<p>Ê†πÊçÆÊèêÁ§∫Ôºå<code>input</code>‰∏ç‰ºö‰º†ÈÄí<code>FD_CLOEXEC</code>ËÄå<code>stdin</code>Âàô‰ºö‰º†ÈÄí<code>FD_CLOEXEC</code></p>
<p>ÂΩìÁÑ∂Êàë‰ª¨ËøôÈ¢òÂåÖÂê´Â∫ìÊñá‰ª∂ÂèØ‰ª•ÂæàÂ•ΩÁöÑËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºå‰∫ãÂÆû‰∏äÈ¢òÁõÆÂèØËÉΩÊòØË¶ÅË¶ÅÊ±ÇÊàë‰ª¨ÊâãÊêì,<s>Êàë‰ª¨Áî®ËΩÆÂ≠êÁªïËøá‰∫ÜËøô‰∏Ä‰∏™ËøáÁ®ã</s></p>
<p>ÊâãÊêì‰∏Ä‰∏™ËØïËØï</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">run_program_with_input</span><span class="token punctuation">(</span>program_path<span class="token punctuation">,</span> input_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># ÊâìÂºÄËæìÂÖ•Êñá‰ª∂</span>
    input_fd <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> os<span class="token punctuation">.</span>O_RDONLY<span class="token punctuation">)</span>
    
    <span class="token comment"># ÂàõÂª∫Â≠êËøõÁ®ã</span>
    pid <span class="token operator">=</span> os<span class="token punctuation">.</span>fork<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> pid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># Â≠êËøõÁ®ã</span>
        <span class="token comment"># ÈáçÂÆöÂêëÂ≠êËøõÁ®ãÁöÑÊ†áÂáÜËæìÂÖ•Âà∞ËæìÂÖ•Êñá‰ª∂</span>
        os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>input_fd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        
        <span class="token comment"># ÊâßË°åÂ§ñÈÉ®Á®ãÂ∫è</span>
        os<span class="token punctuation">.</span>execl<span class="token punctuation">(</span>program_path<span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>program_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># Áà∂ËøõÁ®ã</span>
        <span class="token comment"># Á≠âÂæÖÂ≠êËøõÁ®ãÁªìÊùü</span>
        os<span class="token punctuation">.</span>waitpid<span class="token punctuation">(</span>pid<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        
        <span class="token comment"># ÂÖ≥Èó≠Êñá‰ª∂ÊèèËø∞Á¨¶</span>
        os<span class="token punctuation">.</span>close<span class="token punctuation">(</span>input_fd<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    program_path <span class="token operator">=</span> <span class="token string">"./your_program"</span>
    input_file <span class="token operator">=</span> <span class="token string">"./input.txt"</span>
    run_program_with_input<span class="token punctuation">(</span>program_path<span class="token punctuation">,</span> input_file<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level20"><a class="markdownIt-Anchor" href="#level20"></a> level20</h3>
<p>Êúâ‰∫Ü‰∏äÈ¢òÁöÑÁªèÈ™å</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># ÊâìÂºÄÂπ∂ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/tmp/rfqbmu'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
<span class="token comment"># Â∞ÜÊñá‰ª∂ÂÜÖÂÆπ‰Ωú‰∏∫ËæìÂÖ•‰º†ÈÄíÁªôÂ≠êËøõÁ®ã</span>
    result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level20'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>f<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÁÑ∂ÂêéÁõ¥Êé•catÂ∞±ÂèØ‰ª•‰∫Ü</p>
<h3 id="level21"><a class="markdownIt-Anchor" href="#level21"></a> level21</h3>
<p><code>subprocess.run(['env','-i','/challenge/embryoio_level21'])</code></p>
<h3 id="level22"><a class="markdownIt-Anchor" href="#level22"></a> level22</h3>
<p>mdÔºåÂèàÊù•‰∏ÄËΩÆÔºåÊää‰∏äÈù¢ÁöÑËÑöÊú¨<code>ipython</code>ËøêË°åÊîπ‰∏∫<code>python</code>ËøêË°åÔºåÁúüÊòØÊúç‰∫Ü</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">subprocess.run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'env'</span>,<span class="token string">'-i'</span>,<span class="token string">'/challenge/embryoio_level22'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level23"><a class="markdownIt-Anchor" href="#level23"></a> level23</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">subprocess.run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./embryoio_level23'</span><span class="token punctuation">]</span>,input<span class="token operator">=</span>b<span class="token string">"eyejkdde"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level24"><a class="markdownIt-Anchor" href="#level24"></a> level24</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">subprocess.run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level24'</span>,<span class="token string">"yogjcbumez"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level25"><a class="markdownIt-Anchor" href="#level25"></a> level25</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level25'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>env<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"qpvtwc"</span><span class="token punctuation">:</span><span class="token string">"eghdabuygy"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level26"><a class="markdownIt-Anchor" href="#level26"></a> level26</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/tmp/sjfilu"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>f<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level27"><a class="markdownIt-Anchor" href="#level27"></a> level27</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/tmp/zjvuap"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level27'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>f<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="level28"><a class="markdownIt-Anchor" href="#level28"></a> level28</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'/challenge/embryoio_level28'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>env<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level29"><a class="markdownIt-Anchor" href="#level29"></a> level29</h3>
<p>Áé∞Âú®Âà∞CËØ≠Ë®ÄÁºñÁ®ãÁöÑÁØáÁ´†‰∫Ü</p>
<p>ËøôÈÉ®ÂàÜÂØπlinuxÁ≥ªÁªüËøõÁ®ãÁöÑÂàõÂª∫Ë∞ÉÁî®ÈúÄË¶ÅÁêÜËß£Ê∏ÖÈô§</p>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/difference-fork-exec/#">Difference between fork() and exec() - GeeksforGeeks</a></p>
<p>Âê¨‰∏ÄÈÅçËØæÊÑüËßâËøòÊòØÊî∂Ëé∑ÂæàÂ§ß</p>
<p>È¢òÁõÆË¶ÅÊ±Ç<code>fork</code>ÂºÄÂ≠êËøõÁ®ãÁÑ∂ÂêéË∞ÉÁî®Êñá‰ª∂</p>
<ul>
<li>Âú®Áà∂ËøõÁ®ã‰∏≠Ôºå<code>pid</code> ÁöÑÂÄºÊòØÊñ∞ÂàõÂª∫ÁöÑÂ≠êËøõÁ®ãÁöÑËøõÁ®ã ID„ÄÇËøô‰∏™ÂÄº‰ºöÂ§ß‰∫é 0„ÄÇ</li>
<li>Âú®Â≠êËøõÁ®ã‰∏≠Ôºå<code>pid</code> ÁöÑÂÄºÊòØ 0ÔºåÁî®Êù•Ë°®Á§∫ÂΩìÂâçÊ≠£Âú®ÊâßË°åÁöÑ‰ª£Á†ÅÊòØÂ≠êËøõÁ®ãÈÉ®ÂàÜ„ÄÇ</li>
<li>ÂØπÁà∂ËøõÁ®ãÁöÑÊ£ÄÊµãÈúÄË¶Å‰ΩøÁî®exec()Á≥ªÂàóÁöÑÂáΩÊï∞ÔºåÂõ†‰∏∫system()Êàñpopen()ÂáΩÊï∞ÈÉΩ‰ºöÊâßË°å‰∏Ä‰∏™shellÔºåÁÑ∂ÂêéÁî®shellÊù•ÊâßË°åÔºåÊâÄ‰ª•Ê≠§Êó∂Áà∂ËøõÁ®ã‰∏∫shellÔºàÊµãËØïÂêéÊòØdashÔºâÔºåËÄå‰∏çÊòØ‰Ω†ÁöÑÁ®ãÂ∫è„ÄÇ</li>
<li>ËÄåexec()Âè™ÊòØÊõøÊç¢ÊéâÊ≠£Âú®exec()ÁöÑËøõÁ®ãÔºåÂΩìÁî®fork()ÂáΩÊï∞Êó∂Â≠êËøõÁ®ãË∞ÉÁî®exec()Á≥ªÂàóÂáΩÊï∞ÊùÄÊ≠ªËá™Â∑±ÁöÑÂ≠êËøõÁ®ãÂâØÊú¨ÁöÑÊó∂ÂÄôÂ∞±‰ºöÂª∫Á´ã‰∏éÂΩìÂâç‰∏ªËøõÁ®ãÁöÑÁà∂Â≠êÂÖ≥Á≥ª„ÄÇ</li>
<li>ÂΩì‰∏Ä‰∏™Áà∂‰∫≤ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Â≠©Â≠ê‰ΩÜÊ≤°ÊúâÁ≠âÂÆÉÁªìÊùüÂ∞±Ëá™Â∑±ÁªìÊùüÁöÑËØùÂ∞±ÂèØËÉΩÈÄ†ÊàêÁ≥ªÁªüÂºÇÂ∏∏ÔºåÊü•ËØ¢waitpid()ÁöÑ‰ΩøÁî®Êù•Á≠âÂæÖÂ≠©Â≠êËøõÁ®ã„ÄÇ</li>
</ul>
<p>Âè¶Â§ñÊü•ËØ¢‰∫Ü‰∏Ä‰∏ãÔºåËØ¥ÊòØexecÁ≥ªÁªüË∞ÉÁî®ÔºåÂÆûÈôÖ‰∏äÂú®Linux‰∏≠ÔºåÂπ∂‰∏çÂ≠òÂú®‰∏Ä‰∏™exec()ÁöÑÂáΩÊï∞ÂΩ¢ÂºèÔºåexecÊåáÁöÑÊòØ‰∏ÄÁªÑÂáΩÊï∞Ôºå‰∏ÄÂÖ±Êúâ6‰∏™ÔºåÂàÜÂà´ÊòØÔºö</p>
<pre class="line-numbers language-none"><code class="language-none">#include &lt;unistd.h&gt;
int execl(const char *path, const char *arg, ...);
int execlp(const char *file, const char *arg, ...);
int execle(const char *path, const char *arg, ..., char *const envp[]);
int execv(const char *path, char *const argv[]);
int execvp(const char *file, char *const argv[]);
int execve(const char *path, char *const argv[], char *const envp[]);
const char *filenameÔºöË°®Á§∫Ë¶ÅÊâßË°åÁöÑÁ®ãÂ∫èÁöÑÊñá‰ª∂Ë∑ØÂæÑ„ÄÇËøô‰∏™ÂèÇÊï∞ÊåáÂÆö‰∫ÜË¶ÅÊâßË°åÁöÑÁ®ãÂ∫èÁöÑË∑ØÂæÑ„ÄÇÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÂ∫îËØ•Êèê‰æõÁ®ãÂ∫èÁöÑÁªùÂØπË∑ØÂæÑÔºå‰ª•Á°Æ‰øùÁ≥ªÁªüÂèØ‰ª•ÊâæÂà∞Âπ∂Ê≠£Á°ÆÊâßË°åÁ®ãÂ∫è„ÄÇÂ¶ÇÊûúÁ®ãÂ∫èÂú® PATH ÁéØÂ¢ÉÂèòÈáè‰∏≠ÔºåÂàôÂèØ‰ª•Áõ¥Êé•Êèê‰æõÁ®ãÂ∫èÁöÑÂêçÁß∞„ÄÇ

char *const argv[]ÔºöË°®Á§∫Á®ãÂ∫èÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞ÂàóË°®„ÄÇËøô‰∏™ÂèÇÊï∞ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºåÊØè‰∏™Â≠óÁ¨¶‰∏≤ÈÉΩÊòØ‰∏Ä‰∏™ÂëΩ‰ª§Ë°åÂèÇÊï∞„ÄÇÊï∞ÁªÑÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÈÄöÂ∏∏ÊòØÁ®ãÂ∫èÁöÑÂêçÁß∞ÔºåÂêéÁª≠ÂÖÉÁ¥†ÊòØ‰º†ÈÄíÁªôÁ®ãÂ∫èÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞„ÄÇÊï∞ÁªÑÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÂøÖÈ°ªÊòØ NULLÔºå‰ª•Ë°®Á§∫ÂèÇÊï∞ÂàóË°®ÁöÑÁªìÊùü„ÄÇ

char *const envp[]ÔºöË°®Á§∫Á®ãÂ∫èÁöÑÁéØÂ¢ÉÂèòÈáèÂàóË°®„ÄÇËøô‰∏™ÂèÇÊï∞ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºåÊØè‰∏™Â≠óÁ¨¶‰∏≤ÈÉΩÊòØ‰∏Ä‰∏™ÁéØÂ¢ÉÂèòÈáèËÆæÁΩÆÔºåÊ†ºÂºè‰∏∫ &quot;name&#x3D;value&quot;„ÄÇÊï∞ÁªÑÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†‰πüÂøÖÈ°ªÊòØ NULLÔºå‰ª•Ë°®Á§∫ÁéØÂ¢ÉÂèòÈáèÂàóË°®ÁöÑÁªìÊùü„ÄÇ

‰∏ãÈù¢ÊòØËøô‰∫õÂèÇÊï∞ÁöÑËØ¶ÁªÜËØ¥ÊòéÔºö

filenameÔºöÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÊåáÂÆö‰∫ÜË¶ÅÊâßË°åÁöÑÁ®ãÂ∫èÁöÑË∑ØÂæÑ„ÄÇÂ¶ÇÊûúË∑ØÂæÑÊåáÂêë‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂ÔºåÂàô execve() Â∞ÜÂä†ËΩΩÂπ∂ÊâßË°åËØ•Êñá‰ª∂„ÄÇÊ≥®ÊÑèÔºåexecve() ‰∏ç‰ºöÊü•Êâæ PATH ÁéØÂ¢ÉÂèòÈáè‰∏≠ÊåáÂÆöÁöÑË∑ØÂæÑÔºåÂõ†Ê≠§ÂøÖÈ°ªÊèê‰æõÁªùÂØπË∑ØÂæÑÊàñËÄÖÁõ∏ÂØπË∑ØÂæÑ„ÄÇ

argv[]ÔºöÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºåÁî®‰∫é‰º†ÈÄíÂëΩ‰ª§Ë°åÂèÇÊï∞ÁªôÊñ∞Á®ãÂ∫è„ÄÇÊï∞ÁªÑÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÈÄöÂ∏∏ÊòØÁ®ãÂ∫èÁöÑÂêçÁß∞ÔºåÂêéÁª≠ÂÖÉÁ¥†ÊòØÁ®ãÂ∫èÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞„ÄÇÊï∞ÁªÑÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÂøÖÈ°ªÊòØ NULLÔºå‰ª•Ë°®Á§∫ÂèÇÊï∞ÂàóË°®ÁöÑÁªìÊùü„ÄÇ

envp[]ÔºöÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºåÁî®‰∫é‰º†ÈÄíÁéØÂ¢ÉÂèòÈáèÁªôÊñ∞Á®ãÂ∫è„ÄÇÊØè‰∏™Â≠óÁ¨¶‰∏≤ÈÉΩÊòØ‰∏Ä‰∏™ÁéØÂ¢ÉÂèòÈáèËÆæÁΩÆÔºåÊ†ºÂºè‰∏∫ &quot;name&#x3D;value&quot;„ÄÇÊï∞ÁªÑÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÂøÖÈ°ªÊòØ NULLÔºå‰ª•Ë°®Á§∫ÁéØÂ¢ÉÂèòÈáèÂàóË°®ÁöÑÁªìÊùü„ÄÇ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
‚Äã
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level29"</span><span class="token punctuation">,</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//‰ΩøÁî®execÁ≥ªÂàóÂáΩÊï∞ÊâßË°åÊó∂‰∏ç‰ºöÊîπÂèòÊñ∞ËøõÁ®ãÁöÑÁà∂‰∫≤ÔºåÁõ∏ÂΩì‰∫éÂè™ÊòØÂ∞ÜÂΩìÂâçËøõ>Á®ãÊõøÊç¢Êéâ‰∫Ü</span>
    <span class="token keyword">return</span> <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
‚Äã
    <span class="token comment">//char *argv[]ÊòØ‰∏Ä‰∏™ÊåáÈíàÊï∞ÁªÑÔºåÊåáÂêë‰º†ÂÖ•ÁöÑÂèÇÊï∞ÔºåÊØè‰∏™ÊåáÈíàÈÉΩÊåáÂêë‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
‚Äã
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//fork()ÊâßË°å‰πãÂêéÔºå‰ºöÂ§çÂà∂‰∏Ä‰∏™Âü∫Êú¨‰∏ÄÊ†∑ÁöÑËøõÁ®ã‰Ωú‰∏∫Â≠êËøõÁ®ãÔºåÁÑ∂Âêé‰∏§‰∏™ËøõÁ®ã‰ºöÂàÜÂà´ÊâßË°åÂêéÈù¢ÁöÑ‰ª£Á†Å</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//Â¶ÇÊûúfpid‰∏∫-1ÔºåËØ¥ÊòéforkÂ§±Ë¥•</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error in fork!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ÊàêÂäüÂàô‰ºöÂá∫Áé∞‰∏§‰∏™ËøõÁ®ãÔºåfpid==0ÁöÑÊòØÂ≠êËøõÁ®ã</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ÊàëÊòØÂ≠êËøõÁ®ã\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//fpid==1ÁöÑÊòØÁà∂ËøõÁ®ã</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ÊàëÊòØÁà∂ËøõÁ®ã\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Á≠âÂæÖÂ≠êËøõÁ®ãÁªìÊùü</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂºÑÊáÇ‰∫ÜÂü∫Êú¨ÂéüÁêÜÂêé</p>
<p>ÂÜôÂá∫‰∏Ä‰∏™ÁÆÄÂçïÁöÑËøêË°åÁ®ãÂ∫è</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level29"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level29"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level30"><a class="markdownIt-Anchor" href="#level30"></a> level30</h3>
<p>Âêå‰∏äÂ§ö‰∏™ÂØÜÁ†Å‰º†ÂèÇ</p>
<h3 id="level31"><a class="markdownIt-Anchor" href="#level31"></a> level31</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level31"</span><span class="token punctuation">,</span><span class="token string">"aomapmyibu"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level31"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level32"><a class="markdownIt-Anchor" href="#level32"></a> level32</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level32"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newenv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"rnzara=mtqxpnweqm"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level32"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>newenv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level33"><a class="markdownIt-Anchor" href="#level33"></a> level33</h3>
<p>ËæìÂÖ•ÊµÅÈáçÂÆöÂêë</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level33"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newenv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level33"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>newenv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        FILE <span class="token operator">*</span>fp<span class="token operator">=</span><span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"/tmp/aoztam"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level34"><a class="markdownIt-Anchor" href="#level34"></a> level34</h3>
<p>ËæìÂá∫ÊµÅÈáçÂÆöÂêë</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span>
<span class="token keyword">void</span> <span class="token function">pwncollege</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newargv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"embryoio_level34"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>newenv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token constant">NULL</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level34"</span><span class="token punctuation">,</span>newargv<span class="token punctuation">,</span>newenv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>env<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">pid_t</span> fpid<span class="token punctuation">;</span>
    fpid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error in fork!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>fpid<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        FILE <span class="token operator">*</span>fp<span class="token operator">=</span><span class="token function">freopen</span><span class="token punctuation">(</span><span class="token string">"/tmp/ivyyzs"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">,</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im child!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pwncollege</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fpid<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Im Parent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level35"><a class="markdownIt-Anchor" href="#level35"></a> level35</h3>
<p>ËÆæÁΩÆÁ©∫ÁéØÂ¢ÉÂèòÈáèÔºå‰∏çÈáçÂ§çË¥¥‰∫Ü</p>
<h3 id="level36"><a class="markdownIt-Anchor" href="#level36"></a> level36</h3>
<pre class="line-numbers language-none"><code class="language-none">- the challenge checks for a specific parent process : bash
- the challenge checks for a specific process at the other end of stdout : cat
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ÈÇ£‰πàÊàë‰ª¨‰πãÈó¥bashÊâßË°åÔºå Â∞Üstdout ËæìÈÄÅÂà∞ catÂç≥ÂèØ</p>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level36 | cat<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level37"><a class="markdownIt-Anchor" href="#level37"></a> level37</h3>
<p>ËøôÈáåÊúâ‰∏™ÂùëÔºåÂõ†‰∏∫ÊàëÁî®ÁöÑvscode ÔºåÈªòËÆ§ÊòØ<code>dash</code></p>
<p>ÈúÄË¶ÅÊâãÂä®ËæìÂÖ•<code>bash</code>ÂàáÊç¢Âà∞<code>bash</code>ÁÑ∂ÂêéÊâçËÉΩÈÄöËøáÊ£ÄÊü•</p>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level37 | grep &quot;pwn&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level38"><a class="markdownIt-Anchor" href="#level38"></a> level38</h3>
<p>Â§ç‰π†‰∏Ä‰∏ã<code>sed</code></p>
<ol>
<li><strong>ÊõøÊç¢ÊñáÊú¨</strong>Ôºö
<ul>
<li><code>s/old/new/</code>ÔºöÂ∞ÜË°å‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÂåπÈÖçÁöÑ <code>old</code> ÊõøÊç¢‰∏∫ <code>new</code>„ÄÇ</li>
<li><code>s/old/new/g</code>ÔºöÂ∞ÜË°å‰∏≠ÊâÄÊúâÂåπÈÖçÁöÑ <code>old</code> ÊõøÊç¢‰∏∫ <code>new</code>„ÄÇ</li>
<li><code>s/old/new/2</code>ÔºöÂ∞ÜË°å‰∏≠Á¨¨‰∫å‰∏™ÂåπÈÖçÁöÑ <code>old</code> ÊõøÊç¢‰∏∫ <code>new</code>„ÄÇ</li>
</ul>
</li>
<li><strong>Âà†Èô§Ë°å</strong>Ôºö
<ul>
<li><code>d</code>ÔºöÂà†Èô§ÂåπÈÖçÁöÑË°å„ÄÇ</li>
<li><code>1d</code>ÔºöÂà†Èô§Á¨¨‰∏ÄË°å„ÄÇ</li>
<li><code>2,5d</code>ÔºöÂà†Èô§Á¨¨‰∫åÂà∞Á¨¨‰∫îË°å„ÄÇ</li>
</ul>
</li>
<li><strong>ÊèíÂÖ•ÂíåËøΩÂä†ÊñáÊú¨</strong>Ôºö
<ul>
<li><code>i\text</code>ÔºöÂú®ÂåπÈÖçË°åÂâçÊèíÂÖ•ÊñáÊú¨„ÄÇ</li>
<li><code>a\text</code>ÔºöÂú®ÂåπÈÖçË°åÂêéËøΩÂä†ÊñáÊú¨„ÄÇ</li>
</ul>
</li>
<li><strong>ÊâìÂç∞ÊñáÊú¨</strong>Ôºö
<ul>
<li><code>p</code>ÔºöÊâìÂç∞ÂåπÈÖçÁöÑË°å„ÄÇ</li>
</ul>
</li>
<li><strong>Ë°åÁöÑÈÄâÊã©</strong>Ôºö
<ul>
<li><code>5p</code>ÔºöÊâìÂç∞Á¨¨‰∫îË°å„ÄÇ</li>
<li><code>1,5p</code>ÔºöÊâìÂç∞Á¨¨‰∏ÄÂà∞Á¨¨‰∫îË°å„ÄÇ</li>
</ul>
</li>
<li><strong>ÊâßË°åÊñá‰ª∂‰∏≠ÁöÑÂëΩ‰ª§</strong>Ôºö
<ul>
<li><code>-f scriptfile</code>Ôºö‰ªéÊåáÂÆöÊñá‰ª∂‰∏≠ËØªÂèñ <code>sed</code> ÂëΩ‰ª§Âπ∂ÊâßË°å„ÄÇ</li>
</ul>
</li>
<li><strong>ÁºñËæëÊ†áËÆ∞</strong>Ôºö
<ul>
<li><code>b label</code>ÔºöË∑≥ËΩ¨Âà∞Ê†áËÆ∞ <code>label</code>„ÄÇ</li>
<li><code>t label</code>ÔºöÂ¶ÇÊûúÊúâÊõøÊç¢ÔºåÂàôË∑≥ËΩ¨Âà∞Ê†áËÆ∞ <code>label</code>„ÄÇ</li>
</ul>
</li>
<li><strong>Ë°åÂè∑</strong>Ôºö
<ul>
<li><code>=</code>ÔºöÊâìÂç∞Ë°åÂè∑„ÄÇ</li>
<li><code>N</code>ÔºöÂ∞Ü‰∏ã‰∏ÄË°åÊ∑ªÂä†Âà∞Ê®°ÂºèÁ©∫Èó¥„ÄÇ</li>
</ul>
</li>
<li><strong>Ê®°ÂºèÂåπÈÖç</strong>Ôºö
<ul>
<li><code>^</code>ÔºöÂåπÈÖçË°åÁöÑÂºÄÂ§¥„ÄÇ</li>
<li><code>$</code>ÔºöÂåπÈÖçË°åÁöÑÁªìÂ∞æ„ÄÇ</li>
<li><code>.</code>ÔºöÂåπÈÖç‰ªªÊÑèÂçï‰∏™Â≠óÁ¨¶„ÄÇ</li>
<li><code>*</code>ÔºöÂåπÈÖçÈõ∂‰∏™ÊàñÂ§ö‰∏™ÂâçÈù¢ÁöÑÂÖÉÁ¥†„ÄÇ</li>
</ul>
</li>
<li><strong>ÂÖ∂‰ªñÂëΩ‰ª§</strong>Ôºö
<ul>
<li><code>q</code>ÔºöÈÄÄÂá∫ <code>sed</code>„ÄÇ</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level38 | sed &quot;p&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level39"><a class="markdownIt-Anchor" href="#level39"></a> level39</h3>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level39 | rev |rev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level40"><a class="markdownIt-Anchor" href="#level40"></a> level40</h3>
<pre class="line-numbers language-none"><code class="language-none">cat | .&#x2F;embryoio_level40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level41"><a class="markdownIt-Anchor" href="#level41"></a> level41</h3>
<p>ÊúâÁÇπsb?</p>
<p>Ê≤°ÊáÇ‰ªÄ‰πàÂéüÁêÜ</p>
<p>ÂºÄÂßã‰ΩøÁî®<code>rev | ./embryoio_level41</code>ËæìÂÖ•ÂêéÊ≤°ÂèçÂ∫î</p>
<p><a target="_blank" rel="noopener" href="https://discord.com/channels/750635557666816031/1193136623169310731/threads/1214880613790777365">‚Ä¢ Discord | #program-interaction | pwn.college</a></p>
<p>ÂèëÁé∞ÂæàÂ§ö‰∫∫ÂíåÊàë‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂú®vscodeÈáåÈù¢ÁöÑÁªàÁ´ØÊêûÂ∞±‰∏çÂ§™Ë°å</p>
<p>ËøôÈáåÊúâËØ¶ÁªÜÁöÑËÆ®ËÆ∫</p>
<p>ÂéüÂõ†Â§ßÊ¶ÇÊòØÂõ†‰∏∫<code>rev</code>‰∏ç‰ºöÂ§ÑÁêÜ<code>\n</code>,ÈúÄË¶ÅÊàë‰ª¨ÊâãÂä®ËæìÂÖ•<code>ctrl+D</code>ÂèëÁîü<code>EOF</code>‰ø°Âè∑</p>
<p>ËøôÊ†∑Â∞±Ëß£ÂÜ≥‰∫Ü</p>
<h3 id="level42"><a class="markdownIt-Anchor" href="#level42"></a> level42</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./embryoio_level42 <span class="token operator">|</span> <span class="token function">cat</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ÁÑ∂Âêé<code>bash 1.sh</code>ÊâßË°åËøô‰∏™ËÑöÊú¨,ÂèàÊòØ‰∏ÄÈÅçËΩÆÂõû</p>
<h3 id="level43"><a class="markdownIt-Anchor" href="#level43"></a> level43</h3>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level43 | grep &quot;pwn&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level44"><a class="markdownIt-Anchor" href="#level44"></a> level44</h3>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level44 | sed &quot;p&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level45"><a class="markdownIt-Anchor" href="#level45"></a> level45</h3>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;embryoio_level45 | rev | rev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level46"><a class="markdownIt-Anchor" href="#level46"></a> level46</h3>
<pre class="line-numbers language-none"><code class="language-none">cat | .&#x2F;embryoio_level46<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="level47"><a class="markdownIt-Anchor" href="#level47"></a> level47</h3>
<pre class="line-numbers language-none"><code class="language-none">rev|rev | .&#x2F;embryoio_level47<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>ËÆ∞ÂæóËæìÂÖ•<code>ctrl + D</code></p>
<h3 id="level48"><a class="markdownIt-Anchor" href="#level48"></a> level48</h3>
<p>Ê†πÊçÆÊèêÁ§∫ÔºåÂèØ‰ª•‰ΩøÁî®<code>subprocess</code>‰πüÂèØ‰ª•‰ΩøÁî®<code>pwntools</code></p>
<p><code>subprocess</code>Âè™ËÉΩ‰ΩøÁî®<code>popen</code>Âõ†‰∏∫<code>run</code>ÁöÑÂå∫Âà´Âú®‰∫é</p>
<p><code>subprocess.Popen</code> Âíå <code>subprocess.run</code> ÈÉΩÊòØ Python ‰∏≠Áî®‰∫éÊâßË°åÂ§ñÈÉ®ÂëΩ‰ª§ÁöÑÊ®°Âùó„ÄÇÂÆÉ‰ª¨‰πãÈó¥ÁöÑ‰∏ªË¶ÅÂå∫Âà´Âú®‰∫éÔºö</p>
<ol>
<li><strong>ËøîÂõûÂÄº</strong>Ôºö
<ul>
<li><code>subprocess.Popen</code> ËøîÂõû‰∏Ä‰∏™ Popen ÂØπË±°ÔºåËØ•ÂØπË±°Ë°®Á§∫Ê≠£Âú®ËøêË°åÁöÑÂ≠êËøõÁ®ã„ÄÇ‰Ω†ÂèØ‰ª•‰ΩøÁî®ËØ•ÂØπË±°ÁöÑÊñπÊ≥ïÊù•‰∏éÂ≠êËøõÁ®ãËøõË°å‰∫§‰∫íÔºå‰æãÂ¶ÇÁ≠âÂæÖÂÖ∂ÂÆåÊàêÊàñÂèëÈÄÅËæìÂÖ•„ÄÇ</li>
<li><code>subprocess.run</code> ËøîÂõû‰∏Ä‰∏™ CompletedProcess ÂØπË±°ÔºåËØ•ÂØπË±°ÂåÖÂê´ÊúâÂÖ≥ËøêË°åÂëΩ‰ª§ÁöÑ‰ø°ÊÅØÔºåÂ¶ÇËøîÂõûÁ†Å„ÄÅÊ†áÂáÜËæìÂá∫ÂíåÊ†áÂáÜÈîôËØØ</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level48"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ÂºÇÊàñ??</p>
<p>ÊàëÈòÖËØª‰∫Ü<code>pwntools</code>ÁöÑÊñáÊ°£ÔºåÊàëËÆ§‰∏∫</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># ÂêØÂä®‰∏Ä‰∏™Â≠êËøõÁ®ãÊâßË°åÂëΩ‰ª§ÔºåÂπ∂Â∞ÜËæìÂá∫ÈáçÂÆöÂêëÂà∞‰∏Ä‰∏™ÁÆ°ÈÅì</span>
p1 <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"/challenge/embryoio_level48"</span><span class="token punctuation">)</span>

<span class="token comment"># ‰ΩøÁî®catÂëΩ‰ª§ËØªÂèñÂ≠êËøõÁ®ãÁöÑËæìÂá∫</span>
p2 <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>

<span class="token comment"># ËØªÂèñcatÂëΩ‰ª§ÁöÑËæìÂá∫</span>
output <span class="token operator">=</span> p2<span class="token punctuation">.</span>recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># ÊâìÂç∞ËæìÂá∫</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>‰∏∫‰ªÄ‰πà‰∏çË°åÂë¢</p>
<p><s>ÂøÉÊÄÅÁàÜÁÇ∏‰∫Ü</s></p>
<p>Á†îÁ©∂‰∏ÄÊ≥¢<code>pwntools</code></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kelxLZ/article/details/123152529">Pwntools 2022ÁÆÄÊòéÊâãÂÜå_pwntoolsÊâãÂÜå-CSDNÂçöÂÆ¢</a></p>
<p><a target="_blank" rel="noopener" href="https://gist.github.com/anvbis/64907e4f90974c4bdd930baeb705dedf">pwntools-cheatsheet.md (github.com)</a></p>
<h3 id="level49"><a class="markdownIt-Anchor" href="#level49"></a> level49</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level49"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"grep"</span><span class="token punctuation">,</span><span class="token string">"pwn"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level50"><a class="markdownIt-Anchor" href="#level50"></a> level50</h3>
<p>Âú®Ipython‰∏≠ËøêË°å</p>
<h3 id="level51"><a class="markdownIt-Anchor" href="#level51"></a> level51</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level51"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p2<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level52"><a class="markdownIt-Anchor" href="#level52"></a> level52</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level52"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level53"><a class="markdownIt-Anchor" href="#level53"></a> level53</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p1 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level53"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ËæìÂÖ•ÂØÜÁ†ÅÂêéËÆ∞Âæó<code>ctrl+D</code>ÂèëÁîü<code>fd</code>Ê†áËØÜ</p>
<h3 id="level54"><a class="markdownIt-Anchor" href="#level54"></a> level54</h3>
<p>Áî®pythonÊâßË°åÂàöÊâçÁöÑËÑöÊú¨ÂèàÊòØ‰∏ÄÈÅçËΩÆÂõû ÊàëËßâÂæóÂèØ‰ª•Á≤æÁÆÄ‰∏Ä‰∏ã</p>
 <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level54"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level55"><a class="markdownIt-Anchor" href="#level55"></a> level55</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level55"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"grep"</span><span class="token punctuation">,</span><span class="token string">"pwn"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level56"><a class="markdownIt-Anchor" href="#level56"></a> level56</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level56"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"sed"</span><span class="token punctuation">,</span><span class="token string">"p"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level57"><a class="markdownIt-Anchor" href="#level57"></a> level57</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level57"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p2<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level58"><a class="markdownIt-Anchor" href="#level58"></a> level58</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess

p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>close_fds<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level58"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p1<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level59"><a class="markdownIt-Anchor" href="#level59"></a> level59</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocess
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p2<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"rev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p2<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
p1<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/challenge/embryoio_level59"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>stdin<span class="token operator">=</span>p2<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span>stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="level60"><a class="markdownIt-Anchor" href="#level60"></a> level60</h3>
<p>Áî®CËØ≠Ë®ÄÁºñÁ®ãÂÆûÁé∞‰ª•‰∏äËøáÁ®ãÔºåÂèàÊòØ‰∏ÄÈÅçËΩÆÂõû<s>ÂÖ≥‰∫éÊàë9Ê¨°ËΩÆÂõûËøô‰ª∂‰∫ã</s></p>
<p>ËøôÈáåÈúÄË¶ÅÊ∑±ÂÖ•‰∫ÜËß£<code>Linux</code>ÁöÑ<code>pipe</code>Êú∫Âà∂Ôºå‰∏çËÉΩËÄÅÂΩì<code>Ë∞ÉÂåÖ‰æ†</code></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/58489873">Linux ÁöÑËøõÁ®ãÈó¥ÈÄö‰ø°ÔºöÁÆ°ÈÅì - Áü•‰πé (zhihu.com)</a></p>
<p><code>ÁÆ°ÈÅìÁöÑËÆæËÆ°‰πüÊòØÈÅµÂæ™UNIXÁöÑ‚Äú‰∏ÄÂàáÁöÜÊñá‰ª∂‚ÄùËÆæËÆ°ÂéüÂàôÁöÑ</code></p>
<p><code>ÂÆûÁé∞ÂΩ¢ÊÄÅ‰∏äÊòØÊñá‰ª∂Ôºå‰ΩÜÊòØÁÆ°ÈÅìÊú¨Ë∫´Âπ∂‰∏çÂç†Áî®Á£ÅÁõòÊàñËÄÖÂÖ∂‰ªñÂ§ñÈÉ®Â≠òÂÇ®ÁöÑÁ©∫Èó¥</code></p>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/05/09/PwnCollege1-ProgramMiuse/" rel="prev" title="pwnCollege1-ProgramMiuse"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">pwnCollege1-ProgramMiuse</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/05/04/web-practices/" rel="next" title="web-practices"><span class="post-nav-text">web-practices</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>ÊÇ®ÈúÄË¶ÅÁßëÂ≠¶‰∏äÁΩëÔºåÊâçÂèØ‰ΩøÁî®ËØÑËÆ∫Âå∫ÂäüËÉΩ„ÄÇ</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/05/09/PwnCollege2-ProgramInteraction/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank"></a></div><div class="copyright"><span>&copy; 2023 ‚Äì 2024 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Npc</span></div><div class="footer-custom-text">=w=</div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div class="search-result-container"></div></div><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>